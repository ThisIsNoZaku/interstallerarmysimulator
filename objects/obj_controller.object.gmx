<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1000</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>


test_map=false;
target_navy_number=5;
global.sound_playing=0;
global.defeat=0;tutorial=0;
sound_in=0;sound_to="";
fix_left=0;fix_right=0;
text_bar=0;bar_fix=0;
last_attack_form=1;
last_raid_form=3;
double_click=0;
double_was=0;
last_weapons_tab=1;
complex_event=false;
current_eventing="";
chaos_rating=0;
obj_cuicons.alarm[1]=1;// Clean up custom icons


obj_controller.restart_name="";
obj_controller.restart_founding="";
obj_controller.restart_secret="";
obj_controller.restart_title[0]="";
var i;i=0;repeat(11){i+=1;obj_controller.restart_title[i]="";}
obj_controller.restart_icon=0;
obj_controller.restart_icon_name="";
obj_controller.restart_powers="";
var ad;ad=-1;repeat(5){ad+=1;obj_controller.restart_adv[ad]="";obj_controller.restart_dis[ad]="";}
obj_controller.restart_recruiting_type="";
obj_controller.restart_trial="";
obj_controller.restart_recruiting_name="";
obj_controller.restart_home_type="";
obj_controller.restart_home_name="";
obj_controller.restart_fleet_type=0;
obj_controller.restart_recruiting_exists=0;
obj_controller.restart_homeworld_exists=0;
obj_controller.restart_homeworld_rule=0;
obj_controller.restart_battle_cry="";
obj_controller.restart_main_color="";
obj_controller.restart_secondary_color="";
obj_controller.restart_trim_color="";
obj_controller.restart_pauldron2_color="";
obj_controller.restart_pauldron_color="";
obj_controller.restart_lens_color="";
obj_controller.restart_weapon_color="";
obj_controller.restart_col_special=0;
obj_controller.restart_trim=0;
obj_controller.restart_skin_color=0;
obj_controller.restart_hapothecary="";
obj_controller.restart_hchaplain="";
obj_controller.restart_clibrarian="";
obj_controller.restart_fmaster="";
obj_controller.restart_recruiter="";
obj_controller.restart_admiral="";
obj_controller.restart_equal_specialists=0;
obj_controller.restart_load_to_ships=0;
obj_controller.restart_successors=0;
obj_controller.restart_mutations=0;
obj_controller.restart_preomnor=0;
obj_controller.restart_voice=0;
obj_controller.restart_doomed=0;
obj_controller.restart_lyman=0;
obj_controller.restart_omophagea=0;
obj_controller.restart_ossmodula=0;
obj_controller.restart_membrane=0;
obj_controller.restart_zygote=0;
obj_controller.restart_betchers=0;
obj_controller.restart_catalepsean=0;
obj_controller.restart_secretions=0;
obj_controller.restart_occulobe=0;
obj_controller.restart_mucranoid=0;
obj_controller.restart_master_name="";
obj_controller.restart_master_melee=0;
obj_controller.restart_master_ranged=0;
obj_controller.restart_master_specialty=0;
obj_controller.restart_strength=0;
obj_controller.restart_cooperation=0;
obj_controller.restart_purity=0;
obj_controller.restart_stability=0;

i=99;
repeat(3){i+=1;
    obj_controller.r_role[i,2]="Honor Guard";obj_controller.r_wep1[i,2]="Power Sword";obj_controller.r_wep2[i,2]=string(obj_img.gyro);
    obj_controller.r_armor[i,2]="Power Armor";obj_controller.r_mobi[i,2]="";obj_controller.r_gear[i,2]="";
    
    obj_controller.r_role[i,3]="Veteran";obj_controller.r_wep1[i,3]=string(obj_img.blade)+"sword";obj_controller.r_wep2[i,3]=string(obj_img.gyro);
    obj_controller.r_armor[i,3]="Power Armor";obj_controller.r_mobi[i,3]="";obj_controller.r_gear[i,3]="";
    
    obj_controller.r_role[i,4]="Terminator";obj_controller.r_wep1[i,4]="Power Fist";obj_controller.r_wep2[i,4]="Storm "+string(obj_img.gyro);
    obj_controller.r_armor[i,4]=string(obj_img.battlesuit);obj_controller.r_mobi[i,4]="";obj_controller.r_gear[i,4]="";
    
    obj_controller.r_role[i,5]="Captain";obj_controller.r_wep1[i,5]="Power Fist";obj_controller.r_wep2[i,5]=string(obj_img.gyro_adj)+" Pistol";
    obj_controller.r_armor[i,5]="Power Armor";obj_controller.r_mobi[i,5]="";obj_controller.r_gear[i,5]="";
    
    obj_controller.r_role[i,6]=obj_img.unit[1,6];obj_controller.r_wep1[i,6]="Close Combat Weapon";obj_controller.r_wep2[i,6]=string(obj_img.laser)+"cannon";
    obj_controller.r_armor[i,6]=obj_img.unit[1,6];obj_controller.r_mobi[i,6]="";obj_controller.r_gear[i,6]="";
    
    obj_controller.r_role[i,7]="Company Champion";obj_controller.r_wep1[i,7]="Power Sword";obj_controller.r_wep2[i,7]="Storm Shield";
    obj_controller.r_armor[i,7]="Power Armor";obj_controller.r_mobi[i,7]="";obj_controller.r_gear[i,7]="";
    
    obj_controller.r_role[i,8]="Tactical Marine";obj_controller.r_wep1[i,8]=string(obj_img.gyro);obj_controller.r_wep2[i,8]=string(obj_img.blade)+"sword";
    obj_controller.r_armor[i,8]="Power Armor";obj_controller.r_mobi[i,8]="";obj_controller.r_gear[i,8]="";
    
    obj_controller.r_role[i,9]="Devastator";obj_controller.r_wep1[i,9]="Heavy Ranged";obj_controller.r_wep2[i,9]=string(obj_img.gyro_adj)+" Pistol";
    obj_controller.r_armor[i,9]="Power Armor";obj_controller.r_mobi[i,9]="";obj_controller.r_gear[i,9]="";
    
    obj_controller.r_role[i,10]="Assault Marine";obj_controller.r_wep1[i,10]=string(obj_img.blade)+"sword";obj_controller.r_wep2[i,10]=string(obj_img.gyro_adj)+" Pistol";
    obj_controller.r_armor[i,10]="Power Armor";obj_controller.r_mobi[i,10]="Jump Pack";obj_controller.r_gear[i,10]="";
    
    obj_controller.r_role[i,12]="Scout";obj_controller.r_wep1[i,12]="Sniper Rifle";obj_controller.r_wep2[i,12]=string(obj_img.blade)+"sword";
    obj_controller.r_armor[i,12]="Scout Armor";obj_controller.r_mobi[i,12]="";obj_controller.r_gear[i,12]="";
    
    obj_controller.r_role[i,14]="Chaplain";obj_controller.r_wep1[i,14]="Power Sword";obj_controller.r_wep2[i,14]="Storm "+string(obj_img.gyro);
    obj_controller.r_armor[i,14]="Power Armor";obj_controller.r_gear[i,14]="Rosarius";obj_controller.r_mobi[i,14]="";
    
    obj_controller.r_role[i,15]="Apothecary";obj_controller.r_wep1[i,15]="Power Sword";obj_controller.r_wep2[i,15]="Storm "+string(obj_img.gyro);
    obj_controller.r_armor[i,15]="Power Armor";obj_controller.r_gear[i,15]="Narthecium";obj_controller.r_mobi[i,15]="";
    
    obj_controller.r_role[i,16]="Techmarine";obj_controller.r_wep1[i,16]="Power Axe";obj_controller.r_wep2[i,16]="Storm "+string(obj_img.gyro);
    obj_controller.r_armor[i,16]="Power Armor";obj_controller.r_gear[i,16]="Servo Arms";obj_controller.r_mobi[i,16]="";
    
    obj_controller.r_role[i,17]="Librarian";obj_controller.r_wep1[i,17]="Force Weapon";obj_controller.r_wep2[i,17]="Storm "+string(obj_img.gyro);
    obj_controller.r_armor[i,17]="Power Armor";obj_controller.r_gear[i,17]="Psychic Hood";obj_controller.r_mobi[i,17]="";

}// 100 is defaults, 101 is the allowable starting equipment

i=-1;repeat(21){i+=1;
    obj_controller.r_race[100,i]=0;
    obj_controller.r_role[100,i]="";
    obj_controller.r_wep1[100,i]="";
    obj_controller.r_wep2[100,i]="";
    obj_controller.r_armor[100,i]="";
    obj_controller.r_gear[100,i]="";
    obj_controller.r_mobi[100,i]="";
}
// 
// 
// 


window_data=string(window_get_x())+"|"+string(window_get_y())+"|"+string(window_get_width())+"|"+string(window_get_height())+"|";
window_old=window_data;if (window_get_fullscreen()=1){window_old="fullscreen";window_data="fullscreen";}
cheatcode=0;cheatyface=0;

debug_lines=0;
ini_open("debug_log.ini");
debug_lines=ini_read_real("Main","lines",0);
ini_close();

debugl("=========Controller Created");

ini_open("saves.ini");
master_volume=ini_read_real("Settings","master_volume",1);
effect_volume=ini_read_real("Settings","effect_volume",1);
music_volume=ini_read_real("Settings","music_volume",1);
large_text=ini_read_real("Settings","large_text",0);
settings_heresy=ini_read_real("Settings","settings_heresy",0);
settings_fullscreen=ini_read_real("Settings","fullscreen",1);
settings_window_data=ini_read_string("Settings","window_data","fullscreen");
    if (test_map=true) then global.cheat_debug=true;
ini_close();



/*
    Welcome to the project file for Chapter Master.  As of December
    2014 I will be attempting to add documentation across this file
    in order to facilitate the transfer of development.  This comment
    in particular will give you a rundown on the most key parts of
    Chapter Master.  Burn it to memory and it will help smooth out
    development.
    
    
    The main objects that you will probably be concering yourself
    with are as follows:
    
    obj_ini: Handles all of the marine, ship, and vehicle variables.
    It is first created after going through the main menu and
    finilizing chapter creation.
    
    obj_controller: Misc variables, is the focus of the room view,
    and draws the vast majority of the user interface.
    
    obj_popup: Draws and handles all of the popup stuff (such as
    random events, confirmation boxes, changing equipment, etc.)
    
    
    In addition to these objects, there are also a multitude of
    scripts.  They are split into a number of folders for different
    categories and relatively clean access.
    
    Sys: Utility functions that should be included within frikkin'
    Game Maker.  Stuff like drawing dotted lines, adding comas to
    numbers, exploding a banana string into multiple variables.
    
    Combat: Anything that relates to things dying goes in here.
    Note that the scr_weapon script also handles the tooltips for
    weapons and their stats, until it is cleaned up and rewritten.
    
    Interface: This contains all of the long, probably uneccesary
    scripts for drawing the UI.  The controller object executes these
    in the draw function when certain criteria is met.
    
    Turn: All of the end-of-turn AI, random events, and actions
    pertaining to ending turn go in here.  Note that the enemy AI
    is split further into a handful of different scripts, designated
    as A, B, C, D, and E.  These are all ran on each star object each
    turn.
        A: Enemy ground combat
        B: Rebellions, number increases, spreading
        C: Enemy production of ships
        D: Local random event happenings
        E: Enemy space combat and quening player battles
    Note that the alarm5 event of the controller also has some turn
    end scripts- this one handles the END of END of turn for variables
    and crap that is not neccesarily pertaining to a local star or planet.
    
    Diplomacy: Everything related to quests, trading, dialogue, and 
    names goes into this folder.  The scr_dialogue in particular is
    the main script that contains all of the dialogue writing for
    each enemy race.
    
    Root Folder: All of the frequently-accessed scripts that don't
    fall neatly into the other folders go on top.  The most important
    ones to take note of are scr_chapter (contains all the presets),
    chapter_random (randomizes the chapter), scr_initialize_custom
    (executed by obj_ini to generate the actual chapter arrays), and
    scr_loyalty (either calculates the loyalty or changes it on
    demand).  Check equipment, add items, add man, add vehicle, and add
    artifact are also in this root folder, and frequently used.
    
    The Machine God watches over you.
*/





info_fragments=0;
play_time=0;
play_second=0;
invis=false;

otha=0;
zoomed=0;
spr_custom1=0;
spr_custom2=0;
spr_custom3=0;
spr_custom4=0;
force_scroll=0;
homeworld_rule=1;
demanding=0;
select_wounded=1;
terra_direction=floor(random(360))+1;

load_game=0;
good_log=0;

// Line
l_options=0;
l_menu=0;
l_manage=0;
l_settings=0;
l_apothecarium=0;
l_reclusium=0;
l_librarium=0;
l_armory=0;
l_recruitment=0;
l_fleet=0;
l_diplomacy=0;
l_log=0;
l_turn=0;
// Highlight
h_options=0;
h_menu=0;
h_manage=0;
h_settings=0;
h_apothecarium=0;
h_reclusium=0;
h_librarium=0;
h_armory=0;
h_recruitment=0;
h_fleet=0;
h_diplomacy=0;
h_log=0;
h_turn=0;
// Relative Y
y_slide=0;
new_banner_x=0;
hide_banner=0;
// 
new_button_highlight="";
// new_button_highlighting=0;
new_buttons_hide=0;
new_buttons_frame=0;

tooltip="";
tooltip_weapon=0;
tooltip_stat1=0;
tooltip_stat2=0;
tooltip_stat3=0;
tooltip_stat4=0;
tooltip_other="";
tooltip_x=0;
tooltip_y=0;
tooltip_width=0;
tooltip_height=0;

// for weapon display in management
ui_weapon[1]=0;ui_weapon[2]=0;
ui_arm[1]=true;ui_arm[2]=true;
ui_above[1]=true;ui_above[2]=true;
ui_spec[1]=false;ui_spec[2]=false;
ui_twoh[1]=false;ui_twoh[2]=false;
ui_xmod[1]=0;ui_xmod[2]=0;
ui_ymod[1]=0;ui_ymod[2]=0;
ui_back=true;ui_force_both=false;
ui_specialist=0;ttrim=0;ui_coloring="";
// 
ui_melee_penalty=0;
ui_ranged_penalty=0;
// End


click=0;
click2=0;
mouse_left=0;
dropdown_open=0;
scrollbar_engaged=0;
born_leader=0;

craftworld=0;
hurssy=0;
hurssy_time=0;
qsfx=0;

und_armories=0;
und_gene_vaults=0;
und_lairs=0;

gene_sold=0;
gene_xeno=0;
gene_tithe=24;
gene_iou=0;

// 
managing=0;formating=0;
man_current=0;man_max=0;man_see=0;
ship_current=0;ship_max=0;ship_see=0;
man_sel[0]=0;man_size=0;
selecting_location="";
selecting_types="";
selecting_dudes="";
sel_all="";
sel_promoting=0;
sel_loading=0;
sel_uid=0;

// for chapter events and celebrations
fest_sid=0;fest_wid=0;fest_planet=0;fest_star="";
fest_type="";fest_cost=0;fest_warp=0;fest_scheduled=0;
fest_lav=0;fest_locals=0;
fest_feature1=0;fest_feature2=0;fest_feature3=0;
fest_display=0;fest_display_tags="";fest_repeats=0;
fest_honor_co=0;fest_honor_id=0;fest_honoring=0;
fest_attend="";

fest_feasts=0;fest_boozes=0;fest_drugses=0;

var i;i=-1;repeat(2001){i+=1;
    recent_type[i]="";recent_keyword[i]="";recent_turn[i]=0;recent_number[i]=0;
}recent_happenings=0;
// end chapter events and celebrations


var i;i=-1;repeat(40){i+=1;sel_uni[i]="";sel_veh[i]="";command_set[i]=0;}
command_set[1]=0;command_set[2]=0;
command_set[3]=1;command_set[4]=1;command_set[5]=1;command_set[6]=1;command_set[7]=1;
command_set[8]=0;command_set[9]=0;command_set[20]=1;command_set[24]=1;
blandify=0;

selecting_planet=0;
selecting_ship=0;
fleet_minimized=0;
fleet_all=1;
tolerant=0;
unload=0;
new_vehicles=1;
menu=500;
settings=0;
text_bar=0;
text_selected="";
return_object=0;
return_size=0;
// menu=0;
menu_artifact=1;
menu_artifact_type=0;
menu_adept=0;
artifacts=0;
identifiable=0;
repair_ships=0;
// 
stc_wargear=0;stc_vehicles=0;stc_ships=0;stc_un_total=0;
stc_wargear_un=0;stc_vehicles_un=0;stc_ships_un=0;
stc_bonus[0]=0;stc_bonus[1]=0;stc_bonus[2]=0;stc_bonus[3]=0;
stc_bonus[4]=0;stc_bonus[5]=0;stc_bonus[6]=0;

// 

check_number=0;
year_fraction=0;
year=0;
millenium=0;

if (instance_exists(obj_ini)){
    if (obj_ini.millenium!=0){
        check_number=obj_ini.check_number;
        year_fraction=0;// 84 per turn
        year=obj_ini.year;
        millenium=obj_ini.millenium;
    }
}

penitent=0;
penitent_current=0;
penitent_max=0;
penitent_turnly=0;
penitent_turn=0;
penitent_end=0;
blood_debt=0;


/*
if (bloo=1) and (instance_exists(obj_controller)){obj_controller.blood_debt=1;}
if (bloo=1){
    penitent=1;penitent_max=(obj_creation.strength*1000)+300;
    penitent_current=300;penitent_end=obj_creation.strength*48;
}
if (bloo=0){
    penitent=1;penitent_max=(obj_creation.strength*60);
    penitent_current=1;
    penitent_end=obj_creation.strength*5;
}*/


if (instance_exists(obj_ini)){
    var o,bloo;bloo=0;o=0;repeat(4){o+=1;if (obj_ini.dis[o]="Blood Debt") then bloo=1;}

    penitent=obj_ini.penitent;
    penitent_current=obj_ini.penitent_current;
    penitent_max=obj_ini.penitent_max;
    
    if (bloo=1){
        penitent_end=millenium+year+(obj_ini.penitent_end/12);
        blood_debt=1;
    }
    if (bloo=0){
        penitent_end=millenium+year+(obj_ini.penitent_end);
    }
    
    if (string_count(obj_ini.spe[0,1],"$")&gt;0) then born_leader=1;
}

// 
var i;i=-1;
repeat(501){i+=1;
    man[i]="";ide[i]=0;man_sel[i]=0;ma_lid[i]=0;ma_wid[i]=0;ma_promote[i]=0;
    ma_race[i]=0;ma_loc[i]="";ma_name[i]="";ma_role[i]="";ma_wep1[i]="";ma_mobi[i]="";
    ma_wep2[i]="";ma_armor[i]="";ma_gear[i]="";ma_health[i]=100;ma_chaos[i]=0;ma_exp[i]=0;ma_god[i]=0;
    sh_ide[i]=0;sh_uid[i]=0;sh_name[i]="";sh_class[i]="";sh_loc[i]="";sh_hp[i]="";sh_cargo[i]=0;sh_cargo_max[i]="";
    squad[i]=0;
    
    if (i&lt;=50){penit_co[i]=0;penit_id[i]=0;}
    if (i&lt;=100){event[i]="";event_duration[i]=0;}
}
alll=0;
//
popup=0;// 1: fleet, 2: other, 3: system
selected=0;
sel_owner=0;
sel_system_x=0;
sel_system_y=0;
popup_master_crafted=0;

turn=1;
// turn=40;

last_event=0;
last_mission=0;

last_world_inspection=0;// Duhuhu
last_fleet_inspection=0;

// chaos_turn=100+((floor(random(10))+1)*choose(-1,1));
chaos_turn=2;

chaos_fleets=0;
tau_fleets=0;
tau_stars=0;
tau_messenger=0;
imp_ships=0;
cooldown=8;
exit_all=0;
// 
diplomacy=0;
trading=0;
trading_artifact=0;
trading_enemy_demand=0;
trading_demand=0;
trade_likely="";
questing=0;
liscensing=0;
audience=0;
force_goodbye=0;
trade_req=0;trade_gene=0;trade_chip=0;trade_info=0;
zui=0;
was_zoomed=1;

// Variables for management
var t;t=-1;
repeat(200){
    t+=1;temp[t]="";
}
temp[90]=0;
temp[9000]="";
t=4699;repeat(20){t+=1;temp[t]=0;temp[t+100]=0;}

audiences=0;
audien[0]=0;audien[1]=0;audien[2]=0;audien[3]=0;audien[4]=0;audien[5]=0;
audien[6]=0;audien[7]=0;audien[8]=0;audien[9]=0;audien[10]=0;audien[11]=0;
audien[12]=0;audien[13]=0;audien[14]=0;
audien_topic[0]="";audien_topic[1]="";audien_topic[2]="";audien_topic[3]="";audien_topic[4]="";audien_topic[5]="";
audien_topic[6]="";audien_topic[7]="";audien_topic[8]="";audien_topic[9]="";audien_topic[10]="";audien_topic[11]="";
audien_topic[12]="";audien_topic[13]="";audien_topic[14]="";
// 
recruits=0;
recruiting_worlds="";
recruit_trial="Blood Duel";
// 
recruit_last=0;
var i;i=-1;
repeat(501){
    i+=1;
    recruit_name[i]="";
    recruit_corruption[i]=0;
    recruit_distance[i]=0;
    recruit_training[i]=0;
    recruit_exp[i]=0;
    
    if (i&lt;=50){// For loyalty penalties
        loyal[i]="";
        loyal_num[i]=0;// If less than 1 and greater than 0; that x100 is the chance for discovery
        loyal_time[i]=0;
    }
    if (i&lt;=10){
        inquisitor_gender[i]=choose(1,1,1,1,2,2,2);
        inquisitor_type[i]=choose("Ordo Malleus","Ordo Xenos","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus");
        inquisitor[i]=scr_imperial_name(inquisitor_gender[i]);// For 'random inquisitor wishes to inspect your fleet
    }
    if (i&lt;60){
        quest[i]="";// 300req
        quest_faction[i]=0;// 6
        quest_end[i]=0;// like 4 or so after the turn this is created
    }
}
diplo_last="";
diplo_text="";
diplo_txt="";
diplo_char=0;
var q;q=-1;repeat(6){q+=1;diplo_option[q]="";diplo_goto[q]="";}
diplo_alpha=0;
combat=0;
random_event_next="";
// random_event_next="space_hulk";
useful_info="";

// 
i=0;
i+=1;loyal[i]="Heretic Contact";
i+=1;loyal[i]="Heretical Homeworld";
i+=1;loyal[i]="Traitorous Marines";
i+=1;loyal[i]="Use of Sorcery";
i+=1;loyal[i]="Mutant "+string(obj_img.organics);

i+=1;loyal[i]="Non-Codex Arming";
i+=1;loyal[i]="Non-Codex Size";
i+=1;loyal[i]="Lack of "+string(obj_img.unit[1,15]);
i+=1;loyal[i]="Upset Machine Spirits";
i+=1;loyal[i]="Undevout";
i+=1;loyal[i]="Irreverance for His Servants";
i+=1;loyal[i]="Unvigilant";
i+=1;loyal[i]="Conduct Unbecoming";
i+=1;loyal[i]="Refusing to Crusade";

i+=1;loyal[i]=string(obj_img.faction[6])+" Contact";
i+=1;loyal[i]=string(obj_img.faction[7])+" Contact";
i+=1;loyal[i]=string(obj_img.faction[8])+" Contact";
i+=1;loyal[i]="Xeno Trade";
i+=1;loyal[i]="Xeno Associate";

i+=1;loyal[i]=string(obj_img.faction_dude_formal[4])+" Killer";
i+=1;loyal[i]="Crossing the "+string(obj_img.faction[4]);
i+=1;loyal[i]="Avoiding Inspections";
i+=1;loyal[i]="Lost Standard";

inqis_flag_lair=0;
inqis_flag_gene=0;

faction_justmet=0;

trade_mine[0]="";trade_mine[1]="Requisition";trade_mine[2]="Gene-Seed";trade_mine[3]="STC Fragment";trade_mine[4]="Info Chip";
trade_theirs[0]="";trade_theirs[1]="";trade_theirs[2]="";trade_theirs[3]="";trade_theirs[4]="";trade_theirs[5]="";trade_theirs[6]="";
trade_disp[0]=0;trade_disp[1]=0;trade_disp[2]=0;trade_disp[3]=0;trade_disp[4]=0;trade_disp[5]=0;trade_disp[6]=0;
trade_take[0]="";trade_take[1]="";trade_take[2]="";trade_take[3]="";trade_take[4]="";
trade_tnum[0]=0;trade_tnum[1]=0;trade_tnum[2]=0;trade_tnum[3]=0;trade_tnum[4]=0;
trade_give[0]="";trade_give[1]="";trade_give[2]="";trade_give[3]="";trade_give[4]="";
trade_mnum[0]=0;trade_mnum[1]=0;trade_mnum[2]=0;trade_mnum[3]=0;trade_mnum[4]=0;

requisition=500;
if (instance_exists(obj_ini)){
    if (obj_ini.progenitor=0) /*and (obj_creation.custom=0)*/ and (global.chapter_name!="Doom Benefactors") then requisition=2000;
}
if (test_map=true) then requisition=50000;



income=0;income_last=0;
/*income-=obj_ini.battle_barges;
income-=obj_ini.strike_cruisers/2;
income-=(obj_ini.gladius+obj_ini.hunters)/10;*/
income_base=0;income_home=0;income_forge=0;income_agri=0;
income_recruiting=0;income_training=0;income_fleet=0;income_trade=0;income_leader=0;income_tribute=0;income_controlled_planets=0;

info_chips=0;
inspection_passes=0;
recruiting_worlds_bought=0;



// BATTLE FORMATIONS
var i;i=-1;repeat(16){i+=1;
    bat_formation[i]="";bat_formation_type[i]=0;
    bat_deva_for[i]=1;bat_assa_for[i]=4;
    bat_tact_for[i]=2;bat_vete_for[i]=2;
    bat_hire_for[i]=3;bat_libr_for[i]=3;
    bat_comm_for[i]=3;bat_tech_for[i]=3;
    bat_term_for[i]=3;bat_hono_for[i]=3;
    bat_drea_for[i]=5;bat_rhin_for[i]=6;
    bat_pred_for[i]=7;bat_land_for[i]=7;
    bat_scou_for[i]=1;
}
//                          ground=1    raid=2
// 1: Attack        type=1
// 2: Defend        type=1
// 3: Raid              type=2
// 4: (New Formation)   type=0
bat_formation[1]="Attack";bat_formation_type[1]=1;
bat_formation[2]="Defend";bat_formation_type[2]=1;
bat_formation[3]="Raid";bat_formation_type[3]=2;
// Defaults end here


bat_devastator_column=1;
bat_assault_column=4;
bat_tactical_column=2;
bat_veteran_column=2;
bat_hire_column=3;
bat_librarian_column=3;
bat_command_column=3;
bat_techmarine_column=3;
bat_terminator_column=3;
bat_honor_column=3;
bat_dreadnought_column=5;
bat_rhino_column=6;
bat_predator_column=7;
bat_landraider_column=7;
bat_scout_column=1;



faction[0]="";disposition[0]=0;
faction[1]="Player";disposition[1]=0;
faction[2]=obj_img.faction[2];disposition[3]=0;
faction[3]=obj_img.faction[3];disposition[4]=0;
faction[4]=obj_img.faction[4];disposition[4]=0;
faction[5]=obj_img.faction[5];disposition[5]=0;

if (instance_exists(obj_ini)){
    // faction[2]="Imperium";
    disposition[2]=obj_ini.imperium_disposition;
    // faction[3]="Mechanicus";
    disposition[3]=obj_ini.mechanicus_disposition;// Hurr
    // faction[4]="Inquisition";
    disposition[4]=obj_ini.inquisition_disposition;// Durr
    // faction[5]="Ecclesiarchy";
    disposition[5]=obj_ini.ecclesiarchy_disposition;// URhhhhh
}

faction[6]=obj_img.faction[6];disposition[6]=-10;// Thems
// faction[7]="Ork";disposition[7]=-40;// Thems
faction[7]=obj_img.faction[7];disposition[7]=-40;// Thems
faction[8]=obj_img.faction[8];disposition[8]=0;// Yep
faction[9]=obj_img.faction[9];disposition[9]=floor(random_range(40,100))=1;// use this to countdown genestealer cults, create one at the end
faction[10]=obj_img.faction[11];disposition[10]=-70;
faction[11]=obj_img.faction[10];disposition[10]=-70;
faction[12]="";disposition[12]=0;
faction[13]=obj_img.faction[13];disposition[13]=-20;

disposition_max[0]=0;
disposition_max[1]=0;

disposition_max[2]=40;
disposition_max[3]=40;
disposition_max[4]=40;
disposition_max[5]=40;


if (instance_exists(obj_ini)){
    disposition_max[2]=40+obj_ini.imperium_disposition;if (disposition_max[2]&gt;100) then disposition_max[2]=100;
    disposition_max[3]=40+obj_ini.mechanicus_disposition;if (disposition_max[3]&gt;100) then disposition_max[3]=100;
    disposition_max[4]=40+obj_ini.inquisition_disposition;if (disposition_max[4]&gt;100) then disposition_max[4]=100;
    disposition_max[5]=40+obj_ini.ecclesiarchy_disposition;if (disposition_max[5]&gt;100) then disposition_max[5]=100;
}


disposition_max[6]=0;
disposition_max[7]=0;
disposition_max[8]=0;
disposition_max[9]=0;
disposition_max[10]=0;
disposition_max[11]=0;
disposition_max[12]=0;
disposition_max[13]=0;

faction_leader[0]="";faction_title[0]="";faction_status[0]="";faction_leader[1]="";faction_title[1]="";faction_status[1]="";
faction_leader[2]=scr_imperial_name(1);faction_title[2]=string(obj_img.faction_title[2])+" ";faction_status[2]="Allied";
faction_leader[3]=scr_imperial_name(1);faction_title[3]=string(obj_img.faction_title[3])+" ";faction_status[3]="Allied";
if (faction_leader[3]=faction_leader[2]) then faction_leader[3]=scr_marine_name();

faction_leader[4]=scr_imperial_name(1);
if (faction_leader[4]=faction_leader[3]) then faction_leader[4]=scr_imperial_name(1);
faction_title[4]=string(obj_img.faction_title[4])+" ";faction_status[4]="Allied";

// faction_leader[5]=choose("Dennise","Aiava","Hana","Tsux","Beherns","Lashunda","Noella","Dominque","Romelia","Dania");
faction_leader[5]=scr_imperial_name(2);
faction_title[5]=string(obj_img.faction_title[5])+" ";faction_status[5]="Allied";

faction_leader[6]=scr_eldar_name(2);
faction_title[6]=string(obj_img.faction_title[6])+" ";faction_status[6]="Antagonism";// If disposition = 0 then instead set it to "Antagonism"
if (instance_exists(obj_ini)){if (string_count("Eldar",obj_ini.strin)&gt;0) then faction_status[6]="War";}

faction_leader[7]=scr_ork_name();
faction_title[7]=string(obj_img.faction_title[7])+" ";faction_status[7]="War";

faction_leader[8]="Por'O ";faction_leader[8]+=choose("Ar","Cha","Doran","Eldi","Kais","Ko","Kunas","M'yen","Ro","Tsua'm","Ukos");
faction_title[8]=string(obj_img.faction_title[8])+" ";faction_status[8]="Antagonism";


faction_leader[9]="";faction_title[9]="";faction_status[9]="War";
faction_leader[10]=":D";faction_title[10]=string(obj_img.faction_title[10])+" ";faction_status[10]="War";
faction_leader[11]="";faction_title[11]="";faction_status[11]="War";
faction_leader[12]="";faction_title[12]="";faction_status[12]="War";
faction_leader[13]="";faction_title[13]="";faction_status[13]="War";

faction_gender[0]=1;faction_gender[1]=1;faction_gender[2]=1;faction_gender[3]=1;faction_gender[4]=1;faction_gender[10]=1;
faction_gender[5]=1;faction_gender[6]=choose(1,2);faction_gender[7]=1;faction_gender[8]=choose(1,1,2);faction_gender[9]=1;
if (faction_gender[4]=2) then faction_leader[4]=scr_imperial_name(2);
faction_gender[10]=choose(1,1,1,2,2);
    if (faction_gender[10]=1) then faction_leader[10]=choose("1","1","1","2");
    if (faction_gender[10]=2) then faction_leader[10]=choose("1","2","2","2");
    if (faction_leader[10]="1") then faction_leader[10]=scr_marine_name();
    if (faction_leader[10]="2") then faction_leader[10]=scr_chaos_name();
faction_gender[11]=1;faction_gender[12]=1;faction_gender[13]=1;

// faction_gender[10]=1;// 139

known[0]=2;known[1]=999;
known[2]=1;known[3]=1;
known[4]=0;
known[5]=0;
known[6]=0;
known[7]=0;
known[8]=0;known[9]=0;known[10]=0;known[11]=0;known[12]=0;known[13]=0;






// UI testing
// known[4]=1;known[5]=1;known[6]=1;known[7]=1;known[8]=1;known[9]=1;known[10]=1;


// eldar mission testing
// known[6]=2;
// disposition[4]=90;
// disposition[3]=60;

annoyed[0]=0;annoyed[1]=0;
annoyed[2]=0;annoyed[3]=0;annoyed[4]=0;annoyed[5]=0;
annoyed[6]=0;annoyed[7]=0;annoyed[8]=0;annoyed[9]=0;annoyed[10]=0;
annoyed[11]=0;annoyed[12]=0;annoyed[13]=0;

ignore[0]=0;ignore[1]=0;
ignore[2]=0;ignore[3]=0;ignore[4]=0;ignore[5]=0;
ignore[6]=0;ignore[7]=0;ignore[8]=0;ignore[9]=0;ignore[10]=0;
ignore[11]=0;ignore[12]=0;ignore[13]=0;

turns_ignored[0]=0;turns_ignored[1]=0;
turns_ignored[2]=0;turns_ignored[3]=0;turns_ignored[4]=0;turns_ignored[5]=0;
turns_ignored[6]=0;turns_ignored[7]=0;turns_ignored[8]=0;turns_ignored[9]=0;turns_ignored[10]=0;
turns_ignored[11]=0;turns_ignored[12]=0;turns_ignored[13]=0;

faction_defeated[0]=0;
faction_defeated[1]=0;faction_defeated[2]=0;faction_defeated[3]=0;faction_defeated[4]=0;faction_defeated[5]=0;
faction_defeated[6]=0;faction_defeated[7]=0;faction_defeated[8]=0;faction_defeated[9]=0;faction_defeated[10]=0;
faction_defeated[11]=0;faction_defeated[12]=0;faction_defeated[13]=0;

// Unit names
battle_cry="For the "+string(obj_img.king_title);
fortress_name="";
flagship_name="";
home_name="";home_type="";
recruiting_name="";recruiting_type="";
// home_name="Ultramar";


/*main_color="White";
secondary_color="White";
lens_color="White";
weapon_color="White";*/


main_color=0;
secondary_color=0;
trim_color=0;
pauldron2_color=0;
pauldron_color=0;
lens_color=0;
weapon_color=0;
col_special=0;
trim=0;





adept_name="";recruiter_name="";
progenitor="";successor_chapters=0;
mutation="";

// 



progenitor_disposition=0;
astartes_disposition=0;astartes_max=0;
imperium_disposition=0;imperium_max=0;
guard_disposition=0;guard_max=0;
inquisition_disposition=0;inquisition_max=0;
ecclesiarchy_disposition=0;ecclesiarchy_max=0;
mechanicus_disposition=0;mechanicus_max=0;
other1_disposition=0;other1="";

// if (global.load=0) then randomize();
// if (global.load=0){repeat(12){scr_add_artifact("Device","",0,obj_ini.ship[1],501);}}






if (instance_exists(obj_ini)){
    if (global.load=0) and (string_count("Tolerant",obj_ini.strin2)&gt;0){
        obj_controller.disposition[6]+=5;
        obj_controller.disposition[7]+=5;
        obj_controller.disposition[8]+=10;
    }
    if (global.load=0){
        // Founding Chapter STC Bonuses here
        if (global.chapter_name="Salamanders"){stc_wargear=4;stc_bonus[1]=3;stc_bonus[2]=3;}
        if (global.chapter_name="Iron Hands"){stc_wargear=2;stc_bonus[1]=5;stc_vehicles=2;stc_bonus[3]=3;}
        if (global.chapter_name="Blood Ravens"){repeat(3){scr_add_artifact("random_nodemon","",0,obj_ini.ship[1],501);}}
        
        adept_name=scr_marine_name();
        recruiter_name=obj_ini.recruiter_name;
        progenitor=obj_ini.progenitor;
        successor_chapters=obj_ini.successors;
        mutation="";
        main_color=obj_ini.main_color;
        secondary_color=obj_ini.secondary_color;
        trim_color=obj_ini.trim_color;
        pauldron2_color=obj_ini.pauldron2_color;
        pauldron_color=obj_ini.pauldron_color;
        lens_color=obj_ini.lens_color;
        weapon_color=obj_ini.weapon_color;
        col_special=obj_ini.col_special;
        trim=obj_ini.trim;
        recruit_trial=obj_ini.aspirant_trial;
        homeworld_rule=obj_ini.homeworld_rule;
        
        scr_colors_initialize();
        scr_shader_initialize();
        instance_create(-100,-100,obj_event_log);
        debugl("New Game");
    }

}




if (global.load&gt;0){
    load_game=global.load;
    successor_chapters=0;
    instance_create(0,0,obj_saveload);
    with(obj_ini){instance_destroy();}
    instance_create(0,0,obj_ini);
    // obj_saveload.menu=2;
    obj_saveload.alarm[0]=1;
    obj_saveload.load_part=1;
    obj_cursor.image_alpha=0;
    scr_colors_initialize();
    if (global.restart=0) then debugl("Loading Game");
    if (global.restart&gt;0) then debugl("Restarting Game");
    exit;
}

var xx,yy,me,dist,go,plan;
global.custom=1;

// 
training_apothecary=2;
apothecary_points=0;
apothecary_aspirant=0;
training_chaplain=2;
chaplain_points=0;
chaplain_aspirant=0;
training_psyker=2;
psyker_points=0;
psyker_aspirant=0;
training_techmarine=0;
tech_points=0;
tech_aspirant=0;
recruiting=0;
penitorium=0;

if (instance_exists(obj_ini)){
    if (string_count("Intolerant",obj_ini.strin2)&gt;0) then training_psyker=0;
    if (global.chapter_name="Space Wolves") then training_chaplain=0;
}

// 
// 0: none      1: management
// 11: apothecary       12: chaplain        13: librarium       14: armamentarium

instance_create(floor(random(room_width-128))+64,floor(random(room_height-256))+128,obj_star);
plan=floor(random(5))+19;
plan=30*1.5;
plan=70;
if (test_map=true) then plan=20;

repeat(120){
    go=0;
    
    if (instance_number(obj_star)&lt;plan){
    
    if (go=0){
        // xx=floor(random(1152+640))+64;
        // yy=floor(random(732+480))+80;
        
        xx=floor(random(room_width-128))+64;
        yy=floor(random(room_height-256))+128;
        
        me=instance_nearest(xx,yy,obj_star);
        if (point_distance(me.x,me.y,xx,yy)&gt;=100) then go=1;
    }
    if (go=1){
        instance_create(xx,yy,obj_star);
    }
    
    
    }
    

}

fleet_type="";
if (obj_ini.fleet_type=1) then fleet_type="Fleet";
if (obj_ini.fleet_type=1) then fleet_type="Homeworld";
if (obj_ini.fleet_type=3) then fleet_type="Crusade";
star_names="";


/*
progenitor_disposition=0;astartes_disposition=0;
guard_disposition=0;
other1_disposition=0;other1="";
*/

tau=0;
tyranids=0;
ork=1;
eldar=0;

if (global.custom=1){
    tau=choose(0,0,1);
    eldar=choose(0,1);
}






loyalty=100;
loyalty_hidden=100;// Updated when inquisitors do an inspection

gene_seed=20;
if (string_count("Sieged",obj_ini.strin2)&gt;0) then gene_seed=floor(random_range(300,500));
if (global.chapter_name="Lamenters") then gene_seed=10;
// gene_seed=2000;

marines=0;
marines=obj_ini.specials+obj_ini.firsts+obj_ini.seconds+obj_ini.thirds+obj_ini.fourths+obj_ini.fifths;
marines+=obj_ini.sixths+obj_ini.sevenths+obj_ini.eighths+obj_ini.ninths+obj_ini.tenths;
command=0;
command=obj_ini.commands;

if (global.load=0) then marines-=command;






// Introduction Screen
temp[30]=string(check_number)+" "+string(year_fraction)+" "+string(year)+".M"+string(millenium);// Date
temp[31]=string_upper(adept_name);// Adept name
temp[32]=string_upper(obj_ini.name[0,1]);// Master name
temp[33]=string_upper(scr_thought());// Thought of the day


var njm, mm, com, word, vih, masta, forga, chapla, apa, liba, techa, libra, coda, lexa, apotha, old_dudes;
njm=34;mm=0;com=0;vih=0;word="";masta=0;forga=0;chapla=0;apa=0;liba=0;techa=0;libra=0;coda=0;lexa=0;apotha=0;old_dudes=0;

var honoh,termi, veter, capt, chap, apoth, stand, dread, tact, assa, deva, rhino, speeder, raider, standard, bike, scou, whirl, pred;
honoh=0;termi=0;veter=0;capt=0;chap=0;apoth=0;stand=0;dread=0;tact=0;assa=0;deva=0;rhino=0;speeder=0;raider=0;standard=0;bike=0;scou=0;whirl=0;pred=0;

repeat(100){mm+=1;
    if (obj_ini.role[com,mm]=obj_img.faction_title[1]) then masta=1;
    if (obj_ini.role[com,mm]="Forge Master") then forga=1;
    if (obj_ini.role[com,mm]="Master of Sanctity") then chapla=1;
    if (obj_ini.role[com,mm]="Master of the Apothecarion") then apa=1;
    if (obj_ini.role[com,mm]="Chief "+string(obj_ini.role[100,17])) then liba=1;
    if (obj_ini.role[com,mm]=obj_ini.role[100,16]) then techa+=1;
    if (obj_ini.role[com,mm]=obj_ini.role[100,17]) then libra+=1;
    if (obj_ini.role[com,mm]="Codiciery") then coda+=1;
    if (obj_ini.role[com,mm]="Lexicanum") then lexa+=1;
    if (obj_ini.role[com,mm]=obj_ini.role[100,14]) then old_dudes+=1;
    if (obj_ini.role[com,mm]=obj_ini.role[100,15]) then apotha+=1;
    if (obj_ini.role[com,mm]=obj_ini.role[100,2]) then honoh+=1;
}

temp[njm]="Command staff which includes";

if (masta=1) then temp[njm]+=", your majesty "+string(obj_ini.name[com,1]);
if (forga=1) then temp[njm]+=",  Forge Master "+string(obj_ini.name[com,2]);
if (chapla=1) then temp[njm]+=",  Master of Sanctity "+string(obj_ini.name[com,3]);
if (apa=1) then temp[njm]+=",  Master of the Apothecarion "+string(obj_ini.name[com,4]);
if (liba=1) then temp[njm]+=",  and Chief Librarian "+string(obj_ini.name[com,5])+".  ";

vih=string_pos(",",temp[njm]);
temp[njm]=string_delete(temp[njm],vih,1);
njm+=1;

temp[njm]+="  It has";
if (techa&gt;0) then temp[njm]+=", "+string(techa)+" "+string(obj_ini.role[100,16])+"s";
if (old_dudes&gt;0) then temp[njm]+=", "+string(techa)+" "+string(obj_ini.role[100,16])+"s";
if (apotha&gt;0) then temp[njm]+=", "+string(apotha)+" "+string(obj_ini.role[100,15])+"s";
if (libra&gt;0) then temp[njm]+=", "+string(libra)+" "+string(obj_ini.role[100,17])+"s";
if (coda&gt;0) then temp[njm]+=", "+string(coda)+" Codiciery";
if (lexa&gt;0) then temp[njm]+=", "+string(lexa)+" Lexicanum.";

vih=string_pos(",",temp[njm]);
temp[njm]=string_delete(temp[njm],vih,1);

if (honoh&gt;0) then temp[njm]+="  You have an Honor Guard which contains "+string(honoh)+" souls.";
        
// show_message(string(temp[njm-1])+string(temp[njm]));
/*scr_add_item(string(obj_img.battlesuit),10);
scr_add_item("Tartaros",10);
scr_add_item("Power Fist",10);*/
// repeat(5){scr_add_man("Sister Hospitaler",0,"","","","","",0,true,"default","");}
// scr_add_item("Archeotech Laspistol",10);


repeat(10){
    njm+=1;mm=0;vih=0;com+=1;fisted=0;techa=0;
    termi=0;veter=0;capt=0;chap=0;apoth=0;stand=0;dread=0;tact=0;assa=0;deva=0;rhino=0;speeder=0;raider=0;standard=0;bike=0;scou=0;whirl=0;pred=0;

    repeat(400){mm+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,4]) then termi+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,3]) then veter+=1;
        if (obj_ini.role[com,mm]="Venerable "+string(obj_ini.role[100,6])) then dread+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,5]) then capt+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,14]) then chap+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,15]) then apoth+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,16]) then techa+=1;
        if (obj_ini.role[com,mm]="Standard Bearer") then standard+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,8]) then tact+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,10]) then assa+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,9]) then deva+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,6]) then dread+=1;
        if (obj_ini.role[com,mm]=obj_ini.role[100,12]) then scou+=1;
    }
    repeat(100){vih+=1;
        if (obj_ini.veh_role[com,vih]=string(obj_img.unit[1,21])) then raider+=1;
        if (obj_ini.veh_role[com,vih]=string(obj_img.unit[1,18])) then rhino+=1;
        if (obj_ini.veh_role[com,vih]=string(obj_img.unit[1,22])) then speeder+=1;
        if (obj_ini.veh_role[com,vih]="Bike") then bike+=1;
        if (obj_ini.veh_role[com,vih]=string(obj_img.unit[1,19])) then pred+=1;
        if (obj_ini.veh_role[com,vih]=string(obj_img.unit[1,20])) then whirl+=1;
    }
    
    if (com=1) then word="first";if (com=2) then word="second";if (com=3) then word="third";if (com=4) then word="fourth";if (com=5) then word="fifth";
    if (com=6) then word="sixth";if (com=7) then word="seventh";if (com=8) then word="eighth";if (com=9) then word="ninth";if (com=10) then word="tenth";
    if (com&gt;=1){
        if (veter+termi+stand+dread+tact+assa+deva+rhino+raider+standard+scou+whirl&gt;0) then temp[njm]="You have a "+string(word)+" company.  It has";
        else{temp[njm]="";}
    }
    // temp[njm]=string(word);
    
    if (capt=1) then temp[njm]+=", "+string(capt)+" "+string(obj_ini.role[100,5]);
    if (chap=1) then temp[njm]+=", "+string(chap)+" "+string(obj_ini.role[100,14]);
    if (chap&gt;1) then temp[njm]+=", "+string(chap)+" "+string(obj_ini.role[100,14])+"s";
    if (apoth=1) then temp[njm]+=", "+string(apoth)+" "+string(obj_ini.role[100,15]);
    if (apoth&gt;1) then temp[njm]+=", "+string(apoth)+" "+string(obj_ini.role[100,15])+"s";
    if (techa=1) then temp[njm]+=", "+string(techa)+" "+string(obj_ini.role[100,16]);
    if (techa&gt;1) then temp[njm]+=", "+string(techa)+" "+string(obj_ini.role[100,16])+"s";
    
    if (standard=1) then temp[njm]+=", 1 Standard Bearer, 1 Company Champion, ";
    if (termi&gt;0) then temp[njm]+=", "+string(termi)+" "+string(obj_ini.role[100,4])+"s";
    if (veter&gt;0) then temp[njm]+=", "+string(veter)+" "+string(obj_ini.role[100,3])+"s";
    if (tact&gt;0) then temp[njm]+=", "+string(tact)+" "+string(obj_ini.role[100,8])+"s";
    if (assa&gt;0) then temp[njm]+=", "+string(assa)+" "+string(obj_ini.role[100,10])+"s";
    if (deva&gt;0) then temp[njm]+=", "+string(deva)+" "+string(obj_ini.role[100,9])+"s";
    if (scou&gt;0) then temp[njm]+=", "+string(scou)+" "+string(obj_ini.role[100,12])+"s";
    if (dread=1) then temp[njm]+=", "+string(dread)+" "+string(obj_ini.role[100,6])+"";
    if (dread&gt;1) then temp[njm]+=", "+string(dread)+" "+string(obj_ini.role[100,6])+"s";
    if (raider=1) then temp[njm]+=", "+string(raider)+" "+string(obj_img.unit[1,21]);if (raider&gt;1) then temp[njm]+=", "+string(raider)+" "+string(obj_img.unit[1,21])+"s";
    if (pred=1) then temp[njm]+=", "+string(pred)+" "+string(obj_img.unit[1,19]);if (pred&gt;1) then temp[njm]+=", "+string(pred)+" "+string(obj_img.unit[1,19])+"s";
    if (whirl=1) then temp[njm]+=", "+string(whirl)+" "+string(obj_img.unit[1,20]);if (whirl&gt;1) then temp[njm]+=", "+string(whirl)+" "+string(obj_img.unit[1,20])+"s";
    if (rhino=1) then temp[njm]+=", "+string(rhino)+" "+string(obj_img.unit[1,18]);if (rhino&gt;1) then temp[njm]+=", "+string(rhino)+" "+string(obj_img.unit[1,18])+"s";
    if (speeder=1) then temp[njm]+=", "+string(speeder)+" "+string(obj_img.unit[1,22]);if (speeder&gt;1) then temp[njm]+=", "+string(speeder)+" "+string(obj_img.unit[1,22])+"s";
    if (bike=1) then temp[njm]+=", "+string(bike)+" Attack Bike";if (bike&gt;1) then temp[njm]+=", "+string(raider)+" Attack Bikes";
    
    if (string_length(temp[njm])&gt;0) then temp[njm]+=".";
    
    if (njm!=0){
        vih=string_pos(",",temp[njm]);
        temp[njm]=string_delete(temp[njm],vih,1);
    }
    // show_message(temp[njm]);
    
}





temp[59]="CLASSIFICATION: SECTOR LOGISTICAE#++++++++++DATE: "+string(temp[30])+"#++++++++AUTHOR: MASTER ADEPT "+string(temp[31])+"#++++++++++++RE: INTRODUCTORY MISSIVE#+++++RECIPIENT: "+string_upper(obj_img.faction_title[1])+" "+string(temp[32])+"##++THOUGHT: "+string(temp[33])+"++##I see you have made it unscathed, your grace.  Death comes with you as it should!  The enemy is on the horizon.  Thy chapter is mighty and only waits for your word to wreak havoc upon our enemies.##Your chapter contains-#";
temp[60]=string(temp[59])+string(temp[34])+string(temp[35])+"##"+string(temp[36])+"##"+string(temp[37])+"##"+string(temp[38])+"##"+string(temp[39])+"##"+string(temp[40])+"##"+string(temp[41])+"##"+string(temp[42])+"##"+string(temp[43])+"##"+string(temp[44])+"##"+string(temp[45]);

temp[61]="##Your armamentarium contains some spare equipment- ";

var u;u=0;

repeat(30){u+=1;
    if (obj_ini.equipment[u]!="") then temp[61]+=string(obj_ini.equipment_number[u])+" "+string(obj_ini.equipment[u])+", ";
    if (obj_ini.equipment[u]="") and (obj_ini.equipment[u-1]!=""){temp[61]=string_delete(temp[61],string_length(temp[61]),3);temp[61]+=".";}
}

// temp[61]+=".";

temp[62]="##Your fleet contains ";




var bb, sk, glad, hunt, ships, bb_names, sk_names, glad_names, hunt_names;
bb=0;sk=0;glad=0;hunt=0;ships=0;

bb_names="";sk_names="";glad_names="";hunt_names="";

mm=0;codex[0]="";codex_discovered[0]=0;
repeat(30){mm+=1;
    if (obj_ini.ship[mm]!=""){
        ships+=1;
        if (obj_ini.ship_class[mm]=string(obj_img.ship[1,1])){bb+=1;bb_names+=", "+string(obj_ini.ship[mm]);}
        if (obj_ini.ship_class[mm]=string(obj_img.ship[1,2])){sk+=1;sk_names+=", "+string(obj_ini.ship[mm]);}
        if (obj_ini.ship_class[mm]=string(obj_img.ship[1,3])){glad+=1;glad_names+=", "+string(obj_ini.ship[mm]);}
        if (obj_ini.ship_class[mm]=string(obj_img.ship[1,4])){hunt+=1;hunt_names+=", "+string(obj_ini.ship[mm]);}
    }
    codex[mm]="";codex_discovered[mm]=0;
}
temp[62]+=string(ships)+" warships.#";

vih=string_pos(",",bb_names);bb_names=string_delete(bb_names,vih,1);
vih=string_pos(",",sk_names);sk_names=string_delete(sk_names,vih,1);
vih=string_pos(",",glad_names);glad_names=string_delete(glad_names,vih,1);
vih=string_pos(",",hunt_names);hunt_names=string_delete(hunt_names,vih,1);

if (obj_ini.fleet_type!=1) or (bb=1) then temp[62]+="Your flagship is the "+string(obj_img.ship[1,1])+" "+string(obj_ini.ship[1])+".  ";
if (obj_ini.fleet_type=1) and (bb&gt;1){
    temp[62]+="There are "+string(bb)+" "+string(obj_img.ship[1,1])+"s; "+string(bb_names)+".  ";
}temp[62]+="#";
if (sk&gt;0){temp[62]+="There are "+string(sk)+" "+string(obj_img.ship[1,2])+"s; "+string(sk_names)+".  ";temp[62]+="#";}
if (glad&gt;0){temp[62]+="There are "+string(glad)+" "+string(obj_img.ship[1,3])+" Escorts; "+string(glad_names)+".  ";temp[62]+="#";}
if (hunt&gt;0){temp[62]+="There are "+string(hunt)+" "+string(obj_img.ship[1,1])+" Escorts; "+string(hunt_names)+".";temp[62]+="#";}



// show_message(temp[61]);
// show_message(temp[62]);


// 61 : equipment
// 62 : ships


var lol;
lol=160;


draw_set_font(fnt_small);
vih=string_height(string(temp[60])+string(temp[61])+string(temp[62]));
vih-=210;vih=(vih/lol)+1;


if (floor(vih)&lt;vih){vih+=1;vih=floor(vih);}

// show_message(string(vih)+" pages");

man=0;





man=65;
temp[65]=string(temp[60])+string(temp[61])+string(temp[62]);
repeat(vih){
    man+=1;
    temp[man]=string(temp[60])+string(temp[61])+string(temp[62]);
}



var lig, remov, stahp;lig=0;remov=0;stahp=0;

// show_message("Length: "+string(string_length(temp[65])));
// show_message("Height: "+string(string_height(temp[65])));

if (vih&gt;=1){
    repeat(4000){
        if (string_height(temp[65])&gt;210){
            lig=string_length(temp[65]);
            temp[65]=string_delete(temp[65],lig-1,1);
        }
    }
}
remov=string_length(string(temp[65]))+1;


if (vih&gt;=2){
    temp[66]=string_delete(temp[66],1,remov);
    repeat(4000){
        if (string_height(temp[66])&gt;130){
            lig=string_length(temp[66]);
            temp[66]=string_delete(temp[66],lig-1,1);
        }
    }
}
remov=string_length(string(temp[65])+string(temp[66]))+1;
// show_message(remov);

if (vih&gt;=3){
    temp[67]=string_delete(temp[67],1,remov);
    repeat(4000){
        if (string_height(temp[67])&gt;lol){
            lig=string_length(temp[67]);
            temp[67]=string_delete(temp[67],lig-1,1);
        }
    }
}
remov=string_length(string(temp[65])+string(temp[66])+string(temp[67]))+1;

if (vih&lt;4) then temp[68]="";
if (vih&gt;=4){
    temp[68]=string_delete(temp[68],1,remov);
    repeat(4000){
        if (string_height(temp[68])&gt;lol){
            lig=string_length(temp[68]);
            temp[68]=string_delete(temp[68],lig-1,1);
        }
    }
}
remov=string_length(string(temp[65])+string(temp[66])+string(temp[67])+string(temp[68]))+1;

if (vih&lt;5) then temp[69]="";
if (vih&gt;=5){
    temp[69]=string_delete(temp[69],1,remov);
    repeat(4000){
        if (string_height(temp[69])&gt;lol){
            lig=string_length(temp[69]);
            temp[69]=string_delete(temp[69],lig-1,1);
        }
    }
}
remov=string_length(string(temp[65])+string(temp[66])+string(temp[67])+string(temp[68])+string(temp[69]))+1;





// random_event_next="chaos_invasion";
/*var ii;ii=0;
repeat(50){ii+=1;
    obj_ini.gear[0,ii]="Exterminatus";
}*/

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>301</id>
        <kind>0</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_set_alarm</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>2</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="9">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>with(obj_p_fleet){
    var steh;steh=instance_nearest(x,y,obj_star);
    var b;b=0;
    repeat(4){b+=1;
        if (steh.p_first[b]&lt;=5) and (steh.dispo[b]&gt;-30) and (steh.dispo[b]&lt;0) then steh.dispo[b]=min(obj_ini.imperium_disposition,obj_controller.disposition[2])+choose(-1,-2,-3,-4,0,1,2,3,4);
    }
    if (string_count("????|",steh.p_feature[1])&gt;0)with(steh){{scr_planetary_feature(1);}}
    if (string_count("????|",steh.p_feature[2])&gt;0)with(steh){{scr_planetary_feature(2);}}
    if (string_count("????|",steh.p_feature[3])&gt;0)with(steh){{scr_planetary_feature(3);}}
    if (string_count("????|",steh.p_feature[4])&gt;0)with(steh){{scr_planetary_feature(4);}}
}



// target_navy_number

with(obj_star){
    var o,sco;o=0;sco=0;
    
    repeat(4){o+=1;
        if (p_type[o]="Hive") then sco+=3;
        if (p_type[o]="Temperate") then sco+=1;
    }
    if (sco&gt;=4) then instance_create(x,y,obj_temp_inq);
}

if (instance_number(obj_temp_inq)&lt;target_navy_number){
    with(obj_temp_inq){instance_destroy();}
    with(obj_star){
        var o,sco;o=0;sco=0;
        
        repeat(4){o+=1;
            if (p_type[o]="Hive") then sco+=3;
            if (p_type[o]="Temperate") then sco+=1;
        }
        if (sco&gt;=3) then instance_create(x,y,obj_temp_inq);
    }
}

repeat(30){
    if (instance_number(obj_temp_inq)&gt;target_navy_number){
        var kebob;kebob=instance_nearest(random(room_width),random(room_height),obj_temp_inq);
        with(kebob){instance_destroy();}
    }
}

with(obj_temp_inq){
    var nav,ii;nav=instance_create(x+24,y-24,obj_en_fleet);
    nav.owner=2;nav.navy=1;ii=0;
    
    nav.capital_number=choose(1,2,3);
    nav.frigate_number=(nav.capital_number*2)+3;
    nav.escort_number=12;
    nav.home_x=x;nav.home_y=y;
    nav.orbiting=instance_nearest(x,y,obj_star);
    nav.orbiting.present_fleet[2]+=1;
    
    nav.image_speed=0;
    var ii;ii=0;ii+=nav.capital_number-1;ii+=round((nav.frigate_number/2));ii+=round((nav.escort_number/4));
    if (ii&lt;=1) and (nav.capital_number+nav.frigate_number+nav.escort_number&gt;0) then ii=1;
    nav.image_index=ii;
    instance_destroy();
}

with(obj_en_fleet){
    if (owner=2) and (navy=1){var i;
        i=0;repeat(capital_number){i+=1;
            capital_max_imp[i]=(((floor(random(15))+1)*1000000)+15000000)*2;
            capital_imp[i]=capital_max_imp[i];
        }
        i=0;repeat(frigate_number){i+=1;
            frigate_max_imp[i]=(500000+(floor(random(50))+1)*10000)*2;
            frigate_imp[i]=frigate_max_imp[i];
        }
    }
}



</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="8">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Traitorus</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// excommunicatus traitorus

instance_activate_object(obj_star);


var witch;
witch=obj_controller;
if (instance_exists(obj_turn_end)) then witch=obj_turn_end;
witch.audiences+=1;witch.audien[witch.audiences]=4;
witch.audien_topic[witch.audiences]="declare_war";if (gene_xeno&gt;99995) then witch.audien_topic[witch.audiences]="gene_xeno";
obj_controller.disposition[4]-=50;obj_controller.faction_status[4]="War";
obj_controller.turns_ignored[4]=9999;if (known[4]&gt;0) then known[4]=4;

witch.audiences+=1;witch.audien[witch.audiences]=2;
witch.audien_topic[witch.audiences]="declare_war";obj_controller.disposition[2]-=40;
obj_controller.faction_status[2]="War";obj_controller.turns_ignored[2]=9999;if (known[2]&gt;0) then known[2]=2;

obj_controller.faction_status[3]="War";obj_controller.turns_ignored[3]=9999;obj_controller.disposition[3]-=30;if (known[3]&gt;0) then known[3]=2;

if (known[5]&gt;0){
    witch.audiences+=1;witch.audien[witch.audiences]=5;
    witch.audien_topic[witch.audiences]="declare_war";known[5]=2;
}
obj_controller.faction_status[5]="War";obj_controller.turns_ignored[5]=9999;obj_controller.disposition[5]-=40;

if (obj_controller.faction_gender[10]=1) and (obj_controller.known[10]=0) and (obj_controller.faction_defeated[10]=0){
    witch.audiences+=1;witch.audien[witch.audiences]=10;
    witch.audien_topic[witch.audiences]="intro";
}


with(obj_star){
    if (p_owner[1]=1) or (p_owner[2]=1) or (p_owner[3]=1) or (p_owner[4]=1){
        var heh;heh=instance_create(x,y,obj_crusade);
        heh.radius=64;heh.duration=9999;heh.show=false;heh.placing=false;heh.alarm[1]=-1;
        if (p_owner[1]=1){p_pdf[1]+=p_guardsmen[1];p_guardsmen[1]=0;}
        if (p_owner[2]=1){p_pdf[2]+=p_guardsmen[2];p_guardsmen[2]=0;}
        if (p_owner[3]=1){p_pdf[3]+=p_guardsmen[3];p_guardsmen[3]=0;}
        if (p_owner[4]=1){p_pdf[4]+=p_guardsmen[4];p_guardsmen[4]=0;}
    }
}

if (instance_exists(obj_fleet)) then instance_deactivate_object(obj_star);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="7">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Defeat Screen</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

debugl("=========Player Defeated; Exited to Defeat Screen");

audio_stop_sound(snd_royal);
audio_play_sound(snd_defeat,0,true);
audio_sound_gain(snd_defeat, 0, 0);

var nope;nope=0;if (master_volume=0) or (music_volume=0) then nope=1;
if (nope!=1){audio_sound_gain(snd_defeat,1*master_volume*music_volume,2000);}

if (obj_controller.marines+obj_controller.command&lt;=50) and (global.defeat!=2) then global.defeat=0;

room_goto(Defeat);
global.icon=obj_ini.icon;
global.icon_name=obj_ini.icon_name;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Selecting Units Stuff</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

if (menu=1) and (managing&gt;0){
    var f;f=0;
    
    var cap,apo,chap,bear,tct,assa,dev,sco,hon,ve,ter,oth,drea,vdrea,codi,lexi,lib,tech;
    cap=0;apo=0;chap=0;bear=0;tct=0;assa=0;dev=0;sco=0;hon=0;ve=0;ter=0;oth=0;drea=0;vdrea=0;codi=0;lexi=0;lib=0;tech=0;
    
    var rhi,pre,lrad,lspi,whi;
    rhi=0;pre=0;lrad=0;lspi=0;whi=0;
    
    otha=0;
    
    var manz,vanz,stahp;
    manz=0;vanz=0;stahp=0;
    
    repeat(man_max){
        f+=1;// cooldown=8;
        
        if (man_sel[f]=1){
            
            if (ma_promote[f]=0) then sel_promoting=-1;
            
            
            if (ma_role[f]="Ork Sniper") or (ma_role[f]="Flash Git") or (ma_role[f]="Crusader") or (ma_role[f]="Skitarii") then otha=1;
            if (ma_role[f]=obj_img.unit[5,7]) or (ma_role[f]=obj_img.unit[5,17]) or (ma_role[f]="Ranger") then otha=1;
            if (otha&gt;0) then stahp=1;
            
            // if (ma_promote[f]=1) and (man[f]="man"){
            if (man[f]="man"){
                manz+=1;
                
                if (ma_role[f]=obj_ini.role[100,5]) then cap+=1;
                if (ma_role[f]=obj_ini.role[100,15]) then apo+=1;
                if (ma_role[f]=obj_ini.role[100,14]) then chap+=1;
                if (ma_role[f]=obj_ini.role[100,17]) then lib+=1;
                if (ma_role[f]=obj_ini.role[100,16]) then tech+=1;
                
                if (ma_role[f]=obj_ini.role[100,6]) or (ma_role[f]="Venerable "+string(obj_ini.role[100,6])) then drea+=1;
                
                if (ma_role[f]="Standard Bearer") then bear+=1;
                if (ma_role[f]=obj_ini.role[100,8]) then tct+=1;if (ma_role[f]=obj_ini.role[100,10]) then assa+=1;
                if (ma_role[f]=obj_ini.role[100,9]) then dev+=1;
                if (ma_role[f]=obj_ini.role[100,12]) then sco+=1;if (ma_role[f]=obj_ini.role[100,2]) then hon+=1;
                if (ma_role[f]=obj_ini.role[100,3]) then ve+=1;
                if (ma_role[f]=obj_ini.role[100,4]) then ter+=1;if (ma_role[f]=obj_ini.role[100,6]) then drea+=1;
                if (ma_role[f]="Venerable "+string(obj_ini.role[100,6])) then vdrea+=1;
                if (ma_role[f]="Codiciery") then codi+=1;if (ma_role[f]="Lexicanum") then lexi+=1;
                
            }
            if (man[f]="vehicle"){// vanz+=1;// This needs to be extended to accomodate the selection text like the man ones
                vanz+=1;
                
                if (ma_role[f]=string(obj_img.unit[1,21])) then lrad+=1;
                if (ma_role[f]=string(obj_img.unit[1,18])) then rhi+=1;
                if (ma_role[f]=string(obj_img.unit[1,19])) then pre+=1;
                if (ma_role[f]=string(obj_img.unit[1,22])) then lspi+=1;
                if (ma_role[f]=string(obj_img.unit[1,20])) then whi+=1;
            }
        }
        
    }// End repeat
    
    var heh;heh=0;selecting_dudes="";
    heh=cap;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,5]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=chap;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,14]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=apo;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,15]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=lib;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,17]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=codi;if (heh&gt;0){selecting_dudes+=string(heh)+" Codiciery";if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=lexi;if (heh&gt;0){selecting_dudes+=string(heh)+" Lexicanum";if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=bear;if (heh&gt;0){selecting_dudes+=string(heh)+" Standard Bearer";if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    
    heh=hon;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,2]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    
    heh=tech;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,16]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=ter;if (heh&gt;0){selecting_dudes+=string(heh)+" Terminator";if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=ve;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,3]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=tct;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,8]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=dev;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,9]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=sco;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,12]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=drea;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_ini.role[100,6]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    
    
    heh=lrad;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_img.unit[1,21]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=pre;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_img.unit[1,19]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=rhi;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_img.unit[1,18]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=whi;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_img.unit[1,20]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    heh=lspi;if (heh&gt;0){selecting_dudes+=string(heh)+" "+string(obj_img.unit[1,22]);if (heh&gt;1) then selecting_dudes+="s";selecting_dudes+=", ";}
    
    if (string_length(selecting_dudes)&gt;0) then selecting_dudes=string_delete(selecting_dudes,string_length(selecting_dudes),2);
    
    if (man_size=0) then selecting_location="";
    
    if (vanz&gt;0) and (manz=0) and (stahp=0){sel_promoting=1;alarm[6]=15;exit;}
    if (drea+vdrea&gt;0) then sel_promoting=-1;
    // if (cap+apo+chap+bear+tct+assa+dev+sco+hon+ve+ter+oth+drea+vdrea!=1) then sel_promoting=0;
    if (cap+apo+chap+bear+tct+assa+dev+sco+hon+ve+ter+oth+lib+codi+lexi+tech&gt;=1) and (sel_promoting!=-1) then sel_promoting=1;
    if (manz&gt;0) and (vanz&gt;0) then sel_promoting=-1;
    if (man_size=0) then sel_promoting=-1;
    
    if (lib&gt;0) and (lexi+codi+cap+apo+chap+bear+tct+assa+dev+sco+hon+ve+ter+oth+drea+vdrea+tech&gt;0) then sel_promoting=-1;if (lib&gt;1) then sel_promoting=-1;
    if (codi&gt;0) and (lexi+lib+cap+apo+chap+bear+tct+assa+dev+sco+hon+ve+ter+oth+drea+vdrea+tech&gt;0) then sel_promoting=-1;if (codi&gt;1) then sel_promoting=-1;
    if (lexi&gt;0) and (codi+lib+cap+apo+chap+bear+tct+assa+dev+sco+hon+ve+ter+oth+drea+vdrea+tech&gt;0) then sel_promoting=-1;if (lexi&gt;1) then sel_promoting=-1;
    if (apo&gt;0) and (lib+lexi+codi+cap+chap+bear+tct+assa+dev+sco+hon+ve+ter+oth+drea+vdrea+tech&gt;0) then sel_promoting=-1;if (apo&gt;1) then sel_promoting=-1;
    if (chap&gt;0) and (lib+lexi+codi+cap+apo+bear+tct+assa+dev+sco+hon+ve+ter+oth+drea+vdrea+tech&gt;0) then sel_promoting=-1;if (chap&gt;1) then sel_promoting=-1;

    if (stahp&gt;0) then sel_promoting-=1;
    
    if (sel_promoting=-1) then sel_promoting=0;
    alarm[6]=7; 
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Chaos incr</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>


// Chaos influence / corruption
var times;times=max(1,round(turn/150));
if (known[10]=2) and (faction_defeated[10]=0) then times+=1;


var xx3, yy3, plani, stahr;stahr=0;
xx3=floor(random(room_width))+1;
yy3=floor(random(room_height))+1;
stahr=instance_nearest(xx3,yy3,obj_star);
plani=floor(random(stahr.planets))+1;


if (faction_gender[10]=1) and (faction_defeated[10]=0) and (turn&gt;=chaos_turn) then repeat(times){
    if (stahr.p_type[plani]!="Dead") and (stahr.planets&gt;0) and (turn&gt;=20){
        var cathedral;cathedral=0;
        if (string_count("Cathedral",stahr.p_feature[plani])&gt;0) then cathedral=choose(0,1,1);
    
        if (cathedral=0){
            if (stahr.p_heresy[plani]&gt;=0) and (stahr.p_heresy[plani]&lt;10){
                stahr.p_heresy[plani]+=choose(0,0,0,0,0,0,0,0,5);
            }
            if (stahr.p_heresy[plani]&gt;=10) and (stahr.p_heresy[plani]&lt;20){
                stahr.p_heresy[plani]+=choose(-2,-2,-2,5,10,15);
            }
            if (stahr.p_heresy[plani]&gt;=20) and (stahr.p_heresy[plani]&lt;40){
                stahr.p_heresy[plani]+=choose(-2,-1,0,0,0,0,0,0,5,10);
            }
            if (stahr.p_heresy[plani]&gt;=40) and (stahr.p_heresy[plani]&lt;60){
                stahr.p_heresy[plani]+=choose(-2,-1,0,0,0,0,0,0,5,10,15);
            }
            if (stahr.p_heresy[plani]&gt;=60) and (stahr.p_heresy[plani]&lt;100){
                stahr.p_heresy[plani]+=choose(-1,0,0,0,0,5,10,15);
            }
        }
        
        if (stahr.p_heresy[plani]&lt;0) then stahr.p_heresy[plani]=0;
    }
}

instance_activate_object(obj_star);



// Build new Imperial Ships
with(obj_temp6){instance_destroy();}with(obj_temp5){instance_destroy();}with(obj_temp4){instance_destroy();}
imp_ships=0;
with(obj_en_fleet){
    if (owner=2){
        obj_controller.imp_ships+=capital_number;
        obj_controller.imp_ships+=frigate_number/2;
        obj_controller.imp_ships+=escort_number/4;
    }
}
with(obj_star){
    if (owner=2) then instance_create(x,y,obj_temp6);
    if (owner=3) then instance_create(x,y,obj_temp5);
    if (space_hulk=1) or (craftworld=1){x-=20000;y-=20000;}
}
var sha;sha=instance_number(obj_temp6)*1.3;// former
sha=instance_number(obj_temp6)*0.65;// new

with(obj_temp6){instance_destroy();}

if (instance_number(obj_temp5)&gt;0) and (imp_ships&lt;sha){
    var rando,rando2;rando=floor(random(100))+1;rando2=choose(1,2,2,3,3,3);
    var forge;forge=instance_nearest(random(room_width),random(room_height),obj_temp5);
    
    if (rando&lt;=(12)*instance_number(obj_temp5)){
        var flit;flit=instance_create(forge.x,forge.y,obj_en_fleet);
        flit.owner=2;flit.sprite_index=spr_fleet_imperial;
        if (rando2=1) then flit.capital_number=1;
        if (rando2=2) then flit.frigate_number=1;
        if (rando2=3) then flit.escort_number=1;
        flit.trade_goods="merge";
    with(obj_temp5){instance_destroy();}
    with(obj_star){
        if (x&gt;10) and (y&gt;10) and ((owner=2) or (owner=3)){
            var mapre;mapre=0;
            mapre+=present_fleet[1];
            mapre+=present_fleet[2];
            mapre+=present_fleet[3];
            mapre+=present_fleet[4];
            mapre+=present_fleet[5];
            mapre+=present_fleet[6];
            mapre+=present_fleet[7];
            mapre+=present_fleet[8];
            mapre+=present_fleet[9];
            mapre+=present_fleet[10];
            mapre+=present_fleet[13];
            
            if (planets=4) and (mapre=0) then instance_create(x,y,obj_temp6);
            if (planets=3) and (mapre=0) then instance_create(x,y,obj_temp5);
            if ((planets=1) or (planets=2)) and (mapre=0) and (p_type[1]!="Dead") then instance_create(x,y,obj_temp4);
        }
    }
    var targeted;targeted=0;
    
    if (instance_number(obj_temp6)&gt;0) and (targeted=0) then targeted=instance_nearest(random(room_width),random(room_height),obj_temp6);
    if (instance_number(obj_temp5)&gt;0) and (targeted=0) then targeted=instance_nearest(random(room_width),random(room_height),obj_temp5);
    if (instance_number(obj_temp4)&gt;0) and (targeted=0) then targeted=instance_nearest(random(room_width),random(room_height),obj_temp4);
    if (targeted!=0) and (instance_exists(targeted)){
    
    flit.action_x=targeted.x;flit.action_y=targeted.y;flit.alarm[4]=1;}
    
    with(obj_temp6){instance_destroy();}with(obj_temp5){instance_destroy();}with(obj_temp4){instance_destroy();}
    }
}



instance_activate_object(obj_star);
with(obj_star){
    if (x&lt;-10000){x+=20000;y+=20000;}
    if (x&lt;-10000){x+=20000;y+=20000;}
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Training</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

var tra;tra=0;

// Training here
if (training_apothecary=1) then apothecary_points+=0.8;
if (training_apothecary=2) then apothecary_points+=0.9;
if (training_apothecary=3) then apothecary_points+=1;
if (training_apothecary=4) then apothecary_points+=1.5;
if (training_apothecary=5) then apothecary_points+=2;
if (training_apothecary=6) then apothecary_points+=4;


if (training_apothecary&gt;0) then tra=scr_role_count(string(obj_ini.role[100,15])+" Aspirant","");
if (apothecary_points&gt;=4) and (apothecary_aspirant!=0) and (tra=0){apothecary_points=0;apothecary_aspirant=0;}
if (apothecary_points&gt;=48){
    if (tra&gt;0){
        var yoo, tid;tid=0;
        yoo=scr_random_marine(string(obj_ini.role[100,15])+" Aspirant",0);tid=yoo;
        // show_message(tid);
        // show_message(obj_ini.role[0,tid]);
        repeat(10){
            if (obj_ini.role[0,tid]!=(string(obj_ini.role[100,15])+" Aspirant")){
                yoo=scr_random_marine((obj_ini.role[100,15]+" Aspirant"),0);
                tid=yoo;// tco=(yoo-tid)*100;
            }
        }
        if (obj_ini.role[0,tid]=(obj_ini.role[100,15]+" Aspirant")){
            apothecary_points-=48;apothecary_aspirant=0;
            obj_ini.role[0,tid]=obj_ini.role[100,15];obj_ini.experience[0,tid]+=10;
            var eq1,eq2,eq3,t,r;eq1=1;eq2=1;eq3=1;t=0;r=0;
            if (obj_ini.wep1[0,tid]!=obj_ini.wep1[100,15]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.wep1[100,15]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.wep1[0,tid]!="") then scr_add_item(obj_ini.wep1[0,tid],1);scr_add_item(obj_ini.wep1[100,15],-1);obj_ini.wep1[0,tid]=obj_ini.wep1[100,15];}
                if (r=0) then eq1=0;
            }
            if (obj_ini.wep2[0,tid]!=obj_ini.wep2[100,15]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.wep2[100,15]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.wep2[0,tid]!="") then scr_add_item(obj_ini.wep2[0,tid],1);scr_add_item(obj_ini.wep2[100,15],-1);obj_ini.wep2[0,tid]=obj_ini.wep2[100,15];}
                if (r=0) then eq2=0;
            }
            if (obj_ini.gear[0,tid]!=obj_ini.gear[100,15]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.gear[100,15]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.gear[0,tid]!="") then scr_add_item(obj_ini.gear[0,tid],1);scr_add_item(obj_ini.gear[100,15],-1);obj_ini.gear[0,tid]=obj_ini.gear[100,15];}
                if (r=0) then eq3=0;
            }
            scr_alert("green","recruitment",string(obj_ini.role[100,15])+" Aspirant "+string(obj_ini.name[0,tid])+" has finished training.",0,0);
            if (eq1+eq2+eq3!=3){
                var warn,w5;warn="";w5=0;
                if (eq1=0) then warn+=string(obj_ini.wep1[100,15])+", ";
                if (eq2=0) then warn+=string(obj_ini.wep2[100,15])+", ";
                if (eq3=0) then warn+=string(obj_ini.gear[100,15])+", ";
                
                w5=string_length(warn)-1;
                warn=string_delete(warn,w5,2);
                warn+=".";
                scr_alert("red","recruitment","Not enough equipment: "+string(warn),0,0);
            }
            with(obj_ini){scr_company_order(0);}
        }
    }
}tra=0;
if (apothecary_points&gt;=4) and (apothecary_aspirant=0){    
    var yoo, tid, tco;tid=0;tco=0;
    repeat(10){
        if (tco&lt;2) or (tco&gt;10){
            yoo=scr_random_marine(choose(obj_ini.role[100,8],obj_ini.role[100,8],obj_ini.role[100,10],obj_ini.role[100,9]),60);
            tid=floor(yoo);tco=(yoo-tid)*100;
            if (obj_ini.role[tco,tid]="") or (obj_ini.role[tco,tid]=obj_ini.role[100,6]) or (obj_ini.role[tco,tid]="Venerable "+string(obj_ini.role[100,6])){yoo=0;tid=0;tco=0;}
        }
    }
    if (tco&lt;=10) and (obj_ini.role[tco,tid]!=""){
        apothecary_aspirant=1;
        var g1,h;g1=0;g2=0;h=0;
        repeat(300){h+=1;if (g1=0){if (obj_ini.role[0,h]="") then g1=h;}}// This gets the last open slot for company 0
        if (g1!=0){command+=1;marines-=1;
            obj_ini.race[0,g1]=obj_ini.race[tco,tid];obj_ini.loc[0,g1]=obj_ini.loc[tco,tid];obj_ini.name[0,g1]=obj_ini.name[tco,tid];
            obj_ini.role[0,g1]=obj_ini.role[100,15]+" Aspirant";obj_ini.wep1[0,g1]=obj_ini.wep1[tco,tid];obj_ini.lid[0,g1]=obj_ini.lid[tco,tid];
            obj_ini.wid[0,g1]=obj_ini.wid[tco,tid];obj_ini.wep2[0,g1]=obj_ini.wep2[tco,tid];obj_ini.armor[0,g1]=obj_ini.armor[tco,tid];
            obj_ini.gear[0,g1]=obj_ini.gear[tco,tid];obj_ini.hp[0,g1]=obj_ini.hp[tco,tid];obj_ini.chaos[0,g1]=obj_ini.chaos[tco,tid];
            obj_ini.mobi[0,g1]=obj_ini.mobi[tco,tid];
            obj_ini.experience[0,g1]=obj_ini.experience[tco,tid];obj_ini.age[0,g1]=obj_ini.age[tco,tid];
            obj_ini.loc[tco,tid]="";obj_ini.name[tco,tid]="";obj_ini.wep1[tco,tid]="";obj_ini.lid[tco,tid]=0;obj_ini.role[tco,tid]="";
            obj_ini.wid[tco,tid]=0;obj_ini.wep2[tco,tid]="";obj_ini.armor[tco,tid]="";obj_ini.gear[tco,tid]="";obj_ini.hp[tco,tid]=0;
            obj_ini.chaos[tco,tid]=0;obj_ini.experience[tco,tid]=0;obj_ini.age[tco,tid]=0;obj_ini.mobi[tco,tid]="";
            if (obj_ini.gear[0,g1]!=""){scr_add_item(obj_ini.gear[0,g1],1);obj_ini.gear[0,g1]="";}
            if (obj_ini.mobi[0,g1]!=""){scr_add_item(obj_ini.mobi[0,g1],1);obj_ini.mobi[0,g1]="";}
            scr_alert("green","recruitment",string(obj_ini.role[100,15])+" Aspirant "+string(obj_ini.name[0,g1])+" begins training.",0,0);
            with(obj_ini){scr_company_order(tco);scr_company_order(0);}
        }    
    }
}










if (global.chapter_name!="Space Wolves") and (global.chapter_name!="Iron Hands"){

if (training_chaplain=1) then chaplain_points+=0.8;
if (training_chaplain=2) then chaplain_points+=0.9;
if (training_chaplain=3) then chaplain_points+=1;
if (training_chaplain=4) then chaplain_points+=1.5;
if (training_chaplain=5) then chaplain_points+=2;
if (training_chaplain=6) then chaplain_points+=4;

if (training_chaplain&gt;0) then tra=scr_role_count(string(obj_ini.role[100,14])+" Aspirant","");
if (chaplain_points&gt;=4) and (chaplain_aspirant!=0) and (tra=0){chaplain_points=0;chaplain_aspirant=0;}
if (chaplain_points&gt;=48){
    if (tra&gt;0){
        var yoo, tid;tid=0;
        yoo=scr_random_marine((obj_ini.role[100,14]+" Aspirant"),0);tid=yoo;
        repeat(10){
            if (obj_ini.role[0,tid]!=obj_ini.role[100,14]+" Aspirant"){
                yoo=scr_random_marine((obj_ini.role[100,14]+" Aspirant"),0);
                tid=yoo;// tco=(yoo-tid)*100;
            }
        }
        if (obj_ini.role[0,tid]=(obj_ini.role[100,14]+" Aspirant")){
            chaplain_points-=48;chaplain_aspirant=0;
            obj_ini.role[0,tid]=obj_ini.role[100,14];obj_ini.experience[0,tid]+=10;
            var eq1,eq2,eq3,t,r;eq1=1;eq2=1;eq3=1;t=0;r=0;
            if (obj_ini.wep1[0,tid]!=obj_ini.wep1[100,14]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.wep1[100,14]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.wep1[0,tid]!="") then scr_add_item(obj_ini.wep1[0,tid],1);scr_add_item(obj_ini.wep1[100,14],-1);obj_ini.wep1[0,tid]=obj_ini.wep1[100,14];}
                if (r=0) then eq1=0;
            }
            if (obj_ini.wep2[0,tid]!=obj_ini.wep2[100,14]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.wep2[100,14]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.wep2[0,tid]!="") then scr_add_item(obj_ini.wep2[0,tid],1);scr_add_item(obj_ini.wep2[100,14],-1);obj_ini.wep2[0,tid]=obj_ini.wep2[100,14];}
                if (r=0) then eq2=0;
            }
            if (obj_ini.gear[0,tid]!=obj_ini.gear[100,14]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.gear[100,14]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.gear[0,tid]!="") then scr_add_item(obj_ini.gear[0,tid],1);scr_add_item(obj_ini.gear[100,14],-1);obj_ini.gear[0,tid]=obj_ini.gear[100,14];}
                if (r=0) then eq3=0;
            }
            scr_alert("green","recruitment",string(obj_ini.role[100,14])+" Aspirant "+string(obj_ini.name[0,tid])+" has finished training.",0,0);
            if (eq1+eq2+eq3!=3){
                var warn,w5;warn="";w5=0;
                if (eq1=0) then warn+=string(obj_ini.wep1[100,14])+", ";
                if (eq2=0) then warn+=string(obj_ini.wep2[100,14])+", ";
                if (eq3=0) then warn+=string(obj_ini.gear[100,14])+", ";
                
                w5=string_length(warn)-1;
                warn=string_delete(warn,w5,2);
                warn+=".";
                scr_alert("red","recruitment","Not enough equipment: "+string(warn),0,0);
            }
            with(obj_ini){scr_company_order(0);}
        }
    }
}
if (chaplain_points&gt;=4) and (chaplain_aspirant=0){    
    var yoo, tid, tco;tid=0;tco=0;
    repeat(10){
        if (tco&lt;1) or (tco&gt;10){
            yoo=scr_random_marine(choose(obj_ini.role[100,8],obj_ini.role[100,8],obj_ini.role[100,10]),60);
            tid=floor(yoo);
            tco=(yoo-tid)*100;
            if (obj_ini.role[tco,tid]="") or (obj_ini.role[tco,tid]=obj_ini.role[100,6]) or (obj_ini.role[tco,tid]="Venerable "+string(obj_ini.role[100,6])){yoo=0;tid=0;tco=0;}
        }
    }
    if (tco&lt;=10) and (obj_ini.role[tco,tid]!=""){
        chaplain_aspirant=1;
        var g1,h;g1=0;g2=0;h=0;
        repeat(300){h+=1;if (g1=0){if (obj_ini.role[0,h]="") then g1=h;}}// This gets the last open slot for company 0
        if (g1!=0){command+=1;marines-=1;
            obj_ini.race[0,g1]=obj_ini.race[tco,tid];obj_ini.loc[0,g1]=obj_ini.loc[tco,tid];obj_ini.name[0,g1]=obj_ini.name[tco,tid];
            obj_ini.role[0,g1]=obj_ini.role[100,14]+" Aspirant";obj_ini.wep1[0,g1]=obj_ini.wep1[tco,tid];obj_ini.lid[0,g1]=obj_ini.lid[tco,tid];
            obj_ini.wid[0,g1]=obj_ini.wid[tco,tid];obj_ini.wep2[0,g1]=obj_ini.wep2[tco,tid];obj_ini.armor[0,g1]=obj_ini.armor[tco,tid];
            obj_ini.gear[0,g1]=obj_ini.gear[tco,tid];obj_ini.hp[0,g1]=obj_ini.hp[tco,tid];obj_ini.chaos[0,g1]=obj_ini.chaos[tco,tid];
            obj_ini.experience[0,g1]=obj_ini.experience[tco,tid];obj_ini.age[0,g1]=obj_ini.age[tco,tid];
            obj_ini.mobi[0,g1]=obj_ini.mobi[tco,tid];
            obj_ini.loc[tco,tid]="";obj_ini.name[tco,tid]="";obj_ini.wep1[tco,tid]="";obj_ini.lid[tco,tid]=0;obj_ini.role[tco,tid]="";
            obj_ini.wid[tco,tid]=0;obj_ini.wep2[tco,tid]="";obj_ini.armor[tco,tid]="";obj_ini.gear[tco,tid]="";obj_ini.hp[tco,tid]=0;
            obj_ini.chaos[tco,tid]=0;obj_ini.experience[tco,tid]=0;obj_ini.age[tco,tid]=0;obj_ini.mobi[tco,tid]="";
            if (obj_ini.gear[0,g1]!=""){scr_add_item(obj_ini.gear[0,g1],1);obj_ini.gear[0,g1]="";}
            if (obj_ini.mobi[0,g1]!=""){scr_add_item(obj_ini.mobi[0,g1],1);obj_ini.mobi[0,g1]="";}
            scr_alert("green","recruitment",string(obj_ini.role[100,14])+" Aspirant "+string(obj_ini.name[0,g1])+" begins training.",0,0);
            with(obj_ini){scr_company_order(tco);scr_company_order(0);}
        }    
    }
}}tra=0;






if (training_psyker=1) then psyker_points+=0.8;
if (training_psyker=2) then psyker_points+=0.9;
if (training_psyker=3) then psyker_points+=1;
if (training_psyker=4) then psyker_points+=1.5;
if (training_psyker=5) then psyker_points+=2;
if (training_psyker=6) then psyker_points+=4;

var o,yep,goal;goal=48;yep=0;
o=0;repeat(4){o+=1;if (obj_ini.adv[o]="Psyker Abundance"){goal=30;yep=1;}}

if (training_psyker&gt;0) then tra=scr_role_count(string(obj_ini.role[100,17])+" Aspirant","");
if (psyker_points&gt;=round(goal/2)) and (psyker_aspirant!=0) and (tra=0){psyker_points=0;psyker_aspirant=0;}
if (psyker_points&gt;=goal){
    if (tra&gt;0){
        var yoo, tid;tid=0;
        yoo=scr_random_marine((obj_ini.role[100,17]+" Aspirant"),0);tid=yoo;
        repeat(10){
            if (obj_ini.role[0,tid]!=obj_ini.role[100,17]+" Aspirant"){
                yoo=scr_random_marine((obj_ini.role[100,17]+" Aspirant"),0);
                tid=yoo;// tco=(yoo-tid)*100;
            }
        }
        if (obj_ini.role[0,tid]=(obj_ini.role[100,17]+" Aspirant")){
            psyker_points-=48;psyker_aspirant=0;
            obj_ini.role[0,tid]="Lexicanum";
            scr_alert("green","recruitment","Librarian Aspirant "+string(obj_ini.name[0,tid])+" has finished training.",0,0);
            with(obj_ini){scr_company_order(0);}
        }
    }
}
if (psyker_points&gt;=round(goal/2)) and (psyker_aspirant=0){
    var yoo, tid, tco;tid=0;tco=0;
    repeat(15){
        if (tco&lt;=2) or (tco&gt;10){
            yoo=scr_random_marine(obj_ini.role[100,8],30);
            tid=floor(yoo);
            tco=(yoo-tid)*100;
            if (obj_ini.role[tco,tid]=""){yoo=0;tid=0;tco=0;}
            if (tid+tco!=0){if (obj_ini.role[tco,tid]="Company Champion"){yoo=0;tid=0;tco=0;}}
        }
    }
    if (tco&lt;=10) and (obj_ini.role[tco,tid]!=""){
        psyker_aspirant=1;
        var g1,h;g1=0;g2=0;h=0;
        repeat(300){h+=1;if (g1=0){if (obj_ini.role[0,h]="") then g1=h;}}// This gets the last open slot for company 0
        if (g1!=0){command+=1;marines-=1;
            obj_ini.race[0,g1]=obj_ini.race[tco,tid];obj_ini.loc[0,g1]=obj_ini.loc[tco,tid];obj_ini.name[0,g1]=obj_ini.name[tco,tid];
            obj_ini.role[0,g1]=string(obj_ini.role[100,17])+" Aspirant";obj_ini.wep1[0,g1]=obj_ini.wep1[tco,tid];obj_ini.lid[0,g1]=obj_ini.lid[tco,tid];
            obj_ini.wid[0,g1]=obj_ini.wid[tco,tid];obj_ini.wep2[0,g1]=obj_ini.wep2[tco,tid];obj_ini.armor[0,g1]=obj_ini.armor[tco,tid];
            obj_ini.gear[0,g1]=obj_ini.gear[tco,tid];obj_ini.hp[0,g1]=obj_ini.hp[tco,tid];obj_ini.chaos[0,g1]=obj_ini.chaos[tco,tid];
            obj_ini.experience[0,g1]=obj_ini.experience[tco,tid];obj_ini.age[0,g1]=obj_ini.age[tco,tid];
            scr_powers_new(0,g1);
            
            if (string_count("Abund",obj_ini.strin)&gt;0) then obj_ini.experience[0,g1]+=floor(random(5))+3;
            
            obj_ini.mobi[0,g1]=obj_ini.mobi[tco,tid];
            obj_ini.loc[tco,tid]="";obj_ini.name[tco,tid]="";obj_ini.wep1[tco,tid]="";obj_ini.lid[tco,tid]=0;obj_ini.role[tco,tid]="";
            obj_ini.wid[tco,tid]=0;obj_ini.wep2[tco,tid]="";obj_ini.armor[tco,tid]="";obj_ini.gear[tco,tid]="";obj_ini.hp[tco,tid]=0;
            obj_ini.chaos[tco,tid]=0;obj_ini.experience[tco,tid]=0;obj_ini.age[tco,tid]=0;obj_ini.mobi[tco,tid]="";
            if (obj_ini.gear[0,g1]!=""){scr_add_item(obj_ini.gear[0,g1],1);obj_ini.gear[0,g1]="";}
            if (obj_ini.mobi[0,g1]!=""){scr_add_item(obj_ini.mobi[0,g1],1);obj_ini.mobi[0,g1]="";}
            scr_alert("green","recruitment",string(obj_ini.role[100,17])+" Aspirant "+string(obj_ini.name[0,g1])+" begins training.",0,0);
            with(obj_ini){scr_company_order(tco);scr_company_order(0);}
        }    
    }
}tra=0;













/*var tm_num;tm_num=0;
tm_num=scr_role_count("Tech Recruit","");

if (tm_num&gt;0){*/
if (training_techmarine=1) then tech_points+=1;
if (training_techmarine=2) then tech_points+=2;
if (training_techmarine=3) then tech_points+=4;
if (training_techmarine=4) then tech_points+=6;
if (training_techmarine=5) then tech_points+=8;
if (training_techmarine=6) then tech_points+=16;

if (training_techmarine&gt;0) then tra=scr_role_count(string(obj_ini.role[100,16])+" Aspirant","");
if (tech_points&gt;=4) and (tech_aspirant!=0) and (tra=0){tech_points=0;tech_aspirant=0;}
if (tech_points&gt;=360){
    if (tra&gt;0){
        var yoo, tid;tid=0;
        yoo=scr_random_marine((obj_ini.role[100,16]+" Aspirant"),0);tid=yoo;
        repeat(10){
            if (obj_ini.role[0,tid]!=obj_ini.role[100,16]+" Aspirant"){
                yoo=scr_random_marine((obj_ini.role[100,16]+" Aspirant"),0);
                tid=yoo;// tco=(yoo-tid)*100;
            }
        }
        if (obj_ini.role[0,tid]=(obj_ini.role[100,16]+" Aspirant")){
            tech_points-=360;tech_aspirant=0;
            obj_ini.role[0,tid]=obj_ini.role[100,16];obj_ini.experience[0,tid]+=10;
            
            var eq1,eq2,eq3,t,r;eq1=1;eq2=1;eq3=1;t=0;r=0;
            if (obj_ini.wep1[0,tid]!=obj_ini.wep1[100,16]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.wep1[100,16]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.wep1[0,tid]!="") then scr_add_item(obj_ini.wep1[0,tid],1);scr_add_item(obj_ini.wep1[100,16],-1);obj_ini.wep1[0,tid]=obj_ini.wep1[100,16];}
                if (r=0) then eq1=0;
            }
            if (obj_ini.wep2[0,tid]!=obj_ini.wep2[100,16]){
                repeat(50){t+=1;if (obj_ini.equipment[t]=obj_ini.wep2[100,16]) and (obj_ini.equipment_number[t]&gt;=1) and (r=0) then r=t;}
                if (r!=0){if (obj_ini.wep2[0,tid]!="") then scr_add_item(obj_ini.wep2[0,tid],1);scr_add_item(obj_ini.wep2[100,16],-1);obj_ini.wep2[0,tid]=obj_ini.wep2[100,16];}
                if (r=0) then eq2=0;
            }
            if (obj_ini.gear[0,tid]!=obj_ini.gear[100,16]){
                if (obj_ini.gear[0,tid]!="") then scr_add_item(obj_ini.gear[0,tid],1);
                obj_ini.gear[0,tid]="Servo Arms";
            }
            scr_alert("green","recruitment",string(obj_ini.name[0,tid])+" returns from Mars, a "+string(obj_ini.role[100,16])+".",0,0);
            
            if (eq1+eq2!=2){
                var warn,w5;warn="";w5=0;
                if (eq1=0) then warn+=string(obj_ini.wep1[100,16])+", ";
                if (eq2=0) then warn+=string(obj_ini.wep2[100,16])+", ";
                
                w5=string_length(warn)-1;warn=string_delete(warn,w5,2);warn+=".";
                scr_alert("red","recruitment","Not enough equipment: "+string(warn),0,0);
            }
            
            obj_ini.loc[0,tid]=obj_ini.home_name;obj_ini.wid[0,tid]=2;obj_ini.lid[0,tid]=0;
            // Probably want to change this to take into account fleet type chapters- also increase the man_size of that area by +X
            
            if (global.chapter_name!="Iron Hands") and (obj_ini.bio[0,tid]&lt;4) then obj_ini.bio[0,tid]=choose(4,5,6);
            if (global.chapter_name="Iron Hands") and (obj_ini.bio[0,tid]&lt;7) then obj_ini.bio[0,tid]=choose(7,8);
            
            // 135 ; probably also want to increase the p_player by 1 just because
            
            with(obj_ini){scr_company_order(0);}
        }
    }
}
if (tech_points&gt;=4) and (tech_aspirant=0){    
    var yoo, tid, tco;tid=0;tco=0;
    repeat(10){
        if (tco&lt;2) or (tco&gt;10){
            yoo=scr_random_marine(choose(obj_ini.role[100,8],obj_ini.role[100,8],obj_ini.role[100,10],obj_ini.role[100,9]),30);
            tid=floor(yoo);
            tco=(yoo-tid)*100;
            if (obj_ini.role[tco,tid]="") or (string_count("Dread",obj_ini.armor[tco,tid])&gt;0){yoo=0;tid=0;tco=0;}
        }
    }
    if (tco&lt;=10) and (obj_ini.role[tco,tid]!=""){
        tech_aspirant=1;
        var g1,h;g1=0;g2=0;h=0;
        repeat(300){h+=1;if (g1=0){if (obj_ini.role[0,h]="") then g1=h;}}// This gets the last open slot for company 0
        if (g1!=0){command+=1;marines-=1;
            obj_ini.race[0,g1]=obj_ini.race[tco,tid];obj_ini.loc[0,g1]=obj_ini.loc[tco,tid];obj_ini.name[0,g1]=obj_ini.name[tco,tid];
            obj_ini.role[0,g1]=obj_ini.role[100,16]+" Aspirant";obj_ini.wep1[0,g1]=obj_ini.wep1[tco,tid];obj_ini.lid[0,g1]=obj_ini.lid[tco,tid];
            obj_ini.wid[0,g1]=obj_ini.wid[tco,tid];obj_ini.wep2[0,g1]=obj_ini.wep2[tco,tid];obj_ini.armor[0,g1]=obj_ini.armor[tco,tid];
            obj_ini.gear[0,g1]=obj_ini.gear[tco,tid];obj_ini.hp[0,g1]=obj_ini.hp[tco,tid];obj_ini.chaos[0,g1]=obj_ini.chaos[tco,tid];
            obj_ini.mobi[0,g1]=obj_ini.mobi[tco,tid];
            obj_ini.experience[0,g1]=obj_ini.experience[tco,tid];obj_ini.age[0,g1]=obj_ini.age[tco,tid];
            obj_ini.loc[tco,tid]="";obj_ini.name[tco,tid]="";obj_ini.wep1[tco,tid]="";obj_ini.lid[tco,tid]=0;obj_ini.role[tco,tid]="";
            obj_ini.wid[tco,tid]=0;obj_ini.wep2[tco,tid]="";obj_ini.armor[tco,tid]="";obj_ini.gear[tco,tid]="";obj_ini.hp[tco,tid]=0;
            obj_ini.chaos[tco,tid]=0;obj_ini.experience[tco,tid]=0;obj_ini.age[tco,tid]=0;obj_ini.mobi[tco,tid]="";
            if (obj_ini.lid[0,g1]&gt;0){// Remove from ship
                var man_size;man_size=scr_unit_size(obj_ini.armor[0,g1],obj_ini.role[0,g1],true);
                obj_ini.ship_carrying[obj_ini.lid[0,g1]]-=man_size;
            }
            obj_ini.loc[0,g1]="Terra";obj_ini.wid[0,g1]=4;obj_ini.lid[0,g1]=0;
            if (obj_ini.wep1[0,g1]!="Power Weapon") and (obj_ini.wep1[0,g1]!=""){scr_add_item(obj_ini.wep1[0,g1],1);obj_ini.wep1[0,g1]="";}
            if (obj_ini.wep2[0,g1]!=""){scr_add_item(obj_ini.wep2[0,g1],1);obj_ini.wep2[0,g1]="";}
            if (obj_ini.gear[0,g1]!=""){scr_add_item(obj_ini.gear[0,g1],1);obj_ini.gear[0,g1]="";}
            if (obj_ini.mobi[0,g1]!=""){scr_add_item(obj_ini.mobi[0,g1],1);obj_ini.mobi[0,g1]="";}
            scr_alert("green","recruitment",string(obj_ini.role[100,16])+" Aspirant "+string(obj_ini.name[0,g1])+" journeys to Mars.",0,0);
            with(obj_ini){scr_company_order(tco);scr_company_order(0);}
        }    
    }
}tra=0;


/*
training_apothecary=2;
apothecary_points=0;
apothecary_aspirant=0;
training_chaplain=2;
chaplain_points=0;
chaplain_aspirant=0;
training_psyker=2;
psyker_points=0;
psyker_aspirant=0;
training_techmarine=0;
tech_points=0;
recruiting=0;
recruits=0;
*/









var i, onceh, up, tot,stahp;
i=0;onceh=0;up=0;tot=0;stahp=0;

if (obj_ini.fleet_type!=1){
    with(obj_temp5){instance_destroy();}
    with(obj_p_fleet){
        if (action!="") then instance_create(x,y,obj_temp5);
        if (x&lt;0) or (x&gt;room_width) or (y&lt;0) or (y&gt;room_height) then instance_create(x,y,obj_temp5);
    }
    if (instance_number(obj_temp5)&gt;=instance_number(obj_p_fleet)) then stahp=1;
    with(obj_temp5){instance_destroy();}
}









// probably rewrite all of this








var recruits_finished,tot,recruit_first;
recruits_finished=0;tot=0;recruit_first="";

i=0;
repeat(300){i+=1;
    if (recruit_name[i]!="") then tot+=1;
    if (recruit_name[i]!="") and (recruit_distance[i]&lt;=0) then recruit_training[i]-=1;
}

i=0;
repeat(300){i+=1;
    if (recruit_name[i]!="") and (recruit_training[i]&lt;=0){
        scr_add_man(obj_ini.role[100,12],10,"Scout Armor",obj_ini.role[100,12],"",recruit_exp[i],recruit_name[i],recruit_corruption[i],false,"default","");
        if (recruit_first="") then recruit_first=recruit_name[i];
        recruits_finished+=1;recruit_name[i]="";recruit_training[i]=-50;
    }
}

i=0;
repeat(299){i+=1;
    if (recruit_name[i]="") and (recruit_name[i+1]!=""){
        recruit_name[i]=recruit_name[i+1];
        recruit_corruption[i]=recruit_corruption[i+1];
        recruit_distance[i]=recruit_distance[i+1];
        recruit_training[i]=recruit_training[i+1];
        recruit_exp[i]=recruit_exp[i+1];
        
        recruit_name[i+1]="";recruit_corruption[i+1]=0;
        recruit_distance[i+1]=0;recruit_training[i+1]=0;
        recruit_exp[i+1]=0;
    }
}

if (recruits_finished=1) then scr_alert("green","recruitment",string(obj_ini.role[100,12])+" "+string(recruit_first)+" has joined the 10th Company.",0,0);
if (recruits_finished&gt;1) then scr_alert("green","recruitment",string(recruits_finished)+"x "+string(obj_ini.role[100,12])+" have joined the 10th Company.",0,0);

recruits=tot;


// "+string(obj_img.organics)+" Test-Slaves
i=0;repeat(120){i+=1;
    if (obj_ini.slave_batch_num[i]&gt;0){
        obj_ini.slave_batch_eta[i]-=1;
        if (obj_ini.slave_batch_eta[i]=0){
            obj_ini.slave_batch_eta[i]=60;
            obj_controller.gene_seed+=obj_ini.slave_batch_num[i];
            // color / type / text /x/y
            scr_alert("green","test-slaves","Test-Slave Incubators Batch "+string(i)+" harvested for "+string(obj_ini.slave_batch_num[i])+" "+string(obj_img.organics)+".",0,0);
        }
    }
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Other</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

if (turn=240) and (global.chapter_name="Lamenters"){obj_ini.strin2+="Black Rage";
    scr_popup(string(obj_img.organics)+" Mutation","Your "+string(obj_img.player_army)+" has begun to have visions and nightmares of Sanguinius' fall.  The less mentally disciplined of your battle-brothers no longer are able to sleep soundly, waking from sleep in a screaming, frothing rage.  It appears the Black Rage has returned.","black_rage","");    
}

if (obj_ini.adv[1]="Scavengers") or (obj_ini.adv[1]="Scavengers") or (obj_ini.adv[1]="Scavengers") or (obj_ini.adv[1]="Scavengers"){
    var lroll1,lroll2,loot;
    lroll1=floor(random(100))+1;
    lroll2=floor(random(100))+1;
    loot="";
    if (obj_ini.dis[1]="Shitty Luck") or (obj_ini.dis[2]="Shitty Luck") or (obj_ini.dis[3]="Shitty Luck") or (obj_ini.dis[4]="Shitty Luck"){lroll1+=2;lroll2+=25;}
    if (lroll1&lt;=5){
        loot=choose(string(obj_img.blade)+"sword",string(obj_img.gyro_adj)+" Pistol","Combat Knife","Narthecium");
        if (lroll2&lt;=80) then loot=choose("Power Sword","Storm "+string(obj_img.gyro));
        if (lroll2&lt;=60) then loot=choose("Plasma Pistol",string(obj_img.blade)+"fist",string(obj_img.laser)+"cannon","Heavy "+string(obj_img.gyro),"Assault Cannon","Bike");
        if (lroll2&lt;=30) then loot=choose("Artificer Armor","Plasma Gun",string(obj_img.blade)+"fist","Rosarius","Psychic Hood");
        if (lroll2&lt;=10) then loot=choose(string(obj_img.battlesuit),"Artificer Armor",obj_img.unit[1,6],"Plasma Gun","Power Fist",string(obj_img.hammer),"Iron Halo");
        var tix;tix="A "+string(loot)+" has been gifted to the "+string(obj_img.player_army)+".";
        tix=string_replace(tix,"A A","An A");tix=string_replace(tix,"A E","An E");
        tix=string_replace(tix,"A I","An I");tix=string_replace(tix,"A O","An O");
        scr_add_item(string(loot),1);scr_alert("","loot",tix,0,0);
    }
}


// Check number of navy fleets
with(obj_temp_inq){instance_destroy();}
with(obj_temp8){instance_destroy();}
with(obj_en_fleet){
    if (owner=2) and (navy=1) then instance_create(x,y,obj_temp_inq);
}
if (instance_number(obj_temp_inq)&gt;target_navy_number){
    with(obj_en_fleet){if (navy=0) or (guardsmen_unloaded=1) then y-=20000;}
    var him;him=instance_nearest(random(room_width),random(room_height),obj_en_fleet);
    if (him.guardsmen_unloaded=0) and (him.navy=1) then with(him){instance_destroy();}
    with(obj_en_fleet){if (y&lt;-10000) then y+=20000;}
}
if (instance_number(obj_temp_inq)&lt;target_navy_number){
    with(obj_star){
        var o,good;o=0;good=0;
        repeat(4){o+=1;
            if (p_type[o]="Forge") and (p_owner[o]=3) and (p_orks[o]+p_tau[o]+p_tyranids[o]+p_chaos[o]+p_traitors[o]+p_necrons[o]=0){
                if (present_fleet[7]+present_fleet[8]+present_fleet[9]+present_fleet[10]+present_fleet[13]=0){
                    good=1;if (instance_nearest(x+24,y-24,obj_en_fleet).navy=1) then good=0;
                }
            }
        }
        if (good=1) then instance_create(x,y,obj_temp8);
    }
}
if (instance_exists(obj_temp8)){
    var newy,nav,ii;newy=instance_nearest(random(room_width),random(room_height),obj_temp8);
    nav=instance_create(newy.x+24,newy.y-24,obj_en_fleet);
    nav.owner=2;ii=0;
    
    nav.capital_number=0;
    nav.frigate_number=0;
    nav.escort_number=1;
    nav.home_x=x;nav.home_y=y;
    with(instance_nearest(newy.x,newy.y,obj_star)){present_fleet[2]+=1;}
    nav.orbiting=instance_nearest(newy.x,newy.y,obj_star);
    nav.navy=1;
    
    var ii;ii=0;ii+=nav.capital_number-1;ii+=round((nav.frigate_number/2));ii+=round((nav.escort_number/4));
    if (ii&lt;=1) and (nav.capital_number+nav.frigate_number+nav.escort_number&gt;0) then ii=1;
    nav.image_index=ii;nav.image_speed=0;
    
    nav.trade_goods="building_ships";
    with(obj_temp8){instance_destroy();}
}




if (gene_tithe=0) and (faction_status[2]!="War"){// Time for another tithe
    gene_tithe=24;
    
    var expected,onceh,txt,mech_mad;onceh=0;txt="";mech_mad=false;
    expected=max(1,round(obj_controller.gene_seed/20));
    if (obj_controller.faction_status[3]="War") then mech_mad=true;
    
    if (obj_controller.gene_seed&lt;=0) or (mech_mad=true){onceh=2;gene_iou+=1;loyalty-=2;loyalty_hidden-=2;
        txt="No "+string(obj_img.organics)+" for "+string(obj_img.faction[3])+" tithe.  High Lords of Terra IOU increased to "+string(gene_iou)+".";
    }
    
    if (mech_mad=false){
        if (obj_controller.gene_seed&gt;0) and (und_gene_vaults=0) and (onceh=0){
            obj_controller.gene_seed-=expected;onceh=1;
            
            if (obj_controller.gene_seed&gt;=gene_iou) and (gene_iou&gt;0){
                expected+=gene_iou;obj_controller.gene_seed-=gene_iou;gene_iou=0;
                onceh=3;
            }
            
            repeat(50){
                if (obj_controller.gene_seed&lt;gene_iou) and (obj_controller.gene_seed&gt;0) and (gene_iou&gt;0){
                    expected+=1;obj_controller.gene_seed-=1;gene_iou-=1;if (gene_iou=0) then onceh=3;
                }
            }
            
            if (gene_iou&lt;0) then gene_iou=0;
            
            txt=string(expected)+" "+string(obj_img.organics)+" sent to "+string(obj_img.faction[3])+" for tithe.";
            if (gene_iou&gt;0) then txt+="  IOU remains at "+string(gene_iou)+".";
            if (onceh=3) then txt+="  IOU has been payed off.";
        }
        
        if (obj_controller.gene_seed&gt;0) and (und_gene_vaults&gt;0) and (onceh=0){
            expected=1;obj_controller.gene_seed-=expected;onceh=1;
            
            if (obj_controller.gene_seed&lt;gene_iou) and (obj_controller.gene_seed&gt;0) and (gene_iou&gt;0){
                expected+=1;obj_controller.gene_seed-=1;gene_iou-=1;if (gene_iou=0) then onceh=3;
            }
            
            if (gene_iou&lt;0) then gene_iou=0;
            
            txt=string(expected)+" "+string(obj_img.organics)+" sent to "+string(obj_img.faction[3])+" for tithe.";
            if (gene_iou&gt;0) then txt+="  IOU remains at "+string(gene_iou)+".";
            if (onceh=3) then txt+="  IOU has been payed off.";
        }
        
        if (onceh!=2){scr_alert("green","tithes",txt,0,0);scr_event_log("",txt);}
        if (onceh=2){scr_alert("red","tithes",txt,0,0);scr_event_log("red",txt);}
    }
}
if (gene_sold&gt;0){
    var disc,droll;disc=0;droll=0;
    gene_sold=floor(gene_sold*75)/100;

    if (gene_sold&lt;1) then gene_sold=0;    
    if (gene_sold&gt;=50){
        disc=round(gene_sold/7);
        droll=floor(random(100))+1;
        
        if (droll&lt;=disc) and (obj_controller.known[4]!=0){// Inquisition takes notice
            var disp_change;disp_change=-3;
            if (gene_sold&gt;=100) then disp_change=-5;
            if (gene_sold&gt;=200) then disp_change=-7;
            if (gene_sold&gt;=400) then disp_change=-10;
            gene_sold=0;scr_audience(4,"gene_trade",disp_change,"",2,0);
        }
    }
}
if (gene_xeno&gt;0){
    var disc,droll;disc=0;droll=0;
    gene_xeno=floor(gene_xeno*90)/100;

    if (gene_xeno&lt;1) then gene_xeno=0;    
    if (gene_xeno&gt;=5){
        disc=round(gene_xeno/5);
        droll=floor(random(100))+1;
        
        if (droll&lt;=disc) and (obj_controller.known[4]!=0){// Inquisition takes notice
            gene_xeno=99999;alarm[8]=1;
        }
    }
}











var c,e,p;c=-1;e=0;p=0;penitorium=0;
repeat(11){c+=1;e=0;
    repeat(250){e+=1;
        if (obj_ini.god[c,e]&gt;=10){
            p+=1;penit_co[p]=c;penit_id[p]=e;penitorium+=1;
            if (obj_ini.chaos[c,e]&lt;90) and (obj_ini.chaos[c,e]&gt;0){
                var heresy_old,heresy_new;heresy_old=0;heresy_new=0;
                heresy_old=round((obj_ini.chaos[c,e]*obj_ini.chaos[c,e])/50)-0.5;
                heresy_new=(heresy_old*50)/obj_ini.chaos[c,e];
                obj_ini.chaos[c,e]=max(0,heresy_new);
            }
        }
    }
}

// STC Bonuses
if (obj_controller.stc_ships&gt;=6){var v;v=0;
    repeat(40){v+=1;
        if (obj_ini.ship_hp[v]&lt;obj_ini.ship_maxhp[v]) then obj_ini.ship_hp[v]+=round(obj_ini.ship_maxhp[v]*0.06);
        if (obj_ini.ship_hp[v]&gt;obj_ini.ship_maxhp[v]) then obj_ini.ship_hp[v]=obj_ini.ship_maxhp[v];
    }
}




// if (turn=chaos_turn) and (faction_gender[10]=1){// show_message("Turn 100");
if (turn=5) and (faction_gender[10]=1){// show_message("Turn 100");
    var xx4,yy4,plant,planeh,fleeta,testi;
    xx4=0;yy4=0;plant=0;planeh=0;testi=0;fleeta=0;
    
    with(obj_en_fleet){if (owner!=2) then y-=20000;}
    
    repeat(50){
        if (planeh=0){xx4=floor(random(room_width))+1;yy4=floor(random(room_height))+1;plant=instance_nearest(xx4,yy4,obj_star);}
        if (planeh=0) and (plant.owner=2) and (plant.planets&gt;1){
            planeh=instance_nearest(xx4,yy4,obj_star);
            
            if (planeh.present_fleet[2]&gt;0){
                fleeta=instance_nearest(planeh.x,planeh.y,obj_en_fleet);
                if (point_distance(fleeta.x,fleeta.y,planeh.x,planeh.y)&gt;40) then planeh=0;
            }
            if (planeh.present_fleet[2]=0) then planeh=0;
        }
    }
    if (planeh!=0){
        if (planeh.p_type[1]="Dead") then testi=2;
        if (planeh.p_type[1]!="Dead") then testi=1;
        
        planeh.p_feature[testi]+="WL10|";
        if (planeh.p_type[testi]="Hive") then planeh.p_heresy[testi]+=25;
        if (planeh.p_type[testi]!="Hive") then planeh.p_heresy[testi]+=10;
        if (planeh.p_heresy[testi]&lt;50) then planeh.p_heresy_secret[testi]=10;
        
        // show_message("Placed the chaos warlord on "+string(planeh.name)+" "+scr_roman(testi));// 139
        // obj_controller.x=planeh.x;obj_controller.y=planeh.y;
    }
    
    with(obj_en_fleet){if (owner!=2) then y+=20000;}
}



if (blood_debt=1) and (penitent=1){
    penitent_turn+=1;
    // was -60
    penitent_turnly=((penitent_turn*penitent_turn)-512)*-1;
    if (penitent_turnly&gt;0) then penitent_turnly=0;
    penitent_current+=penitent_turnly;
    
    if (penitent_current&lt;=0){penitent=0;alarm[8]=1;}
    if (penitent_end&lt;30000) then penitent_end+=41000;
    
    if (penitent_current&gt;=penitent_max) or (((obj_controller.millenium*1000)+obj_controller.year)&gt;=penitent_end){
        penitent=0;
        if (known[4]=2) or (known[4]&gt;=4) then scr_audience(4,"penitent_end",0,"",0,0);
        if (known[5]&gt;=2) then scr_audience(5,"penitent_end",0,"",0,0);
        disposition[2]+=20;disposition[3]+=15;disposition[4]+=20;disposition[5]+=20;
        var o;o=0;repeat(4){if (o&lt;=4){o+=1;if (obj_ini.adv[o]="Reverent Guardians") then o=500;}}if (o&gt;100) then obj_controller.disposition[5]+=10;
        scr_event_log("","Blood Debt payed off.  You may once more recruit Astartes.");
    }
}

if (penitent=1) and (blood_debt=0){
    penitent_turn+=1;penitent_current+=1;penitent_turnly=0;
    
    if (penitent_current&lt;=0){penitent=0;alarm[8]=1;}
    if (penitent_current&gt;=penitent_max){penitent=0;
        if (known[4]=2) or (known[4]&gt;=4) then scr_audience(4,"penitent_end",0,"",0,0);
        if (known[5]&gt;=2) then scr_audience(5,"penitent_end",0,"",0,0);
        disposition[2]+=20;disposition[3]+=15;disposition[4]+=20;disposition[5]+=20;
        var o;o=0;repeat(4){if (o&lt;=4){o+=1;if (obj_ini.adv[o]="Reverent Guardians") then o=500;}}if (o&gt;100) then obj_controller.disposition[5]+=10;
        scr_event_log("","Penitent Crusade ends.  You may once more recruit Astartes.");
    }
}














// if (obj_controller.known[7]=0){
if ((turn&gt;=10) or (obj_ini.fleet_type=3)) and (faction_defeated[7]=0){
    var waaagh;waaagh=floor(random(100))+1;
    with(obj_star){
        if (owner=7) then instance_create(x,y,obj_temp2);
    }
    if ((instance_number(obj_temp2)&gt;=5) and (waaagh&lt;=instance_number(obj_temp2)) and (obj_controller.known[7]=0))/* or (obj_controller.test_map=true)*/{
        obj_controller.known[7]=0.5;
        with(obj_star){
            if (owner=7) then alarm[4]=1;
        }
        
        if (!instance_exists(obj_turn_end)) then scr_popup("WAAAAGH!","The greenskins have swelled in activity, their numbers increasing seemingly without relent.  A massive Warboss has risen to take control, leading most of the sector's Orks on a massive WAAAGH!","waaagh","");
        if (instance_exists(obj_turn_end)){
            obj_turn_end.popups+=1;
            obj_turn_end.popup[obj_turn_end.popups]=1;
            obj_turn_end.popup_type[obj_turn_end.popups]="WAAAAGH!";
            obj_turn_end.popup_text[obj_turn_end.popups]="The greenskins have swelled in activity, their numbers increasing seemingly without relent.  A massive Warboss has risen to take control, leading most of the sector's Orks on a massive WAAAGH!";
            obj_turn_end.popup_image[obj_turn_end.popups]="waaagh";
            scr_event_log("red","Ork WAAAAGH! begins.");
            
            with(obj_star){
                if (owner=7){
                    var rund;rund=floor(random(planets))+1;
                    if (rund=1) and (p_owner[1]=7) and (p_pdf[1]=0) and (p_guardsmen[1]=0) and (p_orks[1]&gt;=2) then instance_create(x,y,obj_temp6);
                    if (rund=2) and (p_owner[2]=7) and (p_pdf[2]=0) and (p_guardsmen[2]=0) and (p_orks[2]&gt;=2) then instance_create(x,y,obj_temp6);
                    if (rund=3) and (p_owner[3]=7) and (p_pdf[3]=0) and (p_guardsmen[3]=0) and (p_orks[3]&gt;=2) then instance_create(x,y,obj_temp6);
                    if (rund=4) and (p_owner[4]=7) and (p_pdf[4]=0) and (p_guardsmen[4]=0) and (p_orks[4]&gt;=2) then instance_create(x,y,obj_temp6);
                }
            }
            if (instance_exists(obj_temp6)){
                var you2,you,rund;
                you2=instance_nearest(random(room_width),random(room_height),obj_temp6);
                you=instance_nearest(you2.x,you2.y,obj_star);
                
                with(obj_temp2){instance_destroy();}
                repeat(10){
                    if (!instance_exists(obj_temp2)){
                        rund=round(random(you.planets));
                        if (rund=1) and (you.p_owner[1]=7) and (you.p_pdf[1]+you.p_guardsmen[1]=0) and (you.p_orks[1]&gt;=2) then you.p_feature[rund]+="WL7|";
                        if (rund=2) and (you.p_owner[2]=7) and (you.p_pdf[2]+you.p_guardsmen[2]=0) and (you.p_orks[2]&gt;=2) then you.p_feature[rund]+="WL7|";
                        if (rund=3) and (you.p_owner[3]=7) and (you.p_pdf[3]+you.p_guardsmen[3]=0) and (you.p_orks[3]&gt;=2) then you.p_feature[rund]+="WL7|";
                        if (rund=4) and (you.p_owner[4]=7) and (you.p_pdf[4]+you.p_guardsmen[4]=0) and (you.p_orks[4]&gt;=2) then you.p_feature[rund]+="WL7|";
                        if (you.p_orks[rund]&lt;4) then you.p_orks[rund]=4;
                        if (string_count("WL7",you.p_feature[rund])&gt;0) then instance_create(x,y,obj_temp2);
                    }
                }
            }
            with(obj_temp6){instance_destroy();}
            with(obj_temp2){instance_destroy();}
        }
    }
    with(obj_temp2){instance_destroy();}
}


// if (known[5]=1){var spikky;spikky=choose(0,0,0,1,1);if (spikky=1) then with(obj_turn_end){audiences+=1;audien[audiences]=5;audien_topic[audiences]="intro";}}
if (known[5]=1){var spikky;spikky=choose(0,1,1);if (spikky=1) then with(obj_turn_end){audiences+=1;audien[audiences]=5;known[5]=2;audien_topic[audiences]="intro";if (obj_controller.faction_status[5]="War") then audien_topic[audiences]="declare_war";}}
if (known[6]=1) and (faction_defeated[6]=0){var spikky;spikky=choose(0,1);if (spikky=1) then with(obj_turn_end){audiences+=1;audien[audiences]=6;audien_topic[audiences]="intro1";}}
if (known[7]=0.5) and (faction_defeated[7]=0){var spikky;spikky=floor(random(7));if (spikky=1) then with(obj_turn_end){audiences+=1;audien[audiences]=7;audien_topic[audiences]="intro";}}
if (known[8]=1) and (faction_defeated[8]=0){with(obj_turn_end){audiences+=1;audien[audiences]=8;audien_topic[audiences]="intro";}}




// Quests here
var i;i=0;// 135 ; quests
repeat(40){i+=1;
    if (quest_end[i]&lt;=turn) and (quest[i]!=""){
        scr_quest(1,quest[i],quest_faction[i],0);
        quest[i]="";
    }
    if (quest[i]="") and (quest[i+1]!=""){
        quest[i]=quest[i+1];quest_faction[i]=quest_faction[i+1];quest_end[i]=quest_end[i+1];
        quest[i+1]+="";quest_faction[i+1]=0;quest_end[i+1]=0;
    }
}







// Inquisition stuff here
if (disposition[6]&gt;=60) then scr_loyalty("Xeno Associate","+");
if (disposition[7]&gt;=60) then scr_loyalty("Xeno Associate","+");
if (disposition[8]&gt;=60) then scr_loyalty("Xeno Associate","+");

var fuck1;
fuck1=0;fuck1=scr_role_count(obj_ini.role[100,15],"");if (fuck1=0) then scr_loyalty("Lack of Apothecary","+");
fuck1=0;fuck1=scr_role_count(obj_ini.role[100,16],"");if (fuck1=0) then scr_loyalty("Upset Machine Spirits","+");
fuck1=0;fuck1=scr_role_count(obj_ini.role[100,14],"");if (fuck1=0) then scr_loyalty("Undevout","+");

if (marines&gt;=1050) then scr_loyalty("Non-Codex Size","+");






var laas;laas=0;
if (obj_ini.fleet_type=1) then laas=last_world_inspection;
if (obj_ini.fleet_type!=1) then laas=last_fleet_inspection;

var inspec;inspec=0;
if (loyalty&gt;=85) and ((laas+59)&lt;turn) then inspec=1;
if (loyalty&gt;=70) and (loyalty&lt;85) and ((laas+47)&lt;turn) then inspec=1;
if (loyalty&gt;=50) and (loyalty&lt;70) and ((laas+35)&lt;turn) then inspec=1;
if (loyalty&lt;50) and ((laas+11+choose(1,2,3,4))&lt;turn) then inspec=1;

if (obj_ini.fleet_type!=1){
    with(obj_p_fleet){if (capital_number&lt;=0) then instance_deactivate_object(id);}
    if (instance_number(obj_p_fleet)=1) and (obj_ini.fleet_type!=1){// Might be crusading, right?
        if (obj_p_fleet.x&lt;0) or (obj_p_fleet.x&gt;room_width) or (obj_p_fleet.y&lt;0) or (obj_p_fleet.y&gt;room_height) then inspec=0;
    }
    if (instance_number(obj_p_fleet)=0) then inspec=0;
}
instance_activate_object(obj_p_fleet);


with(obj_fleet){if (owner=4) then instance_create(x,y,obj_temp6);}


if (inspec=1) and (faction_status[4]!="War") and (obj_ini.fleet_type=1) and (instance_number(obj_temp6)=0){// Find planet near homeworld to have an inquisitor ship pop from
    // If player does not own their homeworld than do a fleet inspection instead
    with(obj_star){if (owner=1) then instance_create(x,y,obj_temp3);}
    
    if (instance_number(obj_temp3)=1){
        var xy,yx,tar,flit;
        xy=obj_temp3.x;yx=obj_temp3.y;
        
        
        repeat(choose(2,3)){
            tar=instance_nearest(obj_temp3.x,obj_temp3.y,obj_star);
            instance_deactivate_object(tar);
        }
        
        repeat(5){
            tar=instance_nearest(obj_temp3.x,obj_temp3.y,obj_star);
            if (tar.owner=6) then instance_deactivate_object(tar);
        }
        
        tar=instance_nearest(obj_temp3.x,obj_temp3.y,obj_star);
        flit=instance_create(tar.x,tar.y-24,obj_en_fleet);
        flit.owner=4;
        flit.frigate_number=1;
        flit.action_x=xy;
        flit.action_y=yx;
        flit.sprite_index=spr_fleet_inquisition;
        flit.image_index=0;
        
        var roll;
        roll=floor(random(100))+1;
        
        if (roll&lt;=60) then flit.trade_goods="Inqis1";
        if (roll&lt;=70) and (roll&gt;60) then flit.trade_goods="Inqis2";
        if (roll&lt;=80) and (roll&gt;70) then flit.trade_goods="Inqis3";
        if (roll&lt;=90) and (roll&gt;80) then flit.trade_goods="Inqis4";
        if (roll&lt;=100) and (roll&gt;90) then flit.trade_goods="Inqis5";
        
        flit.alarm[4]=1;
        
        instance_activate_object(obj_star);
        with(obj_temp3){instance_destroy();}
        last_world_inspection=turn;
    }
}


if (inspec=1) and (faction_status[4]!="War") and (obj_ini.fleet_type!=1) and (instance_number(obj_temp6)=0){// Find planet near homeworld to have an inquisitor ship pop from
    // If player does not own their homeworld than do a fleet inspection instead
    
    with(obj_temp4){instance_destroy();}
    with(obj_temp5){instance_destroy();}
    
    if (instance_exists(obj_p_fleet)){
        with(obj_p_fleet){
            if (capital_number&gt;0) and (action=""){instance_create(x,y,obj_temp5);}
            if (capital_number&gt;0) and (action!=""){instance_create(action_x,action_y,obj_temp5);}
            if (frigate_number&gt;0) and (action="") then instance_create(x,y,obj_temp4);
            if (frigate_number&gt;0) and (action!="") then instance_create(action_x,action_y,obj_temp4);
        }
    
        var obj,x4,y4,from,target,flit;
        if (instance_exists(obj_p_ship)) then obj=instance_nearest(random(room_width),random(room_height),obj_p_ship);
        if (instance_exists(obj_temp4)) then obj=instance_nearest(random(room_width),random(room_height),obj_temp4);
        if (instance_exists(obj_temp5)) then obj=instance_nearest(random(room_width),random(room_height),obj_temp5);
        
        
        x4=obj.x;y4=obj.y;
        
        with(obj_star){if (owner=6) then instance_deactivate_object(id);}
        
        
        repeat(choose(2,3)){
            from=instance_nearest(x4,y4,obj_star);with(from){instance_deactivate_object(id);};
        }
        from=instance_nearest(x4,y4,obj_star);
        instance_activate_object(obj_star);
        
        
        
        flit=instance_create(from.x,from.y-24,obj_en_fleet);
        flit.owner=4;
        flit.frigate_number=1;
        
        flit.target=instance_nearest(x4,y4,obj_p_fleet);
        flit.action_x=instance_nearest(x4,y4,obj_star).x;
        flit.action_y=instance_nearest(x4,y4,obj_star).y;
        if (flit.target.action!="") then flit.action_eta=flit.target.action_eta;
        // show_message(string(flit.action_eta));
        
        flit.sprite_index=spr_fleet_inquisition;
        flit.image_index=0;
        
        var roll, messi;
        mess="Inquisitor ";
        roll=floor(random(100))+1;
        
        if (roll&lt;=60){flit.trade_goods="Inqis1";mess+=string(obj_controller.inquisitor[1]);}
        if (roll&lt;=70) and (roll&gt;60){flit.trade_goods="Inqis2";mess+=string(obj_controller.inquisitor[2]);}
        if (roll&lt;=80) and (roll&gt;70){flit.trade_goods="Inqis3";mess+=string(obj_controller.inquisitor[3]);}
        if (roll&lt;=90) and (roll&gt;80){flit.trade_goods="Inqis4";mess+=string(obj_controller.inquisitor[4]);}
        if (roll&lt;=100) and (roll&gt;90){flit.trade_goods="Inqis5";mess+=string(obj_controller.inquisitor[5]);}
        flit.trade_goods+="_fleet";
        
        obj=instance_nearest(x4,y4,obj_star);
        
        mess+=" wishes to inspect your fleet at "+string(obj.name);
        scr_alert("green","inspect",mess,obj.x,obj.y);
        if (instance_exists(obj_turn_end)) then obj_turn_end.alerts+=1;
        
        
        flit.alarm[4]=1;
        
        with(obj_temp4){instance_destroy();}
        with(obj_temp5){instance_destroy();}
        last_fleet_inspection=turn;
        
        
        // if (roll&lt;=60)
        
    }
}

with(obj_temp6){instance_destroy();}




i=0;
repeat(10){
    i+=1;
    if (turns_ignored[i]=0) and (annoyed[i]&gt;0) then annoyed[i]-=1;
}


i=0;
repeat(99){i+=1;
    if (event[i]!="") and (event_duration[i]&gt;0){
        event_duration[i]-=1;
        if (event_duration[i]=0){
        
            if (event[i]="game_over_man") then obj_controller.alarm[8]=1;
            
            if (string_count("remove_serf",event[i])&gt;0){
                var ta,tb,tc,pp;
                explode_script(event[i],"|");
                ta=string(explode[0]);tb=string(explode[1]);tc=real(explode[2]);
                obj_controller.temp[1007]=string(tb);
                with(obj_temp5){instance_destroy();}
                with(obj_star){if (name=obj_controller.temp[1007]) then instance_create(x,y,obj_temp5);}
                if (instance_exists(obj_temp5)){
                    pp=instance_nearest(obj_temp5.x,obj_temp5.y,obj_star);pp.dispo[tc]=-10;// Resets
                    var twix;twix=string(obj_img.faction[4])+" executes "+string(obj_img.player_army)+" Serf in control of "+string(tb)+" "+string(tc)+" and installs a new Planetary Governor.";
                    if (pp.p_owner[tc]=1) then pp.p_owner[tc]=pp.p_first[tc];
                    scr_alert("","",string(twix),0,0);scr_event_log("",string(twix));
                }
                with(obj_temp5){instance_destroy();}
            }
            
            if (event[i]="enemy_imperium"){scr_alert("green","enemy","You have made amends with your enemy in the "+string(obj_img.kingdom_title_shortest)+".",0,0);disposition[2]+=20;scr_event_log("","Amends made with Imperium.");}
            if (event[i]="enemy_mechanicus"){scr_alert("green","enemy","You have made amends with your "+string(obj_img.faction[3])+" enemy.",0,0);disposition[3]+=20;scr_event_log("","Amends made with Mechanicus enemy.");}
            if (event[i]="enemy_inquisition"){scr_alert("green","enemy","You have made amends with your enemy in the "+string(obj_img.faction[4])+".",0,0);disposition[4]+=20;scr_event_log("","Amends made with Inquisition enemy.");}
            if (event[i]="enemy_ecclesiarchy"){scr_alert("green","enemy","You have made amends with your enemy in the "+string(obj_img.faction[5])+".",0,0);disposition[5]+=20;scr_event_log("","Amends made with Ecclesiarchy enemy.");}
            
            if (event[i]="imperium_daemon"){scr_alert("red","lol",string(obj_img.faction_title[2])+" "+string(faction_leader[2])+" has gone insane.",0,0);faction_defeated[2]=1;scr_event_log("red","Sector Commander "+string(faction_leader[2])+" has gone insane.");}
            
            if (event[i]="chaos_invasion"){
                // check if homeworld type fleet here
                // if (
                    var xx,yy,flee,dirr;xx=0;yy=0;flee=0;dirr=0;
                    scr_random_find(1,true,"","");
                    
                    if (instance_exists(obj_temp5)){
                        var tee;tee=instance_nearest(obj_temp5.x,obj_temp5.y,obj_star);
                        scr_event_log("purple",string(obj_img.faction[11])+" Fleets exit the warp near the "+string(tee.name)+" system.");
                        repeat(4){
                            dirr+=floor(random_range(50,100))+1;
                            xx=obj_temp5.x+lengthdir_x(72,dirr);yy=obj_temp5.y+lengthdir_y(72,dirr);
                            flee=instance_create(xx,yy,obj_en_fleet);flee.owner=10;
                            flee.sprite_index=spr_fleet_chaos;flee.image_index=4;
                            flee.capital_number=choose(0,1);flee.frigate_number=choose(2,3);flee.escort_number=choose(4,5,6);
                            flee.trade_goods="csm";obj_controller.chaos_fleets+=1;
                            flee.action_x=obj_temp5.x;flee.action_y=obj_temp5.y;flee.alarm[4]=1;
                        }
                    }
                    with(obj_temp5){instance_destroy();}
                // }
            }
            
            if (string_count("new_",event[i])&gt;0){var fucking;fucking=event[i];
                // show_message(fucking);
                with(obj_temp5){instance_destroy();}
                with(obj_star){
                    if (owner=3){
                        if (p_type[1]="Forge") and (p_owner[1]=3) then instance_create(x,y,obj_temp5);
                        if (p_type[2]="Forge") and (p_owner[2]=3) then instance_create(x,y,obj_temp5);
                        if (p_type[3]="Forge") and (p_owner[3]=3) then instance_create(x,y,obj_temp5);
                        if (p_type[4]="Forge") and (p_owner[4]=3) then instance_create(x,y,obj_temp5);
                    }
                }
                if (instance_number(obj_temp5)&gt;0){
                    var that,that2,flit;
                    that=instance_nearest(random(room_width),random(room_height),obj_temp5);
                    that2=instance_nearest(that.x,that.y,obj_star);
                    
                    flit=instance_create(that2.x+24,that2.y-24,obj_p_fleet);
                    
                    var new_name,ship_names,i,last_ship;
                    
                    i=0;ship_names="";new_name="";last_ship=0;
                    repeat(40){
                        i+=1;if (obj_ini.ship[i]!="") then ship_names+=string(obj_ini.ship[i]);
                        if (last_ship=0) and (obj_ini.ship[i]="") then last_ship=i;
                    }
                    
                    i=0;repeat(50){
                        if (new_name=""){
                            new_name=scr_ship_name("imperial");
                            if (string_count(new_name,ship_names)&gt;0) then new_name="";
                        }
                    }
                    
                    obj_ini.ship[last_ship]=new_name;
                    obj_ini.ship_uid[last_ship]=floor(random(99999999))+1;
                    obj_ini.ship_owner[last_ship]=1;
                    obj_ini.ship_size[last_ship]=1;
                    obj_ini.ship_location[last_ship]=that2.name;
                    obj_ini.ship_leadership[last_ship]=100;
                    
                    // show_message(string(fucking));
                    
                    if (string_count(string(obj_img.ship[1,1]),fucking)&gt;0){
                        obj_ini.ship_class[last_ship]=string(obj_img.ship[1,1]);
                        obj_ini.ship_size[last_ship]=3;
                        // show_message("A");
                        obj_ini.ship_hp[last_ship]=1200;obj_ini.ship_maxhp[last_ship]=1200;
                        obj_ini.ship_conditions[last_ship]="";obj_ini.ship_speed[last_ship]=20;obj_ini.ship_turning[last_ship]=45;
                        obj_ini.ship_front_armor[last_ship]=6;obj_ini.ship_other_armor[last_ship]=6;obj_ini.ship_weapons[last_ship]=5;obj_ini.ship_shields[last_ship]=12;
                        obj_ini.ship_wep[last_ship,1]="Weapons Battery";ship_wep_facing[last_ship,1]="left";obj_ini.ship_wep_condition[last_ship,1]="";
                        obj_ini.ship_wep[last_ship,2]="Weapons Battery";ship_wep_facing[last_ship,2]="right";obj_ini.ship_wep_condition[last_ship,2]="";
                        obj_ini.ship_wep[last_ship,3]="Thunderhawk Launch Bays";obj_ini.ship_wep_facing[last_ship,3]="special";obj_ini.ship_wep_condition[last_ship,3]="";
                        obj_ini.ship_wep[last_ship,4]="Torpedo Tubes";obj_ini.ship_wep_facing[last_ship,4]="front";obj_ini.ship_wep_condition[last_ship,4]="";
                        obj_ini.ship_wep[last_ship,5]="Bombardment Cannons";obj_ini.ship_wep_facing[last_ship,5]="most";obj_ini.ship_wep_condition[last_ship,5]="";
                        obj_ini.ship_capacity[last_ship]=600;obj_ini.ship_carrying[last_ship]=0;obj_ini.ship_contents[last_ship]="";
                        obj_ini.ship_turrets[last_ship]=3;// obj_ini.ship_names+=string(obj_ini.ship[last_ship])+"|";
                        flit.capital[1]=obj_ini.ship[last_ship];flit.capital_number=1;flit.capital_num[1]=last_ship;flit.capital_uid[1]=obj_ini.ship_uid[last_ship];
                    }
                    if (string_count(string(obj_img.ship[1,2]),fucking)&gt;0){
                        obj_ini.ship_class[last_ship]=string(obj_img.ship[1,2]);
                        obj_ini.ship_size[last_ship]=2;
                        // show_message("B");
                        obj_ini.ship_hp[last_ship]=600;obj_ini.ship_maxhp[last_ship]=600;
                        obj_ini.ship_conditions[last_ship]="";obj_ini.ship_speed[last_ship]=25;obj_ini.ship_turning[last_ship]=90;
                        obj_ini.ship_front_armor[last_ship]=6;obj_ini.ship_other_armor[last_ship]=6;obj_ini.ship_weapons[last_ship]=4;obj_ini.ship_shields[last_ship]=6;
                        obj_ini.ship_wep[last_ship,1]="Weapons Battery";ship_wep_facing[last_ship,1]="left";obj_ini.ship_wep_condition[last_ship,1]="";
                        obj_ini.ship_wep[last_ship,2]="Weapons Battery";ship_wep_facing[last_ship,2]="right";obj_ini.ship_wep_condition[last_ship,2]="";
                        obj_ini.ship_wep[last_ship,3]="Thunderhawk Launch Bays";obj_ini.ship_wep_facing[last_ship,3]="special";obj_ini.ship_wep_condition[last_ship,3]="";
                        obj_ini.ship_wep[last_ship,4]="Bombardment Cannons";obj_ini.ship_wep_facing[last_ship,4]="most";obj_ini.ship_wep_condition[last_ship,4]="";
                        obj_ini.ship_capacity[last_ship]=250;obj_ini.ship_carrying[last_ship]=0;obj_ini.ship_contents[last_ship]="";
                        obj_ini.ship_turrets[last_ship]=1;// obj_ini.ship_names+=string(obj_ini.ship[last_ship])+"|";
                        flit.frigate[1]=obj_ini.ship[last_ship];flit.frigate_number=1;flit.frigate_num[1]=last_ship;flit.frigate_uid[1]=obj_ini.ship_uid[last_ship];
                    }
                    if (string_count(string(obj_img.ship[1,3]),fucking)&gt;0){
                        obj_ini.ship_class[last_ship]=string(obj_img.ship[1,3]);
                        // show_message("C");
                        obj_ini.ship_hp[last_ship]=200;obj_ini.ship_maxhp[last_ship]=200;
                        obj_ini.ship_conditions[last_ship]="";obj_ini.ship_speed[last_ship]=30;obj_ini.ship_turning[last_ship]=90;
                        obj_ini.ship_front_armor[last_ship]=5;obj_ini.ship_other_armor[last_ship]=5;obj_ini.ship_weapons[last_ship]=1;obj_ini.ship_shields[last_ship]=1;
                        obj_ini.ship_wep[last_ship,1]="Weapons Battery";ship_wep_facing[last_ship,1]="most";obj_ini.ship_wep_condition[last_ship,1]="";
                        obj_ini.ship_capacity[last_ship]=30;obj_ini.ship_carrying[last_ship]=0;obj_ini.ship_contents[last_ship]="";
                        obj_ini.ship_turrets[last_ship]=1;// obj_ini.ship_names+=string(obj_ini.ship[last_ship])+"|";
                        flit.escort[1]=obj_ini.ship[last_ship];flit.escort_number=1;flit.escort_num[1]=last_ship;flit.escort_uid[1]=obj_ini.ship_uid[last_ship];
                    }
                    if (string_count(string(obj_img.ship[1,4]),fucking)&gt;0){
                        obj_ini.ship_class[last_ship]=string(obj_img.ship[1,4]);
                        // show_message("D");
                        obj_ini.ship_hp[last_ship]=200;obj_ini.ship_maxhp[last_ship]=200;
                        obj_ini.ship_conditions[last_ship]="";obj_ini.ship_speed[last_ship]=30;obj_ini.ship_turning[last_ship]=90;
                        obj_ini.ship_front_armor[last_ship]=5;obj_ini.ship_other_armor[last_ship]=5;obj_ini.ship_weapons[last_ship]=2;obj_ini.ship_shields[last_ship]=1;
                        obj_ini.ship_wep[last_ship,1]="Torpedoes";ship_wep_facing[last_ship,1]="front";obj_ini.ship_wep_condition[last_ship,1]="";
                        obj_ini.ship_wep[last_ship,2]="Weapons Battery";ship_wep_facing[last_ship,2]="most";obj_ini.ship_wep_condition[last_ship,2]="";
                        obj_ini.ship_capacity[last_ship]=25;obj_ini.ship_carrying[last_ship]=0;obj_ini.ship_contents[last_ship]="";
                        obj_ini.ship_turrets[last_ship]=1;// obj_ini.ship_names+=string(obj_ini.ship[last_ship])+"|";
                        flit.escort[1]=obj_ini.ship[last_ship];flit.escort_number=1;flit.escort_num[1]=last_ship;flit.escort_uid[1]=obj_ini.ship_uid[last_ship];
                    }
                    
                    // show_message(string(obj_ini.ship_class[last_ship])+":"+string(obj_ini.ship[last_ship]));
                
                
                    if (instance_exists(that2)){
                        if (obj_ini.ship_size[last_ship]!=1) then scr_popup("Ship Constructed","Your new "+string(obj_ini.ship_class[last_ship])+" '"+string(obj_ini.ship[last_ship])+"' has finished being constructed.  It is orbiting "+string(that2.name)+" and awaits its maiden voyage.","shipyard","");
                        if (obj_ini.ship_size[last_ship]=1) then scr_popup("Ship Constructed","Your new "+string(obj_ini.ship_class[last_ship])+" Escort '"+string(obj_ini.ship[last_ship])+"' has finished being constructed.  It is orbiting "+string(that2.name)+" and awaits its maiden voyage.","shipyard","");
                        var bob;bob=instance_create(that2.x+16,that2.y-24,obj_star_event);bob.image_alpha=1;bob.image_speed=1; 
                    }
                }
                if (instance_number(obj_temp5)=0) then event_duration[i]=2;
                with(obj_temp5){instance_destroy();}
                event[i]="";event_duration[i]-=1;
            }
            
            
            if (string_count("inquisitor_spared",event[i])&gt;0){
                var diceh;diceh=floor(random(100))+1;
                
                if (string_count("Shit",obj_ini.strin2)&gt;0) then diceh-=25;
                
                if (diceh&lt;=25){alarm[8]=1;scr_loyalty("Crossing the Inquisition","+");}
                if (diceh&gt;25) and (diceh&lt;=50){scr_loyalty("Crossing the Inquisition","+");}
                if (diceh&gt;50) and (diceh&lt;=85){}
                if (diceh&gt;85) and (event[i]="inquisitor_spared2"){
                    scr_popup("Anonymous Message","You recieve an anonymous letter of thanks.  It mentions that motions are underway to destroy any local forces of "+string(obj_img.faction[11])+".","","");
                    with(obj_star){var o;o=0;repeat(4){o+=1;p_heresy[o]=max(0,p_heresy[o]-10);}}
                }
            
            }
            
            
            if (string_count("strange_building",event[i])&gt;0){
                var aa,bb,cc,dd,ee;
                aa="";bb="";cc=0;dd=0;ee="";
                explode_script(event[i],"|");
                aa=string(explode[0]);// event
                bb=string(explode[1]);// marine name
                cc=real(explode[2]);// company
                dd=real(explode[3]);// marine
                ee=string(explode[4]);// item
                
                var killy,tixt;killy=0;tixt=string(obj_ini.role[100,16])+" "+string(bb)+" has finished his work- ";
                
                if (ee="Icon"){tixt+="it is a "+string(global.chapter_name)+" Icon wrought in metal, finely decorated.  Pride for his "+string(obj_img.player_army)+" seems to have overtaken him.  There are no corrections to be made and the item is placed where many may view it.";}
                if (ee="Statue"){tixt+="it is a small, finely crafted statue wrought in metal.  The "+string(obj_ini.role[100,16])+" is scolded for the waste of material, but none daresay the quality of the piece.";}                
                if (ee="Bike"){scr_add_item("Bike",1);
                    tixt+="it is a finely crafted Bike, conforming mostly to STC standards.  The other "+string(obj_ini.role[100,16])+" are surprised at the rapid pace of his work.";
                }
                if (ee="Rhino"){scr_add_vehicle(obj_img.unit[1,18],0,"Storm "+string(obj_img.gyro),"Storm "+string(obj_img.gyro),"","Dozer Blades");
                    tixt+="it is a finely crafted "+string(obj_img.unit[1,18])+", conforming to STC standards.  The other "+string(obj_ini.role[100,16])+" are surprised at the rapid pace of his work.";
                }
                if (ee="Artifact"){
                    scr_event_log("",string(obj_ini.role[100,16])+" "+string(bb)+" constructs an Artifact.");
                    if (obj_ini.fleet_type=1) then scr_add_artifact("random_nodemon","",0,obj_ini.home_name,2);
                    if (obj_ini.fleet_type!=1) then scr_add_artifact("random_nodemon","",0,obj_ini.ship_location[1],501);
                    var k,last_artifact;k=0;last_artifact=0;
                    repeat(100){if (last_artifact=0){k+=1;if (obj_ini.artifact[k]="") then last_artifact=k-1;}}
                    tixt+="some form of divine inspiration has seemed to have taken hold of him.  An artifact "+string(obj_ini.artifact[k])+" has been crafted.";
                }
                if (ee="baby"){
                    obj_ini.chaos[cc,dd]+=choose(8,12,16,20);
                    tixt+="some form of horrendous statue.  A weird amalgram of limbs and tentacles, the sheer atrocity of it is made worse by the tiny, baby-like form, the once natural shape of a human child twisted nearly beyond recognition.";
                }
                if (ee="robot"){
                    obj_ini.chaos[cc,dd]+=choose(2,4,6,8,10);
                    tixt+="some form of small, box-like robot.  It seems to teeter around haphazardly, nearly falling over with each step.  "+string(bb)+" maintains that it has no AI, though the other "+string(obj_ini.role[100,16])+" express skepticism.";
                }
                if (ee="demon"){
                    obj_ini.chaos[cc,dd]+=choose(8,12,16,20);
                    tixt+="some form of horrendous statue.  What was meant to be some sort of angel, or primarch, instead has a mishappen face that is hardly human in nature.  Between the fetid, ragged feathers and empty sockets it is truly blasphemous.";
                }
                if (ee="fusion"){
                    // obj_ini.chaos[cc,dd]+=choose(70);
                    tixt+="some kind of ill-mannered ascension.  One of your battle-brothers enters the armamentarium to find "+string(bb)+" fused to a vehicle, his flesh twisted and submerged into the frame.  Mechendrites and weapons fire upon the marine without warning, a windy scream eminating from the abomination.  It takes several battle-brothers to take out what was once a "+string(obj_ini.role[100,16])+".";
                    
                    // This is causing the problem
                    
                    obj_ini.race[cc,dd]=0;obj_ini.loc[cc,dd]="";obj_ini.name[cc,dd]="";obj_ini.role[cc,dd]="";obj_ini.wep1[cc,dd]="";obj_ini.lid[cc,dd]=0;
                    obj_ini.wep2[cc,dd]="";obj_ini.armor[cc,dd]="";obj_ini.gear[cc,dd]="";obj_ini.hp[cc,dd]=100;obj_ini.chaos[cc,dd]=0;obj_ini.experience[cc,dd]=0;
                    obj_ini.mobi[cc,dd]="";obj_ini.age[cc,dd]=0;
                    with(obj_ini){scr_company_order(0);}
                }
                
                scr_popup("He Built It",tixt,"tech_build","target_marine|"+string(bb)+"|"+string(cc)+"|"+string(dd)+"|");
            }
            
            if (event_duration[i]&lt;=0) then event[i]="";
        }
    }
}
i=0;
repeat(99){i+=1;
    if (event[i]!="") and (event_duration[i]&lt;=0) then event[i]="";
    if (event[i]="") and (event_duration[i]=0) and (event[i+1]!=""){
        event[i]=event[i+1];
        event_duration[i]=event_duration[i+1];
        event[i+1]="";event_duration[i+1]=0;
    }
}


// Right here need to sort the battles within the obj_turn_end
with(obj_turn_end){scr_battle_sort();}

var i;i=0;
repeat(10){
    i+=1;
    if (turns_ignored[i]&gt;0) and (turns_ignored[i]&lt;500) then turns_ignored[i]-=1;
}
if (known[6]&gt;=2) and (faction_gender[6]=2) and (floor(turn/10)=(turn/10)) then turns_ignored[6]+=floor(random_range(0,6));

with(obj_temp4){instance_destroy();}
if (instance_exists(obj_p_fleet)) then with(obj_p_fleet){scr_apothecary_ship();}// asgsdgasdgasdgdsag
scr_random_event(true);

// Random events here

if (hurssy_time&gt;0) and (hurssy&gt;0) then hurssy_time-=1;
if (hurssy_time=0) and (hurssy&gt;0){hurssy_time=-1;hurssy=0;}
with(obj_p_fleet){
    if (hurssy_time&gt;0) and (hurssy&gt;0) then hurssy_time-=1;
    if (hurssy_time=0) and (hurssy&gt;0){hurssy_time=-1;hurssy=0;}
}
with(obj_star){
    if (p_hurssy_time[1]&gt;0) and (p_hurssy[1]&gt;0) then p_hurssy_time[1]-=1;if (p_hurssy_time[1]=0) and (p_hurssy[1]&gt;0){p_hurssy_time[1]=-1;p_hurssy[1]=0;}
    if (p_hurssy_time[2]&gt;0) and (p_hurssy[2]&gt;0) then p_hurssy_time[2]-=1;if (p_hurssy_time[2]=0) and (p_hurssy[2]&gt;0){p_hurssy_time[2]=-1;p_hurssy[2]=0;}
    if (p_hurssy_time[3]&gt;0) and (p_hurssy[3]&gt;0) then p_hurssy_time[3]-=1;if (p_hurssy_time[3]=0) and (p_hurssy[3]&gt;0){p_hurssy_time[3]=-1;p_hurssy[3]=0;}
    if (p_hurssy_time[4]&gt;0) and (p_hurssy[4]&gt;0) then p_hurssy_time[4]-=1;if (p_hurssy_time[4]=0) and (p_hurssy[4]&gt;0){p_hurssy_time[4]=-1;p_hurssy[4]=0;}
}

if (turn=2){
    if (obj_ini.master_name="Zakis Randi") or (global.chapter_name="Knights Inductor") and (obj_controller.faction_status[2]!="War") then alarm[8]=1;
}






// Player-set events
if (fest_scheduled&gt;0) and (fest_repeats&gt;0){
    var cm_present,lock;cm_present=false;
    fest_repeats-=1;lock="";lock=scr_master_loc();
    
    if (fest_sid&gt;0) and (obj_ini.ship[fest_sid]=lock) then cm_present=true;
    if (fest_wid&gt;0) and (string(fest_star)+"."+string(fest_wid)=lock) then cm_present=true;
    
    if (cm_present=true){
        var imag;imag="";
        
        if (fest_type="Great Feast") then imag="event_feast";
        if (fest_type="Tournament") then imag="event_tournament";
        if (fest_type="Deathmatch") then imag="event_deathmatch";
        if (fest_type="Imperial Mass") then imag="event_mass";
        if (fest_type="Cult Sermon") then imag="event_ccult";
        if (fest_type=string(obj_img.player_army)+" Relic") then imag="event_ccrelic";
        if (fest_type="Triumphal March") then imag="event_march";
        
        if (fest_wid&gt;0) then scr_popup("Scheduled Event","Your "+string(fest_type)+" takes place on "+string(fest_star)+" "+scr_roman(fest_wid)+".  Would you like to spectate the event?",imag,"");
        if (fest_sid&gt;0) then scr_popup("Scheduled Event","Your "+string(fest_type)+" takes place on the ship '"+string(obj_ini.ship[fest_sid])+".  Would you like to spectate the event?",imag,"");
    }
    
    // if (fest_repeats=0) then fest_scheduled=0;
}









// Income
if (income_controlled_planets&gt;0){
    with(obj_turn_end){
        var a;a=90;
        repeat(90){a-=1;
            if (alert[a]!=0){
                alert[a+1]=alert[a];
                alert_type[a+1]=alert_type[a];
                alert_text[a+1]=alert_text[a];
                alert_char[a+1]=alert_char[a];
                alert_txt[a+1]=alert_color[a];
            }
        }
    }
    obj_turn_end.alert[1]=1;
    obj_turn_end.alert_type[1]="";
    obj_turn_end.alert_char[1]=0;
    obj_turn_end.alert_txt[1]="";
    obj_turn_end.alert_color[1]="yellow";
    obj_turn_end.alerts+=1;
        
    if (income_controlled_planets=1) then obj_turn_end.alert_text[1]="-"+string(income_tribute)+" Requisition granted by tithes from 1 planet.";
    if (income_controlled_planets&gt;1) then obj_turn_end.alert_text[1]="-"+string(income_tribute)+" Requisition granted by tithes from "+string(income_controlled_planets)+" planets.";
}

instance_activate_object(obj_p_fleet);

with(obj_star){if (x&lt;-10000){x+=20000;y+=20000;}};


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>income_last</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>income</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (born_leader&gt;0){
    income_leader=round(income/10);
    income+=income_leader;
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Calc Moolah</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_income</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// initialize combat

menu=0;
instance_create(0,0,obj_ncombat);



exit;
instance_create(0,0,obj_fleet);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
instance_activate_object(obj_star);
instance_activate_object(obj_restart_vars);
instance_activate_all();

// Should determine here, randomly what sort of enemy planets there are
// One of the following:
// Lots of damn orks
// Lots of damn tyranids
// Some damn orks and a few genestealer cults

var field;
field=choose("orks","tyranids","both");
if (global.chapter_name="Lamenters") then field="both";
if (test_map=true) then field="orks";





good_log=1;



var xx,yy,px,py,ed,ok,did,roar,rando;
ok=0;did=0;roar="";ed=0;px=0;py=0;rando=0;



repeat(100){
    if (ok=0){
        xx=floor(random((room_width-128)))+64;
        yy=floor(random((room_width-92)))+64;

        ed=instance_nearest(xx,yy,obj_star);

        if (instance_exists(ed)){
            if (ed.star="orange1") or (ed.star="orange2"){
                if (ed.p_type[1]="Temperate"){did=1;ok=1;if (obj_ini.fleet_type=1){ed.p_owner[1]=1;ed.p_first[1]=1;ed.owner=1;}px=ed.x;py=ed.y;}
                if (ed.p_type[2]="Temperate") and (did=0){did=1;ok=1;if (obj_ini.fleet_type=1){ed.p_owner[2]=1;ed.p_first[2]=1;ed.owner=1;}px=ed.x;py=ed.y;}
                if (ed.p_type[3]="Temperate") and (did=0){did=1;ok=1;if (obj_ini.fleet_type=1){ed.p_owner[3]=1;ed.p_first[3]=1;ed.owner=1;}px=ed.x;py=ed.y;}
                if (ed.p_type[4]="Temperate") and (did=0){did=1;ok=1;if (obj_ini.fleet_type=1){ed.p_owner[4]=1;ed.p_first[4]=1;ed.owner=1;}px=ed.x;py=ed.y;}
            }

            if (ok=0) and (did=0) then instance_deactivate_object(ed);

        }
    
    }

}


instance_activate_object(obj_star);


if (did=1){// Player star has been set
    // Begin player homeworld

    ed.planets=2;ed.vision=1;if (obj_ini.fleet_type=1) then ed.owner=1;
    ed.p_type[3]="";ed.planet[3]=0;
    ed.p_type[4]="";ed.planet[4]=0;
    
    if (obj_ini.fleet_type=1){
        if (obj_ini.recruiting_type!=obj_ini.home_type) and (obj_ini.home_name!=obj_ini.recruiting_name){
            ed.p_type[1]=obj_ini.recruiting_type;if (obj_ini.recruiting_name!="random") then ed.name=obj_ini.recruiting_name;
            ed.p_type[2]=obj_ini.home_type;ed.planet[2]=1;if (obj_ini.home_name!="random") then ed.name=obj_ini.home_name;
            ed.p_feature[1]="Recruiting World|";
            ed.p_feature[2]=string(obj_img.hq_ground)+"|";ed.p_owner[2]=1;ed.p_first[2]=1;
            if (homeworld_rule!=1) then ed.dispo[2]=-5000;
            
            if (obj_ini.home_type="Shrine") then known[5]=1;
            if (obj_ini.recruiting_type="Shrine") then known[5]=1;
            
            ed.p_lasers[2]=8;ed.p_silo[2]=100;ed.p_defenses[2]=75;
            if (obj_ini.custom=0){ed.p_lasers[2]=32;ed.p_silo[2]=300;ed.p_defenses[2]=225;}
            
            if (ed.p_type[1]="random") then ed.p_type[1]=choose("Feral","Temperate","Desert","Ice");
            if (ed.p_type[2]="random") then ed.p_type[2]=choose("Feral","Temperate","Desert","Ice");
            // if (ed.name="random") then with(ed){scr_star_name();}
            if (global.chapter_name!="Lamenters") then obj_controller.recruiting_worlds+=string(ed.name)+" I|";
            
            ed.p_player[2]=obj_ini.man_size;
        }
        if (obj_ini.recruiting_type=obj_ini.home_type) or (obj_ini.home_name=obj_ini.recruiting_name){
            ed.p_type[1]="Dead";
            ed.p_type[2]=obj_ini.home_type;ed.planet[2]=1;if (obj_ini.home_name!="random") then ed.name=obj_ini.home_name;
            ed.p_feature[2]="Recruiting World|"+string(obj_img.hq_ground)+"|";ed.p_owner[2]=1;ed.p_first[2]=1;
            if (homeworld_rule!=1) then ed.dispo[2]=-5000;
            
            if (obj_ini.home_type="Shrine") then known[5]=1;
            if (obj_ini.recruiting_type="Shrine") then known[5]=1;
            
            ed.p_lasers[2]=8;ed.p_silo[2]=100;ed.p_defenses[2]=75;
            if (obj_ini.custom=0){ed.p_lasers[2]=32;ed.p_silo[2]=300;ed.p_defenses[2]=225;}
            
            if (ed.p_type[1]="random") then ed.p_type[1]=choose("Feral","Temperate","Desert","Ice");
            if (ed.p_type[2]="random") then ed.p_type[2]=choose("Feral","Temperate","Desert","Ice");
            // if (ed.name="random") then with(ed){scr_star_name();}
            if (global.chapter_name!="Lamenters") then obj_controller.recruiting_worlds+=string(ed.name)+" II|";
            
            ed.p_player[2]=obj_ini.man_size;
        }
    }
    if (obj_ini.fleet_type!=1){// Crusade and fleet based
        if (obj_ini.recruiting_type!=obj_ini.home_type) and (obj_ini.home_name!=obj_ini.recruiting_name){
            ed.p_type[1]=obj_ini.recruiting_type;if (obj_ini.recruiting_name!="random") then ed.name=obj_ini.recruiting_name;
            ed.p_type[2]=obj_ini.home_type;ed.planet[2]=1;if (obj_ini.home_name!="random") then ed.name=obj_ini.home_name;
            ed.p_feature[1]="Recruiting World|";
            if (ed.p_type[1]="random") then ed.p_type[1]=choose("Feral","Temperate","Desert","Ice");
            if (ed.p_type[2]="random") then ed.p_type[2]=choose("Feral","Temperate","Desert","Ice");
            // if (ed.name="random") then with(ed){scr_star_name();}
            if (global.chapter_name!="Lamenters") then obj_controller.recruiting_worlds+=string(ed.name)+" I|";
            
            // ed.p_player[2]=obj_ini.man_size;
        }
        if (obj_ini.recruiting_type=obj_ini.home_type) or (obj_ini.home_name=obj_ini.recruiting_name){
            ed.p_type[1]="Dead";
            ed.p_type[2]=obj_ini.home_type;ed.planet[2]=1;if (obj_ini.home_name!="random") then ed.name=obj_ini.home_name;
            ed.p_feature[2]="Recruiting";
            if (ed.p_type[1]="random") then ed.p_type[1]=choose("Feral","Temperate","Desert","Ice");
            if (ed.p_type[2]="random") then ed.p_type[2]=choose("Feral","Temperate","Desert","Ice");
            // if (ed.name="random") then with(ed){scr_star_name();}
            if (global.chapter_name!="Lamenters") then obj_controller.recruiting_worlds+=string(ed.name)+" II|";
            
            // ed.p_player[2]=obj_ini.man_size;
        }
    }
    with(ed){
        var f;f=0;
        repeat(4){f+=1;
            if (string_count("Recruiting",p_feature[f])&gt;0) and (string_count(string(obj_img.hq_ground),p_feature[f])=0){
                if (p_owner[f]=1) then p_owner[f]=2;
            }
            if (string_count(string(obj_img.hq_ground),p_feature[f])&gt;0){
                if (p_owner[f]!=1) then p_owner[f]=1;
                owner=1;
            }
        }
    }
    if (obj_ini.veh_loc[1,1]="random") or (obj_ini.veh_loc[1,1]="Random"){
        var coh,iy;coh=-1;iy=-1;
        repeat(11){coh+=1;iy=0;
            repeat(60){iy+=1;obj_ini.veh_loc[coh,iy]=ed.name;}
        }
        ed.p_player[2]+=obj_ini.man_size;
    }
    
    
    
    var fleet, f;
    fleet=instance_create(ed.x+24,ed.y-24,obj_p_fleet);
    fleet.owner=1;
    // ed.present_fleets=1;
    fleet.alarm[5]=5;
    
    f=0;
    repeat(40){f+=1;
        if (obj_ini.ship_size[f]=1){fleet.escort_number+=1;fleet.escort[fleet.escort_number]=obj_ini.ship[f];fleet.escort_num[fleet.escort_number]=f;fleet.escort_uid[fleet.escort_number]=obj_ini.ship_uid[fleet.escort_num[fleet.escort_number]];}
        if (obj_ini.ship_size[f]=2){fleet.frigate_number+=1;fleet.frigate[fleet.frigate_number]=obj_ini.ship[f];fleet.frigate_num[fleet.frigate_number]=f;fleet.frigate_uid[fleet.frigate_number]=obj_ini.ship_uid[fleet.frigate_num[fleet.frigate_number]];}
        if (obj_ini.ship_size[f]=3){
            fleet.capital_number+=1;
            fleet.capital[fleet.capital_number]=obj_ini.ship[f];
            fleet.capital_num[fleet.capital_number]=f;
            fleet.capital_uid[fleet.capital_number]=obj_ini.ship_uid[fleet.capital_num[fleet.capital_number]];
        }
    }
    
    var ii;ii=0;ii+=fleet.capital_number;ii+=round((fleet.frigate_number/2));ii+=round((fleet.escort_number/4));
    if (ii&lt;=1) then ii=1;fleet.image_index=ii;
    
    if (obj_ini.load_to_ships&gt;0){
        scr_start_load(fleet,ed,obj_ini.load_to_ships);
        with(obj_p_fleet){instance_create(x,y,obj_fleet_show);}
    }
    
    
    
    
    // End player homeworld
    instance_deactivate_object(ed);
    
    ed=instance_nearest(px,py,obj_star);ed.star="white2";
    ed.planet[1]=1;ed.planet[2]=1;ed.image_index=4;
    ed.p_type[1]="Forge";ed.p_type[2]="Ice";
    ed.p_owner[1]=3;ed.p_owner[2]=3;ed.p_owner[3]=3;ed.p_owner[4]=3;
    ed.p_first[1]=3;ed.p_first[2]=3;ed.p_first[3]=3;ed.p_first[4]=3;
    ed.owner=3;if (ed.planets&lt;2) then ed.planets=2;
    
    with(ed){// with ed
        var a,b,c,d,e,f,g,h;
a=99;b=99;c=99;d=99;e="";f=0;g="";h=0;

repeat(10){

    e=p_type[1];
    if (e="Lava") then a=1;if (e="Desert") then a=2;if (e="Hive") then a=3;
    if (e="Feral") then a=4;if (e="Agri") then a=5;if (e="Temperate") then a=6;
    if (e="Ice") then a=7;if (e="Dead") then a=1;if (e="Forge") then a=1.5;
    e=p_type[2];
    if (e="Lava") then b=1;if (e="Desert") then b=2;if (e="Hive") then b=3;
    if (e="Feral") then b=4;if (e="Agri") then b=5;if (e="Temperate") then b=6;
    if (e="Ice") then b=7;if (e="Dead") then b=2.5;if (e="Forge") then b=1.5;
    e=p_type[3];
    if (e="Lava") then c=1;if (e="Desert") then c=2;if (e="Hive") then c=3;
    if (e="Feral") then c=4;if (e="Agri") then c=5;if (e="Temperate") then c=6;
    if (e="Ice") then c=7;if (e="Dead") then c=3.5;if (e="Forge") then c=1.5;
    e=p_type[4];
    if (e="Lava") then d=1;if (e="Desert") then d=2;if (e="Hive") then d=3;
    if (e="Feral") then d=4;if (e="Agri") then d=5;if (e="Temperate") then d=6;
    if (e="Ice") then d=7;if (e="Dead") then d=4.5;if (e="Forge") then d=1.5;

    if (d&lt;c){
        f=c;e=p_type[3];
        c=d;p_type[3]=p_type[4];
        p_type[4]=e;d=f;
    }
    
    if (c&lt;b){
        f=b;e=p_type[2];
        b=c;p_type[2]=p_type[3];
        p_type[3]=e;c=f;
    }
    
    if (b&lt;a){
        f=a;e=p_type[1];
        a=b;p_type[1]=p_type[2];
        p_type[2]=e;b=f;
    }
    
    
    
    
}// end repeat

    if (p_type[1]!="Forge") and (p_type[1]!="Ice"){p_owner[1]=2;p_first[1]=2;}
    if (p_type[2]!="Forge") and (p_type[2]!="Ice"){p_owner[2]=2;p_first[2]=2;}
    if (p_type[3]!="Forge") and (p_type[3]!="Ice"){p_owner[3]=2;p_first[3]=2;}
    if (p_type[4]!="Forge") and (p_type[4]!="Ice"){p_owner[4]=2;p_first[4]=2;}

    }// end with ed
    
    
    
    // ed.explored=1;
    
    with(instance_nearest(xx,yy,obj_star)){}instance_deactivate_object(instance_nearest(xx,yy,obj_star));
    with(instance_nearest(xx,yy,obj_star)){}instance_deactivate_object(instance_nearest(xx,yy,obj_star));
    with(instance_nearest(xx,yy,obj_star)){}instance_deactivate_object(instance_nearest(xx,yy,obj_star));
    with(instance_nearest(xx,yy,obj_star)){}instance_deactivate_object(instance_nearest(xx,yy,obj_star));
    with(instance_nearest(xx,yy,obj_star)){}instance_deactivate_object(instance_nearest(xx,yy,obj_star));
    with(instance_nearest(xx,yy,obj_star)){}instance_deactivate_object(instance_nearest(xx,yy,obj_star));
    
    
    
    
    
    if (tau=1){
        ed=instance_furthest(px,py,obj_star);
        
        with(obj_star){if (planets=0) then instance_deactivate_object(id);}
        
        var stop;
        stop=0;
        
        repeat(100){
            if (stop!=5){
                if (ed.planets=1) and (ed.p_type[1]="Dead"){stop=1;with(ed){instance_deactivate_object(instance_id);}}
                if (ed.planets&gt;=1) or (ed.p_type[1]!="Dead") then stop=0;
                if (stop=0) then stop=5;
            }
        }
        
        ed.planet[1]=1;ed.p_owner[1]=8;ed.p_type[1]="Desert";xx=ed.x;yy=ed.y;ed.tau[1]=choose(3,4);ed.p_influence[1]=70;
        instance_deactivate_object(ed);
        
        rando=choose(0,1,1);
        if (rando=1){
            ed=instance_nearest(xx,yy,obj_star);
            if (ed.planets&gt;0) and (ed.p_type[1]!="Dead") and (ed.owner=2){ed.p_owner[1]=8;ed.owner=8;ed.tau[1]=choose(2,3,4);ed.p_influence[1]=70;}
            instance_deactivate_object(ed);
        }
        
        rando=choose(0,1,1);
        if (rando=1){
            ed=instance_nearest(xx,yy,obj_star);
            if (ed.planets&gt;0) and (ed.p_type[1]!="Dead") and (ed.owner=2){ed.p_owner[1]=8;ed.owner=8;ed.tau[1]=choose(2,3,4);ed.p_influence[1]=70;}
            instance_deactivate_object(ed);
        }
        
        rando=choose(0,1,1);
        if (rando=1){
            ed=instance_nearest(xx,yy,obj_star);
            if (ed.planets&gt;0) and (ed.p_type[1]!="Dead") and (ed.owner=2){ed.p_owner[1]=8;ed.owner=8;ed.tau[1]=choose(2,3,4);ed.p_influence[1]=70;}
            instance_deactivate_object(ed);
        }
        
        rando=choose(0,1);
        if (rando=1){
            ed=instance_nearest(xx,yy,obj_star);
            if (ed.planets&gt;0) and (ed.p_type[1]!="Dead") and (ed.owner=2){ed.p_owner[1]=8;ed.owner=8;ed.tau[1]=choose(2,3,4);ed.p_influence[1]=70;}
            instance_deactivate_object(ed);
        }
        
        instance_activate_object(obj_star);
    }
    
    
    // Chaos
    /*
    xx=floor(random(1152))+64;yy=floor(random(748))+64;
    ed=instance_nearest(xx,yy,obj_star);if (ed.planets&gt;0) and (ed.owner=2){ed.planet[1]=1;ed.p_owner[1]=10;ed.owner=10;instance_deactivate_object(ed);}
    xx=floor(random(1152))+64;yy=floor(random(748))+64;
    ed=instance_nearest(xx,yy,obj_star);if (ed.planets&gt;0) and (ed.owner=2){ed.planet[1]=1;ed.p_owner[1]=10;ed.owner=10;instance_deactivate_object(ed);}
    // More sneaky this way; you have to be noted of rising heresy or something, or have a ship in the system
    */
    with(obj_star){
        if (name="Kim Jong") and (owner=2){
            rando=choose(0,0,1,1);
            if (rando=1){
                p_owner[1]=10;p_owner[2]=10;p_owner[3]=10;p_owner[4]=10;owner=10;
                p_heresy[1]=floor(random_range(80,100));p_heresy[2]=floor(random_range(80,100));
                p_heresy[3]=floor(random_range(80,100));p_heresy[4]=floor(random_range(80,100));
                if (p_type[1]!="Dead") then p_traitors[1]=6;if (p_type[2]!="Dead") then p_traitors[2]=6;
                if (p_type[3]!="Dead") then p_traitors[3]=6;if (p_type[4]!="Dead") then p_traitors[4]=6;
            }
        }
    }
    
    // Ork planets here
    with(obj_star){
        if (planets&gt;0) and (owner=2) and (p_type[1]!="Dead"){
            instance_create(x,y,obj_temp3);
        }
    }
    
    var orkz,ed2,n,i;
    orkz=choose(4,5,6)+3;
    if (field="orks") then orkz+=4;
    if (field="both") then orkz+=2;
    if (obj_ini.fleet_type=3) then orkz+=3;
    if (test_map=true) then orkz=4;
    
    repeat(orkz){
        n=instance_number(obj_temp3);
        i=floor(random(n));
        ed=instance_find(obj_temp3, i);
        ed2=instance_nearest(ed.x,ed.y,obj_star);
        
        ed2.planet[1]=1;ed2.p_owner[1]=7;ed2.p_owner[2]=7;ed2.p_owner[3]=7;ed2.p_owner[4]=7;ed2.owner=7;
        with(ed){instance_destroy();}
    }
    with(obj_temp3){instance_destroy();}
    
    
    with(obj_star){
        if (planets&gt;0) and (owner=2) and (p_type[1]!="Dead"){
            instance_create(x,y,obj_temp3);
        }
    }
    if (field="tyranids"){
        orkz=floor(choose(3,4,5,6)*2)+1;
        if (obj_ini.fleet_type=3) then orkz+=2;
        
        repeat(orkz){
            n=instance_number(obj_temp3);
            i=floor(random(n));
            ed=instance_find(obj_temp3, i);
            ed2=instance_nearest(ed.x,ed.y,obj_star);
            
            ed2.planet[1]=1;ed2.p_owner[1]=9;ed2.owner=9;
            with(ed){instance_destroy();}
        }
    }
    with(obj_temp3){instance_destroy();}
    
    with(obj_star){
        if (planets&gt;0) and (owner&lt;=5) and (p_type[1]!="Dead"){
            instance_create(x,y,obj_temp3);
        }
    }
    if (field="both"){
    if (obj_ini.fleet_type=3) then orkz+=3;
    orkz+=3;
        repeat(orkz){
            n=instance_number(obj_temp3);
            i=floor(random(n));
            ed=instance_find(obj_temp3, i);
            ed2=instance_nearest(ed.x,ed.y,obj_star);
            
            ed2.planet[1]=1;ed2.p_owner[1]=90;ed2.owner=90;
            with(ed){instance_destroy();}
        }
    
    }
    with(obj_temp3){instance_destroy();}
    
    
    
    
    
    
    
    // Another mechanicus
    xx=floor(random(1152+640))+64;yy=floor(random(748+480))+64;
    ed=instance_nearest(xx,yy,obj_star);if (ed.planets&gt;0) and (ed.owner=2){ed.planet[1]=1;ed.p_type[1]="Forge";ed.p_owner[1]=3;ed.p_first[1]=3;ed.owner=3;instance_deactivate_object(ed);}
    
    xx=floor(random(1152+640))+64;yy=floor(random(748+480))+64;
    ed=instance_nearest(xx,yy,obj_star);if (ed.planets&gt;0) and (ed.owner=2){ed.planet[1]=1;ed.p_type[1]="Forge";ed.p_owner[1]=3;ed.p_first[1]=3;ed.owner=3;instance_deactivate_object(ed);}
    

}



x=px;y=py;

instance_activate_object(obj_star);


if (did=0) then alarm[1]=5;
if (did!=0) then obj_star.alarm[1]=1;






// Eldar craftworld here

var go, xx, yy;
go=0;xx=0;yy=0;

craftworld=1;


repeat(100){
    if (go=0){
        xx=floor(random(1152+600))+104;
        yy=floor(random(748+440))+104;
        if (point_distance(room_width/2,room_height/2,xx,yy)&gt;=50) then go=1;
        me=instance_nearest(xx,yy,obj_star);
        if (go=1) and (point_distance(me.x,me.y,xx,yy)&gt;=150) then go=2;
        if (go=1) then go=0;
        if (xx&gt;=1050+640) or (yy&lt;=300+480) then go=0;
    }
    
    if (go=2){
        var craft;
        craft=instance_create(xx,yy,obj_star);
        craft.craftworld=1;go=999;
        craft.p_feature[1]="WL6|";
        
        var elforce;
        elforce=instance_create(xx-24,yy-24,obj_en_fleet);
        elforce.sprite_index=spr_fleet_eldar;elforce.owner=6;
        elforce.capital_number=choose(2,3);
        elforce.frigate_number=choose(4,5,6);
        elforce.escort_number=floor(random_range(7,11))+1;
        elforce.image_alpha=0;
        elforce.orbiting=craft;
    }
    
    
}




// End craftworld

// instance_activate_object(obj_restart_vars);
// if (global.load=0) then 
scr_restart_variables(2);
// with(obj_restart_vars){instance_destroy();}


if (!instance_exists(obj_saveload)) and (instance_exists(obj_creation)) and (global.load=0){
    
    var i;i=0;
    repeat(10){i+=1;
        if (obj_creation.world[i]!=""){
            with(obj_star){
                var run;run=0;
                repeat(4){run+=1;
                    if (p_type[run]=obj_creation.world_type[i]) then instance_create(x,y,obj_temp3);
                }
            
            }
            
            var him;him=instance_nearest(random(room_width),random(room_height),obj_temp3);
            
            if (instance_exists(him)){
                var him2;him2=instance_nearest(him.x,him.y,obj_star);
                with(obj_temp3){instance_destroy();}
                
                var run;run=0;
                
                repeat(4){run+=1;
                    if (him2.p_type[run]=obj_creation.world_type[i]){
                        him2.name=obj_creation.world[i];
                        if (obj_creation.world_feature[i]!="") then him2.p_feature[run]=obj_creation.world_feature[i];
                        obj_creation.world[i]="";obj_creation.world_type[i]="";obj_creation.world_feature[i]="";
                    }
                    
                }
                
                instance_deactivate_object(him2);
            
            }
        
        
        
        /*world[i]="";
        world_type[i]="";
        world_feature[i]="";*/
        }
    
    }



}


instance_activate_all();
with(obj_creation){instance_destroy();}


/* //135 testing crusade object
instance_create(x,y,obj_crusade);
obj_crusade.placing=1;scr_zoom();*/



// 135 ; testing artifacts with combat
// argument0 : type
// argument1 : tags
// argument2 : identified
// argument3: location
// argument4: sid

// scr_add_artifact("Weapon","",4,obj_ini.home_name,1);

repeat(10){scr_add_artifact("random","",0,obj_ini.ship[1],501);}

scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);
scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);
scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);
scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);
scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);
scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);
scr_add_artifact("good","daemonic",0,obj_ini.ship[1],501);


// scr_add_item("Cyclonic Torpedo",5);
// scr_add_item("Exterminatus",5);
    
if (test_map=true){
    // scr_add_item("Exterminatus",5);
    /*scr_add_artifact("good","",0,obj_ini.ship[1],501);
    scr_add_artifact("good","",0,obj_ini.ship[1],501);
    scr_add_artifact("good","",0,obj_ini.ship[1],501);
    scr_add_artifact("good","",0,obj_ini.ship[1],501);
    scr_add_artifact("good","",0,obj_ini.ship[1],501);
    scr_add_artifact("good","",0,obj_ini.ship[1],501);
    scr_add_artifact("good","",0,obj_ini.ship[1],501);*/
}

with(obj_temp7){instance_destroy();}
with(obj_en_fleet){
    if (owner=8) and (instance_nearest(x,y,obj_star).owner=8) then instance_create(x,y,obj_temp7);
}
if (instance_exists(obj_temp7)){var t1;
    t1=instance_nearest(room_width/2,room_height/2,obj_temp7);
    terra_direction=point_direction(obj_temp7.x,obj_temp7.y,room_width/2,room_height/2);
}

/*with(obj_star){
    scr_star_ownership(false);
}*/


// x=0;y=0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
instance_activate_object(obj_star);
if (instance_exists(obj_ini)) and (global.load=0){alarm[1]=2;
    instance_activate_object(obj_star);
    instance_activate_object(obj_restart_vars);
    instance_activate_all();
}
instance_activate_object(obj_restart_vars);


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (double_click&gt;=0) then double_click-=1;
if (text_bar&gt;0){text_bar+=1;
    if (menu=1) and (managing&gt;0) then obj_ini.company_title[managing]=keyboard_string;
    if (menu=24) and (formating&gt;0) and (formating&gt;3) then bat_formation[formating]=keyboard_string;
}
if (text_bar&gt;60) then text_bar=1;
if (bar_fix&gt;0){bar_fix=-1;scr_ui_formation_bars();}


if (fest_scheduled=0) and (fest_sid+fest_wid&gt;0) and (menu!=12.1){
    fest_sid=0;fest_wid=0;fest_planet=0;
    fest_type="";fest_cost=0;
    fest_lav=0;fest_locals=0;
    fest_feature1=0;fest_feature2=0;fest_feature3=0;
    fest_display=0;fest_repeats=0;
    fest_honor_co=0;fest_honor_id=0;
    fest_attend="";
}


if (menu!=24) and (formating&gt;0) then formating=0;

if (instance_exists(obj_formation_bar)) and ((menu!=24) or (formating&lt;=0)){
    with(obj_formation_bar){instance_destroy();}
    with(obj_temp8){instance_destroy();}formating=0;
}




if (sound_in&gt;=0) then sound_in-=1;
if (sound_in=0) and (sound_to!=""){audio_stop_all();
    if (sound_to="blood"){
        global.sound_playing=audio_play_sound(snd_blood,0,true);
        audio_sound_gain(global.sound_playing, 0, 0);
        var nope;nope=0;if (obj_controller.master_volume=0) or (obj_controller.music_volume=0) then nope=1;
        if (nope!=1){audio_sound_gain(global.sound_playing,0.2*obj_controller.master_volume*obj_controller.music_volume,2000);}
    }
    if (sound_to="royal"){
        global.sound_playing=audio_play_sound(snd_royal,0,true);
        audio_sound_gain(global.sound_playing, 0, 0);
        var nope;nope=0;if (obj_controller.master_volume=0) or (obj_controller.music_volume=0) then nope=1;
        if (nope!=1){audio_sound_gain(global.sound_playing,0.25*obj_controller.master_volume*obj_controller.music_volume,2000);}
    }
}



/*if (x&lt;800) then x=800;
if (y&lt;450) then y=450;
if (x&gt;(room_width-800)) then x=room_width-800;
if (y&gt;(room_height-450)) then y=room_height-450;*/

if (real(cheatcode)=65445){global.cheat_req=true;cheatyface=1;obj_controller.requisition=51234;}
if (real(cheatcode)=94864){global.cheat_gene=true;cheatyface=1;obj_controller.gene_seed=9999;}
if (real(cheatcode)=86476){global.cheat_disp=true;cheatyface=1;
    obj_controller.disposition[2]=100;
    obj_controller.disposition[3]=100;
    obj_controller.disposition[4]=100;
    obj_controller.disposition[5]=100;
    obj_controller.disposition[6]=100;
    obj_controller.disposition[7]=100;
    obj_controller.disposition[8]=100;
    obj_controller.disposition[9]=100;
    obj_controller.disposition[10]=100;
}
if (real(cheatcode)=49844){global.cheat_debug=true;cheatyface=1;}
if (real(cheatcode)=99991){cheatyface=1;diplomacy=10.5;scr_dialogue("test");}
if (global.cheat_req=true) and (obj_controller.requisition!=51234) then obj_controller.requisition=51234;
cheatcode="";

if (menu!=17.5) and (instance_exists(obj_event_log)){
    obj_event_log.help=0;
}



if (!instance_exists(obj_event_log)) and (instance_exists(obj_controller)){
    instance_activate_object(obj_event_log);
}

if (!instance_exists(obj_ingame_menu)){
    play_second+=1;if (play_second&gt;=30){
        play_second=0;play_time+=1;
        
        window_old=window_data;
        window_data=string(window_get_x())+"|"+string(window_get_y())+"|"+string(window_get_width())+"|"+string(window_get_height())+"|";
        if (window_get_fullscreen()=1){window_old="fullscreen";window_data="fullscreen";}
        
        if (window_data!="fullscreen") and (window_get_fullscreen()=0){
            if (window_data!=window_old){
                ini_open("saves.ini");
                ini_write_string("Settings","window_data",string(window_get_x())+"|"+string(window_get_y())+"|"+string(window_get_width())+"|"+string(window_get_height())+"|");
                ini_close();
            }
        }
        
    }
}



if (menu!=60) and (instance_exists(obj_temp_build)){// Nope
    if (obj_temp_build.new=1) then menu=60;
    with(obj_shop){instance_destroy();}
    with(obj_managment_panel){instance_destroy();}
    with(obj_drop_select){instance_destroy();}
    with(obj_star_select){instance_destroy();}
    with(obj_fleet_select){instance_destroy();}
}

if (menu=0) and (instance_exists(obj_temp_build)){// Return to star selection
    // obj_controller.selected=obj_temp_build.target;
    // obj_controller.sel_owner=obj_temp_build.target.owner;
    obj_controller.selecting_planet=obj_temp_build.planet;
    // Pass variables to obj_controller.temp[t]=""; here
    instance_create(obj_temp_build.x,obj_temp_build.y,obj_star_select);
    // obj_star_select.owner=obj_controller.sel_owner;
    // obj_star_select.target=obj_controller.selected;
    obj_star_select.loading_name=obj_controller.selected.name;
    popup=3;
    with(obj_temp_build){instance_destroy();}
}
if (menu!=60) and (instance_exists(obj_temp_build)){// REMOVE
    with(obj_temp_build){instance_destroy();}
}



if (text_selected!="") and (text_selected!="none") then text_bar+=1;
if (text_bar&gt;60) then text_bar=1;


if (obj_controller.disposition[4]&lt;=20) or (obj_controller.loyalty&lt;=33) and (demanding=0) then demanding=1;
if (obj_controller.disposition[4]&gt;20) and (obj_controller.loyalty&gt;33) and (demanding=1) then demanding=0;




if ((menu=0) and (formating=0)) or (instance_exists(obj_fleet)){
    var spd, keyb;spd=12;keyb="";
    if ((!instance_exists(obj_ingame_menu)) and (!instance_exists(obj_ncombat))) or (instance_exists(obj_fleet)){
        if ((keyboard_check(vk_left)) or (mouse_x&lt;=view_xview[0]+2) or (keyboard_check(ord("A")))) and (x&gt;800) then x-=spd;
        if ((keyboard_check(vk_right)) or (mouse_x&gt;=view_xview[0]+1598) or (keyboard_check(ord("D")))) and (x&lt;(room_width-800)) then x+=spd;
        if ((keyboard_check(vk_up)) or (mouse_y&lt;=view_yview[0]+2) or (keyboard_check(ord("W")))) and (y&gt;450) then y-=spd;
        if ((keyboard_check(vk_down)) or (mouse_y&gt;=view_yview[0]+898) or (keyboard_check(ord("S")))) and (y&lt;(room_height-450)) then y+=spd;
    }
}

if (x&lt;800) then x=800;
if (y&lt;450) then y=450;
if (x&gt;(room_width-800)) then x=room_width-800;
if (y&gt;(room_height-450)) then y=room_height-450;



if (test_map=true) then with(obj_en_fleet){
    if (owner=2){
        /*owner=10;
        sprite_index=spr_fleet_chaos;
        orbiting=0;*/
        capital_number=0;
        frigate_number=1;
        escort_number=2;
    }
}









var freq;freq=150;

if (l_options&gt;0) then l_options+=1;if (l_options&gt;105) then l_options=0;if (l_options=0) and (floor(random(freq))=3) then l_options=1;
if (l_menu&gt;0) then l_menu+=1;if (l_menu&gt;105) then l_menu=0;if (l_menu=0) and (floor(random(freq))=3) then l_menu=1;

if (l_manage&gt;0) then l_manage+=1;if (l_manage&gt;141) then l_manage=0;if (l_manage=0) and (floor(random(freq))=3) then l_manage=1;
if (l_settings&gt;0) then l_settings+=1;if (l_settings&gt;141) then l_settings=0;if (l_settings=0) and (floor(random(freq))=3) then l_settings=1;

if (l_apothecarium&gt;0) then l_apothecarium+=1;if (l_apothecarium&gt;113) then l_apothecarium=0;if (l_apothecarium=0) and (floor(random(freq))=3) then l_apothecarium=1;
if (l_reclusium&gt;0) then l_reclusium+=1;if (l_reclusium&gt;113) then l_reclusium=0;if (l_reclusium=0) and (floor(random(freq))=3) then l_reclusium=1;
if (l_librarium&gt;0) then l_librarium+=1;if (l_librarium&gt;113) then l_librarium=0;if (l_librarium=0) and (floor(random(freq))=3) then l_librarium=1;
if (l_armory&gt;0) then l_armory+=1;if (l_armory&gt;113) then l_armory=0;if (l_armory=0) and (floor(random(freq))=3) then l_armory=1;
if (l_recruitment&gt;0) then l_recruitment+=1;if (l_recruitment&gt;113) then l_recruitment=0;if (l_recruitment=0) and (floor(random(freq))=3) then l_recruitment=1;
if (l_fleet&gt;0) then l_fleet+=1;if (l_fleet&gt;113) then l_fleet=0;if (l_fleet=0) and (floor(random(freq))=3) then l_fleet=1;

if (l_diplomacy&gt;0) then l_diplomacy+=1;if (l_diplomacy&gt;141) then l_diplomacy=0;if (l_diplomacy=0) and (floor(random(freq))=3) then l_diplomacy=1;
if (l_log&gt;0) then l_log+=1;if (l_log&gt;141) then l_log=0;if (l_log=0) and (floor(random(freq))=3) then l_log=1;
if (l_turn&gt;0) then l_turn+=1;if (l_turn&gt;141) then l_turn=0;if (l_turn=0) and (floor(random(freq))=3) then l_turn=1;

if (new_buttons_hide=1) and (y_slide&lt;43){if (y_slide&lt;43) then y_slide+=2;if (new_buttons_frame&lt;24) then new_buttons_frame+=1;}
if (new_buttons_hide=0) and (y_slide&gt;0){if (y_slide&gt;0) then y_slide-=2;if (new_buttons_frame&gt;0) then new_buttons_frame-=1;}
if (new_buttons_hide=1) and (y_slide&lt;43){if (y_slide&lt;43) then y_slide+=2;if (new_buttons_frame&lt;24) then new_buttons_frame+=1;}
if (new_buttons_hide=0) and (y_slide&gt;0){if (y_slide&gt;0) then y_slide-=2;if (new_buttons_frame&gt;0) then new_buttons_frame-=1;}

if ((new_buttons_hide+hide_banner&gt;0)) and (new_banner_x&lt;161) then new_banner_x+=(161/11);
if ((new_buttons_hide+hide_banner=0)) and (new_banner_x&gt;0) then new_banner_x-=(161/11);

if (y_slide&lt;0) then y_slide=0;
if (new_banner_x&lt;0) then new_banner_x=0;
if (y_slide&gt;0) then new_button_highlight="";

var high;high="";
if (new_buttons_hide=0) and (y_slide&lt;=0) and (!instance_exists(obj_ingame_menu)){
    var bx,by,wid,hei,but,stop;
    wid=0;hei=0;but=0;bx=0;by=0;stop=0;
    
    but=4;bx=1374;by=8;wid=108;hei=42;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+hei-dif2) then stop=1;
            }
            if (stop=0) then high="options";
        }
    }
    but=4;bx=1484;by=8;wid=108;hei=42;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+hei-dif2) then stop=1;
            }
            if (stop=0) then high="menu";
        }
    }
    
    
    but=1;bx=34;by=838;wid=142;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+134){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+134);dif2=dif1*1.25;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="manage";
        }
    }
    but=1;bx=179;by=838;wid=142;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+134){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+134);dif2=dif1*1.25;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="settings";
        }
    }
    
    but=1;bx=1130;by=838;wid=142;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+134){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+134);dif2=dif1*1.25;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="diplomacy";
        }
    }
    but=1;bx=1275;by=838;wid=142;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+134){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+134);dif2=dif1*1.25;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="log";
        }
    }
    but=2;bx=1420;by=838;wid=142;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+134){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+134);dif2=dif1*1.25;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="turn";
        }
    }
    
    
    but=3;bx=357;by=838;wid=115;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="apoth";
        }
    }
    but=3;bx=473;by=838;wid=115;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="reclusium";
        }
    }
    but=3;bx=590;by=838;wid=115;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="librarium";
        }
    }
    but=3;bx=706;by=838;wid=115;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="armory";
        }
    }
    but=3;bx=822;by=838;wid=115;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="recruitment";
        }
    }
    but=3;bx=938;by=838;wid=115;hei=43;
    if (mouse_y&gt;=view_yview[0]+by) and (mouse_y&lt;=view_yview[0]+by+hei){
        if (mouse_x&gt;=view_xview[0]+bx) and (mouse_x&lt;=view_xview[0]+bx+wid){
            if (mouse_x&gt;=view_xview[0]+bx+108){
                var dif1,dif2;dif1=mouse_x-(view_xview[0]+bx+108);dif2=dif1*2;
                if (mouse_y&lt;view_yview[0]+by+dif2) then stop=1;
            }
            if (stop=0) then high="fleet";
        }
    }
    
    new_button_highlight=high;
}

if (high="options") and (h_options&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_options+=0.02;
if ((high!="options") or (new_buttons_hide=1)) and (h_options&gt;0) then h_options-=0.04;

if (high="menu") and (h_menu&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_menu+=0.02;
if ((high!="menu") or (new_buttons_hide=1)) and (h_menu&gt;0) then h_menu-=0.04;



if (high="manage") and (h_manage&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_manage+=0.02;
if ((high!="manage") or (new_buttons_hide=1)) and (h_manage&gt;0) then h_manage-=0.04;

if (high="settings") and (h_settings&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_settings+=0.02;
if ((high!="settings") or (new_buttons_hide=1)) and (h_settings&gt;0) then h_settings-=0.04;

if (high="diplomacy") and (h_diplomacy&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_diplomacy+=0.02;
if ((high!="diplomacy") or (new_buttons_hide=1)) and (h_diplomacy&gt;0) then h_diplomacy-=0.04;

if (high="log") and (h_log&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_log+=0.02;
if ((high!="log") or (new_buttons_hide=1)) and (h_log&gt;0) then h_log-=0.04;

if (high="turn") and (h_turn&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_turn+=0.02;
if ((high!="turn") or (new_buttons_hide=1)) and (h_turn&gt;0) then h_turn-=0.04;




if (high="apoth") and (h_apothecarium&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_apothecarium+=0.02;
if ((high!="apoth") or (new_buttons_hide=1)) and (h_apothecarium&gt;0) then h_apothecarium-=0.04;

if (high="reclusium") and (h_reclusium&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_reclusium+=0.02;
if ((high!="reclusium") or (new_buttons_hide=1)) and (h_reclusium&gt;0) then h_reclusium-=0.04;

if (high="librarium") and (h_librarium&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_librarium+=0.02;
if ((high!="librarium") or (new_buttons_hide=1)) and (h_librarium&gt;0) then h_librarium-=0.04;

if (high="armory") and (h_armory&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_armory+=0.02;
if ((high!="armory") or (new_buttons_hide=1)) and (h_armory&gt;0) then h_armory-=0.04;

if (high="recruitment") and (h_recruitment&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_recruitment+=0.02;
if ((high!="recruitment") or (new_buttons_hide=1)) and (h_recruitment&gt;0) then h_recruitment-=0.04;

if (high="fleet") and (h_fleet&lt;0.5) and (new_buttons_hide=0) and (y_slide&lt;=0) then h_fleet+=0.02;
if ((high!="fleet") or (new_buttons_hide=1)) and (h_fleet&gt;0) then h_fleet-=0.04;



if (menu=14) and (!instance_exists(obj_shop)) then instance_create(0,0,obj_shop);
if (menu!=14) and (instance_exists(obj_shop)) then with(obj_shop){instance_destroy();}



if (instance_exists(obj_ingame_menu)) or (instance_exists(obj_saveload)) then exit;




if (menu=1) and (managing&gt;0){
    var xx, yy, bb;bb="";
    xx=view_xview[0]+0;
    yy=view_yview[0]+0;


    var c,fx;c=0;fx="";
    if (managing&lt;=10) then c=managing;
    if (managing&gt;20) then c=managing-10;
    

    var top,sel,temp1,temp2,temp3,temp4,temp5,force_tool;
    temp1="";temp2="";temp3="";temp4="";temp5="";force_tool=0;
    
    top=man_current;
    sel=top;
    
    
    yy+=77;
    
    repeat(min(man_max,man_see)){
        force_tool=0;
        
        if (temp[101]=string(ma_role[sel])+" "+string(ma_name[sel])) 
        and ((temp[102]!=ma_armor[sel]) or (temp[104]!=ma_gear[sel]) or (temp[106]=ma_mobi[sel]) or (temp[108]!=ma_wep1[sel]) or (temp[110]!=ma_wep1[sel])
        or (temp[114]="refresh")) then force_tool=1;
        
        
        if (mouse_x&gt;=xx+25) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+974) and (mouse_y&lt;yy+85)
        or (force_tool=1)
        /*and ((temp[101]!=string(ma_role[sel])+" "+string(ma_name[sel])) or (temp[104]!=ma_gear[sel]) or (temp[106]!=ma_mobi[sel]))*/{
            var ach,dr,ma,ra,acy;dr=1;ma=1;ra=1;ach=0;acy=0;
            
            
            
            if (man[sel]="man"){
                marine_armor[0]=ma_armor[sel];fix_left=0;fix_right=0;
                
                var cah;cah=managing;if (cah&gt;10) then cah=0;
                temp[100]="1";if (obj_ini.race[cah,ide[sel]]!=1) then temp[100]=string(obj_ini.race[cah,ide[sel]]);
                
                
                dr=0.7-((ma_exp[sel]*ma_exp[sel])/40000);
                
                if (ma_gear[sel]="Rosarius") then dr-=0.33;
                if (ma_gear[sel]="Iron Halo"){dr-=0.33;ach+=20;}
                if (ma_mobi[sel]="Jump Pack"){dr-=0.1;}
                if (ma_mobi[sel]="Bike") then ach+=25;
                if (ma_wep1[sel]="Boarding Shield"){ach+=20;acy+=4;}
                if (ma_wep2[sel]="Boarding Shield"){ach+=20;acy+=4;}
                if (ma_wep1[sel]="Storm Shield"){ach+=30;acy+=8;}
                if (ma_wep2[sel]="Storm Shield"){ach+=30;acy+=8;}
                
                if (obj_ini.role[cah,ide[sel]]=obj_img.faction_title[1]){
                    if (obj_ini.adv[1]="Paragon") or (obj_ini.adv[2]="Paragon") or (obj_ini.adv[3]="Paragon") or (obj_ini.adv[4]="Paragon"){
                        ra+=0.2;ma+=0.2;
                    }
                }
                
                
                if (ma_armor[sel]="MK3 Iron Armor") then ra-=0.1;
                if (ma_armor[sel]="MK4 Maximus"){ra+=0.05;ma+=0.05;}
                if (ma_armor[sel]="MK6 Corvus"){ra+=0.1;}
                if (string_count("Artificer",ma_armor[sel])&gt;0){ma+=0.1;}
                if (string_count("Terminator",ma_armor[sel])&gt;0){ra-=0.1;ma+=0.2;}
                if (ma_armor[sel]="Tartaros"){ra-=0.05;ma+=0.2;}
                
                var j,jj;j=0;jj=0;
                if (ma_race[sel]=1){
                    j=0;jj=0;repeat(4){j+=1;if (obj_ini.adv[j]="Slow and Purposeful") then jj=1;}if (jj=1) then dr-=0.2;
                    j=0;jj=0;repeat(4){j+=1;if (obj_ini.adv[j]="Lightning Warriors") then jj=1;}if (jj=1) then dr-=0.2;
                }
                
                if (dr&lt;0.25) then dr=0.25;
                
                var ttt;ttt=ma_exp[sel]-30;ttt=(ttt*0.0014)+1;ttt=max(1,(min(ttt,1.5)));ma=ma*ttt;ra=ra*ttt;
                
                if (ma_race[sel]=1){
                    j=0;jj=0;repeat(4){j+=1;if (obj_ini.adv[j]="Slow and Purposeful") then jj=1;}if (jj=1){ma-=0.1;ra-=0.1;}
                    j=0;jj=0;repeat(4){j+=1;if (obj_ini.adv[j]="Lightning Warriors") then jj=1;}if (jj=1){ma+=0.2;ra+=0.2;}
                    j=0;jj=0;repeat(4){j+=1;if (obj_ini.adv[j]="Melee Enthusiasts") then jj=1;}if (jj=1){ma+=0.15;}
                }
                
                if (ui_melee_penalty&gt;0) then ma=ma*0.6;
                if (ui_ranged_penalty&gt;0) then ra=ra*0.6;
                
                ui_specialist=0;ui_coloring="";
                if (ma_role[sel]=obj_img.faction_title[1]) then ui_specialist=111;
                if (ma_role[sel]=obj_ini.role[100,2]) then ui_specialist=14;// Honor Guard
                if (ma_role[sel]=obj_ini.role[100,14]) or (ma_role[sel]=string(obj_ini.role[100,14])+" Aspirant") or (ma_role[sel]="Master of Sanctity") then ui_specialist=1;// Chaplain
                if (ma_role[sel]=obj_ini.role[100,15]) or (ma_role[sel]=string(obj_ini.role[100,15])+" Aspirant") or (ma_role[sel]="Master of the Apothecarion") then ui_specialist=3;// Apothecary
                if (ma_role[sel]=obj_ini.role[100,16]) or (ma_role[sel]=string(obj_ini.role[100,16])+" Aspirant") or (ma_role[sel]="Forge Master") then ui_specialist=5;// Techmarine
                if (ma_role[sel]=obj_ini.role[100,17]) or (ma_role[sel]=string(obj_ini.role[100,17])+" Aspirant") or (ma_role[sel]="Chief "+string(obj_ini.role[100,17])) then ui_specialist=7;// Librarian
                if (ma_role[sel]="Death Company") then ui_specialist=15;// Death Company
                
                if (global.chapter_name="Dark Angels"){
                    if (ma_role[sel]=obj_ini.role[100,4]) then ui_coloring="bone";
                    if (managing=1){
                        if ((string_count("Terminator",ma_armor[sel])&gt;0) or (ma_armor[sel]="Tartaros")){
                            if (ma_role[sel]=obj_ini.role[100,5]) then ui_coloring="bone";
                            if (ma_role[sel]=obj_ini.role[100,7]) then ui_coloring="bone";
                            if (ma_role[sel]="Standard Bearer") then ui_coloring="bone";
                        }
                    }
                }
                if ((ui_specialist=14) or (ma_role[sel]=obj_img.faction_title[1])) and (global.chapter_name="Blood Angels") then ui_coloring="gold";
                
                
                temp[101]=string(ma_role[sel])+" "+string(ma_name[sel]);
                
                temp[102]=ma_armor[sel];temp[103]="";
                if (string_count("&amp;",temp[102])&gt;0) then temp[102]=clean_tags(temp[102]);
                tooltip="";tooltip_weapon=0;tooltip_stat1=0;tooltip_stat2=0;tooltip_stat3=0;tooltip_stat4=0;tooltip_other="";
                tooltip=scr_weapon(ma_armor[sel],"",true,0,false,"","description");
                
                if (acy=0){
                    if (tooltip_other="") then temp[103]="("+string(tooltip_stat1)+"AC)";
                    if (tooltip_other!="") then temp[103]="("+string(tooltip_stat1)+"AC, "+string(tooltip_other)+")";
                }
                if (acy&gt;0){
                    if (tooltip_other="") then temp[103]="("+string(tooltip_stat1)+"+"+string(acy)+"AC)";
                    if (tooltip_other!="") then temp[103]="("+string(tooltip_stat1)+"+"+string(acy)+"AC, "+string(tooltip_other)+")";
                }
                
                temp[104]=ma_gear[sel];temp[105]="";
                if (string_count("&amp;",temp[104])&gt;0) then temp[104]=clean_tags(temp[104]);
                tooltip="";tooltip_weapon=0;tooltip_stat1=0;tooltip_stat2=0;tooltip_stat3=0;tooltip_stat4=0;tooltip_other="";
                tooltip=scr_weapon(ma_gear[sel],"",true,0,false,"","description");
                temp[105]="("+string(tooltip_other)+")";
                
                temp[106]=ma_mobi[sel];temp[107]="";
                if (string_count("&amp;",temp[106])&gt;0) then temp[106]=clean_tags(temp[106]);
                tooltip="";tooltip_weapon=0;tooltip_stat1=0;tooltip_stat2=0;tooltip_stat3=0;tooltip_stat4=0;tooltip_other="";
                tooltip=scr_weapon(ma_mobi[sel],"",true,0,false,"","description");
                temp[107]="("+string(tooltip_other)+")";
                
                var is_a_dread;is_a_dread=false;
                if (string_count("Dread",temp[102])&gt;0) then is_a_dread=true;
                
                temp[108]=ma_wep1[sel];temp[109]="";
                if (string_count("&amp;",temp[108])&gt;0) then temp[108]=clean_tags(temp[108]);
                tooltip="";tooltip_weapon=0;tooltip_stat1=0;tooltip_stat2=0;tooltip_stat3=0;tooltip_stat4=0;tooltip_other="";
                if (is_a_dread=false) then tooltip=scr_weapon(ma_wep1[sel],ma_wep2[sel],true,0,false,"","description");
                if (is_a_dread=true) then tooltip=scr_weapon(ma_wep1[sel],ma_wep2[sel],true,0,true,"","description");
                // temp[109]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat2)+"AP, "+string(tooltip_other)+")";
                temp[109]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_other)+")";
                // if (tooltip_stat4=0) then temp[109]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat2)+"AP, "+string(tooltip_other)+")";
                // if (tooltip_stat4&gt;0) then temp[109]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat2)+"AP, "+string(tooltip_stat4)+" ammo, "+string(tooltip_other)+")";
                if (tooltip_stat4=0) then temp[109]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_other)+")";
                if (tooltip_stat4&gt;0) then temp[109]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat4)+" ammo, "+string(tooltip_other)+")";
                
                temp[110]=ma_wep2[sel];temp[111]="";
                if (string_count("&amp;",temp[110])&gt;0) then temp[110]=clean_tags(temp[110]);
                tooltip="";tooltip_weapon=0;tooltip_stat1=0;tooltip_stat2=0;tooltip_stat3=0;tooltip_stat4=0;tooltip_other="";
                if (is_a_dread=false) then tooltip=scr_weapon(ma_wep2[sel],ma_wep1[sel],true,0,false,"","description");
                if (is_a_dread=true) then tooltip=scr_weapon(ma_wep2[sel],ma_wep1[sel],true,0,true,"","description");
                // temp[111]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat2)+"AP, "+string(tooltip_other)+")";
                temp[111]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_other)+")";
                // if (tooltip_stat4=0) then temp[111]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat2)+"AP, "+string(tooltip_other)+")";
                // if (tooltip_stat4&gt;0) then temp[111]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat2)+"AP, "+string(tooltip_stat4)+" ammo, "+string(tooltip_other)+")";
                if (tooltip_stat4=0) then temp[111]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_other)+")";
                if (tooltip_stat4&gt;0) then temp[111]="("+string(tooltip_stat1)+"DAM, "+string(tooltip_stat4)+" ammo, "+string(tooltip_other)+")";
                
                
                if (ma_role[sel]=obj_img.faction_title[1]){
                    if (obj_ini.adv[1]="Paragon") or (obj_ini.adv[2]="Paragon") or (obj_ini.adv[3]="Paragon") or (obj_ini.adv[4]="Paragon"){
                        temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(130+ach));
                    }
                }
                if (ma_role[sel]!=obj_img.faction_title[1]) or ((obj_ini.adv[1]!="Paragon") and (obj_ini.adv[2]!="Paragon") and (obj_ini.adv[3]!="Paragon") and (obj_ini.adv[4]!="Paragon")){
                    temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(100+ach));
                }
                if (ma_race[sel]=3) then temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(50+ach));
                if (ma_race[sel]=4) then temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(30+ach));
                if (ma_race[sel]=5) then temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(40+ach));
                if (ma_race[sel]=6) then temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(30+ach));
                if (ma_race[sel]=7){
                    if (ma_role[sel]="Ork Sniper") then temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(45+ach));
                    if (ma_role[sel]="Flash Git") then temp[112]=string(real(ma_health[sel]+ach))+"/"+string(real(65+ach));
                }
                
                temp[113]=string(ma_exp[sel]);
                
                var b1,b2;b1=0;b2=0;
                if (ma_bio[sel]&lt;=3){
                    b1=string_to_integer(ma_name[sel]);
                    if (floor(b1/2)!=(b1/2)) then b2=(10.43*ma_bio[sel])-5;
                    if (floor(b1/2)=(b1/2)) then b2=(10.43*ma_bio[sel]);
                }
                if (ma_bio[sel]&gt;3) then b2=(10.43*ma_bio[sel])-5;
                temp[114]=string(ma_bio[sel])+" ("+string(round(max(0,b2)))+"%)";// Bionics
                
                var cah;cah=managing;if (cah&gt;10) then cah=0;
                temp[119]="";// Notes
                if (string_length(obj_ini.spe[cah,ide[sel]])&gt;0){
                    if (string_count("$",obj_ini.spe[cah,ide[sel]])&gt;0) then temp[119]="Born Leader Bonus";
                    if (string_count("@",obj_ini.spe[cah,ide[sel]])&gt;0){
                        temp[119]="Champion Bonus";
                        ma=ma*1.15;ra=ra*1.15;
                    }
                    if (string_count("0",obj_ini.spe[cah,ide[sel]])&gt;0){
                        temp[119]="PSYKER ("+string_upper(obj_ini.psy_powers)+"): ";
                        temp[119]+=string(string_count("|",obj_ini.spe[cah,ide[sel]]));
                        temp[119]+=" Powers known.";
                    }
                }
                
                if (obj_controller.chaos_rating&gt;0) and (temp[119]!="") then temp[119]+="#"+string(max(0,obj_ini.chaos[cah,ide[sel]]))+"% Corruption.";
                if (obj_controller.chaos_rating&gt;0) and (temp[119]="") then temp[119]=string(max(0,obj_ini.chaos[cah,ide[sel]]))+"% Corruption.";
                
                temp[116]=string(round(ma*100))+"%";// Melee Attack
                temp[117]=string(round(ra*100))+"%";// Ranged Attack
                
                
                // mitigation=1-(((1-dr)*0.8)+0.1);
                // mitigation=round(mitigation*100);
                
                // temp[118]=string(max(113,round(100-(dr*100))))+"%#dm: "+string(min(95,mitigation))+"%";// Damage Resistance
                temp[118]=string(min(75,round(100-(dr*100))))+"%";// Damage Resistance
                
            }
            if (man[sel]="vehicle"){
                
            }
        }
        
        
        draw_set_color(38144);draw_rectangle(xx+25,yy+64,xx+974,yy+85,1);
        
        yy+=20;
        
        sel+=1;
        
    }
}























if (global.load&gt;0) then exit;
if (menu=0) then otha=0;

if (cooldown&gt;=0) and (cooldown&lt;9000) then cooldown-=1;
if (click&gt;0){click=-1;audio_play_sound(snd_click,-80,0);audio_sound_gain(snd_click,0.25*master_volume*effect_volume,0);}
if (click2&gt;0){click2=-1;audio_play_sound(snd_click_small,-80,0);audio_sound_gain(snd_click_small,0.25*master_volume*effect_volume,0);}
if (qsfx=1){qsfx=0;scr_quest(0,"artifact_return",4,turn=1);}

/*if (diplomacy&gt;0) and (trading=0) and (trading_artifact=0) and (faction_justmet=1){
    diplo_option[1]="";diplo_option2="";diplo_option3="";
}*/
if (diplomacy=0) then trading_artifact=0;

// 135; 
if (trading_artifact=0) and (trading=0) and (trading_artifact=0) and (faction_justmet=1) and (questing=0) and (trading_demand=0) and (complex_event=false){
    var h;h=0;repeat(4){h+=1;obj_controller.diplo_option[h]="";obj_controller.diplo_goto[h]="";}
}

income=income_base+income_home+income_forge+income_agri+income_recruiting+income_training+income_fleet+income_trade+income_tribute;

// if ((menu&gt;58) or (menu&lt;55)) and (instance_exists(obj_shop)) then with(obj_shop){instance_destroy();}

if (menu=20) and ((diplomacy&gt;0) or ((diplomacy&lt;-5) and (diplomacy&gt;-6))){
    if (string_length(diplo_txt)&lt;string_length(diplo_text)){
        diplo_char+=2;
        diplo_txt=string_copy(diplo_text,0,diplo_char);
    }
    if (diplo_alpha&lt;1) then diplo_alpha+=0.05;
}

if (instance_exists(obj_popup)){
    if (obj_popup.type=99) then fleet_minimized=1;
}


if (menu=0) and (repair_ships&gt;0) and (instance_number(obj_turn_end)=0) and (instance_number(obj_popup)=0){
    repair_ships=0;
    
    var pip;
    pip=instance_create(0,0,obj_popup);
    pip.title="Ships Repaired";
    pip.text="In accordance with the Imperial Repair License, all "+string(obj_ini.chapter_name)+" ships orbiting friendly planets have been repaired. Note that repaired ships, and their fleets, are unable to act further this turn.";
    pip.image="shipyard";
    pip.cooldown=15;
    
    with(obj_p_fleet){
        if (capital_health&lt;100) and (capital_number&gt;0) then acted=2;
        if (frigate_health&lt;100) and (frigate_number&gt;0) then acted=2;
        if (escort_health&lt;100) and (escort_number&gt;0) then acted=2;
    }
    
    var i;i=0;
    repeat(30){i+=1;
        if (obj_ini.ship_location[i]!=obj_img.travel) and (obj_ini.ship_location[i]!="Lost"){obj_ini.ship_hp[i]=obj_ini.ship_maxhp[i];}
    }
    
    // 135 ; need something here to veryify that the ships are within a friendly star system
}


/*if ((zoomed=0) and ((menu=0) or (instance_exists(obj_fleet) or instance_exists(obj_ncombat))) and (!instance_exists(obj_ncombat))) or (force_scroll=1){

if (x&lt;320) then x=320;
if (y&lt;240) then y=240;
if (x&gt;(room_width-320)) then x=room_width-320;
if (y&gt;(room_height-240)) then y=room_height-240;


var spd, keyb;spd=6;keyb="";


/*if ((keyboard_check(vk_left)) or (keyboard_check(ord("A")))) and (x&gt;320) then x-=spd;
if ((keyboard_check(vk_right)) or (keyboard_check(ord("D")))) and (x&lt;(room_width-320)) then x+=spd;
if ((keyboard_check(vk_up)) or (keyboard_check(ord("W")))) and (y&gt;240) then y-=spd;
if ((keyboard_check(vk_down)) or (keyboard_check(ord("S")))) and (y&lt;(room_height-240)) then y+=spd;*/


/*if (x&lt;320) then x=320;
if (y&lt;240) then y=240;
if (x&gt;(room_width-320)) then x=(room_width-320);
if (y&gt;(room_height-240)) then y=(room_height-240);

}


if (menu=1) and (managing&gt;0) and (selecting_location!="") and (man_size=0){
    selecting_location="";sel_loading=0;selecting_planet=0;selecting_ship=0;
}

/*if (popup=0) and (selected=0) and (instance_exists(obj_fleet_controller)){
    with(obj_fleet_controller){instance_destroy();}
}*/



// This unloads units from a ship
if (unload&gt;0){
    cooldown=8;
    
    var q, b, manaj;q=0;b=0;manaj=managing;
    
    
    // 135 ; 
    b=selecting_ship;
    
    if (manaj&gt;10) then manaj=0;
    
    
    
    // show_message(string(manaj)+"#"+string(sh_loc[b])+"|"+string(unload));
    
    repeat(500){q+=1;
        if (man[q]="man") and (ma_loc[q]=selecting_location) and (man_sel[q]!=0){
            if (b=0) then b=ma_lid[q];
            obj_ini.loc[manaj,ide[q]]=obj_ini.ship_location[b];
            obj_ini.lid[manaj,ide[q]]=0;
            obj_ini.wid[manaj,ide[q]]=unload;
            obj_ini.uid[manaj,ide[q]]=0;
            
            ma_loc[q]=obj_ini.ship_location[b];
            ma_lid[q]=0;
            ma_wid[q]=unload;
        }
        if (man[q]="vehicle") and (ma_loc[q]=selecting_location) and (man_sel[q]!=0){
            if (b=0) then b=ma_lid[q];
            obj_ini.veh_loc[manaj,ide[q]]=obj_ini.ship_location[b];
            obj_ini.veh_lid[manaj,ide[q]]=0;
            obj_ini.veh_wid[manaj,ide[q]]=unload;
            obj_ini.veh_uid[manaj,ide[q]]=0;
            
            ma_loc[q]=obj_ini.ship_location[b];
            ma_lid[q]=0;
            ma_wid[q]=unload;
        }
    }
            
    var i;i=-1;selecting_location="";
    repeat(501){i+=1;man_sel[i]=0;}
            
    obj_ini.ship_carrying[b]-=man_size;
    sh_cargo[b]-=man_size;
            
    cooldown=10;sel_loading=0;man_size=0;
    
    unload=0;with(obj_star_select){instance_destroy();}
}




if (managing&gt;0) and (man_size=0) and ((selecting_location!="") or (selecting_types!="") or (selecting_planet!=0) or (selecting_ship!=0)){
    selecting_location="";selecting_types="";selecting_planet=0;selecting_ship=0;
}



if (marines&lt;=0) and (alarm[7]=-1) and (!instance_exists(obj_fleet_controller)) and (!instance_exists(obj_ncombat)) then alarm[7]=15;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="5" enumb="84">
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_saveload</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_fleet</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_ncombat</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>menu</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>managing</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var ok;ok=0;

if (cooldown&lt;=0){
    if (!instance_exists(obj_turn_end)) then ok=1;
    if (instance_exists(obj_turn_end)){if (obj_turn_end.popups_end=1) then ok=1;}
    
    if (ok=1){
        with(obj_turn_end){instance_destroy();}
        with(obj_star_event){instance_destroy();}
        cooldown=8;audio_play_sound(snd_end_turn,-50,0);
        audio_sound_gain(snd_end_turn,master_volume*effect_volume,0);
        
        turn+=1;
        
        with(obj_star){
            present_fleet[1]=0;
            present_fleet[2]=0;
            present_fleet[3]=0;
            present_fleet[4]=0;
            present_fleet[5]=0;
            present_fleet[6]=0;
            present_fleet[7]=0;
            present_fleet[8]=0;
            present_fleet[9]=0;
            present_fleet[10]=0;
            present_fleet[13]=0;
            present_fleet[20]=0;
        }
        with(obj_p_fleet){
            if (action="move") and (obj_controller.faction_status[2]="War"){
                var him;him=instance_nearest(action_x,action_y,obj_star);
                if (point_distance(action_x,action_y,him.x,him.y)&lt;10){
                    him.present_fleet[20]=1;
                }
            }
        }
        with(obj_en_fleet){
            if (action="move") and (owner&gt;5){
                var him;him=instance_nearest(action_x,action_y,obj_star);
                if (point_distance(action_x,action_y,him.x,him.y)&lt;10){
                    him.present_fleet[20]=1;
                }
            }
        }
        
        if (instance_exists(obj_p_fleet)){obj_p_fleet.alarm[1]=1;}
        if (instance_exists(obj_en_fleet)){obj_en_fleet.alarm[1]=1;}
        if (instance_exists(obj_crusade)){obj_crusade.alarm[0]=2;}
        
        requisition+=income;scr_income();
        gene_tithe-=1;
        
        // Do that after the combats and all of that crap
        
        with(obj_star){
            ai_a=2;ai_b=3;ai_c=4;ai_d=5;ai_e=5;
            /*if (p_type[1]="Craftworld"){
                // instance_create(x,y,obj_temp4);
                instance_deactivate_object(id);
                // x=-5000;
            }*/
        }
        alarm[5]=6;instance_create(0,0,obj_turn_end);scr_turn_first();
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="61">
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_popup</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (menu=1) and (managing&gt;0) and (man_max&gt;0){
    if ((man_current+man_see+1)&lt;man_max) then man_current+=1;
     if ((man_current+man_see+1)&lt;man_max) then man_current+=1;
}

if (menu=30) and (managing&gt;0) and (man_max&gt;=10){
    if ((ship_current+ship_see+1)&lt;ship_max) then ship_current+=1;
     if ((ship_current+ship_see+1)&lt;ship_max) then ship_current+=1;
}

if (menu=30) and (managing&gt;0) and (man_max&gt;=50){
    if ((ship_current+ship_see+1)&lt;ship_max) then ship_current+=1;
     if ((ship_current+ship_see+1)&lt;ship_max) then ship_current+=1;
}


if (menu=16) and (man_max&gt;34){
    if ((man_current+man_see+1)&lt;man_max) then man_current+=1;
     if ((man_current+man_see+1)&lt;man_max) then man_current+=1;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="60">
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_popup</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (menu=1) and (managing&gt;0) and (man_max&gt;0){
    if (man_current&gt;1) then man_current-=1;
    if (man_current&gt;1) then man_current-=1;
}

if (menu=30) and (managing&gt;0) and (man_max&gt;=10){
    if (ship_current&gt;1) then ship_current-=1;
    if (ship_current&gt;1) then ship_current-=1;
}

if (menu=30) and (managing&gt;0) and (man_max&gt;=50){
    if (ship_current&gt;1) then ship_current-=1;
    if (ship_current&gt;1) then ship_current-=1;
}


if (menu=16) and (man_current&gt;1){
    if (man_current&gt;1) then man_current-=1;
    if (man_current&gt;1) then man_current-=1;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="56">
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>mouse_left</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>cooldown</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>2</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>cooldown</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>9000</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>cooldown</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="54">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (global.cheat_debug=true) and (instance_number(obj_turn_end)=0) and (instance_number(obj_ncombat)=0) and (instance_number(obj_fleet)=0){
    if (menu=0) and (instance_number(obj_star_select)=0) and (popup=0) and (instance_number(obj_fleet_select)=0) and (instance_number(obj_popup)=0){
        var pop;pop=instance_create(mouse_x,mouse_y,obj_popup);
        pop.image="debug_banshee";
        pop.title="DEBUG";
        pop.planet=1;
        
        pop.text="What would you like to do?";
        pop.option1="Enemy invasion";
        pop.option2="Spawn Fleet";
        pop.option3="Delete Fleet";
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="53">
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>-1</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>mouse_left</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="50">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>diplo v</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var xx, yy;
xx=view_xview[0];
yy=view_yview[0];

if (trading&gt;0) and (force_goodbye!=0) then trading=0;





if (menu=11) and (cooldown&lt;=0){
    if (gene_seed&gt;0) and (obj_ini.zygote=0) and (mouse_x&gt;=xx+407) and (mouse_y&gt;=yy+788) and (mouse_x&lt;xx+529) and (mouse_y&lt;yy+811){
        var i,g;i=0;g=0;repeat(120){i+=1;if (g=0){if (obj_ini.slave_batch_eta[i]=120) then g=i;}}
        if (g=0){i=0;repeat(120){i+=1;if (g=0){if (obj_ini.slave_batch_num[i]=0) then g=i;}}}
        
        var carpal;carpal=1;
        if (obj_ini.slave_batch_num[g]&gt;=10) and (obj_ini.slave_batch_num[g]&lt;50) then carpal=2;
        if (obj_ini.slave_batch_num[g]&gt;=50) then carpal=5;if (obj_ini.slave_batch_num[g]&gt;=150) then carpal=10;
        if (obj_controller.gene_seed&lt;carpal) then carpal=obj_controller.gene_seed;
        
        obj_controller.gene_seed-=carpal;obj_ini.slave_batch_num[g]+=carpal;obj_ini.slave_batch_eta[g]=120;
        
        
        // cooldown=8000;
        cooldown=10;
    }
    if (obj_ini.slave_batch_num[1]&gt;0) and (mouse_x&gt;=xx+659) and (mouse_y&gt;=yy+788) and (mouse_x&lt;xx+838) and (mouse_y&lt;yy+811){
        var i;i=0;repeat(120){i+=1;gene_seed+=obj_ini.slave_batch_num[i];obj_ini.slave_batch_num[i]=0;obj_ini.slave_batch_eta[i]=0;}
        cooldown=8000;
    }
}










if (menu=12) and (cooldown&lt;=0) and (penitorium&gt;0){
    var qp,behav,r_eta,re;qp=0;behav=0;r_eta=0;re=0;
    repeat(min(36,penitorium)){qp+=1;
        if (qp&lt;=penitorium) and (mouse_y&gt;=yy+100+((qp-1)*20)) and (mouse_y&lt;yy+100+(qp*20)){
            if (mouse_x&gt;=xx+1433) and (mouse_x&lt;xx+1497){
                cooldown=20;var c,e;c=penit_co[qp];e=penit_id[qp];
                if (obj_ini.race[c,e]=1){
                    if (obj_ini.age[c,e]&lt;=((obj_controller.millenium*1000)+obj_controller.year)-10) and (obj_ini.zygote=0) and (string_count("Doom",obj_ini.strin2)=0) then obj_controller.gene_seed+=1;
                    if (obj_ini.age[c,e]&lt;=((obj_controller.millenium*1000)+obj_controller.year)-5) and (string_count("Doom",obj_ini.strin2)=0) then obj_controller.gene_seed+=1;
                }
                
                var tek;tek="";
                if (obj_ini.race[c,e]=1){
                    tek=obj_ini.wep1[c,e];if (tek!="") then scr_add_item(tek,1);
                    tek=obj_ini.wep2[c,e];if (tek!="") then scr_add_item(tek,1);
                    tek=obj_ini.armor[c,e];if (tek!="") then scr_add_item(tek,1);
                    tek=obj_ini.mobi[c,e];if (tek!="") then scr_add_item(tek,1);
                    tek=obj_ini.gear[c,e];if (tek!="") then scr_add_item(tek,1);
                }
                
                tek="";
                if (obj_ini.race[c,e]=1) then tek="m";
                if (obj_ini.role[c,e]="Captain") then tek="c";
                if (obj_ini.role[c,e]=obj_ini.role[100,15]) then tek="c";
                if (obj_ini.role[c,e]=obj_ini.role[100,17]) then tek="c";
                if (obj_ini.role[c,e]=obj_ini.role[100,14]) then tek="c";
                if (obj_ini.role[c,e]=obj_ini.role[100,16]) then tek="c";
                if (obj_ini.role[c,e]="Codiciery") then tek="c";
                if (obj_ini.role[c,e]="Lexicanum") then tek="c";
                if (obj_ini.role[c,e]=obj_ini.role[100,6]) then tek="c";
                if (obj_ini.role[c,e]="Venerable "+string(obj_ini.role[100,6])) then tek="c";
                if (obj_ini.role[c,e]="Chief "+string(obj_ini.role[100,17])) then tek="c";
                if (obj_ini.role[c,e]="Master of Sanctity") then tek="c";
                if (obj_ini.role[c,e]="Master of the Apothecarion") then tek="c";
                if (obj_ini.role[c,e]="Forge Master") then tek="c";
                if (obj_ini.role[c,e]=obj_img.faction_title[1]){tek="c";obj_controller.alarm[7]=5;global.defeat=3;}
                
                // Needs to be based on role
                if (tek="m") then obj_controller.marines-=1;
                if (tek="c") then obj_controller.command-=1;
                
                obj_ini.race[c,e]=0;obj_ini.loc[c,e]="";obj_ini.name[c,e]="";obj_ini.role[c,e]="";obj_ini.wep1[c,e]="";obj_ini.lid[c,e]=0;
                obj_ini.wep2[c,e]="";obj_ini.armor[c,e]="";obj_ini.gear[c,e]="";obj_ini.hp[c,e]=100;obj_ini.chaos[c,e]=0;obj_ini.experience[c,e]=0;
                obj_ini.mobi[c,e]="";obj_ini.age[c,e]=0;obj_ini.spe[c,e]="";obj_ini.god[c,e]=0;
                diplo_char=c;with(obj_ini){scr_company_order(obj_controller.diplo_char);}re=1;diplo_char=0;
            }
            if (mouse_x&gt;=xx+1508) and (mouse_x&lt;xx+1567){
                cooldown=20;var c,e;c=penit_co[qp];e=penit_id[qp];
                obj_ini.god[c,e]-=10;re=1;
            }
        }
    }
    if (re=1){
        var g;g=0;
        repeat(100){g+=1;
            penit_co[g]=0;penit_id[g]=0;
        }
        
        penitorium=0;
        var c,e,p;c=-1;e=0;p=0;
        repeat(11){
            c+=1;e=0;
            repeat(250){e+=1;
                if (obj_ini.god[c,e]&gt;=10){p+=1;
                    penit_co[p]=c;
                    penit_id[p]=e;
                    penitorium+=1;
                }
            }
        }
    }
}








if (menu=13) and (cooldown&lt;=0) and (artifacts&gt;0){
    if (mouse_y&gt;=yy+437) and (mouse_y&lt;=yy+461){
        if (mouse_x&gt;=xx+512) and (mouse_x&lt;xx+550){// Previous
            if (menu_artifact&gt;1) and (cooldown&lt;=0){menu_artifact-=1;cooldown=8000;identifiable=0;}
            if (menu_artifact=1) and (cooldown&lt;=0){menu_artifact=artifacts;cooldown=8000;identifiable=0;}
        }
        if (mouse_x&gt;=xx+690) and (mouse_x&lt;xx+732){// Next
            if (menu_artifact&lt;artifacts) and (cooldown&lt;=0){menu_artifact+=1;cooldown=8000;identifiable=0;}
            if (menu_artifact=artifacts) and (cooldown&lt;=0){menu_artifact=1;cooldown=8000;identifiable=0;}
        }
    }
    if (mouse_x&gt;=xx+531) and (mouse_y&gt;=yy+715) and (mouse_x&lt;xx+709) and (mouse_y&lt;yy+733){// Identify now
        if (identifiable=1) and (obj_ini.artifact_identified[menu_artifact]&gt;0) and (requisition&gt;=150){
            obj_ini.artifact_identified[menu_artifact]=0;
            requisition-=150;cooldown=8000;identifiable=0;
            audio_play_sound(snd_identify,-500,0);
            audio_sound_gain(snd_identify,master_volume*effect_volume,0);
        }
    }
    
    
    if (obj_ini.artifact_identified[menu_artifact]=0){
        if (mouse_x&gt;=xx+354) and (mouse_y&gt;=yy+789) and (mouse_x&lt;xx+448) and (mouse_y&lt;yy+804) and (cooldown&lt;=0){// Equip
            var hue;hue=1;
            if (obj_ini.artifact[menu_artifact]="Statue") then hue=0;
            if (obj_ini.artifact[menu_artifact]="Casket") then hue=0;
            if (obj_ini.artifact[menu_artifact]="Chalice") then hue=0;
            if (obj_ini.artifact[menu_artifact]="Robot") then hue=0;
            if (hue=1){
                var pop;
                pop=instance_create(0,0,obj_popup);
                pop.type=8;cooldown=8;
            }
        }
        if (mouse_x&gt;=xx+512) and (mouse_y&gt;=yy+789) and (mouse_x&lt;xx+740) and (mouse_y&lt;yy+804) and (cooldown&lt;=0){// Gift
            var pop,chick;chick=0;
            if (known[2]&gt;1) and (faction_defeated[2]=0) then chick=1;if (known[3]&gt;1) and (faction_defeated[3]=0) then chick=1;
            if (known[4]&gt;1) and (faction_defeated[4]=0) then chick=1;if (known[5]&gt;1) and (faction_defeated[5]=0) then chick=1;
            if (known[6]&gt;1) and (faction_defeated[6]=0) then chick=1;if (known[8]&gt;1) and (faction_defeated[8]=0) then chick=1;
            if (chick!=0){
                pop=instance_create(0,0,obj_popup);
                pop.type=9;cooldown=8;
            }
        }
        if (mouse_x&gt;=xx+780) and (mouse_y&gt;=yy+789) and (mouse_x&lt;xx+894) and (mouse_y&lt;yy+804) and (cooldown&lt;=0){// Destroy
            var fun;fun=floor(random(100))+1;
            // Below here cleans up the artifacts
            var i;i=menu_artifact;
            
            if (menu_artifact=fest_display) then fest_display=0;
            
            if (string_count("Daemon",obj_ini.artifact_tags[i])&gt;0){
                if (obj_ini.artifact_sid[i]&gt;=500){
                    var oops;oops=floor(random(100))+1;
                    
                    if (oops&lt;=60) and (obj_ini.ship_carrying[obj_ini.artifact_sid[i]-500]&gt;0){
                        instance_create(0,0,obj_ncombat);
                        obj_ncombat.battle_special="ship_demon";obj_ncombat.formation_set=1;
                        obj_ncombat.enemy=10;obj_ncombat.battle_id=obj_ini.artifact_sid[i]-500;
                        scr_ship_battle(obj_ini.artifact_sid[i]-500,999);
                    }
                }
            }
            
            
            /*
            
            This was also causing a crash
            
            var e;e=0;
            repeat(500){e+=1;
                if (obj_ini.artifact_tags[i]=obj_controller.recent_keyword[e]){
                    obj_controller.recent_keyword[e]="";obj_controller.recent_type[e]="";
                    obj_controller.recent_turn[e]=0;obj_controller.recent_number[e]=0;
                    scr_recent("artifact_destroyed",obj_controller.recent_keyword,2);
                    scr_recent("","",0);
                }
            }*/
            
            obj_ini.artifact[i]="";obj_ini.artifact_tags[i]="";
            obj_ini.artifact_identified[i]=0;obj_ini.artifact_condition[i]=100;
            obj_ini.artifact_loc[i]="";obj_ini.artifact_sid[i]=0;
            artifacts-=1;cooldown=12;
            if (menu_artifact&gt;artifacts) then menu_artifact=artifacts;
            
            repeat(20){
                obj_ini.artifact[i]=obj_ini.artifact[i+1];obj_ini.artifact_tags[i]=obj_ini.artifact_tags[i+1];
                obj_ini.artifact_identified[i]=obj_ini.artifact_identified[i+1];
                obj_ini.artifact_condition[i]=obj_ini.artifact_condition[i+1];
                obj_ini.artifact_loc[i]=obj_ini.artifact_loc[i+1];obj_ini.artifact_sid[i]=obj_ini.artifact_sid[i+1];
                i+=1;
            }
        }
    }
    
    
}

if (menu=14) and (cooldown&lt;=0){
    /*
    draw_set_alpha(1);draw_rectangle(xx+621,yy+466,xx+720,yy+486,1);
    draw_set_alpha(0.5);draw_rectangle(xx+622,yy+467,xx+719,yy+485,1);
    if (mouse_x&gt;xx+621) and (mouse_y&gt;yy+466) and (mouse_x&lt;xx+720) and (mouse_y&lt;yy+486){
        draw_set_alpha(0.2);draw_rectangle(xx+621,yy+466,xx+720,yy+486,0);
    }draw_set_alpha(1);
    if (stc_wargear_un+stc_vehicles_un+stc_ships_un=0) then draw_set_alpha(0.5);
    draw_text(xx+670,yy+467,"Identify");draw_set_alpha(1);
    
    draw_set_alpha(1);draw_rectangle(xx+733,yy+466,xx+790,yy+486,1);
    draw_set_alpha(0.5);draw_rectangle(xx+734,yy+467,xx+789,yy+485,1);
    if (mouse_x&gt;xx+733) and (mouse_y&gt;yy+466) and (mouse_x&lt;xx+790) and (mouse_y&lt;yy+486){
        draw_set_alpha(0.2);draw_rectangle(xx+733,yy+466,xx+790,yy+486,0);
    }draw_set_alpha(1);
    if (stc_wargear_un+stc_vehicles_un+stc_ships_un=0) then draw_set_alpha(0.5);
    draw_text(xx+761,yy+467,"Gift");draw_set_alpha(1);
    */
    
    
    if (mouse_x&gt;=xx+733) and (mouse_y&gt;=yy+466) and (mouse_x&lt;xx+790) and (mouse_y&lt;yy+486) and (cooldown&lt;=0){// Gift STC Fragment
        if (stc_wargear_un+stc_vehicles_un+stc_ships_un&gt;0){
            var pop,chick;chick=0;
            if (known[2]&gt;1) and (faction_defeated[2]=0) then chick=1;if (known[3]&gt;1) and (faction_defeated[3]=0) then chick=1;
            if (known[4]&gt;1) and (faction_defeated[4]=0) then chick=1;if (known[5]&gt;1) and (faction_defeated[5]=0) then chick=1;
            if (known[6]&gt;1) and (faction_defeated[6]=0) then chick=1;if (known[8]&gt;1) and (faction_defeated[8]=0) then chick=1;
            if (chick!=0){
                pop=instance_create(0,0,obj_popup);
                pop.type=9.1;cooldown=8000;
            }
        }
    }
    
    
    if (mouse_x&gt;xx+621) and (mouse_y&gt;yy+466) and (mouse_x&lt;xx+720) and (mouse_y&lt;yy+486){// Identify STC
        if (stc_wargear_un+stc_vehicles_un+stc_ships_un&gt;0){
            var r1,r2;r2=0;cooldown=8000;
            audio_play_sound(snd_stc,-500,0)
            audio_sound_gain(snd_stc,master_volume*effect_volume,0);
            r1=floor(random(stc_wargear_un+stc_vehicles_un+stc_ships_un))+1;
            
            if (r1&lt;stc_wargear_un) and (stc_wargear_un&gt;0) then r2=1;
            if (r1&gt;stc_wargear_un) and (r1&lt;=stc_wargear_un+stc_vehicles_un) and (stc_vehicles_un&gt;0) then r2=2;
            if (r1&gt;stc_wargear_un+stc_vehicles_un) and (r2&lt;=stc_wargear_un+stc_vehicles_un+stc_ships_un) and (stc_ships_un&gt;0) then r2=3;
            
            if (stc_wargear_un&gt;0) and (stc_vehicles_un+stc_ships_un=0) then r2=1;
            if (stc_vehicles_un&gt;0) and (stc_wargear_un+stc_ships_un=0) then r2=2;
            if (stc_ships_un&gt;0) and (stc_vehicles_un+stc_wargear_un=0) then r2=3;
            
            if (r2=1){
                stc_wargear_un-=1;stc_wargear+=1;
                if (stc_wargear=2) then stc_bonus[1]=choose(1,2,3,4,5);
                if (stc_wargear=4) then stc_bonus[2]=choose(1,2,3);
            }
            if (r2=2){
                stc_vehicles_un-=1;stc_vehicles+=1;
                if (stc_vehicles=2) then stc_bonus[3]=choose(1,2,3,4,5);
                if (stc_vehicles=4) then stc_bonus[4]=choose(1,2,3);
            }
            if (r2=3){
                stc_ships_un-=1;stc_ships+=1;
                if (stc_ships=2) then stc_bonus[5]=choose(1,2,3,4,5);
                if (stc_ships=4) then stc_bonus[6]=choose(1,2,3);
            }
            instance_create(1000,1000,obj_shop);// Refresh the shop
        }
        exit;
    }
    
    

    /*
    if (mouse_x&gt;=xx+223) and (mouse_y&gt;=yy+301) and (mouse_x&lt;xx+333) and (mouse_y&lt;yy+347){menu=55;cooldown=8;with(obj_shop){instance_destroy();}instance_create(0,0,obj_shop);}
    if (mouse_x&gt;=xx+223) and (mouse_y&gt;=yy+347) and (mouse_x&lt;xx+333) and (mouse_y&lt;yy+393){menu=58;cooldown=8;with(obj_shop){instance_destroy();}instance_create(0,0,obj_shop);}
    if (mouse_x&gt;=xx+353) and (mouse_y&gt;=yy+301) and (mouse_x&lt;xx+463) and (mouse_y&lt;yy+393){menu=56;cooldown=8;with(obj_shop){instance_destroy();}instance_create(0,0,obj_shop);}
    if (mouse_x&gt;=xx+483) and (mouse_y&gt;=yy+301) and (mouse_x&lt;xx+593) and (mouse_y&lt;yy+393){menu=57;cooldown=8;with(obj_shop){instance_destroy();}instance_create(0,0,obj_shop);}
    */
}


if (menu=15) and (cooldown&lt;=0){
    if (mouse_x&gt;=xx+748) and (mouse_x&lt;xx+772){
        if (mouse_y&gt;=yy+355) and (mouse_y&lt;yy+373) and (recruiting&lt;5) and (obj_controller.gene_seed&gt;0) and (obj_ini.doomed=0) and (string_count("|",obj_controller.recruiting_worlds)&gt;0) and (obj_controller.penitent=0){cooldown=8000;recruiting+=1;income_recruiting-=2*(string_count("|",obj_controller.recruiting_worlds));scr_income();}
        
        if (mouse_y&gt;=yy+395) and (mouse_y&lt;yy+413) and (training_apothecary&lt;6){cooldown=8000;training_apothecary+=1;scr_income();}
        if (mouse_y&gt;=yy+415) and (mouse_y&lt;yy+433) and (training_chaplain&lt;6) and (global.chapter_name!="Space Wolves") and (global.chapter_name!="Iron Hands"){cooldown=8000;training_chaplain+=1;scr_income();}
        if (mouse_y&gt;=yy+435) and (mouse_y&lt;yy+452) and (training_psyker&lt;6) and (string_count("Intolerant",obj_ini.strin2)=0){cooldown=8000;training_psyker+=1;scr_income();}
        if (mouse_y&gt;=yy+455) and (mouse_y&lt;yy+473) and (training_techmarine&lt;6){
            cooldown=8000;
            var pid;pid=0;pid=scr_role_count("Techmarine","");
            if (pid&gt;=((disposition[3]/2)+5)) then training_techmarine=0;
            if (pid&lt;((disposition[3]/2)+5)){training_techmarine+=1;scr_income();}
        }
    }
    if (mouse_x&gt;=xx+726) and (mouse_x&lt;xx+745){
        if (mouse_y&gt;=yy+355) and (mouse_y&lt;yy+373) and (recruiting&gt;0){cooldown=8000;recruiting-=1;income_recruiting+=2*(string_count("|",obj_controller.recruiting_worlds));scr_income();}
        if (mouse_y&gt;=yy+395) and (mouse_y&lt;yy+413) and (training_apothecary&gt;0){cooldown=8000;training_apothecary-=1;scr_income();}
        if (mouse_y&gt;=yy+415) and (mouse_y&lt;yy+433) and (training_chaplain&gt;0){cooldown=8000;training_chaplain-=1;scr_income();}
        if (mouse_y&gt;=yy+435) and (mouse_y&lt;yy+452) and (training_psyker&gt;0){cooldown=8000;training_psyker-=1;scr_income();}
        if (mouse_y&gt;=yy+455) and (mouse_y&lt;yy+473) and (training_techmarine&gt;0){cooldown=8000;training_techmarine-=1;scr_income();}
    }
    if (mouse_y&gt;=yy+518) and (mouse_y&lt;=yy+542){
        var onceh;onceh=0;
        if (mouse_x&gt;=xx+713) and (mouse_x&lt;=xx+752){cooldown=8000;
            if (recruit_trial="Blood Duel") and (onceh=0){onceh=1;recruit_trial="Hunting the Hunter";}
            if (recruit_trial="Hunting the Hunter") and (onceh=0){onceh=1;recruit_trial="Survival of the Fittest";}
            if (recruit_trial="Survival of the Fittest") and (onceh=0){onceh=1;recruit_trial="Exposure";}
            if (recruit_trial="Exposure") and (onceh=0){onceh=1;recruit_trial="Knowledge of Self";}
            if (recruit_trial="Knowledge of Self") and (onceh=0){onceh=1;recruit_trial="Challenge";}
            if (recruit_trial="Challenge") and (onceh=0){onceh=1;recruit_trial="Apprenticeship";}
            if (recruit_trial="Apprenticeship") and (onceh=0){onceh=1;recruit_trial="Blood Duel";}
        }
        if (mouse_x&gt;=xx+492) and (mouse_x&lt;=xx+528){cooldown=8000;
            if (recruit_trial="Blood Duel") and (onceh=0){onceh=1;recruit_trial="Apprenticeship";}
            if (recruit_trial="Apprenticeship") and (onceh=0){onceh=1;recruit_trial="Challenge";}
            if (recruit_trial="Challenge") and (onceh=0){onceh=1;recruit_trial="Knowledge of Self";}
            if (recruit_trial="Knowledge of Self") and (onceh=0){onceh=1;recruit_trial="Exposure";}
            if (recruit_trial="Exposure") and (onceh=0){onceh=1;recruit_trial="Survival of the Fittest";}
            if (recruit_trial="Survival of the Fittest") and (onceh=0){onceh=1;recruit_trial="Hunting the Hunter";}
            if (recruit_trial="Hunting the Hunter") and (onceh=0){onceh=1;recruit_trial="Blood Duel";}
        }
    }
}


if (menu=16) and (cooldown&lt;=0){
    var i;i=ship_current;
    repeat(34){i+=1;
        if (obj_ini.ship[i]!="") and (mouse_x&gt;=xx+953) and (mouse_x&gt;=yy+84+(i*20)) and (mouse_x&lt;xx+969) and (mouse_y&lt;yy+100+(i*20)){
            temp[40]=obj_ini.ship[i];
            with(obj_p_fleet){var i;i=0;
                repeat(40){i+=1;
                    if (capital[i]=obj_controller.temp[40]) then instance_create(x,y,obj_temp7);
                    if (frigate[i]=obj_controller.temp[40]) then instance_create(x,y,obj_temp7);
                    if (escort[i]=obj_controller.temp[40]) then instance_create(x,y,obj_temp7);
                }
            }
            if (instance_exists(obj_temp7)){
                x=obj_temp7.x;y=obj_temp7.y;cooldown=8000;
                menu=0;with(obj_fleet_show){instance_destroy();}
                instance_create(obj_temp7.x,obj_temp7.y,obj_fleet_show);
                with(obj_temp7){instance_destroy();}
            }
        }
    }
}






if (menu=20) and ((diplomacy&gt;0) or ((diplomacy&lt;-5) and (diplomacy&gt;-6))) and (cooldown&lt;=0){// Diplomacy
    if (trading=0) and (diplo_option[1]="") and (diplo_option[2]="") and (diplo_option[3]="") and (diplo_option[4]=""){
    
        // xx+=208;yy+=83;yy+=50;
    
        if (force_goodbye&lt;=0){
            if (audience=0){
                if (mouse_x&gt;=xx+442) and (mouse_y&gt;=yy+718) and (mouse_x&lt;xx+547) and (mouse_y&lt;yy+737) and (audience=0) and (force_goodbye=0){// Trade
                    trading=1;scr_dialogue("open_trade");cooldown=8;click2=1;trade_likely="";
                }
                if (mouse_x&gt;=xx+561) and (mouse_y&gt;=yy+718) and (mouse_x&lt;xx+667) and (mouse_y&lt;yy+737) and (force_goodbye=0){// Demand
                    cooldown=8;click2=1;trading_demand=diplomacy;scr_dialogue("trading_demand");
                }
                if (mouse_x&gt;=xx+682) and (mouse_y&gt;=yy+718) and (mouse_x&lt;xx+787) and (mouse_y&lt;yy+737) and (force_goodbye=0){// Discuss
                    // 
                }
            }
            if (mouse_x&gt;=xx+442) and (mouse_y&gt;=yy+752) and (mouse_x&lt;xx+547) and (mouse_y&lt;yy+771) and (force_goodbye=0){// Denounce
                if (diplo_last!="denounced"){scr_dialogue("denounced");cooldown=8;click2=1;}
            }
            if (mouse_x&gt;=xx+561) and (mouse_y&gt;=yy+752) and (mouse_x&lt;xx+667) and (mouse_y&lt;yy+771) and (force_goodbye=0){// Praise
                if (diplo_last!="praised"){scr_dialogue("praised");cooldown=8;click2=1;}
            }
            
            if (audience=0){
                if (mouse_x&gt;=xx+682) and (mouse_y&gt;=yy+752) and (mouse_x&lt;xx+787) and (mouse_y&lt;yy+771) and (force_goodbye=0){// Propose Alliance
                    if (diplo_last!="propose_alliance"){cooldown=8;click2=1;scr_dialogue("propose_alliance");}
                }
                // Declare war here
            }
        }
        
        /*
        Propose Alliance    same as Discuss but 752-771
        Declare War         551,784,677,803
        */
           
        if (mouse_x&gt;=xx+818) and (mouse_y&gt;=yy+795) and (mouse_x&lt;xx+897) and (mouse_y&lt;yy+814){// Exit
            click=1;
            
            if (audio_is_playing(snd_blood)=true) then scr_music("royal",2000);
            
            
            
            if (complex_event=true) and (instance_exists(obj_temp_meeting)){
                complex_event=false;diplomacy=0;menu=0;
                force_goodbye=0;cooldown=80;
                with(obj_temp_meeting){instance_destroy();}
                if (instance_exists(obj_turn_end)){obj_turn_end.alarm[1]=1;exit;}
                exit;
            }
            
            
            
            if (trading_artifact!=0){
                var h;h=0;repeat(4){h+=1;obj_controller.diplo_option[h]="";obj_controller.diplo_goto[h]="";}
                diplomacy=0;menu=0;force_goodbye=0;cooldown=8;
                if (trading_artifact=2) and (instance_exists(obj_temp4)){obj_temp4.alarm[2]=1;}// 135 this might not be needed
                trading_artifact=0;
                with(obj_popup){obj_temp4.alarm[1]=1;instance_destroy();}exit;
            }
            
            if (force_goodbye=5){
                var h;h=0;repeat(4){h+=1;obj_controller.diplo_option[h]="";obj_controller.diplo_goto[h]="";}
                diplomacy=0;menu=0;force_goodbye=0;cooldown=8;exit;
            }
            
            if (liscensing=2) and (repair_ships=0){
                cooldown=8;
                var cru;
                cru=instance_create(mouse_x,mouse_y,obj_crusade);
                cru.owner=diplomacy;cru.placing=true;
                diplomacy=0;force_goodbye=0;
                menu=0;exit_all=0;liscensing=0;
                if (zoomed=0) then scr_zoom();
                exit;
            }
            
            if (exit_all!=0){cooldown=8;diplomacy=0;force_goodbye=0;menu=0;exit_all=0;}
            
            if (diplo_last="artifact_thanks") and (force_goodbye!=0){
                diplomacy=0;menu=13;force_goodbye=0;cooldown=8;exit;
            }
            
            // Trading artifact was here
            
            if (audience=0){cooldown=8;diplomacy=0;force_goodbye=0;}// Exits back to diplomacy thing
            
            if (audience&gt;0) and (!instance_exists(obj_turn_end)){cooldown=8;diplomacy=0;menu=0;audience=0;force_goodbye=0;exit;}// No need to check for next audience
            if (audience&gt;0) and (instance_exists(obj_turn_end)){
                if (obj_controller.complex_event=false){
                    cooldown=8;diplomacy=0;menu=0;obj_turn_end.alarm[1]=1;audience=0;force_goodbye=0;exit;
                }
                if (obj_controller.complex_event=true){
                    
                }
            }// Have this check for the next audience, if any
        }
        
        // xx=view_xview[0]+0;yy=view_yview[0]+0;
        
        
        
        if (trading=1) or (trading=2){// Trade goods go here
            trade_theirs[1]="";trade_theirs[2]="";trade_theirs[3]="";trade_theirs[4]="";trade_theirs[5]="";trade_theirs[6]="";
            trade_disp[0]=-100;trade_disp[1]=-100;trade_disp[2]=-100;trade_disp[3]=-100;trade_disp[4]=-100;trade_disp[5]=-100;trade_disp[6]=-100;
            
            trade_req=requisition;trade_gene=gene_seed;
            trade_chip=stc_wargear_un+stc_vehicles_un+stc_ships_un;
            trade_info=info_chips;
            
            if (diplomacy=2){cooldown=8;// Imperium trade goods
                trade_theirs[1]="Requisition";
                // trade_theirs[2]="Storm Trooper";
                trade_theirs[2]="Recruiting Planet";trade_theirs[3]="License: Repair";trade_theirs[4]="License: Crusade";
            }
            if (diplomacy=3){cooldown=8;// Mechanicus trade goods
                trade_theirs[1]=string(obj_img.battlesuit);trade_theirs[2]=string(obj_img.unit[1,21]);trade_theirs[3]="Minor Artifact";
                // trade_theirs[4]="Skitarii";
                trade_theirs[4]="Techpriest";
                trade_disp[1]=30;trade_disp[2]=20;trade_disp[3]=40;// trade_disp[4]=20;
                trade_disp[4]=50;
            }
            if (diplomacy=4){cooldown=8;// Inquisition trade goods
                trade_theirs[1]="Condemnor Boltgun";trade_theirs[2]="Hellrifle";trade_theirs[3]="Incinerator";trade_theirs[4]="Crusader";trade_theirs[5]="Exterminatus";trade_theirs[6]="Cyclonic Torpedo";
                trade_disp[1]=20;trade_disp[2]=30;trade_disp[3]=20;trade_disp[4]=30;trade_disp[5]=40;trade_disp[6]=60;
            }
            if (diplomacy=5){cooldown=8;// Ecclesiarchy trade goods
                trade_theirs[1]="Eviscerator";trade_theirs[2]="Heavy Flamer";trade_theirs[3]="Inferno Bolts";trade_theirs[4]=obj_img.unit[5,7];trade_theirs[5]=obj_img.unit[5,17];
                trade_disp[1]=20;trade_disp[2]=30;trade_disp[3]=30;trade_disp[4]=50;trade_disp[5]=50;
            }
            
            if (diplomacy=6){cooldown=8;// Elfdar trade goods
                trade_theirs[1]="Master Crafted Power Sword";trade_theirs[2]="Archeotech Laspistol";trade_theirs[3]="Ranger";trade_theirs[4]="Useful Information";
                trade_disp[1]=-10;trade_disp[2]=-10;trade_disp[3]=10;trade_disp[4]=-15;
                if (random_event_next!="") and ((string_count("WL10|",useful_info)&gt;0) or (turn&lt;chaos_turn)) and ((string_count("WL7|",useful_info)&gt;0) or (known[7]&lt;1)) and  (string_count("WG|",useful_info)&gt;1) and (string_count("CM|",useful_info)&gt;0) then trade_disp[4]=1000;
            }
            if (diplomacy=7){cooldown=8;// Ork trade goods
                trade_theirs[1]="Power Klaw";trade_theirs[2]="Ork Sniper";trade_theirs[3]="Flash Git";
            }
            
            if (diplomacy=8) then trade_theirs[1]="Test";
            
        }
    }
    // 
    
    
    
    
    
    
    
    if (trading=0) and ((diplo_option[1]!="") or (diplo_option[2]!="") or (diplo_option[3]!="") or (diplo_option[4]!="")){
        if (force_goodbye=0) and (cooldown&lt;=0){
            
            var diplo_pressed;diplo_pressed=0;
            yy=view_yview[0]+0;
            
            var opts,slot,dp;opts=0;slot=0;dp=0;
            repeat(4){dp+=1;if (diplo_option[dp]!="") then opts+=1;}
            if (opts=4) then yy-=30;
            if (opts=2) then yy+=30;
            if (opts=1) then yy+=60;
            
            repeat(4){slot+=1;
                if (diplo_option[slot]!=""){
                    if (mouse_x&gt;=xx+354) and (mouse_y&gt;=yy+694) and (mouse_x&lt;xx+887) and (mouse_y&lt;yy+717) and (cooldown&lt;=0){
                        diplo_pressed=slot;
                    }
                }
                yy+=30;
            }
            yy=view_yview[0];
            
            
            if (diplo_pressed&gt;0) and (diplo_goto[diplo_pressed]!="") and (cooldown&lt;=0){
                click2=1;scr_dialogue(diplo_goto[diplo_pressed]);cooldown=4000;exit;
            }
            
            if (diplo_pressed=1){click2=1;
                if (questing=0) and (trading_artifact=0) and (trading_demand=0){
                    if (diplomacy=4) and (diplo_option[1]="It will not happen again"){// It will not happen again mang
                        scr_dialogue("you_better");diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";force_goodbye=1;
                        
                        var tb,tc,pp;
                        explode_script(obj_controller.temp[1008],"|");
                        tb=string(explode[0]);tc=real(explode[1]);
                        var who,ev,v;v=0;ev=0;repeat(99){v+=1;if (ev=0) and (event[v]="") then ev=v;}
                        event[ev]="remove_serf|"+string(tb)+"|"+string(tc)+"|";event_duration[ev]=choose(1,2);
                        exit;
                    }
                }
                
                if (questing!=0){cooldown=8;
                    if (questing=1) and (diplomacy=6){
                        if (requisition&gt;=500){scr_loyalty("Xeno Trade","+");
                            scr_dialogue("mission1_thanks");scr_quest(2,"300req",6,0);
                            requisition-=500;questing=0;diplo_option[1]="";
                            diplo_option[2]="";diplo_option[3]="";exit;
                        }
                    }
                }
                
                if ((diplomacy=3) or (diplomacy=5)) and (trading_artifact!=0){trading=1;scr_dialogue("open_trade");trade_take[1]="Artifact";trade_tnum[1]=1;trade_req=requisition;trade_gene=gene_seed;trade_chip=info_chips;trade_info=stc_wargear_un+stc_vehicles_un+stc_ships_un;}
                
                if (trading_demand&gt;0) and (diplo_option[1]!="Cancel") and (diplo_option[1]!="") then scr_demand(1);
            }
            
            
            
            if (diplo_pressed=2){
                // show_message("special diplomacy option 2");
                click2=1;
                
                if (questing=0) and (trading_artifact=0) and (trading_demand=0){// Don't want no trabble
                    if (diplomacy=4) and (diplo_option[2]="Very well"){
                        diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";force_goodbye=1;
                        
                        var tb,tc,pp;
                        explode_script(obj_controller.temp[1008],"|");
                        tb=string(explode[0]);tc=real(explode[1]);
                        var who,ev,v;v=0;ev=0;repeat(99){v+=1;if (ev=0) and (event[v]="") then ev=v;}
                        event[ev]="remove_serf|"+string(tb)+"|"+string(tc)+"|";event_duration[ev]=choose(1,2);
                        cooldown=8;diplomacy=0;menu=0;obj_turn_end.alarm[1]=1;audience=0;force_goodbye=0;
                        exit;
                    }
                }
                
                
                
                if (questing!=0){cooldown=8;
                    if (questing=1) and (diplomacy=6){
                        scr_dialogue("quest_maybe");questing=0;
                        diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";exit;
                    }
                }
                
                if (trading_demand&gt;0) and (diplo_option[2]!="Cancel") and (diplo_option[2]!="") then scr_demand(2);
                if (trading_demand&gt;0) and (diplo_option[2]="Cancel"){cooldown=8000;trading_demand=0;diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";diplo_text="...";diplo_txt="...";}
            
                
                if (diplomacy&gt;0) and (trading_artifact&gt;0) and (menu=20){cooldown=8;
                    obj_temp4.alarm[1]=2;trading_artifact=0;menu=0;diplomacy=0;diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";
                }
            }
            
            
            
            if (diplo_pressed=3){
                // show_message("special diplomacy option 3");
                click2=1;
                
                if (questing=0) and (trading_artifact=0) and (trading_demand=0){
                    if (diplomacy=4) and (string_count("You will not",diplo_option[3])&gt;0){// MIIIIINE!!!1
                        scr_dialogue("die_heretic");diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";force_goodbye=1;
                        exit;
                    }
                }
                
                if (questing!=0){cooldown=8;
                    if (questing=1) and (diplomacy=6){// That +2 counteracts the WAITED TOO LONG penalty
                        scr_dialogue("mission1_refused");
                        scr_quest(3,"300req",6,0);questing=0;
                        diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";exit;
                    }
                }
                
                if (trading_demand&gt;0) and (diplo_option[3]!="Cancel") and (diplo_option[3]!="") then scr_demand(3);
                if (trading_demand&gt;0) and (diplo_option[3]="Cancel"){cooldown=8;trading_demand=0;diplo_option[1]="";diplo_option[2]="";diplo_option[3]="";diplo_text="...";diplo_txt="...";}
            }
        }
        if (force_goodbye!=0) and (cooldown&lt;=0){// Want to check to see if the deal went fine here
            if (trading_artifact!=0){click2=1;
                obj_controller.diplo_option[1]="";obj_controller.diplo_option[2]="";obj_controller.diplo_option[3]="";
                diplomacy=0;menu=0;force_goodbye=0;
                with(obj_popup){instance_destroy();}
                if (trading_artifact!=2) then obj_temp4.alarm[1]=1;
                if (trading_artifact=2) then obj_temp4.alarm[2]=1;
                exit;
            }
        }
    }
    
    
    
    
    
    
    
    // 
    if (trading=1) or (trading=2){
        if (scr_hit(xx+818,yy+796,xx+897,yy+815)=true){// Exit
            cooldown=8;trading=0;scr_dialogue("trade_close");click2=1;
            trade_take[0]="";trade_take[1]="";trade_take[2]="";trade_take[3]="";trade_take[4]="";trade_take[5]="";trade_tnum[0]=0;trade_tnum[1]=0;trade_tnum[2]=0;trade_tnum[3]=0;trade_tnum[4]=0;trade_tnum[5]=0;
            trade_give[0]="";trade_give[1]="";trade_give[2]="";trade_give[3]="";trade_give[4]="";trade_give[5]="";trade_mnum[0]=0;trade_mnum[1]=0;trade_mnum[2]=0;trade_mnum[3]=0;trade_mnum[4]=0;trade_mnum[5]=0;
            if (trading_artifact!=0){diplomacy=0;menu=0;force_goodbye=0;with(obj_popup){instance_destroy();}obj_temp4.alarm[1]=1;exit;}// Also need to disable the popup OFFER TERMS option
        }
        if (scr_hit(xx+510,yy+649,xx+615,yy+668)=true){// Clear Terms
            cooldown=8;click2=1;trade_likely="";
            trade_req=requisition;trade_gene=gene_seed;trade_chip=stc_wargear_un+stc_vehicles_un+stc_ships_un;trade_info=info_chips;
            
            if (trading_artifact=0){
                trade_take[0]="";trade_take[1]="";trade_take[2]="";trade_take[3]="";trade_take[4]="";trade_take[5]="";trade_tnum[0]=0;trade_tnum[1]=0;trade_tnum[2]=0;trade_tnum[3]=0;trade_tnum[4]=0;trade_tnum[5]=0;
            }
            trade_give[0]="";trade_give[1]="";trade_give[2]="";trade_give[3]="";trade_give[4]="";trade_give[5]="";trade_mnum[0]=0;trade_mnum[1]=0;trade_mnum[2]=0;trade_mnum[3]=0;trade_mnum[4]=0;trade_mnum[5]=0;
        }
        if (scr_hit(xx+630,yy+649,xx+735,yy+668)=true){// Trade Here?
            cooldown=8;click2=1;if (diplo_last!="offer") then scr_trade(true);
        }
        
        
        
        var minz,;minz=0;
        if (trade_give[4]="") then minz=4;if (trade_give[3]="") then minz=3;if (trade_give[2]="") then minz=2;if (trade_give[1]="") then minz=1; 
        
        // Opponent things to offer
        if (trading_artifact=0){
            if (scr_hit(xx+342,yy+371,xx+485,yy+422)=true) and (cooldown&lt;=0) and (disposition[diplomacy]&gt;=trade_disp[1]){
                cooldown=8;click2=1;scr_trade_add(string(trade_theirs[1]));
            }
            if (scr_hit(xx+342,yy+422,xx+485,yy+470)=true) and (cooldown&lt;=0) and (disposition[diplomacy]&gt;=trade_disp[2]){
                cooldown=8;click2=1;scr_trade_add(string(trade_theirs[2]));
            }
            if (scr_hit(xx+342,yy+470,xx+485,yy+517)=true) and (cooldown&lt;=0) and (disposition[diplomacy]&gt;=trade_disp[3]){
                cooldown=8;click2=1;scr_trade_add(string(trade_theirs[3]));
            }
            if (scr_hit(xx+342,yy+517,xx+485,yy+564)=true) and (cooldown&lt;=0) and (disposition[diplomacy]&gt;=trade_disp[4]){
                cooldown=8;click2=1;scr_trade_add(string(trade_theirs[4]));
            }
            if (scr_hit(xx+342,yy+564,xx+485,yy+611)=true) and (cooldown&lt;=0) and (disposition[diplomacy]&gt;=trade_disp[5]){
                cooldown=8;click2=1;scr_trade_add(string(trade_theirs[5]));
            }
        }
        
        xx+=419;
        // Player Things to Offer
        if (scr_hit(xx+342,yy+371,xx+485,yy+422)=true) and (minz!=0) and (cooldown&lt;=0) and (trade_req&gt;0){// Requisition
            cooldown=8000;click2=1;
            get_integer2("Requisition offered?",trade_req,"m"+string(minz),"Requisition");
            scr_trade(false);
        }
        if (scr_hit(xx+342,yy+422,xx+485,yy+470)=true) and (minz!=0) and (cooldown&lt;=0) and (trade_gene&gt;0){// "+string(obj_img.organics)+"
            cooldown=8000;click2=1;
            get_integer2(string(obj_img.organics)+" offered?",trade_gene,"m"+string(minz),string(obj_img.organics));
            scr_trade(false);
        }
        if (scr_hit(xx+342,yy+470,xx+485,yy+517)=true) and (minz!=0) and (cooldown&lt;=0) and (trade_chip&gt;0){// STC Fragment
            cooldown=8000;click2=1;
            get_integer2("STC Fragments offered?",trade_chip,"m"+string(minz),"STC Fragment");
            scr_trade(false);
        }
        if (scr_hit(xx+342,yy+517,xx+485,yy+564)=true) and (minz!=0) and (cooldown&lt;=0) and (trade_info&gt;0){// Info Chips
            cooldown=8000;click2=1;
            get_integer2("Info Chips offered?",trade_info,"m"+string(minz),"Info Chip");
            scr_trade(false);
        }
        xx-=419;
        
        
        
        
        // Remove items buttons
        if (trading_artifact=0){
            if (scr_hit(xx+507,yy+399,xx+527,yy+418)=true) and (trade_tnum[2]=0) and (trade_tnum[1]!=0) and (cooldown&lt;=0){
                trade_tnum[1]=0;trade_take[1]="";cooldown=8000;click2=1;scr_trade(false);
            }
            if (scr_hit(xx+507,yy+419,xx+527,yy+438)=true) and (trade_tnum[3]=0) and (trade_tnum[2]!=0) and (cooldown&lt;=0){
                trade_tnum[2]=0;trade_take[2]="";cooldown=8000;click2=1;scr_trade(false);
            }
            if (scr_hit(xx+507,yy+439,xx+527,yy+458)=true) and (trade_tnum[4]=0) and (trade_tnum[3]!=0) and (cooldown&lt;=0){
                trade_tnum[3]=0;trade_take[3]="";cooldown=8000;click2=1;scr_trade(false);
            }
            if (scr_hit(xx+507,yy+459,xx+527,yy+478)=true) and (trade_tnum[4]!=0) and (cooldown&lt;=0){
                trade_tnum[4]=0;trade_take[4]="";cooldown=8000;click2=1;scr_trade(false);
            }
        }
        
        if (scr_hit(xx+507,yy+547,xx+527,yy+566)=true) and (trade_mnum[2]=0) and (trade_mnum[1]!=0) and (cooldown&lt;=0){
            if (trade_give[1]="Requisition") then trade_req+=trade_mnum[1];if (trade_give[1]=string(obj_img.organics)) then trade_gene+=trade_mnum[1];
            if (trade_give[1]="STC Fragment") then trade_chip+=trade_mnum[1];if (trade_give[1]="Info Chip") then trade_info+=trade_mnum[1];
            trade_mnum[1]=0;trade_give[1]="";cooldown=8000;click2=1;scr_trade(false);
        }
        if (scr_hit(xx+507,yy+567,xx+527,yy+586)=true) and (trade_mnum[3]=0) and (trade_mnum[2]!=0) and (cooldown&lt;=0){
            if (trade_give[2]="Requisition") then trade_req+=trade_mnum[2];if (trade_give[2]=string(obj_img.organics)) then trade_gene+=trade_mnum[2];
            if (trade_give[2]="STC Fragment") then trade_chip+=trade_mnum[2];if (trade_give[2]="Info Chip") then trade_info+=trade_mnum[2];
            trade_mnum[2]=0;trade_give[2]="";cooldown=8000;click2=1;scr_trade(false);
        }
        if (scr_hit(xx+507,yy+587,xx+527,yy+606)=true) and (trade_mnum[4]=0) and (trade_mnum[3]!=0) and (cooldown&lt;=0){
            if (trade_give[3]="Requisition") then trade_req+=trade_mnum[3];if (trade_give[3]=string(obj_img.organics)) then trade_gene+=trade_mnum[3];
            if (trade_give[3]="STC Fragment") then trade_chip+=trade_mnum[3];if (trade_give[3]="Info Chip") then trade_info+=trade_mnum[3];
            trade_mnum[3]=0;trade_give[3]="";cooldown=8000;click2=1;scr_trade(false);
        }
        if (scr_hit(xx+507,yy+607,xx+527,yy+626)=true) and (trade_mnum[4]!=0) and (cooldown&lt;=0){
            if (trade_give[4]="Requisition") then trade_req+=trade_mnum[4];if (trade_give[4]=string(obj_img.organics)) then trade_gene+=trade_mnum[4];
            if (trade_give[4]="STC Fragment") then trade_chip+=trade_mnum[4];if (trade_give[4]="Info Chip") then trade_info+=trade_mnum[4];
            trade_mnum[4]=0;trade_give[4]="";cooldown=8000;click2=1;scr_trade(false);
        }
    }
    
}












if (zoomed=0) and (cooldown&lt;=0) and (menu=20) and (diplomacy=0){
    xx+=55;yy-=20;

    // speak with Imperium
    if (mouse_y&gt;=yy+355) and (mouse_y&lt;yy+369){
        if (mouse_x&gt;=xx+194) and (mouse_x&lt;xx+288) and (cooldown&lt;=0) and (faction_defeated[2]=0){
            if (known[2]!=0) and (turns_ignored[2]=0){diplomacy=2;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+292) and (mouse_x&lt;xx+350) and (cooldown&lt;=0) and (faction_defeated[2]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[2]=0) and (onceh=0){onceh=1;ignore[2]=1;}
            if (ignore[2]=1) and (onceh=0){onceh=1;ignore[2]=0;}
        }
    }
    // Mechanicus
    if (mouse_y&gt;=yy+491) and (mouse_y&lt;yy+503){
        if (mouse_x&gt;=xx+194) and (mouse_x&lt;xx+288) and (cooldown&lt;=0) and (faction_defeated[3]=0){
            if (known[3]!=0) and (turns_ignored[3]=0){diplomacy=3;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+292) and (mouse_x&lt;xx+350) and (cooldown&lt;=0) and (faction_defeated[3]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[3]=0) and (onceh=0){onceh=1;ignore[3]=1;}
            if (ignore[3]=1) and (onceh=0){onceh=1;ignore[3]=0;}
        }
    }
    // Inquisition
    if (mouse_y&gt;=yy+630) and (mouse_y&lt;yy+644){
        if (mouse_x&gt;=xx+194) and (mouse_x&lt;xx+288) and (cooldown&lt;=0) and (faction_defeated[4]=0){
            if (known[4]!=0) and (turns_ignored[4]=0){diplomacy=4;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+292) and (mouse_x&lt;xx+350) and (cooldown&lt;=0) and (faction_defeated[4]=0){
            var onceh;onceh=0;cooldown=9;click2=1;
            if (ignore[4]=0) and (onceh=0){onceh=1;ignore[4]=1;}
            if (ignore[4]=1) and (onceh=0){onceh=1;ignore[4]=0;}
        }
    }
    // Ecclesiarchy
    if (mouse_y&gt;=yy+760) and (mouse_y&lt;yy+774){
        if (mouse_x&gt;=xx+194) and (mouse_x&lt;xx+288) and (cooldown&lt;=0) and (faction_defeated[3]=0){
            if (known[5]!=0) and (turns_ignored[5]=0){diplomacy=5;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+292) and (mouse_x&lt;xx+350) and (cooldown&lt;=0) and (faction_defeated[5]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[5]=0) and (onceh=0){onceh=1;ignore[5]=1;}
            if (ignore[5]=1) and (onceh=0){onceh=1;ignore[5]=0;}
        }
    }
    
    
    
    // speak with Eldar
    if (mouse_y&gt;=yy+355) and (mouse_y&lt;yy+369){
        if (mouse_x&gt;=xx+1203) and (mouse_x&lt;xx+1300) and (cooldown&lt;=0) and (faction_defeated[6]=0){
            if (known[6]!=0) and (turns_ignored[6]=0){diplomacy=6;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+1303) and (mouse_x&lt;xx+1350) and (cooldown&lt;=0) and (faction_defeated[6]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[6]=0) and (onceh=0){onceh=1;ignore[6]=1;}
            if (ignore[6]=1) and (onceh=0){onceh=1;ignore[6]=0;}
        }
    }
    // Orks
    if (mouse_y&gt;=yy+491) and (mouse_y&lt;yy+503){
        if (mouse_x&gt;=xx+1203) and (mouse_x&lt;xx+1300) and (cooldown&lt;=0) and (faction_defeated[7]=0){
            if (known[7]!=0) and (turns_ignored[7]=0){diplomacy=7;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+1303) and (mouse_x&lt;xx+1350) and (cooldown&lt;=0) and (faction_defeated[7]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[7]=0) and (onceh=0){onceh=1;ignore[7]=1;}
            if (ignore[7]=1) and (onceh=0){onceh=1;ignore[7]=0;}
        }
    }
    // Tau
    if (mouse_y&gt;=yy+630) and (mouse_y&lt;yy+644){
        if (mouse_x&gt;=xx+1203) and (mouse_x&lt;xx+1300) and (cooldown&lt;=0) and (faction_defeated[8]=0){
            if (known[8]!=0) and (turns_ignored[8]=0){diplomacy=8;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+1303) and (mouse_x&lt;xx+1350) and (cooldown&lt;=0) and (faction_defeated[8]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[8]=0) and (onceh=0){onceh=1;ignore[8]=1;}
            if (ignore[8]=1) and (onceh=0){onceh=1;ignore[8]=0;}
        }
    }
    // Heretics
    if (mouse_y&gt;=yy+760) and (mouse_y&lt;yy+774){
        if (mouse_x&gt;=xx+1203) and (mouse_x&lt;xx+1300) and (cooldown&lt;=0) and (faction_defeated[10]=0){
            if (known[10]!=0) and (turns_ignored[10]=0){diplomacy=10;cooldown=8000;}
        }
        if (mouse_x&gt;=xx+1303) and (mouse_x&lt;xx+1350) and (cooldown&lt;=0) and (faction_defeated[10]=0){
            var onceh;onceh=0;cooldown=8000;click2=1;
            if (ignore[10]=0) and (onceh=0){onceh=1;ignore[10]=1;}
            if (ignore[10]=1) and (onceh=0){onceh=1;ignore[10]=0;}
        }
    }
    
    
    
    if (diplomacy&gt;0) and (cooldown=8000){var onceh;onceh=0;
        if (known[diplomacy]=1) and (diplomacy!=4) and (onceh=0){scr_dialogue("intro");onceh=1;known[diplomacy]=2;faction_justmet=1;}
        if (known[diplomacy]&gt;=2) and (diplomacy!=4) and (onceh=0){scr_dialogue("hello");onceh=1;}
        
        if (known[4]=1) and (diplomacy=4) and (onceh=0){scr_dialogue("intro");onceh=1;known[diplomacy]=2;faction_justmet=1;obj_controller.last_mission=turn+1;}
        if (known[4]=3) and (diplomacy=4) and (onceh=0){scr_dialogue("intro");onceh=1;known[diplomacy]=4;faction_justmet=1;obj_controller.last_mission=turn+1;}
        if (known[diplomacy]&gt;=4) and (diplomacy=4) and (onceh=0){scr_dialogue("hello");onceh=1;}
    }
    

}


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_saveload</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_drop_select</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_popup_dialogue</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_ncombat</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>422</id>
        <kind>1</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (combat!=0) then exit;
if (scrollbar_engaged!=0) then exit;
if (instance_exists(obj_ingame_menu)) then exit;


if (instance_exists(obj_turn_end)) and (obj_controller.complex_event!=true) and (!instance_exists(obj_temp_meeting)){
    if (obj_turn_end.popups_end=1) and (audience=0) and (cooldown&lt;=0) then with(obj_turn_end){instance_destroy();}
}


if (instance_exists(obj_turn_end)) and (audience=0) then exit;
if (instance_exists(obj_star_select)) then exit;
if (instance_exists(obj_bomb_select)) then exit;



if (zoomed=0) and (cooldown&lt;=0) and (menu&gt;=500) and (menu&lt;=510){
    /*if (mouse_y&gt;=view_yview[0]+0) and (mouse_y&lt;view_yview[0]+26){
        if (mouse_x&gt;=view_xview[0]+559) and (mouse_x&lt;view_xview[0]+623){
            show_message("Exit");cooldown=8000;click=1;
        }
    }*/
    
    if (mouse_y&gt;=view_yview[0]+27){
        cooldown=8000;
        if (menu&gt;=500) and (temp[menu-434]=""){menu=0;exit;}
        // if (menu=502) and (temp[68]=""){menu=0;exit;}
        if (menu&lt;503) and (menu!=0) then menu+=1;
    }
}

if (menu&gt;=500) then exit;


var zoomeh, diyst, onceh, xx, yy;
zoomeh=0;diyst=999;onceh=0;
xx=view_xview[0];yy=view_yview[0];

zoomeh=zoomed;


if (menu=0) then hide_banner=0;// 136 ; 




if (zoomed=0) and (!instance_exists(obj_ingame_menu)) and (!instance_exists(obj_popup)){
    if (scr_hit(xx+1485,yy+7,xx+1589,yy+48)=true){// Menu
        instance_create(0,0,obj_ingame_menu);
    }
    if (scr_hit(xx+1375,yy+7,xx+1480,yy+48)=true) and (cooldown&lt;=0){// Menu - Help
        /*var igm,butt;igm=instance_create(0,0,obj_ingame_menu);
        igm.settings=1;with(obj_new_button){x-=2000;y-=2000;}
        butt=instance_create(xx+653,yy+664,obj_new_button);butt.sprite_index=spr_ui_but_1;
        butt.depth=-20010;butt.button_text="Exit";butt.button_id=1;butt.scaling=1.5;butt.target=26;*/
        
        if (menu!=17.5) and (onceh=0){menu=17.5;onceh=1;cooldown=8000;click=1;hide_banner=0;instance_activate_object(obj_event_log);obj_event_log.top=1;obj_event_log.help=1;}
        if (menu=17.5) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;hide_banner=0;}
        managing=0;
    }
}



if (instance_exists(obj_temp_build)){
    if (obj_temp_build.new=1) then exit;
}


if (zoomed=0) and (cooldown&lt;=0) and (diplomacy=0){

    // ship panel minimize
    if (popup=1) or (popup=2){
        if (mouse_x&gt;=view_xview[0]+18+obj_fleet_select.void_wid) and (mouse_y&gt;=view_yview[0]+116)
         and (mouse_x&lt;view_xview[0]+36+obj_fleet_select.void_wid) and (mouse_y&lt;view_yview[0]+134) and (cooldown&lt;=0){
        // if (mouse_x&gt;=xx+32) and (mouse_y&gt;=yy+48) and (mouse_x&lt;xx+298) and (mouse_y&lt;yy+66) and (cooldown&lt;=0){
            if (fleet_minimized=0) and (cooldown&lt;=0){fleet_minimized=1;cooldown=8000;click=1;}
            if (fleet_minimized=1) and (cooldown&lt;=0){fleet_minimized=0;cooldown=8000;click=1;}
        }
    }



    if (mouse_y&gt;=yy+0) and (mouse_y&lt;yy+26){
        if (mouse_x&gt;=xx+431) and (mouse_x&lt;xx+496){menu=999;zui=1;cooldown=8000;click=1;var sv;sv=instance_create(x,y,obj_saveload);sv.menu=1;}
        if (mouse_x&gt;=xx+496) and (mouse_x&lt;xx+559){menu=999;zui=1;cooldown=8000;click=1;var sv;sv=instance_create(x,y,obj_saveload);sv.menu=2;}
        if (mouse_x&gt;=xx+559) and (mouse_x&lt;xx+623){menu=999;cooldown=8000;click=1;
            with(obj_ini){instance_destroy();}
            room_goto(Main_Menu);
            with(obj_controller){instance_destroy();}
            instance_destroy();
        }
    }
    if (mouse_x&gt;=xx+36) and (mouse_y&gt;=yy+837) and (mouse_x&lt;xx+176) and (mouse_y&lt;yy+877){// Management
        if (menu!=1)and (onceh=0){
            scr_management(1);menu=1;onceh=1;cooldown=8000;click=1;
            popup=0;selected=0;hide_banner=1;
            with(obj_star_select){instance_destroy();}
            with(obj_fleet_select){instance_destroy();}
        }
        if (menu=1) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;hide_banner=0;}
        managing=0;
    }
    if (mouse_x&gt;=xx+179) and (mouse_y&gt;=yy+837) and (mouse_x&lt;xx+321) and (mouse_y&lt;yy+877){// Settings
        onceh=0;
        if (menu!=21) and (onceh=0){onceh=1;
            menu=21;cooldown=8000;click=1;
            popup=0;selected=0;hide_banner=1;
            with(obj_star_select){instance_destroy();}
            with(obj_fleet_select){instance_destroy();}
        }
        if (menu=21) and (onceh=0){onceh=0;
            if (settings=0) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;hide_banner=0;}
            if (settings&gt;0) and (onceh=0){menu=21;onceh=1;cooldown=8000;click=1;settings=0;}
        }
    }
    
    
    if (mouse_x&gt;=xx+358) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+471) and (mouse_y&lt;yy+879){// Apothecarium
        menu_adept=0;hide_banner=1;if (scr_role_count("Master of the Apothecarion","0")=0) then menu_adept=1;
        if (menu!=11) and (onceh=0){menu=11;onceh=1;cooldown=8000;click=1;temp[36]=scr_role_count(obj_ini.role[100,15],"");}
        if (menu=11) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;}
        managing=0;
    }
    
    if (mouse_x&gt;=xx+474) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+587) and (mouse_y&lt;yy+879){// Reclusium
        menu_adept=0;hide_banner=1;if (scr_role_count("Master of Sanctity","0")=0) then menu_adept=1;
        if (menu!=12) and (onceh=0){
            menu=12;onceh=1;
            cooldown=8000;
            click=1;
            temp[36]=string(scr_role_count(obj_ini.role[100,14],"field"));temp[37]=string(scr_role_count(obj_ini.role[100,14],"home"));
            penitorium=0;
            
            var c,e,p;c=-1;e=0;p=0;// Get lis of penitent dudes?
            repeat(11){
                c+=1;e=0;
                repeat(250){e+=1;
                    if (obj_ini.god[c,e]&gt;=10){
                        p+=1;penit_co[p]=c;penit_id[p]=e;penitorium+=1;
                    }
                }
            }
        }
        if (menu=12) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;}
        managing=0;
    }
    
    if (mouse_x&gt;=xx+591) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+704) and (mouse_y&lt;yy+879){// Librarium
        menu_adept=0;hide_banner=1;if (scr_role_count("Chief "+string(obj_ini.role[100,17]),"0")=0) then menu_adept=1;
        if (menu!=13) and (onceh=0){menu=13;onceh=1;cooldown=8000;click=1;
            if (artifacts&gt;0) and (menu_artifact=0) then menu_artifact=1;
            temp[36]=scr_role_count(obj_ini.role[100,17],"");
            temp[37]=scr_role_count("Codiciery","");
            temp[38]=scr_role_count("Lexicanum","");
        }
        if (menu=13) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;}
        managing=0;
    }
    
    if (mouse_x&gt;=xx+707) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+820) and (mouse_y&lt;yy+879){// Armamentarium
        menu_adept=0;hide_banner=1;if (scr_role_count("Forge Master","0")=0) then menu_adept=1;
        if (menu!=14) and (onceh=0){menu=14;onceh=1;cooldown=8000;click=1;temp[36]=scr_role_count(obj_ini.role[100,16],"");
        temp[37]=temp[36]+scr_role_count(string(obj_ini.role[100,16])+" Aspirant","");}
        if (menu=14) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;}
        managing=0;
    }
    
    if (mouse_x&gt;=xx+805) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+918) and (mouse_y&lt;yy+879){// Recruiting
        var geh,good;good=0;geh=0;
        repeat(50){geh+=1;if (good=0){if (obj_ini.role[10,geh]=obj_ini.role[100,5]) and (obj_ini.name[10,geh]=obj_ini.recruiter_name) then good=geh;}}
        if (geh=0) then menu_adept=1;
        
        menu_adept=0;hide_banner=1;
        if (menu!=15) and (onceh=0){menu=15;onceh=1;cooldown=8000;click=1;}
        if (menu=15) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;}
        managing=0;
    }
    
    if (mouse_x&gt;=xx+939) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+1052) and (mouse_y&lt;yy+879){// Master of the Fleet
        menu_adept=0;hide_banner=1;
        var geh,good;good=0;geh=0;
        repeat(50){geh+=1;if (good=0){if (obj_ini.role[4,geh]=obj_ini.role[100,5]) and (obj_ini.name[10,geh]=obj_ini.lord_admiral_name) then good=geh;}}
        if (geh=0) then menu_adept=1;
        
        if (menu!=16) and (onceh=0){
            menu=16;onceh=1;cooldown=8000;click=1;
            temp[37]="";temp[38]="";temp[39]="";temp[40]="";temp[41]="";
            temp[101]="";temp[102]="";temp[103]="";temp[104]="";
            temp[105]="";temp[106]="";temp[107]="";temp[108]="";
            temp[109]="";temp[110]="";temp[112]="";temp[114]="";
            temp[116]="";temp[118]="";temp[119]="";
            
            var i,g,u,m,d;i=0;g=0;u=0;m=0;d=0;
            i=0;g=0;repeat(60){i+=1;if (obj_ini.ship[i]!="") and (obj_ini.ship_size[i]=3) then g+=1;}temp[37]=string(g);
            i=0;g=0;repeat(60){i+=1;if (obj_ini.ship[i]!="") and (obj_ini.ship_size[i]=2) then g+=1;}temp[38]=string(g);
            i=0;g=0;repeat(60){i+=1;if (obj_ini.ship[i]!="") and (obj_ini.ship_size[i]=1) then g+=1;}temp[39]=string(g);
            i=0;g=0;u=0;
            repeat(60){i+=1;
                if (g!=0) and (obj_ini.ship[i]!=""){if ((obj_ini.ship_hp[i]/obj_ini.ship_maxhp[i])&lt;u){g=i;u=obj_ini.ship_hp[i]/obj_ini.ship_maxhp[i];}}
                if (g=0) and (obj_ini.ship[i]!=""){g=i;u=obj_ini.ship_hp[i]/obj_ini.ship_maxhp[i];}
                if (obj_ini.ship[i]!="") then m=i;
                if (obj_ini.ship[i]!="") and ((obj_ini.ship_hp[i]/obj_ini.ship_maxhp[i])&lt;0.25) then d+=1;
            }
            if (g!=0){temp[40]=string(obj_ini.ship_class[g])+" '"+string(obj_ini.ship[g])+"'";temp[41]=string(u);temp[42]=string(d);}
            man_max=m;
            man_current=1;
        }
        if (menu=16) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;}
        managing=0;
    }
    
    
    
    /*diyst=point_distance(mouse_x,mouse_y,xx+608,yy+453);
    if (diyst&lt;=-5) and (!instance_exists(obj_turn_end)){// End turn
        
    }*/
    
    
    
    
    if (mouse_x&gt;=xx+1131) and (mouse_y&gt;=yy+838) and (mouse_x&lt;xx+1273) and (mouse_y&lt;yy+879){// Diplomacy
        if (menu!=20) and (onceh=0){menu=20;onceh=1;cooldown=8000;click=1;hide_banner=1;}
        if (menu=20) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;hide_banner=0;}
        managing=0;
    }
    
    if (scr_hit(xx+1275,yy+838,xx+1417,yy+879)=true){// Event Log
        if (menu!=17) and (onceh=0){menu=17;onceh=1;cooldown=8000;click=1;hide_banner=1;instance_activate_object(obj_event_log);obj_event_log.top=1;}
        if (menu=17) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;hide_banner=0;}
        managing=0;
    }
    
    if (mouse_x&gt;=xx+1420) and (mouse_y&gt;=yy+837) and (mouse_x&lt;xx+1562) and (mouse_y&lt;yy+877){// End Turn
        if (menu=0) and (cooldown&lt;=0){
            cooldown=8;menu=0;
            
            if (!instance_exists(obj_turn_end)) then ok=1;
            if (instance_exists(obj_turn_end)){if (obj_turn_end.popups_end=1) then ok=1;}
            
            if (ok=1){
                with(obj_turn_end){instance_destroy();}
                with(obj_star_event){instance_destroy();}
                cooldown=8;audio_play_sound(snd_end_turn,-50,0);
                audio_sound_gain(snd_end_turn,master_volume*effect_volume,0);
                
                turn+=1;
                
                with(obj_star){
                    present_fleet[1]=0;present_fleet[2]=0;present_fleet[3]=0;present_fleet[4]=0;present_fleet[5]=0;
                    present_fleet[6]=0;present_fleet[7]=0;present_fleet[8]=0;present_fleet[9]=0;present_fleet[10]=0;
                    present_fleet[13]=0;present_fleet[20]=0;
                }
                with(obj_p_fleet){
                    if (action="move") and (obj_controller.faction_status[2]="War"){
                        var him;him=instance_nearest(action_x,action_y,obj_star);
                        if (point_distance(action_x,action_y,him.x,him.y)&lt;10){
                            him.present_fleet[20]=1;
                        }
                    }
                }
                with(obj_en_fleet){
                    if (action="move") and (owner&gt;5){
                        var him;him=instance_nearest(action_x,action_y,obj_star);
                        if (point_distance(action_x,action_y,him.x,him.y)&lt;10){
                            him.present_fleet[20]=1;
                        }
                    }
                }
                
                if (instance_exists(obj_p_fleet)){obj_p_fleet.alarm[1]=1;}
                if (instance_exists(obj_en_fleet)){obj_en_fleet.alarm[1]=1;}
                if (instance_exists(obj_crusade)){obj_crusade.alarm[0]=2;}
                
                requisition+=income;scr_income();gene_tithe-=1;
                
                // Do that after the combats and all of that crap
                
                with(obj_star){
                    ai_a=2;ai_b=3;ai_c=4;ai_d=5;ai_e=5;
                    if (p_type[1]="Craftworld"){
                        // instance_create(x,y,obj_temp4);
                        instance_deactivate_object(id);
                        // x=-5000;
                    }
                }
                alarm[5]=6;instance_create(0,0,obj_turn_end);scr_turn_first();
            }
        }
        
        if (menu=1) and (onceh=0){menu=0;onceh=1;cooldown=8000;click=1;hide_banner=0;}
        managing=0;
    }
    
    
    
    
    
    // if (mouse_x&gt;=xx+512) and (mouse_y&gt;=yy+449) and (mouse_x&lt;xx+575) and (mouse_y&lt;yy+472){show_message("Log");cooldown=8000;click=1;}
       
}




if (zoomed=0) and (menu=40) and (cooldown&lt;=0){
    var xx, yy;xx=xx+0;yy=yy+0;

    if (mouse_x&gt;=xx+73) and (mouse_y&gt;=yy+69) and (mouse_x&lt;xx+305) and (mouse_y&lt;yy+415){
        menu=41;cooldown=8000;
    }
    if (mouse_x&gt;=xx+336) and (mouse_y&gt;=yy+69) and (mouse_x&lt;xx+568) and (mouse_y&lt;yy+415){
        menu=42;cooldown=8000;
    }
}



if (zoomed=0) and (menu=1) and (managing=0) and (cooldown&lt;=0) and (diplomacy=0){// Main management screen
    var xx, yy;managing=0;
    
    
    xx=xx+0;yy=yy+0;
    if (mouse_x&gt;=xx+248) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+392) and (mouse_y&lt;yy+80+64){managing=11;cooldown=8000;}// HQ
    if (mouse_x&gt;=xx+136) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+248) and (mouse_y&lt;yy+80+64){managing=12;cooldown=8000;}// Apoth
    if (mouse_x&gt;=xx+392) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+504) and (mouse_y&lt;yy+80+144){managing=13;cooldown=8000;}// Librar
    if (mouse_x&gt;=xx+136) and (mouse_y&gt;=yy+144) and (mouse_x&lt;xx+248) and (mouse_y&lt;yy+160+64){managing=14;cooldown=8000;}// Reclus
    if (mouse_x&gt;=xx+248) and (mouse_y&gt;=yy+144) and (mouse_x&lt;xx+392) and (mouse_y&lt;yy+160+64){managing=15;cooldown=8000;}// Armory
    xx+=16;
    if (mouse_x&gt;=xx+24) and (mouse_y&gt;=yy+224) and (mouse_x&lt;xx+136) and (mouse_y&lt;yy+256+64){managing=1;cooldown=8000;}
    if (mouse_x&gt;=xx+136) and (mouse_y&gt;=yy+224) and (mouse_x&lt;xx+248) and (mouse_y&lt;yy+256+64){managing=2;cooldown=8000;}
    if (mouse_x&gt;=xx+248) and (mouse_y&gt;=yy+224) and (mouse_x&lt;xx+360) and (mouse_y&lt;yy+256+64){managing=3;cooldown=8000;}
    if (mouse_x&gt;=xx+360) and (mouse_y&gt;=yy+224) and (mouse_x&lt;xx+472) and (mouse_y&lt;yy+256+64){managing=4;cooldown=8000;}
    if (mouse_x&gt;=xx+472) and (mouse_y&gt;=yy+224) and (mouse_x&lt;xx+584) and (mouse_y&lt;yy+256+64){managing=5;cooldown=8000;}
    if (mouse_x&gt;=xx+24) and (mouse_y&gt;=yy+320) and (mouse_x&lt;xx+136) and (mouse_y&lt;yy+352+64){managing=6;cooldown=8000;}// Companies 6-10
    if (mouse_x&gt;=xx+136) and (mouse_y&gt;=yy+320) and (mouse_x&lt;xx+248) and (mouse_y&lt;yy+352+64){managing=7;cooldown=8000;}
    if (mouse_x&gt;=xx+248) and (mouse_y&gt;=yy+320) and (mouse_x&lt;xx+360) and (mouse_y&lt;yy+352+64){managing=8;cooldown=8000;}
    if (mouse_x&gt;=xx+360) and (mouse_y&gt;=yy+320) and (mouse_x&lt;xx+472) and (mouse_y&lt;yy+352+64){managing=9;cooldown=8000;}
    if (mouse_x&gt;=xx+472) and (mouse_y&gt;=yy+320) and (mouse_x&lt;xx+584) and (mouse_y&lt;yy+352+64){managing=10;cooldown=8000;}
    
    
    
    if (mouse_x&gt;=xx+426) and (mouse_y&gt;=yy+421) and (mouse_x&lt;xx+556) and (mouse_y&lt;yy+443){
        managing=0;cooldown=8000;menu=40;
    }
    
    /*
    draw_rectangle(xx+426,yy+421,xx+556,yy+443,0);
    */
    
    
    
    
    if (managing!=0) and (managing&lt;=15){
        var i;i=-1;man_size=0;selecting_location="";selecting_types="";selecting_ship=0;sel_uid=0;
        repeat(501){i+=1;
            man[i]="";ide[i]=0;man_sel[i]=0;ma_lid[i]=0;ma_wid[i]=0;ma_uid[i]=0;
            ma_race[i]=0;ma_loc[i]="";ma_name[i]="";ma_role[i]="";ma_wep1[i]="";
            ma_wep2[i]="";ma_armor[i]="";ma_health[i]=100;ma_chaos[i]=0;ma_exp[i]=0;ma_promote[i]=0;
            sh_ide[i]=0;sh_uid[i]=0;sh_name[i]="";sh_class[i]="";sh_loc[i]="";sh_hp[i]="";sh_cargo[i]=0;sh_cargo_max[i]="";
            squad[i]=0;
        }
        alll=0;
        if (managing&lt;=10) then scr_company_view(managing);
        if (managing&gt;10) then scr_special_view(managing);
        cooldown=10;sel_loading=0;unload=0;alarm[6]=7;
    }
}


if (zoomed=0) and (menu=1) and (managing&gt;0) and (cooldown&lt;=0){
    var xx,yy;xx=xx+0;yy=yy+0;
    
    if (mouse_x&gt;=xx+23) and (mouse_y&gt;=yy+80) and (mouse_x&lt;xx+95) and (mouse_y&lt;yy+128){// Back out from company
        managing=0;cooldown=8000;scr_ui_refres();scr_management(1);cooldown=8000;click=1;popup=0;selected=0;hide_banner=1;
    }
    if (mouse_x&gt;=xx+424) and (mouse_y&gt;=yy+80) and (mouse_x&lt;xx+496) and (mouse_y&lt;yy+128) and (cooldown&lt;=0){// Previous company
        var onceh;onceh=0;text_bar=0;
        if (managing&gt;1) and (managing&lt;=10) and (onceh=0){scr_ui_refres();managing-=1;cooldown=8000;onceh=1;scr_company_view(managing);}
        if (managing&gt;11) and (onceh=0){scr_ui_refres();managing-=1;cooldown=8000;onceh=1;scr_special_view(managing);}
        if (managing=1) and (onceh=0){scr_ui_refres();managing=15;cooldown=8000;onceh=1;scr_special_view(managing);}
    }
    if (mouse_x&gt;=xx+1105) and (mouse_y&gt;=yy+80) and (mouse_x&lt;xx+1178) and (mouse_y&lt;yy+128) and (cooldown&lt;=0){// Next company
        var onceh;onceh=0;text_bar=0;
        if (managing&lt;10) and (onceh=0){scr_ui_refres();managing+=1;cooldown=8000;onceh=1;scr_company_view(managing);}
        if (managing&gt;10) and (managing&lt;15) and (onceh=0){scr_ui_refres();managing+=1;cooldown=8000;onceh=1;scr_special_view(managing);}
        if (managing=15) and (onceh=0){scr_ui_refres();managing=1;cooldown=8000;onceh=1;scr_company_view(managing);}
    }
}



if (zoomed=0) and (menu=30) and (managing&gt;0) and (cooldown&lt;=0){// This is the back button at LOADING TO SHIPS
    var xx, yy;xx=xx+0;yy=yy+0;
    
    if (mouse_x&gt;=xx+22) and (mouse_y&gt;=yy+84) and (mouse_x&lt;xx+98) and (mouse_y&lt;yy+126){menu=1;cooldown=8000;}
}




if (menu=1) and (managing&gt;0){                       // Selecting individual marines
    var xx, yy, x1, y1,eventing, bb;bb="";
    xx=view_xview[0]+0;yy=view_yview[0]+0;
    var top,sel,temp1,temp2,temp3,temp4,temp5;temp1="";temp2="";temp3="";temp4="";temp5="";
    top=man_current;var stop;stop=0;sel=top;eventing=false;
    
    if (man_size=0) then alll=0;
    
    // selecting all
    if (mouse_x&gt;=xx+1281) and (mouse_y&gt;=yy+607) and (mouse_x&lt;xx+1409) and (mouse_y&lt;yy+636) and (cooldown&lt;=0) and (alll=0){cooldown=8;scr_load_all(true);selecting_types="%!@";}
    if (mouse_x&gt;=xx+1281) and (mouse_y&gt;=yy+607) and (mouse_x&lt;xx+1409) and (mouse_y&lt;yy+636) and (cooldown&lt;=0) and (alll=1){cooldown=8;scr_load_all(false);selecting_types="";}
    
    
    // This clicks on the squad_sel button
    yy+=77;x1=xx;y1=yy;
    var squad_sel;squad_sel=0;
    if (cooldown&lt;=0) then repeat(min(man_max,man_see)){
        repeat(500){if (man[sel]="hide") then sel+=1;}
        if (mouse_x&gt;=xx+25) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+25+8) and (mouse_y&lt;yy+85){
            if (squad_sel=0) and (squad[sel]!=0){squad_sel=squad[sel];cooldown=8;}
        }
        yy+=21;sel+=1;
    }
    
    // This is the 'select all of type' buttons
    sel=1;yy=view_yview[0]+77;
    if (sel_all!=""){
        // repeat(min(man_max,man_see)){
        if (sel_all!="Command") and (sel_all!="man") and (sel_all!="vehicle") then scr_load_decide_loc("unit role",sel_all,false);
        if (sel_all!="Command") and (sel_all!="man") and (sel_all!="vehicle") then scr_load_decide_loc("unit role",sel_all,true);
        if (sel_all="man") then scr_load_decide_loc("man","man",false);
        if (sel_all="vehicle") then scr_load_decide_loc("vehicle","vehicle",true);
        if (sel_all="Command") then scr_load_decide_loc("command","command",false);
        
        repeat(man_max){eventing=false;
        
            // Prevent selecting marines that are in an event
            if (fest_repeats&gt;0){
                if (fest_planet=0) and (fest_sid&gt;0) and (ma_lid[sel]=fest_sid){eventing=true;}
                if (fest_planet=1) and (fest_wid&gt;0) and (ma_wid[sel]=fest_wid) and (ma_loc[sel]=fest_star){eventing=true;}
            }
            
            
            if (sel_all!="Command") and (sel_all!="man") and (sel_all!="vehicle"){// Selects all men of type
                if (man[sel]="man") and (ma_role[sel]=sel_all) and (ma_loc[sel]!="Terra") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_loc[sel]!="Lost") and (ma_god[sel]&lt;10) and ((ma_loc[sel]=selecting_location) or (selecting_location="")) and ((ma_wid[sel]=selecting_planet) or (selecting_planet=0)) and ((ma_lid[sel]=selecting_ship) or (selecting_ship=0)) and (eventing=false){var onceh;onceh=0;
                    if (man_sel[sel]=0) and (onceh=0){man_sel[sel]=1;man_size+=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;if (selecting_location="") and (ma_lid[sel]&gt;0){selecting_location=obj_ini.ship_location[ma_lid[sel]];selecting_ship=ma_lid[sel];sel_loading=1;}}
                    if (man_sel[sel]=1) and (onceh=0){man_sel[sel]=0;man_size-=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;}
                }
            }
            if (sel_all!="Command") and (sel_all!="man") and (sel_all!="vehicle"){// Selects all vehicles of type
                if (man[sel]="vehicle") and (ma_role[sel]=sel_all) and (ma_loc[sel]!="Terra") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_loc[sel]!="Lost") and (ma_god[sel]&lt;10) and ((ma_loc[sel]=selecting_location) or (selecting_location="")) and ((ma_wid[sel]=selecting_planet) or (selecting_planet=0)) and ((ma_lid[sel]=selecting_ship) or (selecting_ship=0)) and (eventing=false){var onceh;onceh=0;
                    if (man_sel[sel]=0) and (onceh=0){man_sel[sel]=1;man_size+=scr_unit_size("",ma_role[sel],true);onceh=1;if (selecting_location="") and (ma_lid[sel]&gt;0){selecting_location=obj_ini.ship_location[ma_lid[sel]];selecting_ship=ma_lid[sel];sel_loading=1;}}
                    if (man_sel[sel]=1) and (onceh=0){man_sel[sel]=0;man_size-=scr_unit_size("",ma_role[sel],true);onceh=1;}
                }
            }
            if (sel_all="man"){// Selects all men
                if (man[sel]="man") and (ma_loc[sel]!="Terra") and (ma_loc[sel]!="Lost") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_god[sel]&lt;10) and ((ma_loc[sel]=selecting_location) or (selecting_location="")) and ((ma_wid[sel]=selecting_planet) or (selecting_planet=0)) and ((ma_lid[sel]=selecting_ship) or (selecting_ship=0)) and (eventing=false){var onceh;onceh=0;
                    if (man_sel[sel]=0) and (onceh=0){man_sel[sel]=1;man_size+=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;if (selecting_location="") and (ma_lid[sel]&gt;0){selecting_location=obj_ini.ship_location[ma_lid[sel]];selecting_ship=ma_lid[sel];sel_loading=1;}}
                    if (man_sel[sel]=1) and (onceh=0){man_sel[sel]=0;man_size-=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;}
                }
            }
            if (sel_all="vehicle"){// Selects all vehicles
                if (man[sel]="vehicle") and (ma_loc[sel]!="Terra") and (ma_loc[sel]!="Lost") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_god[sel]&lt;10) and ((ma_loc[sel]=selecting_location) or (selecting_location="")) and ((ma_wid[sel]=selecting_planet) or (selecting_planet=0)) and ((ma_lid[sel]=selecting_ship) or (selecting_ship=0)) and (eventing=false){var onceh;onceh=0;
                    if (man_sel[sel]=0) and (onceh=0){man_sel[sel]=1;man_size+=scr_unit_size("",ma_role[sel],true);onceh=1;if (selecting_location="") and (ma_lid[sel]&gt;0){selecting_location=obj_ini.ship_location[ma_lid[sel]];selecting_ship=ma_lid[sel];sel_loading=1;}}
                    if (man_sel[sel]=1) and (onceh=0){man_sel[sel]=0;man_size-=scr_unit_size("",ma_role[sel],true);onceh=1;}
                }
            }
            // Selecting command
            if (sel_all="Command") and (man[sel]="man") and (ma_loc[sel]!="Terra") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_god[sel]&lt;10) and ((ma_loc[sel]=selecting_location) or (selecting_location="")) and ((ma_wid[sel]=selecting_planet) or (selecting_planet=0)) and ((ma_lid[sel]=selecting_ship) or (selecting_ship=0)) and (eventing=false){var yep;yep=0;
                if (managing&gt;0) and (managing&lt;=10){
                    if (ma_role[sel]=obj_ini.role[100,5]) or (ma_role[sel]=obj_ini.role[100,14]) then yep=1;
                    if (ma_role[sel]=obj_ini.role[100,15]) or (ma_role[sel]=obj_ini.role[100,16]) then yep=1;
                    if (ma_role[sel]=obj_ini.role[100,17]) then yep=1;
                    if (ma_role[sel]="Codiciery") or (ma_role[sel]="Lexicanum") then yep=1;
                    if (ma_role[sel]="Standard Bearer") then yep=1;
                    if (ma_role[sel]="Company Champion") then yep=1;
                    if (ma_role[sel]="Champion") then yep=1;
                }
                if (yep=1){var onceh;onceh=0;
                    if (man_sel[sel]=0) and (onceh=0){man_sel[sel]=1;man_size+=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;if (selecting_location="") and (ma_lid[sel]&gt;0){selecting_location=obj_ini.ship_location[ma_lid[sel]];selecting_ship=ma_lid[sel];sel_loading=1;}}
                    if (man_sel[sel]=1) and (onceh=0){man_sel[sel]=0;man_size-=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;}
                
                
                
                
                /*
                if (ma_role[sel]=obj_ini.role[100,5]) or (ma_role[sel]=obj_ini.role[100,14]) then yep=1;
                if (ma_role[sel]=obj_ini.role[100,15]) or (ma_role[sel]=obj_ini.role[100,17]) then yep=1;
                if (ma_role[sel]="Codiciery") or (ma_role[sel]="Lexicanum") then yep=1;
                if (ma_role[sel]="Standard Bearer") then yep=1;
                if (yep=1){var onceh;onceh=0;
                    if (man_sel[sel]=0) and (onceh=0){man_sel[sel]=1;man_size+=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;}
                    if (man_sel[sel]=1) and (onceh=0){man_sel[sel]=0;man_size-=scr_unit_size(ma_armor[sel],ma_role[sel],true);onceh=1;}*/
                }
            }
            yy+=20;sel+=1;
        }
        sel_all="";
    }
    
    
    sel=top;yy=view_yview[0]+77;
    repeat(min(man_max,man_see)){
        repeat(500){if (man[sel]="hide") then sel+=1;}
        eventing=false;
        
        if ((mouse_x&gt;=xx+25+8) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+974) and (mouse_y&lt;yy+85) and (cooldown&lt;=0)) or ((squad[sel]=squad_sel) and (squad_sel!=0)){
            
            /*if (mouse_x&lt;=xx+37) and (man[sel]="man") and (ma_role[sel]=obj_img.faction_title[1]){
                cooldown=30;menu=50;click2=1;
                exit;
            }*/
            
            var onceh,dib;onceh=0;stop=0;dib=0;                   // This is the actual individual click right here
            
            eventing=false;
        
            
            // Prevent selecting marines that are in an event
            if (fest_repeats&gt;0){
                if (fest_planet=0) and (fest_sid&gt;0) and (ma_lid[sel]=fest_sid){eventing=true;}
                if (fest_planet=1) and (fest_wid&gt;0) and (ma_wid[sel]=fest_wid) and (ma_loc[sel]=fest_star){eventing=true;}
            }
            
            
            // Register double click
            if (ma_god[sel]&lt;10) and (ma_loc[sel]!="Terra") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_loc[sel]!="Lost") and (eventing=false){
                if (double_click&gt;5) and (sel=double_was) then dib=1;
            }
            
            if ((man_sel[sel]=0) and (onceh=0) and (ma_god[sel]&lt;10) and (ma_loc[sel]!="Terra") and (ma_loc[sel]!=string(obj_img.faction_short[3])+" Vessel") and (ma_loc[sel]!="Lost") and (eventing=false)) or (dib=1){
                if (selecting_location="") and (man[sel]="man"){
                    selecting_location=ma_loc[sel];selecting_ship=ma_lid[sel];selecting_planet=ma_wid[sel];// sel_uid=ma_uid[sel];
                }
                if (selecting_location="") and (man[sel]="vehicle"){
                    selecting_location=ma_loc[sel];selecting_ship=ma_lid[sel];selecting_planet=ma_wid[sel];// sel_uid=ma_uid[sel];
                }
                
                if (selecting_location!="") and (man[sel]="man") and (ma_loc[sel]!=selecting_location) then stop=1;
                if (selecting_location!="") and (man[sel]="vehicle") and (ma_loc[sel]!=selecting_location) then stop=1;
                
                if (man[sel]="man") and (ma_lid[sel]!=sel_loading) and (sel_loading!=0) then stop=1;
                if (man[sel]="vehicle") and (ma_lid[sel]!=sel_loading) and (sel_loading!=0) then stop=1;
                
                // Continue with double click
                if (dib=1) and (stop!=1){
                    // show_message("selecting all "+string(ma_role[sel])+" at "+string(selecting_location));
                    
                    var bi;bi=0;
                    repeat(300){bi+=1;
                        if (man_sel[bi]=0) and (ma_god[bi]&lt;10) and (ma_loc[bi]!="Terra") and (ma_loc[bi]!=string(obj_img.faction_short[3])+" Vessel") and (ma_loc[bi]!="Lost"){
                            if (ma_loc[bi]=selecting_location) and (ma_role[bi]=ma_role[double_was]) and (bi!=double_was){
                                man_sel[bi]=1;
                                
                                if (man[bi]="man") then man_size+=scr_unit_size(ma_armor[bi],ma_role[bi],true);
                                if (man[bi]="vehicle") then man_size+=scr_unit_size("",ma_role[bi],true);
                            }
                        }
                    }
                    
                    double_was=0;
                    cooldown=8;
                    click2=1;
                    stop=1;
                    
                    exit;
                }
                
                cooldown=8;click2=1;double_click+=12;double_was=sel;
                
                if (stop!=1){
                    onceh=1;man_sel[sel]=1;
                    if (string_count("%!@",selecting_types)=0){
                        if (man[sel]="man") then selecting_types+=string(ma_role[sel]);
                        if (man[sel]="vehicle") then selecting_types+=string(ma_role[sel]);
                    }
                    
                    // check for location here
                    if (man[sel]="man") and (ma_lid[sel]&gt;0) then sel_loading=ma_lid[sel];
                    if (man[sel]="vehicle") and (ma_lid[sel]&gt;0) then sel_loading=ma_lid[sel];
                    
                    if (man[sel]="man") then man_size+=scr_unit_size(ma_armor[sel],ma_role[sel],true);
                    if (man[sel]="vehicle") then man_size+=scr_unit_size("",ma_role[sel],true);
                }
                
            }
            if (man_sel[sel]=1) and (onceh=0){
                onceh=1;man_sel[sel]=0;cooldown=8;click2=1;
                if (string_count("%!@",selecting_types)=0){
                    if (man[sel]="man") and (string_count(ma_role[sel],selecting_types)&gt;0) then selecting_types=string_replace(selecting_types,ma_role[sel],"");
                    if (man[sel]="vehicle") and (string_count(ma_role[sel],selecting_types)&gt;0) then selecting_types=string_replace(selecting_types,ma_role[sel],"");
                }
                
                if (man[sel]="man") then man_size-=scr_unit_size(ma_armor[sel],ma_role[sel],true);
                if (man[sel]="vehicle") then man_size-=scr_unit_size("",ma_role[sel],true);
                
                if (man_size=0) then sel_loading=0;
            }
        }
        yy+=20;
        sel+=1;
    }
    if (sel_all!="") then sel_all="";
    // End selecting
    
    xx=xx+0;yy=view_yview[0]+0;
    
    if (mouse_x&gt;=xx+1018) and (mouse_y&gt;yy+805) and (mouse_x&lt;xx+1018+141) and (mouse_y&lt;yy+831){
        if (man_size&gt;0) and (sel_loading=0) and (selecting_location!="Terra") and (selecting_location!=string(obj_img.faction_short[3])+" Vessel"){// Load to ship
            scr_company_load(selecting_location);
            menu=30;cooldown=8000;top=1;exit;
        }
        
        if (man_size&gt;0) and (sel_loading&gt;=1) and (!instance_exists(obj_star_select)) and (selecting_location!="Terra") and (selecting_location!=string(obj_img.faction_short[3])+" Vessel") and (selecting_location!=obj_img.travel){// Unload - ask for planet confirmation
            cooldown=8000;
            var boba;boba=0;
            
            with(obj_temp3){instance_destroy();}
            with(obj_star){if (name=obj_ini.ship_location[obj_controller.selecting_ship]) then instance_create(x,y,obj_temp3);}
            
            if (instance_exists(obj_temp3)){boba=instance_nearest(x,y,obj_star);if (boba.space_hulk=1) and (boba.name=obj_ini.ship_location[obj_controller.selecting_ship]) then with(obj_temp3){instance_destroy();}}
            
            if (instance_exists(obj_temp3)){boba=instance_create(obj_temp3.x,obj_temp3.y,obj_star_select);
                boba.loading=1;
                boba.loading_name=obj_ini.ship_location[selecting_ship];// selecting location is the ship right now; get it's orbit location
                boba.depth=self.depth-50;
                // sel_uid=obj_ini.ship_uid[selecting_ship];
                scr_company_load(obj_ini.ship_location[selecting_ship]);
            }
            with(obj_temp3){instance_destroy();}
        
            
            
        }
    }
    // Other buttons go here
    
    
    // Change equipment
    if (mouse_x&gt;=xx+1018+141) and (mouse_y&gt;yy+805) and (mouse_x&lt;xx+1297) and (mouse_y&lt;yy+831) and (selecting_location!="Terra") and (selecting_location!=string(obj_img.faction_short[3])+" Vessel") and (otha=0){// Change Equipment
        if (man_size&gt;0) and (instance_number(obj_popup)=0){
            var f,god,nuuum;f=0;god=0;nuuum=0;
            var o_wep1,o_wep2,o_armor,o_gear,o_mobi;
            var b_wep1,b_wep2,b_armor,b_gear,b_mobi;
            var vih;vih=0;
            o_wep1="";o_wep2="";o_armor="";o_gear="";o_mobi="";
            b_wep1=0;b_wep2=0;b_armor=0;b_gear=0;b_mobi=0;
            
            repeat(man_max){// Need to make sure that no vehicles are selected
                f+=1;
                
                if (man[f]="man") and (man_sel[f]=1) and (vih=0) then vih=1;// If come across a man, set vih to 1
                if (man[f]="vehicle") and (man_sel[f]=1) and (vih=0) then vih=2;// If come across a vehicle, set vih to 2
                
                if (man[f]="man") and (man_sel[f]=1) and (vih=2) then vih=-1;// If there is a selected man, and vih=2, then stop
                if (man[f]="vehicle") and (man_sel[f]=1) and (vih=1) then vih=-1;// If there is a selected vehicle, and vih=1, then stop
                
                if (man_sel[f]=1) and (vih!=-1){nuuum+=1;
                    if (o_wep1="") and (ma_wep1[f]!="") then o_wep1=ma_wep1[f];
                    if (o_wep2="") and (ma_wep2[f]!="") then o_wep2=ma_wep2[f];
                    if (o_armor="") and (ma_armor[f]!="") then o_armor=ma_armor[f];
                    if (o_gear="") and (ma_gear[f]!="") then o_gear=ma_gear[f];
                    if (o_mobi="") and (ma_mobi[f]!="") then o_mobi=ma_mobi[f];
                    
                    if (ma_wep1[f]="") then b_wep1+=1;if (ma_wep2[f]="") then b_wep2+=1;
                    if (ma_armor[f]="") then b_armor+=1;if (ma_gear[f]="") then b_gear+=1;
                    if (ma_mobi[f]="") then b_mobi+=1;
                    
                    if ((o_wep1!="") and (ma_wep1[f]!=o_wep1)) or (b_wep1=1) then o_wep1="Assortment";
                    if ((o_wep2!="") and (ma_wep2[f]!=o_wep2)) or (b_wep2=1) then o_wep2="Assortment";
                    if ((o_armor!="") and (ma_armor[f]!=o_armor)) or (b_armor=1) then o_armor="Assortment";
                    if ((o_gear!="") and (ma_gear[f]!=o_gear)) or (b_gear=1) then o_gear="Assortment";
                    if ((o_mobi!="") and (ma_mobi[f]!=o_mobi)) or (b_mobi=1) then o_mobi="Assortment";
                }
            }// End repeat
            
            /*if (o_wep1!="") and (string_count("&amp;",o_wep1)&gt;0) then o_wep1=clean_tags(o_wep1);
            if (o_wep2!="") and (string_count("&amp;",o_wep2)&gt;0) then o_wep2=clean_tags(o_wep2);
            if (o_armor!="") and (string_count("&amp;",o_armor)&gt;0) then o_armor=clean_tags(o_armor);
            if (o_gear!="") and (string_count("&amp;",o_gear)&gt;0) then o_gear=clean_tags(o_gear);
            if (o_mobi!="") and (string_count("&amp;",o_mobi)&gt;0) then o_mobi=clean_tags(o_mobi);*/
            
            if (b_wep1=nuuum) then o_wep1="";
            if (b_wep2=nuuum) then o_wep2="";
            if (b_armor=nuuum) then o_armor="";
            if (b_gear=nuuum) then o_gear="";
            if (b_mobi=nuuum) then o_mobi="";
            
            // show_message(string(vih));
            
            if (vih&gt;0) and (man_size&gt;0){
                var pip;pip=instance_create(0,0,obj_popup);pip.type=6;
                pip.o_wep1=o_wep1;pip.o_wep2=o_wep2;pip.o_armor=o_armor;pip.o_gear=o_gear;
                pip.n_wep1=o_wep1;pip.n_wep2=o_wep2;pip.n_armor=o_armor;pip.n_gear=o_gear;
                pip.o_mobi=o_mobi;pip.n_mobi=o_mobi;
                pip.company=managing;pip.units=nuuum;if (vih=2) then pip.vehicle_equipment=1;
                
                if (o_wep1!="") and (string_count("&amp;",o_wep1)&gt;0) then pip.a_wep1=clean_tags(o_wep1);
                if (o_wep2!="") and (string_count("&amp;",o_wep2)&gt;0) then pip.a_wep2=clean_tags(o_wep2);
                if (o_armor!="") and (string_count("&amp;",o_armor)&gt;0) then pip.a_armor=clean_tags(o_armor);
                if (o_gear!="") and (string_count("&amp;",o_gear)&gt;0) then pip.a_gear=clean_tags(o_gear);
                if (o_mobi!="") and (string_count("&amp;",o_mobi)&gt;0) then pip.a_mobi=clean_tags(o_mobi);
            }
        }
    }
    
    // Reset equipment
    if (mouse_x&gt;=xx+1018+141) and (mouse_y&gt;yy+805-26) and (mouse_x&lt;xx+1297) and (mouse_y&lt;yy+831-26) and (selecting_location!="Terra") and (selecting_location!=string(obj_img.faction_short[3])+" Vessel") and (man_size&gt;0){// Reset Equipment
        var f,god,nuuum;f=0;god=0;nuuum=0;
        o_wep1="";o_wep2="";o_armor="";o_gear="";o_mobi="";
        b_wep1=0;b_wep2=0;b_armor=0;b_gear=0;b_mobi=0;
        
        repeat(man_max){f+=1;
            if (man[f]="man") and (man_sel[f]=1) then nuuum+=1;// If come across a man, set vih to 1
        }
    
        var pip;pip=instance_create(0,0,obj_popup);pip.type=6;
        pip.o_wep1="Assortment";pip.o_wep2="Assortment";pip.o_armor="Assortment";pip.o_gear="Assortment";pip.o_mobi="Assortment";
        pip.n_wep1="Assortment";pip.n_wep2="Assortment";pip.n_armor="Assortment";pip.n_gear="Assortment";pip.n_mobi="Assortment";
        pip.company=managing;pip.units=nuuum;pip.alarm[1]=1;
    }
    
    // Promote
    if (mouse_x&gt;=xx+1297) and (mouse_y&gt;yy+805) and (mouse_x&lt;xx+1436) and (mouse_y&lt;yy+831) and (selecting_location!="Terra") and (selecting_location!=string(obj_img.faction_short[3])+" Vessel") and (man_size&gt;0){// Promote
        if (sel_promoting=1) and (instance_number(obj_popup)=0){// and (managing&gt;=0) and (managing&lt;11){
            var pip;pip=instance_create(0,0,obj_popup);
            pip.type=5;pip.company=managing;
            
            var f,god,nuuum;f=0;god=0;nuuum=0;
            repeat(man_max){
                f+=1;
                if (ma_promote[f]&gt;=1) and (man_sel[f]=1){nuuum+=1;
                    if (pip.min_exp=0) then pip.min_exp=ma_exp[f];
                    pip.min_exp=min(ma_exp[f],pip.min_exp);
                }
                if (god=0) and (ma_promote[f]&gt;=1) and (man_sel[f]=1){god=1;pip.unit_role=ma_role[f];}
            }
            if (nuuum&gt;1) then pip.unit_role="Marines";
            pip.units=nuuum;
        }
    }
    
    
    if (mouse_x&gt;=xx+1438) and (mouse_y&gt;=yy+803) and (mouse_x&lt;xx+1578) and (mouse_y&lt;yy+831) and (man_size&gt;0){var f;f=0;// Jail
        repeat(man_max){f+=1;
            if (man[f]="man") and (man_sel[f]=1) and (ma_loc[f]!="Terra") and (ma_loc[f]!=string(obj_img.faction_short[3])+" Vessel"){
                if (ma_god[f]&lt;10) and (managing&lt;=10){ma_god[f]+=10;obj_ini.god[managing,ide[f]]+=10;}
                if (ma_god[f]&lt;10) and (managing&gt;10) and (managing&lt;20){ma_god[f]+=10;obj_ini.god[0,ide[f]]+=10;}
            }
        }
        with(obj_controller){
            var i;i=-1;man_size=0;selecting_location="";selecting_types="";selecting_ship=0;sel_uid=0;
            repeat(501){i+=1;
                man[i]="";ide[i]=0;man_sel[i]=0;ma_lid[i]=0;ma_wid[i]=0;ma_uid[i]=0;
                ma_race[i]=0;ma_loc[i]="";ma_name[i]="";ma_role[i]="";ma_wep1[i]="";
                ma_wep2[i]="";ma_armor[i]="";ma_health[i]=100;ma_chaos[i]=0;ma_exp[i]=0;ma_promote[i]=0;
                sh_ide[i]=0;sh_uid[i]=0;sh_name[i]="";sh_class[i]="";sh_loc[i]="";sh_hp[i]="";sh_cargo[i]=0;sh_cargo_max[i]="";
            }
            alll=0;
            if (managing&lt;=10) then scr_company_view(managing);
            if (managing&gt;20) then scr_company_view(managing);
            if (managing&gt;10) and (managing&lt;=20) then scr_special_view(managing);
            cooldown=8000;sel_loading=0;unload=0;alarm[6]=7;
        }
    }
    
    
    // Add bionics to marine(s)
    if (scr_hit(xx+1300+141,yy+779,xx+1436+141,yy+801)=true) and (man_size&gt;0) and (cooldown&lt;=0){
        var bionics_before,bionics_after,p,cah;
        p=0;cooldown=8000;cah=managing;if (cah&gt;10) then cah=0;
        bionics_before=scr_item_count("Bionics");bionics_after=bionics_before;temp[114]="refresh";
        if (bionics_before&gt;0) then repeat(500){p+=1;
            if (man_sel[p]=1) and (man[p]="man") and (bionics_after&gt;0) and (obj_ini.bio[cah,ide[p]]&lt;10) and (obj_ini.loc[cah,ide[p]]!="Terra") and (obj_ini.loc[cah,ide[p]]!=string(obj_img.faction_short[3])+" Vessel"){
                if (string_count("Dread",ma_armor[p])=0){
                    obj_ini.bio[cah,ide[p]]+=1;bionics_after-=1;
                    obj_ini.hp[cah,ide[p]]=min(obj_ini.hp[cah,ide[p]]+30,100);
                    if (global.chapter_name="Iron Hands") then obj_ini.hp[cah,ide[p]]=min(obj_ini.hp[cah,ide[p]]+20,100);
                    ma_bio[p]=obj_ini.bio[cah,ide[p]];ma_health[p]=obj_ini.hp[cah,ide[p]];
                    if (ma_promote[p]=10) then ma_promote[p]=0;
                }
            }
        }
        
        if (bionics_before!=bionics_after){click=1;scr_add_item("Bionics",bionics_after-bionics_before);}
    }
    
    
    // Set boarders; simple as that
    if (scr_hit(xx+1018,yy+779,xx+1018+141,yy+801)=true) and (man_size&gt;0) and (cooldown&lt;=0){
        var p,cah;p=0;cooldown=8000;cah=managing;if (cah&gt;10) then cah=0;temp[114]="refresh";
        repeat(500){p+=1;
            if (man_sel[p]=1) and (man[p]="man") and (obj_ini.lid[cah,ide[p]]&gt;0) and (obj_ini.loc[cah,ide[p]]!=string(obj_img.faction_short[3])+" Vessel"){var onk;onk=0;
                if (obj_ini.age[cah,ide[p]]==floor(obj_ini.age[cah,ide[p]])) and (onk=0){
                    if (ma_role[p]!=obj_ini.role[100,6]) and (ma_role[p]!="Venerable "+string(obj_ini.role[100,6])) and (string_count("Dread",ma_armor[p])=0){
                        obj_ini.age[cah,ide[p]]+=0.01;onk=1;
                    }
                }
                if (obj_ini.age[cah,ide[p]]!=floor(obj_ini.age[cah,ide[p]])) and (onk=0){obj_ini.age[cah,ide[p]]=floor(obj_ini.age[cah,ide[p]]);onk=1;}
            }
        }
    }
    
    
    
    
    
    if (mouse_x&gt;=xx+1297) and (mouse_y&gt;yy+777) and (mouse_x&lt;xx+1436) and (mouse_y&lt;yy+804) and (selecting_location!="Terra") and (selecting_location!=string(obj_img.faction_short[3])+" Vessel") and (man_size&gt;0){// Transfer
        if (instance_number(obj_popup)=0){// and (managing&gt;=0) and (managing&lt;11){
            var pip;pip=instance_create(0,0,obj_popup);
            pip.type=5.1;pip.company=managing;
            
            var f,god,nuuum,nuuum2,checky,check_number;f=0;god=0;nuuum=0;nuuum2=0;checky=0;check_number=0;
            repeat(man_max){f+=1;
                if (god=0) and (man_sel[f]=1) and (man[f]="man"){god=1;pip.unit_role=ma_role[f];}
                if (god=0) and (man_sel[f]=1) and (man[f]="vehicle"){god=1;pip.unit_role=ma_role[f];}
                if (man_sel[f]=1){
                    if (man[f]="man"){
                        nuuum+=1;checky=1;
                        if (ma_role[f]=obj_ini.role[100,7]) then checky=0;
                        if (ma_role[f]=obj_ini.role[100,14]) then checky=0;
                        if (ma_role[f]=obj_ini.role[100,15]) then checky=0;
                        if (ma_role[f]=obj_ini.role[100,16]) then checky=0;
                        if (ma_role[f]=obj_ini.role[100,17]) then checky=0;
                        if (checky=1) then check_number+=1;
                    }
                    if (man[f]="vehicle") then nuuum2+=1;
                }
            }
            if (nuuum&gt;1) then pip.unit_role="Marines";
            if (nuuum2&gt;1) then pip.unit_role="Vehicles";
            if (nuuum&gt;0) and (nuuum2&gt;0) then pip.unit_role="Units";
            pip.units=nuuum+nuuum2;
            if (nuuum&gt;0) and (check_number&gt;0){if (obj_controller.command_set[1]=0){cooldown=8000;with(pip){instance_destroy();}}}
        }
    }
    
    
    
    
    
    
}



// Selecting a ship to load to      load to ship
if (menu=30) and (managing&gt;0){// Selecting the ship
    var xx, yy, bb, q;bb="";
    xx=xx+0;
    yy=yy+0;
    var top,sel,temp1,temp2,temp3,temp4,temp5;temp1="";temp2="";temp3="";temp4="";temp5="";
    top=ship_current;var stop;stop=0;sel=top;
    
    var wombat;wombat=0;
    sel_uid=sh_uid[sel];
    
    yy=yy+77;
    
    if (cooldown&lt;=0) then repeat(min(ship_max,ship_see)){
        
        if (mouse_x&gt;=xx+25+8) and (mouse_y&gt;=yy+64) and (mouse_x&lt;xx+974) and (mouse_y&lt;yy+85) and (cooldown&lt;=0) and (((sh_cargo[sel]+man_size)&lt;=sh_cargo_max[sel])){
            var onceh, q;onceh=0;stop=0;q=0;
            
            repeat(500){q+=1;
                if (man[q]="man") and (ma_loc[q]=selecting_location) and (sh_loc[sel]=selecting_location){// load man to ship
                    if ((sh_cargo[sel]+man_size)&lt;=sh_cargo_max[sel]) and (man_sel[q]!=0){
                    
                        
                        wombat=sel;
                        
                        ma_loc[q]=sh_name[sel];
                        ma_lid[q]=sh_ide[sel];
                        ma_wid[q]=0;
                        ma_uid[q]=sh_uid[sel];
                        
                        
                        if (managing&lt;=10){
                            loc[managing,q]=sh_name[sel];obj_ini.lid[managing,ide[q]]=sh_ide[sel];obj_ini.wid[managing,ide[q]]=0;
                            obj_ini.uid[managing,ide[q]]=sel_uid;
                        }
                        if (managing&gt;10){
                            loc[0,q]=sh_name[sel];obj_ini.lid[0,ide[q]]=sh_ide[sel];obj_ini.wid[0,ide[q]]=0;
                            obj_ini.uid[0,ide[q]]=sel_uid;
                        }
                        
                        
                    }
                }
                if (man[q]="vehicle") and (ma_loc[q]=selecting_location) and (sh_loc[sel]=selecting_location){// load vehicle to ship
                    if ((sh_cargo[sel]+man_size)&lt;=sh_cargo_max[sel]) and (man_sel[q]!=0){
                    
                        wombat=sel;
                        
                        ma_loc[q]=sh_name[sel];
                        ma_lid[q]=sh_ide[sel];
                        ma_wid[q]=0;
                        ma_uid[q]=sh_uid[sel];
                        veh_loc[managing,q]=sh_name[sel];
                        
                        
                        // if (managing&lt;=10){obj_ini.veh_lid[managing,ide[q]]=sel;obj_ini.veh_wid[managing,ide[q]]=0;}
                        // if (managing&gt;10){obj_ini.veh_lid[0,ide[q]]=sel;obj_ini.veh_wid[0,ide[q]]=0;}
                        
                        if (managing&lt;=10){
                            obj_ini.veh_lid[managing,ide[q]]=sh_ide[sel];obj_ini.veh_wid[managing,ide[q]]=0;
                            obj_ini.veh_uid[managing,ide[q]]=sel_uid;
                        }
                        if (managing&gt;10){
                            obj_ini.veh_lid[0,ide[q]]=sh_ide[sel];obj_ini.veh_wid[0,ide[q]]=0;
                            obj_ini.veh_uid[0,ide[q]]=sel_uid;
                        }
                        
                    }
                }
            }
            
            // Right here decrease the size of stuff on that planet
            // Need to find the obj_star that the controller is loading from
            
            var xb, yb, god, tiber;
            xb=0;yb=0;god=0;tiber=0;
            
            repeat(200){
                if (god=0){
                    xb=random(room_width);
                    yb=random(room_height);
                    tiber=instance_nearest(xb,yb,obj_star);
                    
                    if (tiber.name=selecting_location) then god=1;
                    if (tiber.name!=selecting_location) then instance_deactivate_object(tiber);
                }
            }
            
            if (god=1){
                tiber.p_player[selecting_planet]-=man_size;
                // 135;
                // also need the wid here
            }
            
            instance_activate_object(obj_star);
            
            
            
            
            
            /*
            with(obj_star_select){// This marks that there are forces upon this planet
                if (p_player[obj_controller.unload]=0) then p_player[obj_controller.unload]+=obj_controller.man_size;
            }
            */
            
            
            
            
            
            
            obj_ini.ship_carrying[sh_ide[sel]]+=man_size;
            
            man_size=0;man_current=1;
            menu=1;cooldown=8;
            
            var k;k=0;repeat(500){k+=1;man_sel[k]=0;}
            
        }
        yy+=20;
        sel+=1;
        
    }
    // End selecting
    
    
    
    
    
    xx=xx+0;
    yy=yy+0;
}



if (menu=50) and (managing&gt;0) and (cooldown&lt;=0){
    if (mouse_x&gt;=xx+217) and (mouse_y&gt;=yy+28) and (mouse_x&lt;xx+250) and (mouse_y&lt;yy+59){
        cooldown=8;menu=1;click=1;
    }
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>424</id>
        <kind>2</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (instance_exists(obj_ncombat)) then exit;
if (instance_exists(obj_fleet)) then exit;
if (global.load&gt;0) then exit;
if (invis=true) then exit;

if (test_map=true){
    draw_set_color(c_yellow);draw_set_alpha(0.5);
    draw_line_width(room_width/2,room_height/2,(room_width/2)+lengthdir_x(3000,terra_direction),(room_height/2)+lengthdir_y(3000,terra_direction),4);
    draw_set_alpha(1);
}

// if (instance_exists(obj_turn_end)) then exit;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_ui_manage</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_ui_advisors</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_ui_diplomacy</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_ui_settings</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// Main UI




if (zoomed=0) and (zui=0){
    draw_sprite(spr_new_ui,0,view_xview[0]+0,view_yview[0]+0);
    
    // Buttons here
    draw_sprite(spr_ui_but_4,0,view_xview[0]+1374,view_yview[0]+8);
    draw_sprite(spr_ui_but_4,0,view_xview[0]+1484,view_yview[0]+8);
    
    draw_sprite(spr_ui_but_1,new_buttons_frame,view_xview[0]+34,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_1,new_buttons_frame,view_xview[0]+179,view_yview[0]+838+y_slide);
    
    draw_sprite(spr_ui_but_3,new_buttons_frame,view_xview[0]+357,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_3,new_buttons_frame,view_xview[0]+473,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_3,new_buttons_frame,view_xview[0]+590,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_3,new_buttons_frame,view_xview[0]+706,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_3,new_buttons_frame,view_xview[0]+822,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_3,new_buttons_frame,view_xview[0]+938,view_yview[0]+838+y_slide);
    
    draw_sprite(spr_ui_but_1,new_buttons_frame,view_xview[0]+1130,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_1,new_buttons_frame,view_xview[0]+1275,view_yview[0]+838+y_slide);
    draw_sprite(spr_ui_but_2,new_buttons_frame,view_xview[0]+1420,view_yview[0]+838+y_slide);
    
    // Highlight here
    draw_set_blend_mode(bm_add);
    
    draw_set_alpha(h_options*2);if (h_options&gt;0) then draw_sprite(spr_ui_hov_4,0,view_xview[0]+1374,view_yview[0]+8+y_slide);
    draw_set_alpha(h_menu*2);if (h_menu&gt;0) then draw_sprite(spr_ui_hov_4,0,view_xview[0]+1484,view_yview[0]+8+y_slide);
    
    draw_set_alpha(h_manage*2);if (h_manage&gt;0) then draw_sprite(spr_ui_hov_1,0,view_xview[0]+34,view_yview[0]+838+y_slide);
    draw_set_alpha(h_settings*2);if (h_settings&gt;0) then draw_sprite(spr_ui_hov_1,0,view_xview[0]+179,view_yview[0]+838+y_slide);
    draw_set_alpha(h_diplomacy*2);if (h_diplomacy&gt;0) then draw_sprite(spr_ui_hov_1,0,view_xview[0]+1130,view_yview[0]+838+y_slide);
    draw_set_alpha(h_log*2);if (h_log&gt;0) then draw_sprite(spr_ui_hov_1,0,view_xview[0]+1275,view_yview[0]+838+y_slide);
    draw_set_alpha(h_turn*2);if (h_turn&gt;0) then draw_sprite(spr_ui_hov_2,0,view_xview[0]+1420,view_yview[0]+838+y_slide);
    
    draw_set_alpha(h_apothecarium*2);if (h_apothecarium&gt;0) then draw_sprite(spr_ui_hov_3,0,view_xview[0]+357,view_yview[0]+838+y_slide);
    draw_set_alpha(h_reclusium*2);if (h_reclusium&gt;0) then draw_sprite(spr_ui_hov_3,0,view_xview[0]+473,view_yview[0]+838+y_slide);
    draw_set_alpha(h_librarium*2);if (h_librarium&gt;0) then draw_sprite(spr_ui_hov_3,0,view_xview[0]+590,view_yview[0]+838+y_slide);
    draw_set_alpha(h_armory*2);if (h_armory&gt;0) then draw_sprite(spr_ui_hov_3,0,view_xview[0]+706,view_yview[0]+838+y_slide);
    draw_set_alpha(h_recruitment*2);if (h_recruitment&gt;0) then draw_sprite(spr_ui_hov_3,0,view_xview[0]+822,view_yview[0]+838+y_slide);
    draw_set_alpha(h_fleet*2);if (h_fleet&gt;0) then draw_sprite(spr_ui_hov_3,0,view_xview[0]+938,view_yview[0]+838+y_slide);
    
    draw_set_blend_mode(bm_normal);
    draw_set_alpha(1);
    
    
    
    
    
    
    // Text here
    draw_set_color(c_white);
    draw_set_halign(fa_center);
    draw_set_font(fnt_cul_18);
    
    draw_text(view_xview[0]+1427,view_yview[0]+14,"Help");
    draw_text(view_xview[0]+1537,view_yview[0]+14,"Menu");
    
    if (y_slide&gt;0) then draw_set_alpha((100-(y_slide*2))/100);
    
    draw_text(view_xview[0]+1488,view_yview[0]+843+y_slide,"End Turn");
    draw_set_font(fnt_cul_14);
    draw_text(view_xview[0]+416,view_yview[0]+847+y_slide,string(obj_img.hq_medical));
    draw_text(view_xview[0]+530,view_yview[0]+847+y_slide,"Reclusium");
    draw_text(view_xview[0]+647,view_yview[0]+847+y_slide,string(obj_img.hq_library));
    draw_text(view_xview[0]+764,view_yview[0]+847+y_slide,string(obj_img.hq_forge));
    draw_text(view_xview[0]+878,view_yview[0]+847+y_slide,"Recruitment");
    draw_text(view_xview[0]+994,view_yview[0]+847+y_slide,"Fleet");
    draw_text(view_xview[0]+1198,view_yview[0]+847+y_slide,"Diplomacy");
    draw_text(view_xview[0]+1344,view_yview[0]+847+y_slide,"Event Log");
    draw_text_ext(view_xview[0]+102,view_yview[0]+838+y_slide,string(obj_img.player_army)+"#Management",18,999);
    draw_text_ext(view_xview[0]+250,view_yview[0]+838+y_slide,string(obj_img.player_army)+"#Settings",18,999);
    
    // Low alpha line here?
    draw_set_alpha(0.15);
    
    if (l_options&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_options&gt;94){l_hei=134-l_options;l_why=min(l_options-96,11);}
       draw_line(view_xview[0]+l_options+1374,view_yview[0]+10+1,view_xview[0]+l_options+1374,view_yview[0]+10+37-l_why);
    }
    if (l_menu&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_menu&gt;94){l_hei=134-l_menu;l_why=min(l_menu-96,11);}
       draw_line(view_xview[0]+l_menu+1484,view_yview[0]+10+1,view_xview[0]+l_menu+1484,view_yview[0]+10+37-l_why);
    }
    
    if (l_manage&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_manage&gt;131){l_hei=171-l_manage;l_why=min(l_manage-133,11);}
        draw_line(view_xview[0]+l_manage+34,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_manage+34,view_yview[0]+840+y_slide+37);
    }
    if (l_settings&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_settings&gt;131){l_hei=171-l_settings;l_why=min(l_settings-133,11);}
        draw_line(view_xview[0]+l_settings+179,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_settings+179,view_yview[0]+840+y_slide+37);
    }
    
    if (l_apothecarium&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_apothecarium&gt;101){l_hei=141-l_apothecarium;l_why=min(l_apothecarium-103,11);}
       draw_line(view_xview[0]+l_apothecarium+357,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_apothecarium+357,view_yview[0]+840+y_slide+37);
    }
    if (l_reclusium&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_reclusium&gt;101){l_hei=141-l_reclusium;l_why=min(l_reclusium-103,11);}
       draw_line(view_xview[0]+l_reclusium+473,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_reclusium+473,view_yview[0]+840+y_slide+37);
    }
    if (l_librarium&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_librarium&gt;101){l_hei=141-l_librarium;l_why=min(l_librarium-103,11);}
       draw_line(view_xview[0]+l_librarium+590,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_librarium+590,view_yview[0]+840+y_slide+37);
    }
    if (l_armory&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_armory&gt;101){l_hei=141-l_armory;l_why=min(l_armory-103,11);}
       draw_line(view_xview[0]+l_armory+706,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_armory+706,view_yview[0]+840+y_slide+37);
    }
    if (l_recruitment&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_recruitment&gt;101){l_hei=141-l_recruitment;l_why=min(l_recruitment-103,11);}
       draw_line(view_xview[0]+l_recruitment+822,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_recruitment+822,view_yview[0]+840+y_slide+37);
    }
    if (l_fleet&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_fleet&gt;101){l_hei=141-l_fleet;l_why=min(l_fleet-103,11);}
       draw_line(view_xview[0]+l_fleet+938,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_fleet+938,view_yview[0]+840+y_slide+37);
    }
    
    if (l_diplomacy&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_diplomacy&gt;131){l_hei=171-l_diplomacy;l_why=min(l_diplomacy-133,11);}
        draw_line(view_xview[0]+l_diplomacy+1130,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_diplomacy+1130,view_yview[0]+840+y_slide+37);
    }
    if (l_log&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_log&gt;131){l_hei=171-l_log;l_why=min(l_log-133,11);}
        draw_line(view_xview[0]+l_log+1275,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_log+1275,view_yview[0]+840+y_slide+37);
    }
    if (l_turn&gt;0){var l_hei,l_why;l_hei=37;l_why=0;if (l_turn&gt;131){l_hei=171-l_turn;l_why=min(l_turn-133,11);}
        draw_line(view_xview[0]+l_turn+1420,view_yview[0]+840+y_slide+1+l_why,view_xview[0]+l_turn+1420,view_yview[0]+840+y_slide+37);
    }
    
    draw_set_alpha(1);
    draw_sprite(spr_new_banner,0,view_xview[0]+1439+new_banner_x,view_yview[0]+62);
    draw_sprite(spr_new_ui_cover,0,view_xview[0]+0,view_yview[0]+(900-17));
    
    if (string_count("custom",obj_ini.icon_name)&gt;0){
    
        var cusl;cusl=string_replace(obj_ini.icon_name,"custom","");cusl=real(cusl);
        if (obj_cuicons.spr_custom[cusl]&gt;0) and (obj_cuicons.spr_custom_icon[cusl]!=-1){
            draw_sprite_stretched(obj_cuicons.spr_custom_icon[cusl],0,view_xview[0]+1451+new_banner_x,view_yview[0]+73,141,141);
        }
    
    
        // if (file_exists(    
        
        /*var cusl;cusl=string_replace(obj_ini.icon_name,"custom","");cusl=real(cusl);
        if (obj_cuicons.spr_custom[cusl]&gt;0) and (sprite_exists(obj_cuicons.spr_custom_icon[cusl])){
            draw_sprite_stretched(obj_cuicons.spr_custom_icon[cusl],0,view_xview[0]+1451+new_banner_x,view_yview[0]+73,141,141);
        }*/
    }
    if (string_count("custom",obj_ini.icon_name)=0){
        var icon_sprite,icc;icon_sprite=spr_icon;icc=obj_ini.icon;
        
        if (icc&lt;=20) then scr_image("creation",icc,view_xview[0]+1451+new_banner_x,view_yview[0]+73,141,141);
        
        if (icc&gt;20){icon_sprite=spr_icon_other;icc-=19;
        draw_sprite(icon_sprite,icc,view_xview[0]+1451+new_banner_x,view_yview[0]+73);}
    }
    
    
    draw_set_color(38144);
    draw_set_font(fnt_menu);
    draw_set_halign(fa_center);
    
    draw_text(view_xview[0]+662,view_yview[0]+17,"Sector "+string(obj_ini.sector_name));
    draw_text(view_xview[0]+662.5,view_yview[0]+17.5,"Sector "+string(obj_ini.sector_name));
    
    
    
    if (obj_controller.faction_status[2]!="War"){
        if (penitent_max=0){
            draw_text(view_xview[0]+887,view_yview[0]+17,"Loyal");
            draw_text(view_xview[0]+887,view_yview[0]+17.5,"Loyal");
        }
        if (penitent_max&gt;0){
            var endb,endb2;endb=0;endb2="";
            endb=min(0,(((penitent_turn+1)*(penitent_turn+1))-120)*-1);
            if (endb&lt;0) then endb2=" "+string(endb);draw_set_color(c_red);
            draw_text(view_xview[0]+887,view_yview[0]+17,string(min(100,floor((penitent_current/penitent_max)*100)))+"% Penitent");
            draw_text(view_xview[0]+887,view_yview[0]+17.5,string(min(100,floor((penitent_current/penitent_max)*100)))+"% Penitent");
            draw_set_color(38144);
            // Need a tooltip for here to display the actual amounts
        }
    }
    if (obj_controller.faction_status[2]="War"){
        draw_set_color(255);
        draw_text(view_xview[0]+887,view_yview[0]+17,"Renegade");
        draw_text(view_xview[0]+887,view_yview[0]+17.5,"Renegade");
        draw_set_color(38144);
    }
    
    
    var wid;wid=1;repeat(10){if ((string_width(string(global.chapter_name))*wid)&gt;140) then wid-=0.1;}
    draw_text_transformed(view_xview[0]+1520+new_banner_x,view_yview[0]+208,string(global.chapter_name),wid,1,0);
    draw_text_transformed(view_xview[0]+1520.5+new_banner_x,view_yview[0]+208.5,string(global.chapter_name),wid,1,0);
    
    var yf;yf="";if (year_fraction&lt;10) then yf="00"+string(year_fraction);
    if (year_fraction&gt;=10) and (year_fraction&lt;100) then yf="0"+string(year_fraction);
    if (year_fraction&gt;=100) then yf=string(year_fraction);
    draw_text(view_xview[0]+1520+new_banner_x,view_yview[0]+228,string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium));
    
    
    
    var inc;inc="";if (income_last&gt;0) then inc="+"+string(round(income_last));if (income_last&lt;0) then inc=string(round(income_last));
    draw_set_font(fnt_40k_14);draw_set_halign(fa_left);
    
    // draw_sprite(spr_new_resource,0,view_xview[0]+14,view_yview[0]+16);draw_set_color(16291875);
    scr_image("resource",0,view_xview[0]+14,view_yview[0]+16,23,17);draw_set_color(16291875);
    draw_text(view_xview[0]+36,view_yview[0]+16,string(floor(requisition))+string(inc));
    draw_text(view_xview[0]+36.5,view_yview[0]+16.5,string(floor(requisition))+string(inc));
    
    // draw_sprite(spr_new_resource,1,view_xview[0]+133+32,view_yview[0]+17);draw_set_color(1164001);
    scr_image("resource",1,view_xview[0]+133+32,view_yview[0]+17,23,17);draw_set_color(1164001);
    draw_text(view_xview[0]+157+32,view_yview[0]+16,string(loyalty));
    draw_text(view_xview[0]+157.5+32,view_yview[0]+16.5,string(loyalty));
    
    // draw_sprite(spr_new_resource,2,view_xview[0]+250,view_yview[0]+17);draw_set_color(c_red);
    scr_image("resource",2,view_xview[0]+250,view_yview[0]+17,23,17);draw_set_color(c_red);
    draw_text(view_xview[0]+267,view_yview[0]+16,string(gene_seed));
    draw_text(view_xview[0]+267.5,view_yview[0]+16.5,string(gene_seed));
    
    // draw_sprite(spr_new_resource,3,view_xview[0]+373-10,view_yview[0]+17);draw_set_color(16291875);
    scr_image("resource",3,view_xview[0]+373-10,view_yview[0]+17,23,17);draw_set_color(16291875);
    draw_text(view_xview[0]+395-10,view_yview[0]+16,string(marines)+"/"+string(command));
    draw_text(view_xview[0]+395.5-10,view_yview[0]+16.5,string(marines)+"/"+string(command));
    
    
    
    
}





draw_set_font(fnt_40k_14b);
draw_set_color(c_red);
draw_set_halign(fa_left);
draw_set_alpha(1);

if (global.cheat_debug=true){
    draw_text(view_xview[0]+1124,view_yview[0]+7,"DEBUG MODE");
}


// draw_text(view_xview[0]+1124,view_yview[0]+7,string(obj_controller.cooldown)+", complex: "+string(obj_controller.complex_event)+", EOT:"+string(instance_number(obj_turn_end)));




// draw_text(view_xview[0]+50,view_yview[0]+50,string(faction_defeated[10]));
// draw_text(view_xview[0]+50,view_yview[0]+50,string(last_weapons_tab));


// draw_text(view_xview[0]+1124,view_yview[0]+50,string(temp[100]));
// draw_text(view_xview[0]+1124,view_yview[0]+50,"Inquisition Known: "+string(known[4]));
// draw_text(view_xview[0]+1124,view_yview[0]+7,string(temp[9000]));
// draw_text(view_xview[0]+1124,view_yview[0]+7,string(obj_controller.main_color)+" / "+string(obj_controller.secondary_color));
// draw_text(view_xview[0]+1124,view_yview[0]+7,string(good_log));
// var haha,e;haha="";e=0;repeat(10){e+=1;if (event[e]!="") then haha+=string(event[e])+"|"+string(event_duration[e])+"|#";}
// draw_text(view_xview[0]+1124,view_yview[0]+7,string(instance_number(obj_star)));
// if (instance_exists(obj_popup)){draw_text(view_xview[0]+1124,view_yview[0]+7,"CD:"+string(obj_popup.cooldown)+" , TC:"+string(obj_popup.target_comp));}
/*if (instance_exists(obj_new_button)){
    draw_text(view_xview[0]+1124,view_yview[0]+7,string(obj_new_button.x)+" , "+string(obj_new_button.y));
}*/
/*if (instance_exists(obj_star)){
    draw_text(view_xview[0]+1124,view_yview[0]+7,string(obj_ini.loc[0,0]));
}*/







/*


if (zoomed=0) and (zui=0){
    if (diplomacy=0) and (menu&lt;500) then draw_sprite(spr_game_ui,0,view_xview[0]+0,view_yview[0]+0);
    if (diplomacy&gt;0) or (menu&gt;=500) then draw_sprite(spr_game_ui_d,0,view_xview[0]+0,view_yview[0]+0);
    
    // Resources here
    
    draw_set_font(fnt_info);
    draw_set_halign(fa_left);
    draw_set_color(16291875);
    
    
    if ((menu=0) or (menu=999)) and (penitent=1){
        draw_set_color(c_red);draw_set_halign(fa_center);
        
        var endb,endb2;endb=0;endb2="";
        endb=min(0,(((penitent_turn+1)*(penitent_turn+1))-120)*-1);
        if (endb&lt;0) then endb2=" "+string(endb);
        draw_text_transformed(view_xview[0]+146,view_yview[0]+32,string(floor((penitent_current/penitent_max)*100))+"% Penitent ("+string(penitent_current)+"/"+string(penitent_max)+""+string(endb2)+")",0.75,0.75,0);
        draw_text_transformed(view_xview[0]+146.5,view_yview[0]+32.5,string(floor((penitent_current/penitent_max)*100))+"% Penitent ("+string(penitent_current)+"/"+string(penitent_max)+""+string(endb2)+")",0.75,0.75,0);
        
        draw_set_halign(fa_left);draw_set_color(16291875);
    }
    
    
    var inc;inc="";if (income_last&gt;0) then inc="+"+string(round(income_last));if (income_last&lt;0) then inc=string(round(income_last));
    draw_text_transformed(view_xview[0]+38,view_yview[0]+6,string(floor(requisition))+string(inc),0.75,0.75,0);
    draw_text_transformed(view_xview[0]+38.5,view_yview[0]+6.5,string(floor(requisition))+string(inc),0.75,0.75,0);
    
    draw_set_color(1164001);
    draw_text_transformed(view_xview[0]+140,view_yview[0]+6,string(loyalty),0.75,0.75,0);
    draw_text_transformed(view_xview[0]+140.5,view_yview[0]+6.5,string(loyalty),0.75,0.75,0);
    
    draw_set_color(c_red);
    draw_text_transformed(view_xview[0]+224,view_yview[0]+6,string(gene_seed),0.75,0.75,0);
    draw_text_transformed(view_xview[0]+224.5,view_yview[0]+6.5,string(gene_seed),0.75,0.75,0);
    
    draw_set_color(16291875);// draw_set_color(16749459);
    draw_text_transformed(view_xview[0]+328,view_yview[0]+6,string(marines),0.75,0.75,0);
    draw_text_transformed(view_xview[0]+328.5,view_yview[0]+6.5,string(marines),0.75,0.75,0);
    
    
    
    
    
    if (menu=0) or (menu=999){
    draw_set_color(c_white);
    draw_rectangle(view_xview[0]+544,view_yview[0]+27,view_xview[0]+622,view_yview[0]+105,0);
    
    if (string_count("custom",obj_ini.icon_name)=0) then draw_sprite(spr_icon,obj_ini.icon,view_xview[0]+544,view_yview[0]+27);
    draw_sprite(spr_icon,0,view_xview[0]+544,view_yview[0]+27);
    
    
    draw_set_halign(fa_center);
    draw_set_font(fnt_menu);
    draw_set_color(38144);
    
    var yf;yf="";
    if (year_fraction&lt;10) then yf="00"+string(year_fraction);
    if (year_fraction&gt;=10) and (year_fraction&lt;100) then yf="0"+string(year_fraction);
    if (year_fraction&gt;=100) then yf=string(year_fraction);
    
    draw_text_transformed(view_xview[0]+584,view_yview[0]+27+80,string(global.chapter_name)+"#Sector "+string(obj_ini.sector_name)+"#"+string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium),0.5,0.5,0);
    draw_text_transformed(view_xview[0]+584,view_yview[0]+27+80.25,string(global.chapter_name)+"#Sector "+string(obj_ini.sector_name)+"#"+string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium),0.5,0.5,0);
}}

    
    

/*if (zoomed=1) and (zui=0){
    // draw_sprite_stretched(spr_game_ui,0,view_xview[1]+0,view_yview[1]+0,1280,960);
    if (menu!=0) then exit;
    draw_set_color(c_white);
    draw_rectangle(1088,54,1244,210,0);
    draw_sprite_stretched(spr_icon,obj_ini.icon,1088,54,160,160);
    draw_sprite_stretched(spr_icon,0,1088,54,160,160);
    
    draw_set_halign(fa_center);
    draw_set_font(fnt_menu);
    draw_set_color(38144);
    
    var yf;yf="";
    if (year_fraction&lt;10) then yf="00"+string(year_fraction);
    if (year_fraction&gt;=10) and (year_fraction&lt;100) then yf="0"+string(year_fraction);
    if (year_fraction&gt;=100) then yf=string(year_fraction);
    
    draw_text_transformed(1088+80,54+160,string(global.chapter_name)+"#Sector "+string(obj_ini.sector_name)+"#"+string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium),1,1,0);
    draw_text_transformed(1088+81,54+161,string(global.chapter_name)+"#Sector "+string(obj_ini.sector_name)+"#"+string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium),1,1,0);
}
*/


// .75555
/*
if (zoomed=1) and (zui=0){
    // draw_sprite_stretched(spr_game_ui,0,view_xview[1]+0,view_yview[1]+0,1280,960);
    if (menu!=0) then exit;
    draw_set_color(c_white);
    draw_rectangle(1088*1.5,54*1.5,1244*1.5,210*1.5,0);
    draw_sprite_stretched(spr_icon,obj_ini.icon,1088*1.5,54*1.5,160*1.5,160*1.5);
    draw_sprite_stretched(spr_icon,0,1088*1.5,54*1.5,160*1.5,160*1.5);
    
    draw_set_halign(fa_center);
    draw_set_font(fnt_menu);
    draw_set_color(38144);
    
    var yf;yf="";
    if (year_fraction&lt;10) then yf="00"+string(year_fraction);
    if (year_fraction&gt;=10) and (year_fraction&lt;100) then yf="0"+string(year_fraction);
    if (year_fraction&gt;=100) then yf=string(year_fraction);
    
    draw_text_transformed((1088+80)*1.5,(54+160)*1.5,string(global.chapter_name)+"#Sector "+string(obj_ini.sector_name)+"#"+string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium),1.5,1.5,0);
    draw_text_transformed((1088+81)*1.5,(54+161)*1.5,string(global.chapter_name)+"#Sector "+string(obj_ini.sector_name)+"#"+string(check_number)+" "+string(yf)+" "+string(year)+".M"+string(millenium),1.5,1.5,0);
}

*/



</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_ui_popup</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="80">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

if (menu=0) and (managing=0) and (formating=0){
    if (instance_number(obj_saveload)=0) and (instance_number(obj_credits)=0) and (instance_number(obj_popup_dialogue)=0){
        get_integer2("Enter in cheatcode",999999,"controller","controller");
    }
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="73">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
/*var onceh;onceh=0;
if (audio_is_playing(snd_royal)=true) then scr_music("blood",2000);
if (audio_is_playing(snd_blood)=true) then scr_music("royal",2000);
*/

/*menu=20;diplomacy=10.1;
scr_dialogue("lol");
*/

/*var g;g=0;
repeat(100){g+=1;
    show_message(string(obj_ini.role[0,g])+": "+string(obj_ini.experience[0,g]));
}*/


// alarm[7]=1;


/*with(obj_star){
    var balh;balh=0;
    if (string_count("WL10",p_feature[1])&gt;0) then balh=1;
    if (string_count("WL10",p_feature[2])&gt;0) then balh=2;
    if (string_count("WL10",p_feature[3])&gt;0) then balh=3;
    if (string_count("WL10",p_feature[4])&gt;0) then balh=4;
    if (balh&gt;0) then show_message(string(name)+" "+scr_roman(balh));
}*/

// loyalty=0;loyalty_hidden=0;


// show_message(string(obj_ini.ship[1])+" location: "+string(obj_ini.ship_location[1]));

// alarm[8]=1;

// menu=20;
// diplomacy=-5.3;

/*var i;i=0;
repeat(100){i+=1;
    if (recent_type[i]!="") then show_message(string(i)+"] "+string(recent_type[i])+"/"+string(recent_keyword[i])+"/"+string(recent_number[i]));
}*/


// show_message(cooldown);

// instance_activate_object(obj_enunit);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="32">
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_ncombat</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_popup</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>cooldown</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>500</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>


if (obj_controller.menu=0) or ((obj_controller.menu=999) and (instance_exists(obj_ncombat))){




if (instance_exists(obj_ncombat)){
    if (obj_ncombat.start=7) then exit;
}








var onceh;
onceh=0;

if (zoomed=0) and (onceh=0){zoomed=1;onceh=1;view_visible[0]=false;view_visible[1]=true;obj_cursor.image_xscale=2;obj_cursor.image_yscale=2;}
if (zoomed=1) and (onceh=0){zoomed=0;onceh=1;view_visible[0]=true;view_visible[1]=false;obj_cursor.image_xscale=1;obj_cursor.image_yscale=1;}



}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="13">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
/*var onceh;onceh=0;
if (new_buttons_hide=0) and (onceh=0){onceh=1;new_buttons_hide=1;}
if (new_buttons_hide=1) and (onceh=0){onceh=1;new_buttons_hide=0;}
*/

// scr_gov_disp("Ariana Prime",1,choose(1,2,3,4,5));
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
