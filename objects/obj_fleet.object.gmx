<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-5000</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
instance_activate_object(obj_controller);
debugl("Fleet Combat Started");

start=0;beg=0;fallen=0;fallen_command=0;
obj_controller.cooldown=20;
sel_x1=0;sel_y1=0;control=0;
ships_selected=0;
battle_special="";
csm_exp=0;star_name="";

// woohoo=0;
left_down=0;

view_x=obj_controller.x;
view_y=obj_controller.y;
obj_controller.x=0;
obj_controller.y=240;
obj_controller.combat=1;
is_zoomed=obj_controller.zoomed;
start=0;combat_end=170;

if (obj_controller.zoomed=0) then with(obj_controller){scr_zoom();}

enemy=0;
enemy_status="attacking";

tempor1=0;
tempor2=0;

player_started=0;
player_lasers=0;
player_lasers_cd=70;
player_lasers_target=0;
pla_fleet=0;
ene_fleet=0;
victory=false;

instance_deactivate_all(true);
instance_activate_object(obj_controller);
instance_activate_object(obj_ini);
instance_activate_object(obj_cursor);
instance_activate_object(obj_img);

column[0]="";column_width[0]=0;// This is determined at the pre-battle screen
column[1]="";column_width[1]=0;
column[2]="";column_width[2]=0;
column[3]="";column_width[3]=0;
column[4]="";column_width[4]=0;
column[5]="";column_width[5]=0;// Furthest right


threat=4;
var k,j;
k=-1;
j=-1;


repeat(6){k+=1;j=-1;
    repeat(11){j+=1;
        enemy[j]=0;
        enemy_status[j]=0;
        
        /*en_column[j,k]="";
        en_width[j,k]=0;en_height[j,k]=0;
        en_num[j,k]=0;en_size[j,k]=0;*/
        
        en_capital[j]=0;en_capital_max[j]=0;en_capital_lost[j]=0;
        en_frigate[j]=0;en_frigate_max[j]=0;en_frigate_lost[j]=0;
        en_escort[j]=0;en_escort_max[j]=0;en_escort_lost[j]=0;
        en_ships_max[j]=0;
    }
}
// Should be 0-5 for each of the factions





capital=0;capital_max=0;capital_lost=0;
frigate=0;frigate_max=0;frigate_lost=0;
escort=0;escort_max=0;escort_lost=0;
thunderhawk=0;thunderhawk_list=0;
ships_max=0;
ships_damaged=0;

marines_lost=0;

en_mutation[0]="";
en_mutation[1]="";
en_mutation[2]="";

// 
ambushers=0;if (string_count("Ambushers",obj_ini.strin)&gt;0) then ambushers=1;
bolter_drilling=0;if (string_count(string(obj_img.gyro),obj_ini.strin)&gt;0) then bolter_drilling=1;
enemy_eldar=0;if (string_count("Enemy: Eldar",obj_ini.strin)&gt;0) then enemy_eldar=1;
enemy_fallen=0;if (string_count("Enemy: Fallen",obj_ini.strin)&gt;0) then enemy_fallen=1;
enemy_orks=0;if (string_count("Enemy: Orks",obj_ini.strin)&gt;0) then enemy_orks=1;
enemy_tau=0;if (string_count("Enemy: Tau",obj_ini.strin)&gt;0) then enemy_tau=1;
enemy_tyranids=0;if (string_count("Enemy: Tyraninids",obj_ini.strin)&gt;0) then enemy_tyranids=1;
siege=0;if (string_count("Siege",obj_ini.strin)&gt;0) then siege=1;
slow=0;if (string_count("Purposeful",obj_ini.strin)&gt;0) then slow=1;
melee=0;if (string_count("Melee Enthus",obj_ini.strin)&gt;0) then melee=1;
// 
black_rage=0;if (string_count("Black Rage",obj_ini.strin2)&gt;0) then black_rage=1;
shitty_luck=0;if (string_count("Shitty",obj_ini.strin2)&gt;0) then shitty_luck=1;
warp_touched=0;if (string_count("Warp Touched",obj_ini.strin2)&gt;0) then warp_touched=1;
lyman=obj_ini.lyman;// drop pod penalties
omophagea=obj_ini.omophagea;// feast
ossmodula=obj_ini.ossmodula;// small penalty to all
membrane=obj_ini.membrane;// less chance of survival for wounded
betchers=obj_ini.betchers;// slight melee penalty
catalepsean=obj_ini.catalepsean;// minor global attack decrease
occulobe=obj_ini.occulobe;// penalty if morning and susceptible to flash grenades
mucranoid=obj_ini.mucranoid;// chance to short-circuit
// 
global_melee=1;
global_bolter=1;
global_attack=1;
global_defense=1;

// STC Bonuses
if (obj_controller.stc_bonus[5]=1) then global_defense+=0.1;
if (obj_controller.stc_bonus[5]=2) then global_attack=1.05;
if (obj_controller.stc_bonus[6]=1) then global_defense+=0.1;

// Kings of Space Bonus
if (string_count("Kings of Space",obj_ini.strin)&gt;0){control=1;global_defense+=0.1;global_attack+=0.1;}



// 
master=0;
time=0;










var i;i=-1;
repeat(110){i+=1;
    fighting[i]=0;
    
    ship[i]="";ship_id[i]=0;ship_class[i]=obj_ini.ship_class[i];ship_size[i]=0;
    ship_leadership[i]=100;ship_hp[i]=9999;ship_maxhp[i]=9999;
    ship_conditions[i]="";ship_speed[i]=20;ship_turning[i]=0;
    ship_front_armor[i]=0;ship_other_armor[i]=0;ship_weapons[i]=0;ship_shields=0;
    
    ship_wep[i,1]="";ship_wep_facing[i,1]="";ship_wep_condition[i,1]="";
    ship_wep[i,2]="";ship_wep_facing[i,2]="";ship_wep_condition[i,2]="";
    ship_wep[i,3]="";ship_wep_facing[i,3]="";ship_wep_condition[i,3]="";
    ship_wep[i,4]="";ship_wep_facing[i,4]="";ship_wep_condition[i,4]="";
    ship_wep[i,5]="";ship_wep_facing[i,5]="";ship_wep_condition[i,5]="";
    
    
    ship_capacity[i]=0;ship_carrying[i]=0;ship_contents[i]="";ship_turrets[i]=0;
    
    if (i&lt;=80) then ship_lost[i]=0;
}


// screwing around below here
alarm[6]=2;
// 
// waiting at this point- show loading screen
// in this time the obj_controller passes over which units will be fighting, similar to the below code

column[0]="";column_width[0]=0;column_num[0]=0;// This is determined at the pre-battle screen
column[1]="";column_width[1]=0;column_num[1]=0;
column[2]="";column_width[2]=0;column_num[3]=0;
column[3]="Capital";column_width[3]=270;column_num[3]=0;
column[4]=string(obj_img.ship[1,2]);column_width[4]=140;column_num[4]=0;
column[5]="Escort";column_width[5]=76;column_num[5]=0;// Furthest right


color_index=0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var yeehaw1, yeehaw2, tstar;
yeehaw1=0;yeehaw2=0;tstar=0;

if (player_started=1){yeehaw1=pla_fleet;yeehaw2=ene_fleet;}

if (player_started=0) and (instance_exists(obj_turn_end)){
    yeehaw1=obj_turn_end.battle_pobject[obj_turn_end.current_battle];
}


if (instance_number(obj_en_ship)&gt;0){
    scr_recent("fleet_defeat",star_name,(capital_lost*6)+(frigate_lost*2)+escort_lost);
}
if (instance_number(obj_en_ship)&lt;=0){
    with(obj_p_ship){
        if (hp&lt;=0) then scr_recent("ship_destroyed",obj_ini.ship[ship_id],ship_id);
    }
}





yeehaw1.capital_number=max(capital,0);
yeehaw1.frigate_number=max(frigate,0);
yeehaw1.escort_number=max(escort,0);
yeehaw1.alarm[6]=1;// Check for low health ships

var op,remove,ii,killer,killer_tg;op=0;remove=0;killer=0;killer_tg="";ii=-50;





if (player_started=0) and (instance_exists(obj_turn_end)) then with(obj_star){if (name!=obj_turn_end.battle_location[obj_turn_end.current_battle]){x-=10000;y-=10000;}}
if (player_started=1) then with(obj_star){if (id!=obj_fleet.ene_fleet){x-=10000;y-=10000;}}
ii=instance_nearest(room_width,room_height,obj_star);
obj_controller.temp[1070]=ii.id;
with(obj_star){if (x&lt;-5000) and (y&lt;-5000){x+=10000;y+=10000;}}







op=0;var ofleet;ofleet=0;
repeat(5){op+=1;
    if (enemy[op]!=0) and (enemy[op]!=4){ofleet=0;
        obj_controller.temp[1071]=enemy[op];
        
        // show_message("Hiding all but the fleet owned by "+string(obj_controller.temp[1071]));
        
        with(obj_en_fleet){if (owner!=obj_controller.temp[1071]) or (orbiting!=obj_controller.temp[1070]){x-=10000;y-=10000;}}
        
        ofleet=instance_nearest(room_width/2,room_height/2,obj_en_fleet);
        // show_message("Fleet: "+string(ofleet.capital_number)+"/"+string(ofleet.frigate_number)+"/"+string(ofleet.escort_number)+", lost "+string(en_capital_lost[op])+"/"+string(en_frigate_lost[op])+"/"+string(en_escort_lost[op]));
        
        repeat(50){
            if (!instance_exists(ofleet)){ofleet=instance_nearest(room_width/2,room_height/2,obj_en_fleet);}
            if (instance_exists(ofleet)){
                if (ofleet.trade_goods="player_hold") then ofleet.trade_goods="";
                // show_message("ofleet x:"+string(ofleet.x)+", ofleet y:"+string(ofleet.y)+", ofleet owner: "+string(ofleet.owner)+" wants "+string(enemy[op]));
                if (ofleet.x&gt;-7000) and (ofleet.y&gt;-7000) and (ofleet.owner=enemy[op]){
                    if (en_capital_lost[op]+en_frigate_lost[op]+en_escort_lost[op]&gt;=ofleet.capital_number+ofleet.frigate_number+ofleet.escort_number){
                        en_capital_lost[op]-=ofleet.capital_number;en_frigate_lost[op]-=ofleet.frigate_number;en_escort_lost[op]-=ofleet.escort_number;
                        // show_message("Fleet baleeted");
                        with(ofleet){instance_destroy();}
                    }
                    if (en_capital_lost[op]+en_frigate_lost[op]+en_escort_lost[op]&gt;0) and (instance_exists(ofleet)){
                        // show_message("Fleet: "+string(ofleet.capital_number)+"/"+string(ofleet.frigate_number)+"/"+string(ofleet.escort_number)+", lost "+string(en_capital_lost[op])+"/"+string(en_frigate_lost[op])+"/"+string(en_escort_lost[op]));
                        if (en_capital_lost[op]&gt;0) and (ofleet.capital_number&gt;0){en_capital_lost[op]-=1;ofleet.capital_number-=1;}
                        if (en_frigate_lost[op]&gt;0) and (ofleet.frigate_number&gt;0){en_frigate_lost[op]-=1;ofleet.frigate_number-=1;}
                        if (en_escort_lost[op]&gt;0) and (ofleet.escort_number&gt;0){en_escort_lost[op]-=1;ofleet.escort_number-=1;}
                        if (ofleet.capital_number+ofleet.frigate_number+ofleet.escort_number&lt;=0) then with(ofleet){instance_destroy();}
                    }
                }
            }
        }
        
        with(obj_en_fleet){if (x&lt;-7000) and (y&lt;-7000){x+=10000;y+=10000;}}
        
        // if (instance_exists(ofleet)){show_message("Fleet: "+string(ofleet.capital_number)+"/"+string(ofleet.frigate_number)+"/"+string(ofleet.escort_number));}
        // if (!instance_exists(ofleet)){show_message("FlEET WAS DELETED");}
    }
    
    // show_message("End ship removing");
    
    if (enemy[op]=4) and (enemy_status[op]&lt;0){
        obj_controller.temp[1071]=enemy[op];
        with(obj_en_fleet){if (owner!=obj_controller.temp[1071]) or (orbiting!=obj_controller.temp[1070]){x-=10000;y-=10000;}}
        ofleet=instance_nearest(room_width/2,room_height/2,obj_en_fleet);
        killer=1;obj_controller.temp[1071]=enemy[op];
        killer_tg=ofleet.trade_goods;
        with(ofleet){instance_destroy();}
        with(obj_en_fleet){{x+=10000;y+=10000;}}
    }
}





obj_controller.cooldown=20;

if (killer&gt;0){
    scr_loyalty("Inquisitor Killer","+");
    if (obj_controller.loyalty&gt;=85) then obj_controller.last_world_inspection-=44;
    if (obj_controller.loyalty&gt;=70) and (obj_controller.loyalty&lt;85) then obj_controller.last_world_inspection-=32;
    if (obj_controller.loyalty&gt;=50) and (obj_controller.loyalty&lt;70) then obj_controller.last_world_inspection-=20;
    if (obj_controller.loyalty&lt;50) then scr_loyalty("Inquisitor Killer","+");
    
    var msg,msg2,i,remove;msg="";msg2="";i=0;remove=0;
    if (string_count("Inqis1",killer_tg)=1){msg+="Inquisitor "+string(obj_controller.inquisitor[1])+" has been killed!";remove=1;msg2="Inquisitor "+string(obj_controller.inquisitor[1]);}
    if (string_count("Inqis2",killer_tg)=1){msg+="Inquisitor "+string(obj_controller.inquisitor[2])+" has been killed!";remove=2;msg2="Inquisitor "+string(obj_controller.inquisitor[2]);}
    if (string_count("Inqis3",killer_tg)=1){msg+="Inquisitor "+string(obj_controller.inquisitor[3])+" has been killed!";remove=3;msg2="Inquisitor "+string(obj_controller.inquisitor[3]);}
    if (string_count("Inqis4",killer_tg)=1){msg+="Inquisitor "+string(obj_controller.inquisitor[4])+" has been killed!";remove=4;msg2="Inquisitor "+string(obj_controller.inquisitor[4]);}
    if (string_count("Inqis5",killer_tg)=1){msg+="Inquisitor "+string(obj_controller.inquisitor[5])+" has been killed!";remove=5;msg2="Inquisitor "+string(obj_controller.inquisitor[5]);}
    if (obj_controller.inquisitor_type[remove]="Ordo Hereticus") then scr_loyalty("Inquisitor Killer","+");
    
    i=remove;
    repeat(10-remove){
        if (i&lt;10){
            obj_controller.inquisitor_gender[i]=obj_controller.inquisitor_gender[i+1];
            obj_controller.inquisitor_type[i]=obj_controller.inquisitor_type[i+1];
            obj_controller.inquisitor[i]=obj_controller.inquisitor[i+1];
        }
        if (i=10){
            obj_controller.inquisitor_gender[i]=choose(1,1,1,1,2,2,2);
            obj_controller.inquisitor_type[i]=choose("Ordo Malleus","Ordo Xenos","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus");
            obj_controller.inquisitor[i]=scr_imperial_name(obj_controller.inquisitor_gender[i]);// For 'random inquisitor wishes to inspect your fleet
        }
        i+=1;
    }
    
    instance_activate_object(obj_turn_end);
    
    if (instance_exists(obj_turn_end)) then scr_alert("red","inqis",string(msg),ii.x+16,ii.y-24);
    if (!instance_exists(obj_turn_end)) and (obj_controller.faction_status[4]!="War"){
        var pip;pip=instance_create(0,0,obj_popup);
        pip.title="Inquisitor Killed";pip.text=msg;pip.image="inquisition";pip.cooldown=20;
        
        if (obj_controller.known[4]&lt;3){
            pip.title="EXCOMMUNICATUS TRAITORUS";
            pip.text="The Inquisition has noticed your uncalled murder of "+string(msg2)+" and declared your chapter Excommunicatus Traitorus.";
            obj_controller.alarm[8]=1;
        }
    }
    
    
    // if (obj_controller.known[4]&lt;3) then with(obj_popup){instance_destroy();}
    
    
    
    // excommunicatus traitorus
}


// if (yeehaw1.capital_number+yeehaw1.frigate_number+yeehaw1.escort_number&lt;=0) then with(yeehaw1){instance_destroy();}
// if (yeehaw2.capital_number+yeehaw2.frigate_number+yeehaw2.escort_number&lt;=0) or (victory=true) then with(yeehaw2){instance_destroy();}

// instance_deactivate_object(obj_turn_end);
instance_activate_all();

if (instance_exists(obj_p_assra)){obj_p_assra.alarm[0]=1;}
alarm[4]=2;


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
/*
enemy[2]=6;enemy_status[2]=1;
en_capital[2]=2;en_frigate[2]=3;en_escort[2]=5;
en_capital_max[2]=2;en_frigate_max[2]=3;en_escort_max[2]=5;
en_ships_max[2]=10;

enemy[3]=2;enemy_status[3]=1;
en_capital[3]=1;en_frigate[3]=2;en_escort[3]=3;
en_capital_max[3]=1;en_frigate_max[3]=2;en_escort_max[3]=3;
en_ships_max[3]=6;
*/

var total_enemies, total_allies, t, tt, y1, y2, fug, spawner;
total_enemies=0;
total_allies=1;
spawner=0;
t=0;y1=0;y2=0;tt=0;fug=0;

repeat(6){t+=1;
    if (enemy[t]!=0){
        if (enemy_status[t]&lt;0) then total_enemies+=1;
        if (enemy_status[t]&gt;0) then total_allies+=1;
        
        // show_message("Computer "+string(t)+":"+string(enemy[t])+", status:"+string(enemy_status[t]));
    }
}



if (total_enemies&gt;0){
    t=1;y2=room_height/total_enemies/2;tt=0;
    repeat(5){fug+=1;
        if (enemy_status[fug]&lt;0){
            tt+=1;y1=(t*y2);
            
            spawner=instance_create(room_width+200,y1,obj_fleet_spawner);
            spawner.owner=enemy[fug];
            spawner.height=(y2);
            spawner.number=fug;
            
            t+=2;
        }
    }
}

if (total_allies&gt;0){
    t=0;y1=0;y2=0;tt=0;fug=0;
    t=1;y2=room_height/total_allies/2;tt=0;
    repeat(5){fug+=1;
        if (enemy_status[fug]&gt;0){
            tt+=1;y1=(t*y2);
            
            spawner=instance_create(200,y1,obj_fleet_spawner);
            
            if (fug=1) then spawner.owner=1;
            if (fug&gt;1) then spawner.owner=enemy[fug];// Get the ENEMY after the actual enemies
            
            spawner.height=(y2);
            spawner.number=fug;
            
            t+=2;
        }
    }
}


// show_message("Total Enemies: "+string(total_enemies));
// show_message("Total Allies: "+string(total_allies));


// Buffs here
// if (ambushers=1) or (enemy=8) then 
attack_mode="offensive";
// if (enemy=9) then attack_mode="defensive";

if (ambushers=1) and (ambushers=999) then global_attack=global_attack*1.1;// Need to finish this
if (bolter_drilling=1) then global_bolter=global_bolter*1.1;
// if (enemy_eldar=1) and (enemy=6){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_fallen=1) and (enemy=10){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_orks=1) and (enemy=7){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_tau=1) and (enemy=8){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_tyranids=1) and (enemy=10){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
if (siege=1) and (siege=555) then global_attack=global_attack*1.2;// Need to finish this
if (slow=1){global_attack=global_attack*0.9;global_defense=global_defense*1.2;}
if (melee=1) then global_melee=global_melee*1.15;
// 
if (shitty_luck=1) then global_defense=global_defense*0.9;
// if (lyman=1) and (dropping=1) then ||| handle within each object
if (ossmodula=1){global_attack=global_attack*0.95;global_defense=global_defense*0.95;}
if (betchers=1) then global_melee=global_melee*0.95;
if (catalepsean=1){global_attack=global_attack*0.95;}
// if (occulobe=1){if (time=5) or (time=6) then global_attack=global_attack*0.7;global_defense=global_defense*0.9;}

/*if (global.chapter_name="Dark Angels") or (obj_ini.main_color="Dark Green") then color_index=0;
if (global.chapter_name="White Scars") or (obj_ini.main_color="White") then color_index=1;
if (global.chapter_name="Space Wolves") or (obj_ini.main_color="Light Blue") then color_index=2;
if (global.chapter_name="Imperial Fists") or (obj_ini.main_color="Yellow") then color_index=3;
if (global.chapter_name="Blood Angels") or (obj_ini.main_color="Red") or (obj_ini.main_color="Dark Red") then color_index=4;
if (global.chapter_name="Iron Hands") then color_index=5;
if (global.chapter_name="Ultramarines") or (obj_ini.main_color="Blue") then color_index=6;
if (global.chapter_name="Salamanders") or (obj_ini.main_color="Green") then color_index=7;
if (global.chapter_name="Iron Hands") then color_index=7;
if (global.chapter_name="Black Templars") or (obj_ini.main_color="Black") then color_index=8;
if (global.chapter_name="Minotaurs") or (obj_ini.main_color="Brown") then color_index=9;
if (global.chapter_name="Soul Drinkers") or (obj_ini.main_color="Purple") then color_index=10;
if (global.chapter_name="Lamenters") then color_index=11;
if (global.chapter_name="Emperor's Nightmares") then color_index=12;
if (global.chapter_name="Angry Marines") then color_index=13;
if (global.chapter_name="Star Krakens") then color_index=14;
if (obj_ini.main_color="Pink") then color_index=15;*/





/*
global.chapter_name=5;
obj_ini.main_color=obj_creation.main_color;
obj_ini.secondary_color=obj_creation.secondary_color;
obj_ini.lens_color=obj_creation.lens_color;
obj_ini.weapon_color=obj_creation.weapon_color;
*/



// More prep for player

var i, k, onceh, company;i=0;k=0;onceh=0;

// instance_activate_object(obj_combat_info);

repeat(100){i+=1;
    if (fighting[i]=1) and (obj_ini.ship_class[i]!="") then ships_max+=1;
}



i=0;
repeat(100){i+=1;
    if (fighting[i]=1) and (obj_ini.ship[i]!="") and (obj_ini.ship_hp[i]&gt;0){onceh=0;
        if (obj_ini.ship_size[i]=3) then capital+=1;
        if (obj_ini.ship_size[i]=2) then frigate+=1;
        if (obj_ini.ship_size[i]=1) then escort+=1;
        
        ship_class[i]=obj_ini.ship_class[i];
        ship[i]=obj_ini.ship[i];ship_id[i]=i;ship_size[i]=obj_ini.ship_size[i];
        ship_leadership[i]=100;ship_hp[i]=obj_ini.ship_hp[i];ship_maxhp[i]=obj_ini.ship_maxhp[i];
        ship_conditions[i]=obj_ini.ship_conditions[i];ship_speed[i]=obj_ini.ship_speed[i];ship_turning[i]=obj_ini.ship_turning[i];
        ship_front_armor[i]=obj_ini.ship_front_armor[i];ship_other_armor[i]=obj_ini.ship_other_armor[i];ship_weapons[i]=obj_ini.ship_weapons[i];
        
        var t;t=0;
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        
        ship_capacity[i]=obj_ini.ship_capacity[i];ship_carrying[i]=obj_ini.ship_carrying[i];
        ship_contents[i]=obj_ini.ship_contents[i];ship_turrets[i]=obj_ini.ship_turrets[i];
    }
}

capital_max=capital;
frigate_max=frigate;
escort_max=escort;

obj_fleet_spawner.alarm[0]=1;


// alarm[1]=2;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (combat_end=170) then room_speed=30;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Dead mahreens</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

with(obj_p_ship){instance_destroy();}
with(obj_p_th){instance_destroy();}
with(obj_en_ship){instance_destroy();}
with(obj_en_in){instance_destroy();}
with(obj_al_ship){instance_destroy();}
with(obj_al_in){instance_destroy();}
with(obj_fleet_controller){instance_destroy();}
with(obj_p_round){instance_destroy();}
with(obj_en_round){instance_destroy();}
with(obj_al_round){instance_destroy();}
with(obj_p_assra){instance_destroy();}
with(obj_en_husk){instance_destroy();}

instance_activate_all();
obj_controller.combat=0;
instance_activate_object(obj_turn_end);
// instance_activate_object(obj_star_select);
// show_message(obj_turn_end.current_battle);


if (player_started=0){
    with(obj_turn_end){
        current_battle+=1;
        alarm[0]=1;
    }
}
if (player_started=1){
    var taxt;taxt="";

    taxt=string(global.chapter_name)+" engage and destroy a";
    if (enemy[1]=2) or (enemy[1]=4) or (enemy[1]=5) or (enemy[1]=6) then taxt+="n";
    taxt+=" "+string(obj_controller.faction[enemy[1]]);
    taxt+=" fleet at "+string(ene_fleet.name)+".";scr_event_log("",taxt);
    
    if (instance_exists(obj_star_select)) then with(obj_star_select){
        alarm[1]=1;player_fleet=0;
        var i;i=-1;repeat(15){i+=1;en_fleet[i]=0;}
    }
    if (instance_exists(pla_fleet)){
        pla_fleet.acted=2;
        if (capital+frigate+escort=0) then with(pla_fleet){instance_destroy();}
    }
    if (enemy[1]!=4) and (obj_controller.faction_status[enemy[1]]!="War"){
        obj_controller.audiences+=1;obj_controller.audien[obj_controller.audiences]=enemy[1];
        obj_controller.audien_topic[obj_controller.audiences]="declare_war";
        obj_controller.disposition[enemy[1]]-=20;
    }
}

if (view_x+view_y&gt;0){
    obj_controller.x=view_x;
    obj_controller.y=view_y;
}




// show_message(obj_turn_end.current_battle);
with(obj_controller){instance_activate_all();}
instance_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>instance_activate_object(obj_p_ship);
instance_activate_object(obj_en_ship);

instance_create(0,0,obj_fleet_controller);


if (instance_number(obj_en_ship)=0){
    combat_end=-1;start=6;
    obj_p_ship.alarm[3]=1;
    alarm[0]=10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
capital_max=capital;
frigate_max=frigate;
escort_max=escort;

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Player Ships Here</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// create blocks of infantry


var i, k, col, temp1, temp2, x2, hei, man, sizz;
i=0;k=0;col=5;temp1=0;temp2=0;x2=224;hei=0;man=0;sizz=0;





repeat(100){// This determines the number of ships in each column
    k+=1;
    
    
    if (fighting[k]=1){
        if ((column[col]="Capital") and (ship_size[k]=3)) then column_num[col]+=1;
        if ((column[col-1]="Capital") and (ship_size[k]=3)) then column_num[col-1]+=1;
        if ((column[col-2]="Capital") and (ship_size[k]=3)) then column_num[col-2]+=1;
        if ((column[col-3]="Capital") and (ship_size[k]=3)) then column_num[col-3]+=1;
        if ((column[col-4]="Capital") and (ship_size[k]=3)) then column_num[col-4]+=1;
    
        if (ship_class[k]=column[col]) then column_num[col]+=1;
        if (ship_class[k]=column[col-1]) then column_num[col-1]+=1;
        if (ship_class[k]=column[col-2]) then column_num[col-2]+=1;
        if (ship_class[k]=column[col-3]) then column_num[col-3]+=1;
        if (ship_class[k]=column[col-4]) then column_num[col-4]+=1;
        
        if ((column[col]="Escort") and (ship_size[k]=1)) then column_num[col]+=1;
        if ((column[col-1]="Escort") and (ship_size[k]=1)) then column_num[col-1]+=1;
        if ((column[col-2]="Escort") and (ship_size[k]=1)) then column_num[col-2]+=1;
        if ((column[col-3]="Escort") and (ship_size[k]=1)) then column_num[col-3]+=1;
        if ((column[col-4]="Escort") and (ship_size[k]=1)) then column_num[col-4]+=1;
    }
    
    
}



col=6;
repeat(5){// Start repeat
    temp1=0;temp2=0;

    col-=1;
    if (col&lt;5) then x2-=column_width[col];


if (column_num[col]&gt;0){// Start ship creation
    if (column[col]="Capital"){hei=160;sizz=3;}
    // if (column[col]="Slaughtersong"){hei=200;sizz=3;}
    if (column[col]=string(obj_img.ship[1,2])){hei=96;sizz=2;}
    if (column[col]="Gladius"){hei=64;sizz=1;}
    if (column[col]="Hunter"){hei=64;sizz=1;}
    if (column[col]="Escort"){hei=64;sizz=1;}

    temp1=column_num[col]*hei;
    temp2=((room_height/2)-(temp1/2))+64;
    if (column_num[col]=1) then temp2+=20;
    
    // show_message(string(column_num[col])+" "+string(column[col])+" X:"+string(x2));
    
    k=0;
    repeat(100){k+=1;
        if (ship_class[k]=column[col]) or ((column[col]="Escort") and (ship_size[k]=1))or ((column[col]="Capital") and (ship_size[k]=3)){
            if (sizz=3) and (ship_class[k]!="") and (fighting[k]=1){man=instance_create(x2,temp2,obj_p_capital);man.ship_id=k;man.class=column[col];temp2+=hei;}
            if (sizz=2) and (ship_class[k]!="") and (fighting[k]=1){man=instance_create(x2,temp2,obj_p_cruiser);man.ship_id=k;man.class=column[col];temp2+=hei;}
            if (sizz=1) and (ship_class[k]!="") and (fighting[k]=1){man=instance_create(x2,temp2,obj_p_escort);man.ship_id=k;man.class=column[col];temp2+=hei;}
        }
    }
    

}// End ship creation




}// End repeat
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Enemy Ships Here</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>



if (enemy=2){// This is an orderly Tau ship formation
    var xx,yy,i, temp1, x2, man;
    xx=0;yy=0;i=0;temp1=0;x2=1200;man=0;
    
    if (en_num[4]&gt;0){
        yy=(room_height/2)-((en_height[4]*en_num[4])/2);
        yy+=(en_height[4]/2);
        repeat(en_num[4]){
            man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[4];man.class=en_column[4];
        }
        x2+=en_width[4];
    }
    if (en_num[3]&gt;0){
        yy=(room_height/2)-((en_height[3]*en_num[3])/2);
        yy+=(en_height[3]/2);
        repeat(en_num[3]){
            man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[3];man.class=en_column[3];
        }
        x2+=en_width[3];
    }
    if (en_num[2]&gt;0){
        yy=(room_height/2)-((en_height[2]*en_num[2])/2);
        yy+=(en_height[2]/2);
        repeat(en_num[2]){
            man=instance_create(x2,yy,obj_en_capital);yy+=en_height[2];man.class=en_column[2];
        }
        x2+=en_width[2];
    }
    if (en_num[1]&gt;0){
        yy=256;
        repeat(en_num[1]){
            man=instance_create(x2,yy,obj_en_capital);yy+=en_height[1];man.class=en_column[1];
            yy+=(en_height[1]);
        }
    }
}






/*
if (en_escort&gt;0){en_column[4]="Aconite";en_num[4]=max(1,floor(en_escort/2));en_size[4]=1;}
if (en_escort&gt;1){en_column[3]="Hellebore";en_num[3]=max(1,floor(en_escort/2));en_size[3]=1;}
if (en_frigate&gt;0){en_column[2]="Shadow Class";en_num[2]=en_frigate;en_size[2]=2;}
if (en_capital&gt;0){en_column[1]="Void Stalker";en_num[1]=en_capital;en_size[1]=3;}
*/



if (enemy=6){// This is an orderly Tau ship formation
    var xx,yy,i, temp1, x2, man;
    xx=0;yy=0;i=0;temp1=0;x2=1200;man=0;
    
    if (en_num[4]&gt;0){
        yy=128;
        repeat(en_num[4]){
            man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[4];man.class=en_column[4];
        }
    }
    if (en_num[3]&gt;0){
        yy=room_height-128;
        repeat(en_num[3]){
            man=instance_create(x2,yy,obj_en_cruiser);yy-=en_height[3];man.class=en_column[3];
        }
    }
    x2+=max(en_width[3],en_width[4]);
    
    if (en_num[2]&gt;0){
        yy=(room_height/2)-((en_height[2]*en_num[2])/2);
        yy+=(en_height[2]/2);
        repeat(en_num[2]){
            man=instance_create(x2,yy,obj_en_capital);yy+=en_height[2];man.class=en_column[2];
        }
        x2+=en_width[2];
    }
    if (en_num[1]&gt;0){
        yy=256;
        repeat(en_num[1]){
            man=instance_create(x2,yy,obj_en_capital);yy+=en_height[1];man.class=en_column[1];
            yy+=(en_height[1]);
        }
    }
}






if (enemy=7) or (enemy=10){// This is spew out random ships without regard for formations
    var xx,yy,dist,targ,numb,man;
    xx=0;yy=0;dist=0;target=0;numb=0;man=0;
    
    var i;i=0;
    
    repeat(5){
    
        i+=1;
    
        if (en_column[i]!="") then for(s = 0; s &lt; en_num[i]; s += 1){
            if (en_size[i]&gt;1) then man=instance_create(random_range(1200,1400),round(random(860)+50),obj_en_capital);
            if (en_size[i]=1) then man=instance_create(random_range(1200,1400),round(random(860)+50),obj_en_cruiser);
            man.class=en_column[i];
        }
    
    
    }
}







if (enemy=8){// This is an orderly Tau ship formation
    var xx,yy,i, temp1, x2, man;
    xx=0;yy=0;i=0;temp1=0;x2=1200;man=0;
    
    yy=(room_height/2)-((en_height[5]*en_num[5])/2);
    yy+=(en_height[5]/2);
    repeat(en_num[5]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[5];man.class="Warden";
    }
    x2+=en_width[5];
    
    yy=(room_height/2)-((en_height[2]*en_num[2])/2)-((en_height[3]*en_num[3])/2);
    yy+=(en_height[2]/2);yy+=(en_height[3]/2);
    repeat(en_num[2]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[2];man.class="Emissary";
    }
    repeat(en_num[3]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[3];man.class="Protector";
    }
    x2+=max(en_width[2],en_width[3]);
    
    yy=(room_height/2)-((en_height[4]*en_num[4])/2);
    yy+=(en_height[4]/2);
    repeat(en_num[4]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[4];man.class="Castellan";
    }
    x2+=en_width[4];
    
    yy=(room_height/2)-((en_height[1]*en_num[1])/2);
    yy+=(en_height[1]/2);
    repeat(en_num[1]){
        man=instance_create(x2,yy,obj_en_capital);yy+=en_height[1];man.class="Custodian";
    }

}




if (enemy=9){// This is an orderly Tyranid ship formation
    var xx,yy,i, temp1, x2, man;
    xx=0;yy=0;i=0;temp1=0;x2=1200;man=0;
    
    yy=(room_height/2)-((en_height[4]*en_num[4])/2);
    yy+=(en_height[4]/2);
    repeat(en_num[4]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[4];man.class="Prowler";
    }
    x2+=en_width[4];
    
    yy=(room_height/2)-((en_height[3]*en_num[3])/2);
    yy+=(en_height[3]/2);
    repeat(en_num[3]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[3];man.class="Razorfiend";
    }
    x2+=en_width[3];
    
    yy=(room_height/2)-((en_height[2]*en_num[2])/2);
    yy+=(en_height[2]/2);
    repeat(en_num[2]){
        man=instance_create(x2,yy,obj_en_cruiser);yy+=en_height[2];man.class="Stalker";
    }
    x2+=en_width[2];
    
    yy=(room_height/2)-((en_height[1]*en_num[1])/2);
    yy+=(en_height[1]/2);
    repeat(en_num[1]){
        man=instance_create(x2,yy,obj_en_capital);yy+=en_height[1];man.class="Leviathan";
    }

}




</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>301</id>
        <kind>0</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_set_alarm</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>2</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>3</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Enemy ships</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

// if (csm_exp!=0) then show_message(string(csm_exp));






if (control=1) then instance_activate_object(obj_cursor);


if (enemy=2){
    if (en_escort&gt;0){en_column[4]="Sword Class Frigate";en_num[4]=en_escort;en_size[4]=1;}
    
    if (en_frigate&gt;0){en_column[3]="Avenger Class Grand Cruiser";en_num[3]=en_frigate;en_size[3]=2;}
        
    var i;i=0;i=en_capital;
    if (i&gt;0){
        en_column[2]="Apocalypse Class Battleship";en_num[2]=floor(random(i))+1;
        if (en_num[2]&lt;(en_capital*0.6)) then en_num[2]=round(en_capital*0.6);
        i-=en_num[2];en_size[2]=3;
    }
    
    if (i&gt;0){en_column[1]="Nemesis Class Fleet Carrier";en_num[1]=i;i-=en_num[1];en_size[1]=3;}
}



if (enemy=6){
    if (en_escort&gt;0){en_column[4]="Aconite";en_num[4]=max(1,floor(en_escort/2));en_size[4]=1;}
    if (en_escort&gt;1){en_column[3]="Hellebore";en_num[3]=max(1,floor(en_escort/2));en_size[3]=1;}
    if (en_frigate&gt;0){en_column[2]="Shadow Class";en_num[2]=en_frigate;en_size[2]=2;}
    if (en_capital&gt;0){en_column[1]="Void Stalker";en_num[1]=en_capital;en_size[1]=3;}
}




if (enemy=7){
    var i;i=0;i=en_capital;
    
    if (i&gt;0){en_column[1]="Dethdeala";en_num[1]=floor(random(i))+1;i-=en_num[1];en_size[1]=3;}
    
    if (i&gt;0){en_column[2]="Gorbag's Revenge";en_num[2]=floor(random(i))+1;i-=en_num[2];en_size[2]=3;}// en_num[2]+=en_num[1]+1;
    
    if (i&gt;0){en_column[3]="Kroolboy";en_num[3]=i;i-=en_num[3];en_size[3]=3;}// en_num[3]+=en_num[2]+1;
    
    if (en_frigate&gt;0){en_column[4]="Battlekroozer";en_num[4]=en_frigate;en_size[4]=2;}// en_num[4]+=en_num[3]+1;
    
    if (en_escort&gt;0){en_column[5]="Ravager";en_num[5]=en_escort;en_size[5]=1;}// en_num[5]+=en_num[4]+1;
}

if (enemy=8){
    var i;i=0;i=en_frigate;
    
    if (en_capital&gt;0){en_column[1]="Custodian";en_num[1]=en_capital;en_size[1]=3;}
    
    if (i&gt;0){en_column[2]="Emissary";en_num[2]=1;i-=en_num[2];en_size[2]=2;}
    
    if (i&gt;0){en_column[3]="Protector";en_num[3]=i;i-=en_num[3];en_size[3]=2;}// en_num[3]+=en_num[2]+1;
    
    if (en_escort&gt;0){en_column[4]="Castellan";en_num[4]=round((en_escort/3)*2);en_size[4]=1;}
    
    if (en_escort&gt;2){en_column[5]="Warden";en_num[5]=en_escort-en_num[5];en_size[5]=1;}
}

if (enemy=9){
    var i;i=0;i=en_escort;
    
    if (en_capital&gt;0){en_column[1]="Leviathan";en_num[1]=en_capital;en_size[1]=3;}
    
    if (i&gt;0){en_column[2]="Stalker";en_num[2]=floor(i/3)+1;i-=en_num[2];en_size[2]=1;}
    
    if (en_frigate&gt;0){en_column[3]="Razorfiend";en_num[3]=en_frigate;en_size[3]=2;}// en_num[2]+=en_num[1]+1;
    
    if (i&gt;0){en_column[4]="Prowler";en_num[4]=i;en_size[4]=1;}// en_num[5]+=en_num[4]+1;
}

if (enemy=10){
    var i;i=0;i=en_frigate;
    
    if (en_capital&gt;0){en_column[1]="Desecrator";en_num[1]=en_capital;en_size[1]=3;}
    
    if (i&gt;0){en_column[2]="Avenger";en_num[2]=floor(random(i))+1;i-=en_num[2];en_size[2]=2;}
    
    if (i&gt;0){en_column[3]="Carnage";en_num[3]=floor(random(i))+1;i-=en_num[3];en_size[3]=2;}// en_num[2]+=en_num[1]+1;
    
    if (i&gt;0){en_column[4]="Daemon";en_num[4]=i;i-=en_num[4];en_size[4]=2;}// en_num[3]+=en_num[2]+1;
    
    if (en_escort&gt;0){en_column[5]="Iconoclast";en_num[5]=en_escort;en_size[5]=1;}// en_num[5]+=en_num[4]+1;
}


// show_message("Dethdeala "+string(en_num[1])+" | Gorbag "+string(en_num[2])+" | Kroolboy "+string(en_num[3])+" | Frigate "+string(en_num[4])+" | Escort "+string(en_num[5]));


en_capital=0;
en_frigate=0;
en_escort=0;
en_ships_max=0;



/*
if (enemy="orks"){
    if (threat=1){
        en_column[1]="Ravager";en_num[1]=floor(random_range(1,3));en_size[1]=1;
    }
    if (threat=2){
        en_column[1]=choose("Deathdeala","Gorbag's Revenge","Battlekroozer");en_num[1]=choose(0,1);en_size[1]=3;
        en_column[2]="Ravager";en_num[2]=floor(random_range(1,5));en_size[2]=1;
    }
    if (threat=3){
        en_column[1]="Dethdeala";en_num[1]=choose(1,1);en_size[1]=3;
        en_column[2]="Gorbag's Revenge";en_num[2]=choose(0,1);en_size[2]=3;
        en_column[3]="Battlekroozer";en_num[3]=floor(random_range(0,1));en_size[3]=3;
        en_column[4]="Ravager";en_num[4]=floor(random_range(3,8));en_size[4]=1;
    }
    if (threat=4){
        en_column[1]="Dethdeala";en_num[1]=choose(1,2);en_size[1]=3;
        en_column[2]="Gorbag's Revenge";en_num[2]=choose(0,1,1);en_size[2]=3;
        en_column[3]="Battlekroozer";en_num[3]=floor(random_range(1,1));en_size[3]=3;
        en_column[4]="Ravager";en_num[4]=floor(random_range(4,10));en_size[4]=1;
    }
    if (threat=5){
        en_column[1]="Dethdeala";en_num[1]=choose(1,2,3);en_size[1]=3;
        en_column[2]="Gorbag's Revenge";en_num[2]=choose(0,1,2);en_size[2]=3;
        en_column[3]="Kroolboy";en_num[3]=choose(0,1,2);en_size[3]=3;
        en_column[4]="Battlekroozer";en_num[4]=floor(random_range(0,5));en_size[4]=3;
        en_column[5]="Ravager";en_num[5]=floor(random_range(6,15));en_size[5]=1;
    }
}

*/


/*if (en_num[2]=0) then en_num[2]=en_num[1]+1;
if (en_num[3]=0) then en_num[3]=en_num[2]+1;
if (en_num[4]=0) then en_num[4]=en_num[3]+1;
if (en_num[5]=0) then en_num[5]=en_num[4]+1;

if (en_num[2]!=0) then en_num[2]+=en_num[1];
if (en_num[3]!=0) then en_num[3]+=en_num[3];
if (en_num[4]!=0) then en_num[4]+=en_num[4];
if (en_num[5]!=0) then en_num[5]+=en_num[5];*/


/*var i;i=0;
repeat(5){i+=1;
    if (en_column[4]="") and (en_column[5]!="") and (en_num[5]&gt;0){en_column[4]=en_column[5];en_num[4]=en_num[5];en_column[5]="";en_num[5]=0;}
    if (en_column[3]="") and (en_column[4]!="") and (en_num[4]&gt;0){en_column[3]=en_column[4];en_num[3]=en_num[4];en_column[4]="";en_num[4]=0;}
    if (en_column[2]="") and (en_column[3]!="") and (en_num[3]&gt;0){en_column[2]=en_column[3];en_num[2]=en_num[3];en_column[3]="";en_num[3]=0;}
    if (en_column[1]="") and (en_column[2]!="") and (en_num[2]&gt;0){en_column[1]=en_column[2];en_num[1]=en_num[2];en_column[2]="";en_num[2]=0;}
}*/




var i;i=0;
repeat(5){i+=1;
    if (en_column[i]="Avenger Class Grand Cruiser"){en_width[i]=196;en_height[i]=96;}
    if (en_column[i]="Apocalypse Class Battleship"){en_width[i]=272;en_height[i]=128;}
    if (en_column[i]="Nemesis Class Fleet Carrier"){en_width[i]=272;en_height[i]=128;}
    if (en_column[i]="Sword Class Frigate"){en_width[i]=96;en_height[i]=64;}

    if (en_column[i]="Void Stalker"){en_width[i]=260;en_height[i]=192;}
    if (en_column[i]="Shadow Class"){en_width[i]=212;en_height[i]=160;}
    if (en_column[i]="Hellebore"){en_width[i]=160;en_height[i]=64;}
    if (en_column[i]="Aconite"){en_width[i]=128;en_height[i]=64;}
    
    if (en_column[i]="Deathdeala"){en_width[i]=196;en_height[i]=128;}
    if (en_column[i]="Gorbag's Revenge"){en_width[i]=196;en_height[i]=128;}
    if (en_column[i]="Kroolboy"){en_width[i]=196;en_height[i]=128;}
    if (en_column[i]="Slamblasta"){en_width[i]=196;en_height[i]=128;}
    if (en_column[i]="Battlekroozer"){en_width[i]=160;en_height[i]=96;}
    if (en_column[i]="Ravager"){en_width[i]=128;en_height[i]=64;}
    
    if (en_column[i]="Desecrator"){en_width[i]=196;en_height[i]=128;}
    if (en_column[i]="Avenger"){en_width[i]=160;en_height[i]=96;}
    if (en_column[i]="Carnage"){en_width[i]=160;en_height[i]=96;}
    if (en_column[i]="Daemon"){en_width[i]=160;en_height[i]=96;}
    if (en_column[i]="Iconoclast"){en_width[i]=128;en_height[i]=64;}
    
    if (en_column[i]="Custodian"){en_width[i]=128;en_height[i]=256;}
    if (en_column[i]="Emissary"){en_width[i]=160;en_height[i]=96;}
    if (en_column[i]="Protector"){en_width[i]=64;en_height[i]=180;}
    if (en_column[i]="Castellan"){en_width[i]=48;en_height[i]=96;}
    if (en_column[i]="Warden"){en_width[i]=48;en_height[i]=80;}
    
    if (en_column[i]="Leviathan"){en_width[i]=200;en_height[i]=128;}
    if (en_column[i]="Razorfiend"){en_width[i]=160;en_height[i]=128;}
    if (en_column[i]="Stalker"){en_width[i]=96;en_height[i]=64;}
    if (en_column[i]="Prowler"){en_width[i]=80;en_height[i]=64;}
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Determine Buffs</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
attack_mode="offensive";

// if (ambushers=1) or (enemy=8) then attack_mode="offensive";
// if (enemy=9) then attack_mode="defensive";

if (ambushers=1) and (ambushers=999) then global_attack=global_attack*1.1;// Need to finish this
if (bolter_drilling=1) then global_bolter=global_bolter*1.1;
// if (enemy_eldar=1) and (enemy=6){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_fallen=1) and (enemy=10){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_orks=1) and (enemy=7){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_tau=1) and (enemy=8){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
// if (enemy_tyranids=1) and (enemy=10){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
if (siege=1) and (siege=555) then global_attack=global_attack*1.2;// Need to finish this
if (slow=1){global_attack=global_attack*0.9;global_defense=global_defense*1.2;}
if (melee=1) then global_melee=global_melee*1.15;
// 
if (shitty_luck=1) then global_defense=global_defense*0.9;
// if (lyman=1) and (dropping=1) then ||| handle within each object
if (ossmodula=1){global_attack=global_attack*0.95;global_defense=global_defense*0.95;}
if (betchers=1) then global_melee=global_melee*0.95;
if (catalepsean=1){global_attack=global_attack*0.95;}
// if (occulobe=1){if (time=5) or (time=6) then global_attack=global_attack*0.7;global_defense=global_defense*0.9;}

/*if (global.chapter_name="Dark Angels") or (obj_ini.main_color="Dark Green") then color_index=0;
if (global.chapter_name="White Scars") or (obj_ini.main_color="White") then color_index=1;
if (global.chapter_name="Space Wolves") or (obj_ini.main_color="Light Blue") then color_index=2;
if (global.chapter_name="Imperial Fists") or (obj_ini.main_color="Yellow") then color_index=3;
if (global.chapter_name="Blood Angels") or (obj_ini.main_color="Red") or (obj_ini.main_color="Dark Red") then color_index=4;
if (global.chapter_name="Iron Hands") then color_index=5;
if (global.chapter_name="Ultramarines") or (obj_ini.main_color="Blue") then color_index=6;
if (global.chapter_name="Salamanders") or (obj_ini.main_color="Green") then color_index=7;
if (global.chapter_name="Iron Hands") then color_index=7;
if (global.chapter_name="Black Templars") or (obj_ini.main_color="Black") then color_index=8;
if (global.chapter_name="Minotaurs") or (obj_ini.main_color="Brown") then color_index=9;
if (global.chapter_name="Soul Drinkers") or (obj_ini.main_color="Purple") then color_index=10;
if (global.chapter_name="Lamenters") then color_index=11;
if (global.chapter_name="Emperor's Nightmares") then color_index=12;
if (global.chapter_name="Angry Marines") then color_index=13;
if (global.chapter_name="Star Krakens") then color_index=14;
if (obj_ini.main_color="Pink") then color_index=15;*/



/*
global.chapter_name=5;
obj_ini.main_color=obj_creation.main_color;
obj_ini.secondary_color=obj_creation.secondary_color;
obj_ini.lens_color=obj_creation.lens_color;
obj_ini.weapon_color=obj_creation.weapon_color;
*/


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Ships below</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var i, k, onceh, company;i=0;k=0;onceh=0;

// instance_activate_object(obj_combat_info);

repeat(100){i+=1;
    if (fighting[i]=1) and (obj_ini.ship_class[i]!="") then ships_max+=1;
}




i=0;
repeat(100){i+=1;
    if (fighting[i]=1) and (obj_ini.ship[i]!="") and (obj_ini.ship_hp[i]&gt;0){onceh=0;
        if (obj_ini.ship_size[i]=3) then capital+=1;
        if (obj_ini.ship_size[i]=2) then frigate+=1;
        if (obj_ini.ship_size[i]=1) then escort+=1;
        
        ship_class[i]=obj_ini.ship_class[i];
        ship[i]=obj_ini.ship[i];ship_id[i]=i;ship_size[i]=obj_ini.ship_size[i];
        ship_leadership[i]=100;ship_hp[i]=obj_ini.ship_hp[i];ship_maxhp[i]=obj_ini.ship_maxhp[i];
        ship_conditions[i]=obj_ini.ship_conditions[i];ship_speed[i]=obj_ini.ship_speed[i];ship_turning[i]=obj_ini.ship_turning[i];
        ship_front_armor[i]=obj_ini.ship_front_armor[i];ship_other_armor[i]=obj_ini.ship_other_armor[i];ship_weapons[i]=obj_ini.ship_weapons[i];
        
        var t;t=0;
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        t+=1;ship_wep[i,t]=obj_ini.ship_wep[i,t];ship_wep_facing[i,t]=obj_ini.ship_wep_facing[i,t];ship_wep_condition[i,t]=obj_ini.ship_wep_condition[i,t];
        
        ship_capacity[i]=obj_ini.ship_capacity[i];ship_carrying[i]=obj_ini.ship_carrying[i];
        ship_contents[i]=obj_ini.ship_contents[i];ship_turrets[i]=obj_ini.ship_turrets[i];
    }
}


alarm[2]=1;


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
scr_dead_marines(1);


start=7;


with(obj_controller){
    if (zoomed=1) then scr_zoom();
}



</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// if (woohoo&lt;60) then woohoo+=1;



if (beg!=0)/* and (instance_exists(obj_fleet_controller))*/{
    if (combat_end&gt;-1) and (instance_number(obj_en_ship)=0){combat_end-=1;victory=true;}
    if (combat_end&gt;-1) and ((capital+frigate+escort)&lt;=0) then combat_end-=1;
    if (combat_end&gt;-1){
        if (instance_exists(obj_p_ship)){
            var wooo;
            wooo=instance_nearest(room_width/2,room_height/2,obj_p_ship);
            if (point_distance(wooo.x,wooo.y,room_width/2,room_height/2)&gt;2000){combat_end-=1;debugl("Fleet Combat Ended- Loss - Enemy:"+string(enemy[1]));}
        }
    }
    
    if (combat_end&lt;=-1) and (start=5) and (instance_exists(obj_p_ship)){
        start=6;obj_p_ship.alarm[3]=1;
        alarm[0]=10;debugl("Fleet Combat Ended- Victory - Enemy:"+string(enemy[1]));
    }
    
    if (combat_end&gt;-1) and (instance_number(obj_en_ship)=0) then combat_end-=1;
    if (combat_end&gt;-1) and (instance_number(obj_p_ship)=0) then combat_end-=1;
}


if (start=5){
    if (player_lasers&gt;0) and (instance_exists(obj_en_ship)){
        if (player_lasers_target=0) or (!instance_exists(player_lasers_target)) then player_lasers_target=instance_nearest(-50,room_height/2,obj_en_ship);
        
        player_lasers_cd=max(player_lasers_cd-1,0);
        if (player_lasers_cd&lt;=0){
            player_lasers_cd=round(360/(player_lasers));
            repeat(min(2,player_lasers)){var las;
                las=instance_create(x-150,random(room_height/2)+(room_height/4),obj_p_round);
                las.direction=point_direction(las.x,las.y,player_lasers_target.x,player_lasers_target.y)+round(random_range(-4,4));
                las.image_xscale=1.5;las.image_yscale=1.5;las.speed=30;las.dam=30;
                las.sprite_index=spr_ground_las;las.image_index=0;las.image_speed=0;
            }
            
        }
    }
}


/*
if (instance_number(obj_en_ship)=0) and (start&lt;6){
    stage=6;
    alarm[0]=10;
}

if (instance_number(obj_p_ship)=0) and (start&lt;6){
    capital=0;
    frigate=0;
    escort=0;
    
    stage=6;
    alarm[0]=10;
}
*/

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="56">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

var pressy;pressy=0;
sel_x1=0;sel_y1=0;


if (instance_exists(obj_p_ship)) and (control=1){left_down=0;
    with(obj_p_ship){
        var casey;casey=2;sel_x2=mouse_x;sel_y2=mouse_y;
        
        if (point_distance(sel_x1,sel_y1,sel_x2,sel_y2)&lt;30) then casey=1;
        
        if (casey=1){selected=0;
            if (point_distance(mouse_x,mouse_y,x,y)&lt;=30){selected=1;obj_fleet.ships_selected+=1;}
        }
        
        if (casey=2){
            if (x&gt;=sel_x1) and (y&gt;=sel_y1) and (x&lt;=sel_x2) and (y&lt;=sel_y2){selected=1;obj_fleet.ships_selected+=1;}
            else{if (!keyboard_check(vk_shift)) then selected=0;}
        }
        
        sel_x1=0;sel_y1=0;sel_x2=0;sel_y2=0;
    }
}

if (start=5) and (obj_controller.zoomed=0){
    if (mouse_x&gt;=view_xview[0]+12) and (mouse_y&gt;=view_yview[0]+436) and (mouse_x&lt;view_xview[0]+48) and (mouse_y&lt;view_yview[0]+480) and (room_speed&lt;90) then room_speed+=30;
}
if (start=5) and (obj_controller.zoomed=1){
    if (mouse_x&gt;24) and (mouse_y&gt;872) and (mouse_x&lt;90) and (mouse_y&lt;960) and (room_speed&lt;90) then room_speed+=30;
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="53">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (sel_x1+sel_y1=0) and (control=1){
    if (instance_exists(obj_p_ship)){
        left_down=50;sel_x1=mouse_x;sel_y1=mouse_y;ships_selected=0;
        
        with(obj_p_ship){
            if (keyboard_check(vk_shift)=false) then selected=0;
            sel_x1=mouse_x;sel_y1=mouse_y;
        }
    }
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
    draw_set_color(38144);draw_set_alpha(0.5);
    if (left_down!=0) then draw_rectangle(sel_x1,sel_y1,mouse_x,mouse_y,1);
    draw_set_alpha(1);
    
    draw_set_font(fnt_menu);
    draw_set_halign(fa_center);
    draw_set_color(0);
    
    var xx, yy;
    xx=940;yy=0;

    if (start=0){
        if (obj_controller.zoomed=0){
            draw_set_alpha(0.75);draw_set_color(38144);
            draw_rectangle(view_xview[0]+192,view_yview[0]+40,view_xview[0]+448,view_yview[0]+72,0);
            draw_set_alpha(1);draw_set_color(0);
            draw_rectangle(view_xview[0]+192,view_yview[0]+40,view_xview[0]+448,view_yview[0]+72,1);
            draw_text(view_xview[0]+320,view_yview[0]+48,"Press [Enter] to Begin");
        }
        if (obj_controller.zoomed=1){
            draw_set_alpha(0.75);draw_set_color(38144);
            draw_rectangle(192*2,40*2,448*2,72*2,0);
            draw_set_alpha(1);draw_set_color(0);
            draw_rectangle(192*2,40*2,448*2,72*2,1);
            draw_text_transformed(320*2,48*2,"Press [Enter] to Begin",2,2,0);
        }
        
    }
    
    if (room_speed!=90){
        if (start=5) and (obj_controller.zoomed=0) then draw_sprite(spr_fast_forward,0,view_xview[0]+12,view_yview[0]+436);
        if (start=5) and (obj_controller.zoomed=1) then draw_sprite_ext(spr_fast_forward,0,24,872,2,2,0,c_white,1);
    }

    draw_set_halign(fa_left);
    
    if (obj_controller.zoomed=0){
        draw_set_alpha(0.75);draw_set_color(38144);
        draw_rectangle(view_xview[0]+0,view_yview[0]+0,view_xview[0]+168,view_yview[0]+52,0);
        draw_set_alpha(1);draw_set_color(0);
        draw_rectangle(view_xview[0]+0,view_yview[0]+0,view_xview[0]+168,view_yview[0]+52,1);
    }

    if (obj_controller.zoomed=1){
        draw_set_alpha(0.75);draw_set_color(38144);
        draw_rectangle(0,1,336,104,0);
        draw_set_alpha(1);draw_set_color(0);
        draw_rectangle(0,1,336,104,1);
    }
    
    if (capital&gt;0) and (obj_controller.zoomed=0) then draw_text(view_xview[0]+2,view_yview[0]+2,"Battleships: "+string(capital));
    if (frigate&gt;0) and (obj_controller.zoomed=0) then draw_text(view_xview[0]+2,view_yview[0]+18,"Cruisers: "+string(frigate));
    if (escort&gt;0) and (obj_controller.zoomed=0) then draw_text(view_xview[0]+2,view_yview[0]+34,"Escorts: "+string(escort));
    
    if (obj_controller.zoomed=1){
        if (capital&gt;0) then draw_text_transformed(4,4,"Battleships: "+string(capital),2,2,0);
        if (frigate&gt;0) then draw_text_transformed(4,36,"Cruisers: "+string(frigate),2,2,0);
        if (escort&gt;0) then draw_text_transformed(4,68,"Escorts: "+string(escort),2,2,0);
    }

    
    /*
    if (obj_controller.zoomed=0){
        draw_set_alpha(0.75);draw_set_color(38144);
        draw_rectangle(view_xview[0]+470,view_yview[0]+yy,view_xview[0]+168+470,view_yview[0]+52+yy,0);
        draw_set_alpha(1);draw_set_color(0);
        draw_rectangle(view_xview[0]+470,view_yview[0]+yy,view_xview[0]+168+470,view_yview[0]+52+yy,1);
    }
    if (obj_controller.zoomed=1){
        draw_set_alpha(0.75);draw_set_color(38144);
        draw_rectangle(xx,yy+1,xx+336,yy+104,0);
        draw_set_alpha(1);draw_set_color(0);
        draw_rectangle(xx,yy+1,xx+336,yy+104,1);
    }
    

    if (en_capital&gt;0) and (obj_controller.zoomed=0) then draw_text(view_xview[0]+2+470,view_yview[0]+2+yy,"Battleships: "+string(en_capital));
    if (en_frigate&gt;0) and (obj_controller.zoomed=0) then draw_text(view_xview[0]+2+470,view_yview[0]+18+yy,"Cruisers: "+string(en_frigate));
    if (en_escort&gt;0) and (obj_controller.zoomed=0) then draw_text(view_xview[0]+2+470,view_yview[0]+34+yy,"Escorts: "+string(en_escort));
    
    if (obj_controller.zoomed=1){
        if (en_capital&gt;0) then draw_text_transformed(4+xx,4+yy,"Battleships: "+string(en_capital),2,2,0);
        if (en_frigate&gt;0) then draw_text_transformed(4+xx,36+yy,"Cruisers: "+string(en_frigate),2,2,0);
        if (en_escort&gt;0) then draw_text_transformed(4+xx,68+yy,"Escorts: "+string(en_escort),2,2,0);
    }*/



if (combat_end&lt;=120){
    draw_set_color(0);
    draw_set_alpha((120-combat_end)/100);
    draw_rectangle(0,0,room_width,room_height,0);
    draw_set_alpha(1);
}



if (start=7){
    var losses, aa, bb, cc, dd;losses=0;
    aa=0;bb=0;cc=0;dd=0;
    
    if (capital_max&gt;0) and (capital!=0){aa=((max(capital,0)/max(0,capital_max)));dd+=1;}
    if (capital_max&gt;0) and (capital=0){aa=0;dd+=1;}
    
    if (frigate_max&gt;0) and (frigate!=0){bb=((max(frigate,0)/max(0,frigate_max)));dd+=1;}
    if (frigate_max&gt;0) and (frigate=0){bb=0;dd+=1;}
    
    if (escort_max&gt;0) and (escort!=0){cc=((max(escort,0)/max(0,escort_max)));dd+=1;}
    if (escort_max&gt;0) and (escort=0){cc=0;dd+=1;}
    
    
    losses=(aa+bb+cc)/dd;
    
    // losses=(((max(capital,0)/capital_max))+((max(frigate,0)/frigate_max))+((max(escort,0)/escort_max)))/3;

    
    draw_set_alpha(0.75);draw_set_color(38144);
    draw_rectangle(view_xview[0]+192-24,view_yview[0]+128-96,view_xview[0]+448+24,view_yview[0]+272-96,0);
    
    draw_set_alpha(1);draw_set_color(0);draw_set_halign(fa_center);draw_set_font(fnt_menu);
    
    
    var wounded, vlost, vdamaged, dlost;
    
    if (losses&gt;=0.95){
        draw_text(view_xview[0]+320,view_yview[0]+130-96,"Major Victory");
        draw_text(view_xview[0]+320.5,view_yview[0]+130.5-96,"Major Victory");
        // draw_sprite(spr_postbattle_space,0,view_xview[0]+115,view_yview[0]+216);
        scr_image("postspace",0,view_xview[0]+115,view_yview[0]+216,409,247);
    }
    if (losses&gt;=0.75) and (losses&lt;0.95){
        draw_text(view_xview[0]+320,view_yview[0]+130-96,"Victory");
        draw_text(view_xview[0]+320.5,view_yview[0]+130.5-96,"Victory");
        // draw_sprite(spr_postbattle_space,1,view_xview[0]+115,view_yview[0]+216);
        scr_image("postspace",1,view_xview[0]+115,view_yview[0]+216,409,247);
    }
    if (losses&lt;0.75) and (losses&gt;0.01){
        draw_text(view_xview[0]+320,view_yview[0]+130-96,"Minor Victory");
        draw_text(view_xview[0]+320.5,view_yview[0]+130.5-96,"Minor Victory");
        scr_image("postspace",1,view_xview[0]+115,view_yview[0]+216,409,247);
        // draw_sprite(spr_postbattle_space,1,view_xview[0]+115,view_yview[0]+216);
    }
    if (losses&lt;=0.01){
        draw_text(view_xview[0]+320,view_yview[0]+130-96,"Defeat");
        draw_text(view_xview[0]+320.5,view_yview[0]+130.5-96,"Defeat");
        scr_image("postspace",2,view_xview[0]+115,view_yview[0]+216,409,247);
        // draw_sprite(spr_postbattle_space,2,view_xview[0]+115,view_yview[0]+216);
        
        
        // fallen=100;vlost=100;dlost=100;
    }
    
    
    if (capital_max!=0) then draw_text(view_xview[0]+320,view_yview[0]+160-96,"Battleships Lost: "+string(max(0,capital_lost))+" ("+string(min(100,((max(0,capital_lost)/max(0,capital_max))*100)))+"%)");
    if (frigate_max!=0) then draw_text(view_xview[0]+320,view_yview[0]+176-96,"Cruisers Lost: "+string(max(0,frigate_lost))+" ("+string(min(100,((max(0,frigate_lost)/max(0,frigate_max))*100)))+"%)");
    if (escort_max!=0) then draw_text(view_xview[0]+320,view_yview[0]+192-96,"Escorts Lost: "+string(max(0,escort_lost))+" ("+string(min(100,((min(max(0,escort_lost,escort_max))/max(0,escort_max))*100)))+"%)");
    if (ships_max!=0) and (capital_lost+frigate_lost+escort_lost&gt;0){
        if ((capital_lost+frigate_lost+escort_lost)&lt;(capital_max+frigate_max+escort_max)) then draw_text(view_xview[0]+320,view_yview[0]+208-96,"Ships Damaged: "+string(max(0,ships_damaged-(capital_lost+frigate_lost+escort_lost)))+" ("+string(max(0,min(100,((ships_damaged-(capital_lost+frigate_lost+escort_lost))/(ships_max-(capital_lost+frigate_lost+escort_lost))))*100))+"%)");
        if ((capital_lost+frigate_lost+escort_lost)=(capital_max+frigate_max+escort_max)) then draw_text(view_xview[0]+320,view_yview[0]+208-96,"Ships Damaged: 0 (0%)");
    }
    draw_text(view_xview[0]+320,view_yview[0]+224-96,"Marines Lost: "+string(max(0,fallen)));
    
    draw_set_halign(fa_center);
    draw_text(view_xview[0]+320,view_yview[0]+256-3-96,"[ Continue ]");
    
    

}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="67">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
/*obj_p_capital.hp=0;
obj_en_ship.hp=0;
obj_en_ship.shields=0;
with(obj_en_ship){instance_destroy();}
*/

/*obj_p_ship.hp=0;
player_lasers=48;*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="32">
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>start</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>5</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (obj_controller.cooldown&lt;=0){
    obj_controller.cooldown=8;
    with(obj_controller){scr_zoom();}
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="13">
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>-1</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>obj_controller.cooldown</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>2</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>-1</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>start</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>7</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>422</id>
        <kind>1</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>start</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>5</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// show_message(string(ships_max));

/*en_capital_max=en_capital;
en_frigate_max=en_frigate;
en_escort_max=en_escort;*/

beg=1;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>424</id>
        <kind>2</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>-1</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>obj_controller.cooldown</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>2</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>start</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>7</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// End battle crap here

instance_activate_all();
room_speed=30;
alarm[7]=1;

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
