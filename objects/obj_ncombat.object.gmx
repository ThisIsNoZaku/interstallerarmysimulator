<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-25000</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var co,i;co=-1;
repeat(15){co+=1;i=-1;
    repeat(401){i+=1;
        fighting[co,i]=0;
        if (i&lt;=150){veh_fighting[co,i]=0;}
    }
}co=0;i=0;hue=0;


debugl("Ground Combat Started");

audio_stop_sound(snd_royal);
audio_play_sound(snd_battle,0,true);
audio_sound_gain(snd_battle, 0, 0);
var nope;nope=0;if (obj_controller.master_volume=0) or (obj_controller.music_volume=0) then nope=1;
if (nope!=1){audio_sound_gain(snd_battle,0.25*obj_controller.master_volume*obj_controller.music_volume,2000);}



fack=0;
cd=0;
owner=1;
fix_timer=0;
formation_set=0;
big_boom=0;
kamehameha=false;
on_ship=false;
alpha_strike=0;

view_x=obj_controller.x;view_y=obj_controller.y;
obj_controller.x=0;obj_controller.y=0;
if (obj_controller.zoomed=1){with(obj_controller){scr_zoom();}}
xxx=200;
instance_activate_object(obj_cursor);
instance_activate_object(obj_ini);
instance_activate_object(obj_img)

var i,u;i=11;
repeat(10){i-=1;// This creates the objects to then be filled in
    u=instance_create(i*10,240,obj_pnunit);
}

instance_create(0,0,obj_centerline);

local_forces=0;
battle_loc="";
battle_climate="";
battle_id=0;
battle_object=0;
battle_special="";
defeat=0;
defeat_message=0;
red_thirst=0;
fugg=0;fugg2=0;
battle_over=0;
done=0;

captured_gaunt=0;
ethereal=0;
hulk_treasure=0;
four_show=0;
chaos_angry=0;

leader=0;
thirsty=0;
really_thirsty=0;
allies=0;
present_inquisitor=0;sorcery_seen=0;
inquisitor_ship=0;
guard_total=0;
guard_effective=0;
player_starting_dudes=0;
chapter_master_psyker=0;
guard_pre_forces=0;
ally=0;
ally_forces=0;
ally_special=0;

global_perils=0;
exterminatus=0;
plasma_bomb=0;

display_p1=0;display_p1n="";
display_p2=0;display_p2n="";


alarm[0]=2;
alarm[1]=3;
obj_pnunit.alarm[3]=1;
alarm[2]=8;


started=0;
charged=0;

fadein=40;
enemy=0;
threat=0;
fortified=0;
enemy_fortified=0;
wall_destroyed=0;
enem="Orks";enem_sing="Ork";
flank_x=0;

player_forces=0;player_max=0;
player_defenses=0;player_silos=0;

enemy_forces=0;enemy_max=0;
hulk_forces=0;

i=-1;messages=0;messages_to_show=4;messages_shown=0;
largest=0;priority=0;random_messages=0;dead_enemies=0;
repeat(70){i+=1;
    lines[i]="";
    lines_color[i]="";
    message[i]="";
    message_sz[i]=0;
    message_priority[i]=0;
    dead_jim[i]="";
    dead_ene[i]="";
    dead_ene_n[i]=0;
    
    post_unit_lost[i]="";
    post_unit_veh[i]=0;
    post_units_lost[i]=0;
    post_geneseed_recovered[i]=0;
    post_equipment_lost[i]="";
    post_equipments_lost[i]=0;
    
    crunch[i]=0;
    
    if (i&lt;=10) then mucra[i]=0;
}
slime=0;
apothecaries_alive=0;
apoth=0;
techma=0;
techmarines_alive=0;
injured=0;
command_injured=0;
seed_saved=0;
seed_max=0;
units_saved=0;
command_saved=0;
vehicles_saved=0;
final_deaths=0;
final_command_deaths=0;
vehicle_deaths=0;
casualties=0;
command_casualties=0;
dead_jims=0;
newline="";
newline_color="";
liness=0;
world_size=0;
gene_penalty=0;

timer=0;
timer_stage=0;
timer_speed=0;
timer_maxspeed=1;
timer_pause=-1;
turns=1;


// 

scouts=0;
tacticals=0;
veterans=0;
devastators=0;
assaults=0;
librarians=0;
techmarines=0;
honors=0;
dreadnoughts=0;
terminators=0;
captains=0;
standard_bearers=0;
important_dudes=0;
chaplains=0;
apothecaries=0;

rhinos=0;
predators=0;
land_raiders=0;
whirlwinds=0;

big_mofo=10;




en_scouts=0;
en_tacticals=0;
en_veterans=0;
en_devastators=0;
en_assaults=0;
en_librarians=0;
en_techmarines=0;
en_honors=0;
en_dreadnoughts=0;
en_terminators=0;
en_captains=0;
en_standard_bearers=0;
en_important_dudes=0;
en_chaplains=0;
en_apothecaries=0;

en_big_mofo=10;
en_important_dudes=0;

// 

attacker=0;// 0 is defensive
dropping=0;// 0 is was on ground
attacking=0;// 1 means attacked from space/local
time=floor(random(24))+1;
terrain="";
weather="";

ambushers=0;if (string_count("Ambushers",obj_ini.strin)&gt;0) then ambushers=1;
bolter_drilling=0;if (string_count(string(obj_img.gyro),obj_ini.strin)&gt;0) then bolter_drilling=1;
enemy_eldar=0;if (string_count("Enemy: Eldar",obj_ini.strin)&gt;0) then enemy_eldar=1;
enemy_fallen=0;if (string_count("Enemy: Fallen",obj_ini.strin)&gt;0) then enemy_fallen=1;
enemy_orks=0;if (string_count("Enemy: Orks",obj_ini.strin)&gt;0) then enemy_orks=1;
enemy_tau=0;if (string_count("Enemy: Tau",obj_ini.strin)&gt;0) then enemy_tau=1;
enemy_tyranids=0;
lightning=0;if (string_count("Lightning",obj_ini.strin)&gt;0) then lightning=1;
siege=0;if (string_count("Siege",obj_ini.strin)&gt;0) then siege=1;
slow=0;if (string_count("Purposeful",obj_ini.strin)&gt;0) then slow=1;
melee=0;if (string_count("Melee Enthus",obj_ini.strin)&gt;0) then melee=1;
// 
black_rage=0;if (string_count("Black Rage",obj_ini.strin2)&gt;0){black_rage=1;red_thirst=1;}
shitty_luck=0;if (string_count("Shitty",obj_ini.strin2)&gt;0) then shitty_luck=1;
warp_touched=0;if (string_count("Warp Touched",obj_ini.strin2)&gt;0) then warp_touched=1;


lyman=obj_ini.lyman;// drop pod penalties
omophagea=obj_ini.omophagea;// feast
ossmodula=obj_ini.ossmodula;// small penalty to all
membrane=obj_ini.membrane;// less chance of survival for wounded
betchers=obj_ini.betchers;// slight melee penalty
catalepsean=obj_ini.catalepsean;// minor global attack decrease
occulobe=obj_ini.occulobe;// penalty if morning and susceptible to flash grenades
mucranoid=obj_ini.mucranoid;// chance to short-circuit
// 
global_melee=1;
global_bolter=1;
global_attack=1;
global_defense=1;
// 
if (ambushers=1) and (ambushers=999) then global_attack=global_attack*1.1;
if (bolter_drilling=1) then global_bolter=global_bolter*1.1;
if (enemy_eldar=1) and (enemy=6){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
if (enemy_fallen=1) and (enemy=10){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
if (enemy_orks=1) and (enemy=7){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
if (enemy_tau=1) and (enemy=8){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}
if (enemy_tyranids=1) and (enemy=9){global_attack=global_attack*1.1;global_defense=global_defense*1.1;}

if (siege=1) and (enemy_fortified&gt;=3) and (attacker=1) then global_attack=global_attack*1.2;


if (slow=1){global_attack-=0.1;global_defense+=0.2;}
if (lightning=1){global_attack+=0.2;global_defense-=0.1;}
if (melee=1) then global_melee=global_melee*1.15;
// 
if (shitty_luck=1) then global_defense=global_defense*0.9;
if (lyman=1) and (dropping=1){global_attack=global_attack*0.85;global_defense=global_defense*0.9;}
if (ossmodula=1){global_attack=global_attack*0.95;global_defense=global_defense*0.95;}
if (betchers=1) then global_melee=global_melee*0.95;
if (catalepsean=1){global_attack=global_attack*0.95;}
if (occulobe=1){if (time=5) or (time=6){global_attack=global_attack*0.7;global_defense=global_defense*0.8;}}

enemy_dudes="";
global_defense=2-global_defense;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="8">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (enemy_forces!=0) and (player_forces!=0) and (battle_over=0){

    if ((enemy=6)) and (timer_stage=2){
        timer_stage=3;
        
        messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
    }
    
    if ((enemy!=6)) and (timer_stage=2){
        timer_stage=3;
        
        messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
    }
    
    if ((enemy=6)) and (timer_stage=4){
        timer_stage=5;
        
        messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
    }
    
    if ((enemy!=6)) and (timer_stage=4){
        timer_stage=5;
        
        messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
    }

}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="7">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>End the battle</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
audio_stop_sound(snd_battle);
audio_play_sound(snd_royal,0,true);
audio_sound_gain(snd_royal, 0, 0);
var nope;nope=0;if (obj_controller.master_volume=0) or (obj_controller.music_volume=0) then nope=1;
if (nope!=1){audio_sound_gain(snd_royal,0.25*obj_controller.master_volume*obj_controller.music_volume,2000);}

// scr_dead_marines(1);

// Execute the cleaning scripts
// Check for any more battles

obj_controller.cooldown=10;


if (defeat=0) then debugl("Ground Combat - Victory - Enemy:"+string(enemy)+" ("+string(battle_special)+")");
if (defeat=1) then debugl("Ground Combat - Defeat - Enemy:"+string(enemy)+" ("+string(battle_special)+")");


// If battling own dudes, then remove the loyalists after the fact


if (obj_ncombat.enemy=1){

    var cleann,j;
    j=-1;repeat(11){j+=1;cleann[j]=0;}

    with(obj_enunit){var q;q=0;
        repeat(700){q+=1;
            if (dude_id[q]&gt;0){
                var nco,nid,commandy,siz;
                nco=0;nid=0;commandy=false;
                nco=dude_co[q];nid=dude_id[q];
                cleann[nco]=1;
                
                // show_message("dude ID:"+string(q)+" ("+string(obj_ini.name[nco,nid])+") is being removed from the array");
                
                commandy=is_specialist(obj_ini.role[nco,nid]);
                if (commandy=true) then obj_controller.command-=1;
                if (commandy=false) then obj_controller.marines-=1;
                
                if (obj_ncombat.defeat=0){// Marine was killed, recover equipment
                    if (obj_ini.wep1[nco,nid]!="") then scr_add_item(obj_ini.wep1[nco,nid],1);
                    if (obj_ini.wep2[nco,nid]!="") then scr_add_item(obj_ini.wep2[nco,nid],1);
                    if (obj_ini.armor[nco,nid]!="") then scr_add_item(obj_ini.armor[nco,nid],1);
                    if (obj_ini.gear[nco,nid]!="") then scr_add_item(obj_ini.gear[nco,nid],1);
                    if (obj_ini.mobi[nco,nid]!="") then scr_add_item(obj_ini.mobi[nco,nid],1);
                }
                
                obj_ncombat.world_size+=scr_unit_size(obj_ini.armor[nco,nid],obj_ini.role[nco,nid],true);
                
                obj_ini.race[nco,nid]=0;obj_ini.loc[nco,nid]="";obj_ini.name[nco,nid]="";obj_ini.role[nco,nid]="";obj_ini.wep1[nco,nid]="";
                obj_ini.lid[nco,nid]=0;obj_ini.wep2[nco,nid]="";obj_ini.armor[nco,nid]="";obj_ini.gear[nco,nid]="";obj_ini.hp[nco,nid]=100;
                obj_ini.chaos[nco,nid]=0;obj_ini.experience[nco,nid]=0;obj_ini.mobi[nco,nid]="";obj_ini.age[nco,nid]=0;
                obj_ini.spe[nco,nid]="";obj_ini.god[nco,nid]=0;obj_ini.bio[nco,nid]=0;
            }
        }
    }
    
    j=-1;repeat(11){j+=1;if (cleann[j]!=0) then with(obj_ini){scr_company_order(j);}}
}
if (string_count("cs_meeting",battle_special)&gt;0){
    with(obj_temp_meeting){instance_destroy();}
    
    with(obj_star){
        if (name=obj_ncombat.battle_loc){
            instance_create(x,y,obj_temp_meeting);
            var i,co,ii,otm,good,master_present;ii=0;i=0;co=-1;good=0;master_present=0;
            var run,s,chaos_meeting;run=0;s=0;chaos_meeting=0;
            
            chaos_meeting=obj_ini.wid[0,1];
            
            // show_message("meeting planet:"+string(chaos_meeting));
            repeat(11){co+=1;i=0;
                repeat(200){i+=1;good=0;
                    if (obj_ini.role[co,i]!="") and (obj_ini.loc[co,i]=name) and (obj_ini.wid[co,i]==floor(chaos_meeting)) then good+=1;
                    if (obj_ini.role[co,i]!=obj_ini.role[100,6]) and (obj_ini.role[co,i]!="Venerable "+string(obj_ini.role[100,6])) then good+=1;
                    if (string_count(obj_img.unit[1,6],obj_ini.armor[co,i])=0) or (obj_ini.role[co,i]=obj_img.faction_title[1]) then good+=1;
                    
                    // if (good&gt;=3) then show_message(string(obj_ini.role[co,i])+": "+string(co)+"."+string(i));
                    
                    if (good&gt;=3){
                        obj_temp_meeting.dudes+=1;otm=obj_temp_meeting.dudes;
                        obj_temp_meeting.present[otm]=1;obj_temp_meeting.co[otm]=co;obj_temp_meeting.ide[otm]=i;
                        if (obj_ini.role[co,i]=obj_img.faction_title[1]) then master_present=1;
                    }
                }
            }
            // show_message("obj_temp_meeting.dudes:"+string(obj_temp_meeting.dudes));
            
        }
    }
}









var i,that;i=0;that=0;
repeat(50){if (that=0){i+=1;if (post_equipment_lost[i]="Company Standard") then that=i;}}
if (that!=0){repeat(post_equipments_lost[that]){scr_loyalty("Lost Standard","+");}}

if (battle_special="ruins") or (battle_special="ruins_eldar"){
    instance_activate_object(obj_temp4);
    obj_temp4.defeat=defeat;
    obj_temp4.alarm[7]=1;
}


if (battle_special="WL10_reveal") or (battle_special="WL10_later"){var moar,ox,oy;
    with(obj_temp8){instance_destroy();}
    
    if (chaos_angry&gt;=5){if (string_count("|CPF|",obj_controller.useful_info)=0) then obj_controller.useful_info+="|CPF|";}
    
    if (battle_special="WL10_reveal"){
        instance_create(battle_object.x,battle_object.y,obj_temp8);
        ox=battle_object.x;oy=battle_object.y;// battle_object.owner=10;
        battle_object.p_traitors[battle_id]=6;
        battle_object.p_chaos[battle_id]=4;
        battle_object.p_pdf[battle_id]=0;
        battle_object.p_owner[battle_id]=10;
        
        var corro;corro=0;
        
        repeat(100){var ii;ii=0;
            if (corro&lt;=5){
                moar=instance_nearest(ox,oy,obj_star);
                
                if (moar.owner&lt;=3){corro+=1;
                    repeat(4){ii+=1;
                        if (moar.p_owner[ii]&lt;=3) moar.p_heresy[ii]=min(100,moar.p_heresy[ii]+floor(random_range(30,50)));
                    }
                }
                moar.y-=20000;
            }
        }
        with(obj_star){if (y&lt;-12000) then y+=20000;}
        
        if (battle_object.present_fleet[2]&gt;0){
            with(obj_en_fleet){
                if (navy=0) and (owner=2) and (point_distance(x,y,obj_temp8.x,obj_temp8.y)&lt;40){
                    owner=10;sprite_index=spr_fleet_chaos;
                    if (image_index&lt;=2){escort_number+=3;frigate_number+=1;}
                    if (capital_number=0) then capital_number+=1;
                }
            }
            battle_object.present_fleet[2]-=1;
            battle_object.present_fleet[10]+=1;
        }
        with(obj_temp8){instance_destroy();}
    }
    
    if (defeat=1) and (battle_special="WL10_reveal"){
        obj_controller.audience=10;
        obj_controller.menu=20;
        obj_controller.diplomacy=10;
        obj_controller.known[10]=2;
        with(obj_controller){scr_dialogue("intro2");}
    }
    if (defeat=0){
        obj_controller.known[10]=2;
        obj_controller.faction_defeated[10]=1;
        
        if (instance_exists(obj_turn_end)){
            scr_event_log("","Enemy Leader Assassinated: Chaos Lord");
            scr_alert("","ass",string(obj_img.faction_title[11])+" "+string(obj_controller.faction_leader[10])+" has been killed.",0,0);
            scr_popup(string(obj_img.faction_title[11])+" Killed",string(obj_img.faction_title[11])+" "+string(obj_controller.faction_leader[10])+" has been slain in combat.  Without his leadership the various forces of Chaos in the sector will crumble apart and disintegrate from infighting.  Sector "+string(obj_ini.sector_name)+" is no longer as threatened by the forces of Chaos.","","");
        }
        if (!instance_exists(obj_turn_end)){
            scr_event_log("","Enemy Leader Assassinated: "+string(obj_img.faction_title[11]));
            var pop;pop=instance_create(0,0,obj_popup);
            pop.image="";pop.title=string(obj_img.faction_title[11])+" Killed";
            pop.text=string(obj_img.faction_title[11])+" "+string(obj_controller.faction_leader[10])+" has been slain in combat.  Without his leadership the various forces of Chaos in the sector will crumble apart and disintegrate from infighting.  Sector "+string(obj_ini.sector_name)+" is no longer as threatened by the forces of Chaos.";
        }
        
    }
}




if (battle_special="study2a") or (battle_special="study2b"){
    if (defeat=1){
        var ii,good;ii=0;good=0;
        repeat(4){if (good=0){ii+=1;if (string_count("mech_tomb",battle_object.p_problem[battle_id,ii])&gt;0) then good=ii;}}
        
        if (good&gt;0){
            battle_object.p_problem[battle_id,good]="";
            battle_object.p_timer[battle_id,good]=-1;
            obj_controller.disposition[3]-=10;
            
            if (battle_special="study2a"){
                scr_popup(string(obj_img.faction[3])+" Mission Failed","All of your "+string(obj_img.faction_dudes_formal[1])+" and the Mechanicus Research party have been killed down to the last man.  The research is a bust, and the "+string(obj_img.faction[3])+" is furious with your chapter for not providing enough security.  Relations with them are worse than before.","","");
            }
            if (battle_special="study2b"){
                battle_object.p_necrons[battle_id]=5;
                battle_object.p_feature[battle_id]=string_replace(battle_object.p_feature[battle_id],string(obj_img.faction_dude_formal)+" Tomb","Awakened "+string(obj_img.faction_dude_formal)+" Tomb");
                obj_controller.disposition[3]-=15;obj_controller.disposition[4]-=5;
                scr_popup(string(obj_img.faction[3])+" Mission Failed","All of your "+string(obj_img.faction_dudes_formal[1])+" and the "+string(obj_img.faction[3])+" Research party have been killed down to the last man.  The research is a bust.  To make matters worse the "+string(obj_img.faction_dude_formal)+" Tomb has fully awakened- countless numbers of the souless machines are now pouring out of the tomb.  The "+string(obj_img.faction[3])+" are furious with your chapter.","necron_army","");
                scr_alert("","inqi","The "+string(obj_img.faction[4])+" is displeased with your "+string(obj_img.player_army)+" for tampering with and awakening a "+string(obj_img.faction_dude_formal)+" Tomb",0,0);
                scr_event_log("","The "+string(obj_img.faction[4])+" is displeased with your "+string(obj_img.player_army)+" for tampering with and awakening a "+string(obj_img.faction_dude_formal)+" Tomb");
            }
            
            scr_event_log("",string(obj_img.faction[3])+" Mission Failed: "+string(obj_img.faction_dude_formal)+" Tomb Research Party and present astartes have been killed.");
        }
    }
}




if (enemy=5) and (obj_controller.faction_status[5]!="War"){
    obj_controller.loyalty-=50;obj_controller.loyalty_hidden-=50;
    obj_controller.disposition[2]-=50;obj_controller.disposition[3]-=80;
    obj_controller.disposition[4]-=40;obj_controller.disposition[5]-=30;
    
    obj_controller.faction_status[2]="War";obj_controller.faction_status[3]="War";
    obj_controller.faction_status[4]="War";obj_controller.faction_status[5]="War";
    
    if (!instance_exists(obj_turn_end)){
        obj_controller.audiences+=1;obj_controller.audien[obj_controller.audiences]=5;obj_controller.audien_topic[obj_controller.audiences]="declare_war";
        if (obj_controller.known[4]&gt;1){obj_controller.audiences+=1;obj_controller.audien[obj_controller.audiences]=4;obj_controller.audien_topic[obj_controller.audiences]="declare_war";}
        obj_controller.audiences+=1;obj_controller.audien[obj_controller.audiences]=2;obj_controller.audien_topic[obj_controller.audiences]="declare_war";
    }
    if (instance_exists(obj_turn_end)){
        obj_turn_end.audiences+=1;obj_turn_end.audien[obj_turn_end.audiences]=5;obj_turn_end.audien_topic[obj_turn_end.audiences]="declare_war";
        if (obj_turn_end.known[4]&gt;1){obj_turn_end.audiences+=1;obj_turn_end.audien[obj_turn_end.audiences]=4;obj_turn_end.audien_topic[obj_turn_end.audiences]="declare_war";}
        obj_turn_end.audiences+=1;obj_turn_end.audien[obj_turn_end.audiences]=2;obj_turn_end.audien_topic[obj_turn_end.audiences]="declare_war";
    }
}




if (exterminatus&gt;0) and (dropping!=0) and (string_count("mech",battle_special)=0){
    scr_destroy_planet(1);
}

if (string_count("mech",battle_special)&gt;0) and (defeat=0) then with(obj_temp4){
    var comp,plan,i;i=0;comp=0;plan=0;
    plan=instance_nearest(x,y,obj_star);
    scr_return_ship(obj_temp4.loc,obj_temp4,obj_temp4.num);
    with(obj_temp4){instance_destroy();}
}

i=-1;
repeat(11){i+=1;
    if (i=0){with(obj_ini){scr_company_order(0);scr_vehicle_order(0);}}
    if (i=1){with(obj_ini){scr_company_order(1);scr_vehicle_order(1);}}
    if (i=2){with(obj_ini){scr_company_order(2);scr_vehicle_order(2);}}
    if (i=3){with(obj_ini){scr_company_order(3);scr_vehicle_order(3);}}
    if (i=4){with(obj_ini){scr_company_order(4);scr_vehicle_order(4);}}
    if (i=5){with(obj_ini){scr_company_order(5);scr_vehicle_order(5);}}
    if (i=6){with(obj_ini){scr_company_order(6);scr_vehicle_order(6);}}
    if (i=7){with(obj_ini){scr_company_order(7);scr_vehicle_order(7);}}
    if (i=8){with(obj_ini){scr_company_order(8);scr_vehicle_order(8);}}
    if (i=9){with(obj_ini){scr_company_order(9);scr_vehicle_order(9);}}
    if (i=10){with(obj_ini){scr_company_order(10);scr_vehicle_order(10);}}
}

obj_controller.x=view_x;
obj_controller.y=view_y;
obj_controller.combat=0;
obj_controller.marines-=final_deaths;
obj_controller.command-=final_command_deaths;

instance_activate_all();

if (scr_role_count(obj_img.faction_title[1],"")=0){
    obj_controller.alarm[7]=1;if (global.defeat&lt;=1) then global.defeat=1;
    if (enemy=1) or (enemy=2) or (enemy=5) then global.defeat=3;
}



if (defeat=0) and (threat&gt;=4) then scr_recent("battle_victory",string(battle_loc)+" "+scr_roman(battle_id),enemy);



if (defeat=1) and (final_deaths+final_command_deaths&gt;=10) then scr_recent("battle_defeat",string(enemy),final_deaths+final_command_deaths);



if ((dropping=1) or (attacking=1)) and (string_count("_attack",battle_special)=0) and (string_count("mech",battle_special)=0) and (string_count("ruins",battle_special)=0) and (battle_special!="ship_demon"){
    obj_controller.combat=0;with(obj_drop_select){instance_destroy()};
}
if ((dropping+attacking=0)) and (string_count("_attack",battle_special)=0) and (string_count("mech",battle_special)=0) and (string_count("ruins",battle_special)=0) and (battle_special!="ship_demon") and (string_count("cs_meeting",battle_special)=0){
    var yeehaw1;
    yeehaw1=0;yeehaw1=obj_turn_end.battle_object[obj_turn_end.current_battle];
    if (string_count("ruins",battle_special)=0) then yeehaw1.p_player[obj_turn_end.battle_world[obj_turn_end.current_battle]]-=world_size;
    if (defeat=1) then yeehaw1.p_player[obj_turn_end.battle_world[obj_turn_end.current_battle]]=0;
    
    obj_controller.combat=0;
    with(obj_turn_end){
        alarm[4]=1;
    }
}
if (string_count("ruins",battle_special)&gt;0) and (defeat=1){
    instance_activate_object(obj_star);
    with(obj_star){if (name!=obj_ncombat.battle_loc) then instance_deactivate_object(id);}
    with(obj_star){
        p_player[obj_ncombat.battle_id]-=obj_ncombat.world_size;
    }
    instance_activate_object(obj_star);
}



if (string_count("_attack",battle_special)&gt;0) and (string_count("mech",battle_special)=0) and (string_count("ruins",battle_special)=0) and (string_count("cs_meeting",battle_special)=0){
    if (string_count("wake",battle_special)&gt;0){
        var pip;pip=instance_create(0,0,obj_popup);
        with(pip){
            title="Necron Tomb Awakens";
            image="necron_army";
            if (obj_ncombat.defeat=0) then text="Your marines make a tactical retreat back to the surface, hounded by Necrons all the way.  The Inquisition mission is a failure- you were to blow up the Necron Tomb World stealthily, not wake it up.  The Inquisition is not pleased with your conduct.";
            if (obj_ncombat.defeat=1) then text="Your marines are killed down to the last man.  The Inquisition mission is a failure- you were to blow up the Necron Tomb World stealthily, not wake it up.  The Inquisition is not pleased with your conduct.";
        }
        
        instance_activate_object(obj_star);
        with(obj_star){if (name!=obj_ncombat.battle_loc) then instance_deactivate_object(id);}
        with(obj_star){
            if (p_problem[obj_ncombat.battle_id,1]="bomb"){p_problem[obj_ncombat.battle_id,1]="";p_timer[obj_ncombat.battle_id,1]=0;p_necrons[obj_ncombat.battle_id]=4;}
            if (p_problem[obj_ncombat.battle_id,2]="bomb"){p_problem[obj_ncombat.battle_id,2]="";p_timer[obj_ncombat.battle_id,2]=0;p_necrons[obj_ncombat.battle_id]=4;}
            if (p_problem[obj_ncombat.battle_id,3]="bomb"){p_problem[obj_ncombat.battle_id,3]="";p_timer[obj_ncombat.battle_id,3]=0;p_necrons[obj_ncombat.battle_id]=4;}
            if (p_problem[obj_ncombat.battle_id,4]="bomb"){p_problem[obj_ncombat.battle_id,4]="";p_timer[obj_ncombat.battle_id,4]=0;p_necrons[obj_ncombat.battle_id]=4;}
            if (string_count("Awakened",p_feature[obj_ncombat.battle_id])=0) then p_feature[obj_ncombat.battle_id]=string_replace(p_feature[obj_ncombat.battle_id],"Necron Tomb|","Awakened Necron Tomb|");
        }
        with(obj_temp7){instance_destroy();}
        instance_activate_object(obj_star);
        
        pip.number=obj_temp8.popup
        pip.loc=obj_temp8.loc;
        pip.planet=battle_id;
        obj_controller.combat=0;
        obj_controller.disposition[4]-=5;
        obj_controller.cooldown=10;
        with(obj_temp8){instance_destroy();}
        // obj_turn_end.alarm[1]=4;
    }


    if (defeat=1) and (string_count("wake",battle_special)=0){
        with(obj_temp8){instance_destroy();}
        obj_controller.combat=0;
        obj_controller.cooldown=10;
        obj_turn_end.alarm[1]=4;
    }
    
    if (defeat=0) and (string_count("wake",battle_special)=0){
        obj_temp8.stage+=1;
        obj_controller.combat=0;
        var pip;pip=instance_create(0,0,obj_popup);
        
        with(pip){
            title="Necron Tunnels : "+string(obj_temp8.stage);
            if (obj_temp8.stage=2){image="necron_tunnels_2";
                text="The energy readings are much stronger, now that your marines are deep inside the tunnels.  What was once cramped is now luxuriously large, the tunnel ceiling far overhead decorated by stalactites.";
            }
            if (obj_temp8.stage=3){image="necron_tunnels_3";
                text="After several hours of descent the entrance to the Necron Tomb finally looms ahead- dancing, sickly green light shining free.  Your marine confirms that the Plasma Bomb is ready.";
            }
            if (obj_temp8.stage=4){
                if (obj_temp8.stage&gt;=4){
                    instance_activate_object(obj_star);
                    image="";
                    title="Inquisition Mission Completed";
                    text="Your marines finally enter the deepest catacombs of the Necron Tomb.  There they place the Plasma Bomb and arm it.  All around are signs of increasing Necron activity.  With half an hour set, your men escape back to the surface.  There is a brief rumble as the charge goes off, your mission a success.";
                    option1="";option2="";option3="";
                    
                    if (obj_controller.demanding=0) then obj_controller.disposition[4]+=1;
                    if (obj_controller.demanding=1) then obj_controller.disposition[4]+=choose(0,0,1);
                    
                    // show_message(string(obj_temp8.loc)+"."+string(obj_temp8.wid));
                    // obj_controller.temp[200]=obj_temp8.loc;
                    with(obj_star){if (name!=obj_temp8.loc) then instance_deactivate_object(id);}
                    with(obj_star){if (name=obj_temp8.loc) then instance_create(x,y,obj_temp5);}
                    
                    you=instance_nearest(obj_temp5.x,obj_temp5.y,obj_star);onceh=0;
                    
                    // show_message(you.name);
                    
                    // show_message("TEMP5: "+string(instance_number(obj_temp5))+"#Star: "+string(you));
                    
                    var ppp;ppp=0;
                    if (you.p_problem[obj_temp8.wid,1]="bomb"){ppp=1;you.p_feature[obj_temp8.wid]=string_replace(you.p_feature[obj_temp8.wid],"Necron Tomb|","");you.p_problem[obj_temp8.wid,1]="";you.p_timer[obj_temp8.wid,1]=0;}
                    if (you.p_problem[obj_temp8.wid,2]="bomb"){ppp=2;you.p_feature[obj_temp8.wid]=string_replace(you.p_feature[obj_temp8.wid],"Necron Tomb|","");you.p_problem[obj_temp8.wid,2]="";you.p_timer[obj_temp8.wid,2]=0;}
                    if (you.p_problem[obj_temp8.wid,3]="bomb"){ppp=3;you.p_feature[obj_temp8.wid]=string_replace(you.p_feature[obj_temp8.wid],"Necron Tomb|","");you.p_problem[obj_temp8.wid,3]="";you.p_timer[obj_temp8.wid,3]=0;}
                    if (you.p_problem[obj_temp8.wid,4]="bomb"){ppp=4;you.p_feature[obj_temp8.wid]=string_replace(you.p_feature[obj_temp8.wid],"Necron Tomb|","");you.p_problem[obj_temp8.wid,4]="";you.p_timer[obj_temp8.wid,4]=0;}
                    
                    pip.option1="";pip.option2="";pip.option3="";
                    scr_event_log("","Inquisition Mission Completed: Your "+string(obj_img.faction_dudes_formal[1])+" have sealed the Necron Tomb on "+string(you.name)+" "+string(scr_roman(ppp))+".");
                    scr_gov_disp(you.name,obj_temp8.wid,choose(1,2,3,4,5));
                    
                    if (!instance_exists(obj_temp8)){
                        pip.loc=battle_loc;
                        pip.planet=battle_id;
                    }
                    if (instance_exists(obj_temp8)){
                        pip.number=obj_temp8.popup;
                        pip.loc=obj_temp8.loc;
                        pip.planet=obj_temp8.wid;
                    }
                    
                    // show_message("Battle Closing: "+string(pip.loc)+"."+string(pip.planet));
                    
                    with(obj_temp5){instance_destroy();}
                    instance_activate_object(obj_star);
                    var have_bomb;have_bomb=scr_check_equip("Plasma Bomb",obj_temp8.loc,obj_temp8.wid,1);
                }
            }
        }
        
        if (instance_exists(obj_temp8)) and (pip.planet=0){
            pip.number=obj_temp8.popup
            pip.loc=obj_temp8.loc;
            pip.planet=battle_id;
        }
    }
}


if ((string_count("spyrer",battle_special)&gt;0))/* and (string_count("demon",battle_special)&gt;0))*/ and (defeat=0){
    instance_activate_object(obj_star);
    // show_message(obj_turn_end.current_battle);
    // show_message(obj_turn_end.battle_world[obj_turn_end.current_battle]);
    // title / text / image / speshul
    var spyrer;spyrer=0;
    /*if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],1]="spyrer") then spyrer=1;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],2]="spyrer") then spyrer=2;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],3]="spyrer") then spyrer=3;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],4]="spyrer") then spyrer=4;*/
    if (obj_turn_end.battle_world[obj_turn_end.current_battle]=1) then spyrer=1;
    if (obj_turn_end.battle_world[obj_turn_end.current_battle]=2) then spyrer=2;
    if (obj_turn_end.battle_world[obj_turn_end.current_battle]=3) then spyrer=3;
    if (obj_turn_end.battle_world[obj_turn_end.current_battle]=4) then spyrer=4;
    
    obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],spyrer]="";
    obj_turn_end.battle_object[obj_turn_end.current_battle].p_timer[obj_turn_end.battle_world[obj_turn_end.current_battle],spyrer]=-1;
    
    var tixt;tixt="The Spyrer on "+string(obj_turn_end.battle_object[obj_turn_end.current_battle].name);
    if (spyrer=1) then tixt+=" I";if (spyrer=2) then tixt+=" II";
    if (spyrer=3) then tixt+=" III";if (spyrer=4) then tixt+=" IV";
    tixt+=" has been removed.  The citizens and craftsman may sleep more soundly, the Inquisition likely pleased.";
    scr_popup("Inquisition Mission Completed",tixt,"spyrer","");
    
    if (obj_controller.demanding=0) then obj_controller.disposition[4]+=1;
    if (obj_controller.demanding=1) then obj_controller.disposition[4]+=choose(0,0,1);
    
    if (spyrer=1) then scr_event_log("","Inquisition Mission Completed: The Spyrer on "+string(obj_turn_end.battle_object[obj_turn_end.current_battle].name)+" I has been removed.");
    if (spyrer=2) then scr_event_log("","Inquisition Mission Completed: The Spyrer on "+string(obj_turn_end.battle_object[obj_turn_end.current_battle].name)+" II has been removed.");
    if (spyrer=3) then scr_event_log("","Inquisition Mission Completed: The Spyrer on "+string(obj_turn_end.battle_object[obj_turn_end.current_battle].name)+" III has been removed.");
    if (spyrer=4) then scr_event_log("","Inquisition Mission Completed: The Spyrer on "+string(obj_turn_end.battle_object[obj_turn_end.current_battle].name)+" IV has been removed.");
    scr_gov_disp(obj_turn_end.battle_object[obj_turn_end.current_battle].name,spyrer,choose(1,2,3,4));
    
    instance_deactivate_object(obj_star);
}

if ((string_count("fallen",battle_special)&gt;0)) and (defeat=0){
    var fallen;fallen=0;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],1]="fallen") then fallen=1;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],2]="fallen") then fallen=2;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],3]="fallen") then fallen=3;
    if (obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],4]="fallen") then fallen=4;
    
    obj_turn_end.battle_object[obj_turn_end.current_battle].p_problem[obj_turn_end.battle_world[obj_turn_end.current_battle],fallen]="";
    obj_turn_end.battle_object[obj_turn_end.current_battle].p_timer[obj_turn_end.battle_world[obj_turn_end.current_battle],fallen]=-1;
    
    var tixt;tixt="The Fallen on "+string(obj_turn_end.battle_object[obj_turn_end.current_battle].name);
    tixt+=scr_roman(obj_turn_end.battle_world[obj_turn_end.current_battle]);
    scr_event_log("","Mission Succesful: "+string(tixt)+" have been captured or purged.");
    
    tixt+=" have been captured or purged.  They shall be brought to the "+string(obj_img.player_army)+" "+string(obj_ini.role[100,14])+"s posthaste, in order to account for their sins.  ";
    var ran;ran=choose(1,1,2,3);
    if (ran=1) then tixt+="Suffering is the beginning to penance.";
    if (ran=2) then tixt+="Their screams shall be the harbringer of their contrition.";
    if (ran=3) then tixt+="The shame they inflicted upon us shall be written in their flesh.";
    scr_popup("Hunt the Fallen Completed",tixt,"fallen","");
}

if (defeat=0) and (enemy=9) and (battle_special="tyranid_org"){
    if (captured_gaunt&gt;1){
        pop=instance_create(0,0,obj_popup);
        pop.image="inquisition";
        pop.title="Inquisition Mission Completed";
        pop.text="You have captured several Gaunt organisms.  The Inquisitor is pleased with your work, though she notes that only one is needed- the rest are to be purged.  It will be stored until it may be retrieved.  The mission is a success.";
    }
    if (captured_gaunt=1){
        pop=instance_create(0,0,obj_popup);
        pop.image="inquisition";
        pop.title="Inquisition Mission Completed";
        pop.text="You have captured a Gaunt organism- the Inquisitor is pleased with your work.  The Tyranid will be stored until it may be retrieved.  The mission is a success.";
    }
}



if (enemy=1) and (on_ship=true) and (defeat=0){
    var diceh;diceh=floor(random(100))+1;
    
    var o;o=0;repeat(4){i+=1;if (obj_ini.dis[o]="Shitty Luck") then diceh-=15;}
    
    if (diceh&lt;=15){
        var ship,ship_hp,i;i=-1;
        repeat(51){i+=1;
            ship[i]=obj_ini.ship[i];ship_hp[i]=obj_ini.ship_hp[i];
            if (i=battle_id){obj_ini.ship_hp[i]=-50;scr_recent("ship_destroyed",obj_ini.ship[i],i);}
        }
        var pop;pop=instance_create(0,0,obj_popup);
        pop.image="";
        pop.title="Ship Destroyed";
        pop.text="A handful of loyalist "+string(global.chapter_name)+" make a fighting retreat to the engine of the vessel, '"+string(obj_ini.ship[battle_id])+"', and then overload the main reactor.  Your ship explodes in a brilliant cloud of fire.";
        scr_event_log("red","A handful of loyalist "+string(global.chapter_name)+" overload the main reactor of your vessel '"+string(obj_ini.ship[battle_id])+"'.");
        pop.mission="loyalist_destroy_ship";
        
        with(obj_fleet){repeat(2){scr_dead_marines(2);}}
        with(obj_ini){scr_ini_ship_cleanup();}
    }
}




if (enemy=1){
    if (battle_special="cs_meeting_battle1") or (battle_special="cs_meeting_battle2"){
        obj_controller.diplomacy=10;obj_controller.menu=20;
        with(obj_controller){scr_dialogue("cs_meeting21");}
    }
    
    // obj_img.faction_title[1] just murdered absolutely everyone
    if (battle_special="cs_meeting_battle7") and (defeat=0){
        if (obj_controller.chaos_rating&lt;1) then obj_controller.chaos_rating+=1;
        obj_controller.complex_event=false;obj_controller.diplomacy=0;obj_controller.menu=0;
        obj_controller.force_goodbye=0;obj_controller.cooldown=20;
        obj_controller.current_eventing="chaos_meeting_end";
        with(obj_temp_meeting){instance_destroy();}with(obj_popup){instance_destroy();}
        if (instance_exists(obj_turn_end)){
            obj_turn_end.combating=0;// obj_turn_end.alarm[1]=1;
        }
        var pip;pip=instance_create(0,0,obj_popup);
        pip.title="Enemies Vanquished";pip.text="Not only have you killed the Chaos Lord, "+string(obj_controller.faction_leader[10])+", but also all of your battle brothers that questioned your rule.  As you stand, alone, among the broken corpses of your enemies you begin to question what exactly it is that you accomplished.  No matter the results, you feel as though your actions have been noticed.";
    }
}

if (enemy=10){
    if ((battle_special="cs_meeting_battle10")) and (defeat=0){
        obj_controller.complex_event=false;obj_controller.diplomacy=0;obj_controller.menu=0;
        obj_controller.force_goodbye=0;obj_controller.cooldown=20;
        obj_controller.current_eventing="chaos_meeting_end";
        with(obj_temp_meeting){instance_destroy();}with(obj_popup){instance_destroy();}
        if (instance_exists(obj_turn_end)){
            obj_turn_end.combating=0;// obj_turn_end.alarm[1]=1;
        }
        var pip;pip=instance_create(0,0,obj_popup);
        pip.title="Survived";pip.text="You and the rest of your battle brothers fight your way out of the catacombs, back through the tunnel where you first entered.  By the time you manage it your forces are battered and bloodied and in desperate need of pickup.  The whole meeting was a bust- Chaos Lord "+string(obj_controller.faction_leader[10])+" clearly intended to kill you and simply be done with it.";
    }

    if ((battle_special="cs_meeting_battle5") or (battle_special="cs_meeting_battle6")) and (defeat=0){
        var mos;mos=false;
        
        with(obj_temp4){instance_destroy();}
        with(obj_pnunit){
            var j;j=0;
            repeat(300){j+=1;
                if (marine_type[j]="Master of Sanctity") then instance_create(0,0,obj_temp4);
            }
        }
        // Master of Sanctity present, wishes to take in the player
        if (instance_exists(obj_temp4)) and (string_count("CRMOS|",obj_controller.useful_info)=0){
            obj_controller.menu=20;with(obj_controller){scr_dialogue("cs_meeting_m5");}
        }
        
        // Master of Sanctity not present, just get told that you have defeated the Chaos Lord
        if (!instance_exists(obj_temp4)) or (string_count("CRMOS|",obj_controller.useful_info)&gt;0){
            // Some kind of popup based on what you were going after
            
            obj_controller.complex_event=false;obj_controller.diplomacy=0;obj_controller.menu=0;
            obj_controller.force_goodbye=0;obj_controller.cooldown=20;
            obj_controller.current_eventing="chaos_meeting_end";
            with(obj_temp_meeting){instance_destroy();}with(obj_popup){instance_destroy();}
            if (instance_exists(obj_turn_end)){
                obj_turn_end.combating=0;// obj_turn_end.alarm[1]=1;
            }
            var pip;pip=instance_create(0,0,obj_popup);
            pip.title="Chaos Lord Killed";pip.text="(Not completed yet- variable reward based on what chosen)";
        }
        with(obj_temp4){instance_destroy();}
    }
}



if (battle_special="ship_demon"){
    if (defeat=1){
        var ship,ship_hp,i;i=-1;
        repeat(51){i+=1;
            ship[i]=obj_ini.ship[i];ship_hp[i]=obj_ini.ship_hp[i];
            if (i=battle_id){obj_ini.ship_hp[i]=-50;scr_recent("ship_destroyed",obj_ini.ship[i],i);}
        }
        var pop;pop=instance_create(0,0,obj_popup);
        pop.image="";
        pop.title="Ship Destroyed";
        pop.text="The daemon has slayed all of your marines onboard.  It works its way to the engine of the vessel, '"+string(obj_ini.ship[battle_id])+"', and then tears into the main reactor.  Your ship explodes in a brilliant cloud of fire.";
        scr_event_log("red","A daemon unbound from an Artifact wreaks havoc upon and destroys your vessel '"+string(obj_ini.ship[battle_id])+"'.");
        
        with(obj_fleet){repeat(2){scr_dead_marines(2);}}
        with(obj_ini){scr_ini_ship_cleanup();}
    }
}

if (battle_special="space_hulk") and (defeat=0) and (hulk_treasure&gt;0){
    var shiyp,shi,d,loc;
    shiyp=0;shi=0;d=0;
    
    with(obj_p_fleet){if (action!="") then instance_deactivate_object(id);}
    shiyp=instance_nearest(battle_object.x,battle_object.y,obj_p_fleet);
    if (shi=0) and (shiyp.capital_number&gt;0) then shi=shiyp.capital_num[1];
    if (shi=0) and (shiyp.frigate_number&gt;0) then shi=shiyp.frigate_num[1];
    if (shi=0) and (shiyp.escort_number&gt;0) then shi=shiyp.escort_num[1];
    loc=obj_ini.ship[shi];instance_activate_object(obj_p_fleet);
    
    if (hulk_treasure=1){// Requisition
        var reqi;reqi=round(random_range(30,60)+1)*10;
        obj_controller.requisition+=reqi;
        
        var pop;pop=instance_create(0,0,obj_popup);
        pop.image="space_hulk_done";
        pop.title="Space Hulk: Resources";
        pop.text="Your battle brothers have located several luxury goods and coginators within the Space Hulk.  They are salvaged and returned to the ship, granting "+string(reqi)+" Requisition.";
    }
    if (hulk_treasure=2){// Artifact
        scr_add_artifact("random","random",4,loc,shi+500);
        var i,last_artifact;i=0;last_artifact=0;
        repeat(100){if (last_artifact=0){i+=1;if (obj_ini.artifact[i]="") then last_artifact=i-1;}}
        var pop;pop=instance_create(0,0,obj_popup);
        pop.image="space_hulk_done";
        pop.title="Space Hulk: Artifact";
        pop.text="An Artifact has been retrieved from the Space Hulk and stowed upon "+string(loc)+".  It appears to be a "+string(obj_ini.artifact[last_artifact])+" but should be brought home and identified posthaste.";
        scr_event_log("","Artifact recovered from the Space Hulk.");
    }
    if (hulk_treasure=3){// STC
        scr_add_stc_fragment();// STC here
        var pop;pop=instance_create(0,0,obj_popup);
        pop.image="space_hulk_done";
        pop.title="Space Hulk: STC Fragment";
        pop.text="An STC Fragment has been retrieved from the Space Hulk and safely stowed away.  It is ready to be decrypted or gifted at your convenience.";
        scr_event_log("","STC Fragment recovered from the Space Hulk.");
    }
    if (hulk_treasure=4){// Termie Armor
        var termi;termi=choose(2,2,2,3);
        scr_add_item(string(obj_img.battlesuit),termi);
        var pop;pop=instance_create(0,0,obj_popup);
        pop.image="space_hulk_done";
        pop.title="Space Hulk: Terminator Armor";
        pop.text="The fallen heretics wore several suits of Terminator Armor- a handful of them were found to be cleansible and worthy of use.  "+string(termi)+" Terminator Armor has been added to the Armamentarium.";
    }
}



if ((leader=1) or (battle_special="world_eaters")) and (obj_controller.faction_defeated[10]=0) and (defeat=0) and (battle_special!="WL10_reveal") and (battle_special!="WL10_later"){
    if (battle_special!="WL10_reveal") and (battle_special!="WL10_later"){
    // prolly schedule a popup congratulating
    obj_controller.faction_defeated[enemy]=1;
    if (obj_controller.known[enemy]=0) then obj_controller.known[enemy]=1;
    
    if (battle_special!="world_eaters") then with(obj_star){
        if (string_count("WL"+string(obj_ncombat.enemy),p_feature[obj_ncombat.battle_id])&gt;0){
            p_feature[obj_ncombat.battle_id]=string_replace(p_feature[obj_ncombat.battle_id],"WL"+string(obj_ncombat.enemy)+"|","");
        }
    }
    if (battle_special="world_eaters"){
        obj_controller.faction_defeated[10]=1;// show_message("WL10 defeated");
        if (instance_exists(obj_turn_end)){
            scr_event_log("","Enemy Leader Assassinated: Chaos Lord");
            scr_alert("","ass","Chaos Lord "+string(obj_controller.faction_leader[10])+" has been killed.",0,0);
            scr_popup("Black Crusade Ended","The Chaos Lord "+string(obj_controller.faction_leader[10])+" has been slain in combat.  Without his leadership the Black Crusade is destined to crumble apart and disintegrate from infighting.  Sector "+string(obj_ini.sector_name)+" is no longer at threat by the forces of Chaos.","","");
        }
        if (!instance_exists(obj_turn_end)){
            scr_event_log("","Enemy Leader Assassinated: Chaos Lord");
            var pop;pop=instance_create(0,0,obj_popup);
            pop.image="";pop.title="Black Crusade Ended";
            pop.text="The Chaos Lord "+string(obj_controller.faction_leader[10])+" has been slain in combat.  Without his leadership the Black Crusade is destined to crumble apart and disintegrate from infighting.  Sector "+string(obj_ini.sector_name)+" is no longer at threat by the forces of Chaos.";
        }
    }
}}



instance_activate_all();
with(obj_pnunit){instance_destroy();}
with(obj_enunit){instance_destroy();}
with(obj_nfort){instance_destroy();}
with(obj_centerline){instance_destroy();}
obj_controller.new_buttons_hide=0;


if (instance_exists(obj_cursor)){obj_cursor.image_index=0;}

instance_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (battle_over=1) then exit;

/*if (messages_to_show=8){
    if (enemy_forces&lt;=0) or (!instance_exists(obj_enunit)) and (defeat_message=0){defeat_message=1;
        newline_color="yellow";newline="Enemy Forces Defeated";timer_maxspeed=0;
        timer_speed=0;timer=0;started=2;messages_shown=105;// done=1;// alarm[3]=-1;
        scr_newtext();exit;
    }
    if (player_forces&lt;=0) and (defeat_message=0){defeat_message=1;
        newline_color="yellow";newline=string(global.chapter_name)+" Defeated";
        timer_maxspeed=0;timer_speed=0;started=4;messages_shown=105;defeat=1;// done=1;
        scr_newtext();exit;
    }
    if (instance_exists(obj_enunit)){
        if (timer_stage=2){
            timer_stage=3;
            timer=0;
        }
        if (timer_stage=4){
            timer_stage=5;
            timer=0;
        }
    }
}
*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Final Text</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// Final Screen

var part1,part2,part3,part4,part5,part6,part7,part8,part9,part10;
part1="";part2="";part3="";part4="";part9="";
part5="";part6="";part7="";part8="";part10="";
battle_over=1;

alarm[8]=999999;




if (final_deaths+final_command_deaths&gt;0){
    part1="Marines Lost: "+string(final_deaths+final_command_deaths);
    if (apoth=1) then part1+=" ("+string(obj_ini.role[100,15])+" prevented the death of "+string(units_saved)+")";
    if (apoth&gt;1) then part1+=" ("+string(obj_ini.role[100,15])+"s prevented the death of "+string(units_saved)+")";
    if (injured&gt;0) then part8="Marines Critically Injured: "+string(injured);
    
    var i;i=0;
    repeat(30){i+=1;
        if (post_unit_lost[i]!="") and (post_units_lost[i]&gt;0) and (post_unit_veh[i]=0){
            part2+=string(post_units_lost[i])+"x "+string(post_unit_lost[i])+", ";
        }
    }
    part2=string_delete(part2,string_length(part2)-1,2);part2+=".";i=0;
    
    if (injured&gt;0){newline=part8;scr_newtext();}
    newline=part1;scr_newtext();
    newline=part2;newline_color="red";scr_newtext();
    newline=" ";scr_newtext();
}




seed_saved=(min(seed_max,apoth*40))-gene_penalty;
if (string_count("Doom",obj_ini.strin2)&gt;0) then seed_saved=0;
if (seed_saved&gt;0) then obj_controller.gene_seed+=seed_saved;

if (apoth&gt;0) and (final_deaths+final_command_deaths&gt;0) and (string_count("Doom",obj_ini.strin2)=0){
    part3=string(obj_img.organics)+" Recovered: "+string(seed_saved)+" (";
    if (seed_saved&gt;0) then part3+=string(round((seed_saved/seed_max)*100));
    if (seed_saved=0) then part3+="0";
    part3+="%)";
    newline=part3;scr_newtext();
    newline=" ";scr_newtext();
}
if (apoth=0) and (string_count("Doom",obj_ini.strin2)=0){
    part3="No able-bodied "+string(obj_ini.role[100,15])+".  "+string(seed_max)+" "+string(obj_img.organics)+" lost.";
    newline=part3;scr_newtext();
    newline=" ";scr_newtext();
}
if (string_count("Doom",obj_ini.strin2)&gt;0){
    part3=string(obj_img.player_army)+" Mutation prevents retrieving "+string(obj_img.organics)+".  "+string(seed_max)+" "+string(obj_img.organics)+" lost.";
    newline=part3;scr_newtext();
    newline=" ";scr_newtext();
}


if (red_thirst&gt;2){
    var voodoo;voodoo="";

    if (red_thirst=3) then voodoo="1 Battle Brother lost to the Red Thirst.";
    if (red_thirst&gt;3) then voodoo=string(red_thirst-2)+" Battle Brothers lost to the Red Thirst.";
    
    newline=voodoo;newline_color="red";scr_newtext();
    newline=" ";scr_newtext();
}


if (vehicle_deaths&gt;0){
    part4="Vehicles Lost: "+string(vehicle_deaths);
    if (techma=1) then part4+=" ("+string(obj_ini.role[100,16])+" prevented the destruction of "+string(vehicles_saved)+")";
    if (techma&gt;1) then part4+=" ("+string(obj_ini.role[100,16])+"s prevented the destruction of "+string(vehicles_saved)+")";
    
    var i;i=0;
    repeat(30){i+=1;
        if (post_unit_lost[i]!="") and (post_units_lost[i]&gt;0) and (post_unit_veh[i]=1){
            part5+=string(post_units_lost[i])+"x "+string(post_unit_lost[i])+", ";
        }
    }
    part5=string_delete(part5,string_length(part5)-1,2);part5+=".";i=0;
    
    newline=part4;scr_newtext();
    newline=part5;scr_newtext();
    newline=" ";scr_newtext();
}


if (post_equipment_lost[1]!=""){
    part6="Equipment Lost: ";
    
    var i;i=0;
    repeat(50){i+=1;
        if (post_equipment_lost[i]!="") and (post_equipments_lost[i]&gt;0){
            part7+=string(post_equipments_lost[i])+"x "+string(post_equipment_lost[i])+", ";
        }
    }
    part7=string_delete(part7,string_length(part7)-1,2);part7+=".";i=0;
    
    newline=part6;scr_newtext();
    newline=part7;scr_newtext();
    newline=" ";scr_newtext();
}
if (slime&gt;0){
    var compan_slime;
    compan_slime=0;
    
    var s1,s2,s3,s4;
    s1="";s2="";s3="";s4="";
    
    i=-1;
    
    s1="Slime has short-circuited and destroyed "+string(slime);
    
    repeat(11){i+=1;
        if (mucra[i]=1){compan_slime+=1;s3+=string(i)+", ";}
    }
    
    if (compan_slime&lt;=1){s2=" suits of Power Armor.  Company ";s4=" has been effected.";}
    if (compan_slime&gt;1){s2=" suits of Power Armor.  Companies ";s4=" have been effected.";}
    if (slime=1) then s2=string_replace(s2,"suits ","suit ");
    
    s3=string_delete(s3,string_length(s3)-1,2);
    
    newline=s1+s2+s3+s4;newline_color="red";scr_newtext();
    newline=" ";scr_newtext();
}

instance_activate_object(obj_star);


var lowf;lowf=true;
if (battle_special="tyranid_org") then lowf=false;
if (string_count("_attack",battle_special)&gt;0) then lowf=false;
if (battle_special="ship_demon") then lowf=false;
if (enemy+threat=17) then lowf=false;
if (battle_special="ruins") then lowf=false;
if (battle_special="ruins_eldar") then lowf=false;
if (battle_special="fallen1") then lowf=false;
if (battle_special="fallen2") then lowf=false;
if (battle_special="study2a") then lowf=false;
if (battle_special="study2b") then lowf=false;

if (fortified&gt;0) and (!instance_exists(obj_nfort)) and (lowf=true){
    part9="Fortification level of "+string(battle_loc);
    if (battle_id=1) then part9+=" I";
    if (battle_id=2) then part9+=" II";
    if (battle_id=3) then part9+=" III";
    if (battle_id=4) then part9+=" IV";
    if (battle_id=5) then part9+=" V";
    part9+=" has decreased to "+string(fortified-1)+" ("+string(fortified)+"-1)";
    newline=part9;scr_newtext();
    battle_object.p_fortified[battle_id]-=1;
}


/*if (enemy=5){
    if (obj_controller.faction_status[5]!="War"){
        
    }
}*/





if (defeat=0) and (battle_special="space_hulk"){
    var en_power,loot,dicey,ex;
    en_power=0;loot=0;dicey=floor(random(100))+1;ex=0;
    
    if (enemy=7){en_power=battle_object.p_orks[battle_id];battle_object.p_orks[battle_id]-=1;}
    if (enemy=9){en_power=battle_object.p_tyranids[battle_id];battle_object.p_tyranids[battle_id]-=1;}
    if (enemy=10){en_power=battle_object.p_traitors[battle_id];battle_object.p_traitors[battle_id]-=1;}
    
    part10="Space Hulk Exploration at ";
    ex=min(100,100-((en_power-1)*20));
    part10+=string(ex)+"%";
    newline=part10;if (ex=100) then newline_color="red";scr_newtext();
    
    if (string_count("Shitty",obj_ini.strin2)&gt;0) then dicey=dicey*1.5;
    // show_message("Roll Under: "+string(en_power*10)+", Roll: "+string(dicey));
    
    if (dicey&lt;=(en_power*10)){
        loot=choose(1,2,3,4);
        if (enemy!=10) then loot=choose(1,1,2,3);
        hulk_treasure=loot;
        if (loot&gt;1) then newline="Valuable items recovered.";
        if (loot=1) then newline="Resources have been recovered.";
        newline_color="yellow";
        scr_newtext();
    }
}


if (string_count("ruins",battle_special)&gt;0){
    if (defeat=0) then newline="Ancient Ruins cleared.";
    if (defeat=1) then newline="Failed to clear Ancient Ruins.";
    newline_color="yellow";
    scr_newtext();
}

var npowers;npowers=true;
if (battle_special="tyranid_org") then npowers=false;
if (battle_special="ship_demon") then npowers=false;
if (string_count("_attack",battle_special)&gt;0) then npowers=false;
if (string_count("ruins",battle_special)&gt;0) then npowers=false;
if (battle_special="space_hulk") then npowers=false;
if (battle_special="fallen1") then npowers=false;
if (battle_special="fallen2") then npowers=false;
if (battle_special="study2a") then npowers=false;
if (battle_special="study2b") then npowers=false;
if (defeat=0) and (npowers=true){
    var en_power,new_power;
    en_power=0;new_power=0;
    
    if (enemy=2){
        en_power=battle_object.p_guardsmen[battle_id];
        battle_object.p_guardsmen[battle_id]-=threat;
        // if (threat=1) or (threat=2) then battle_object.p_guardsmen[battle_id]=0;
    }
    
    if (enemy=5){en_power=battle_object.p_sisters[battle_id];part10="Ecclesiarchy";}
    if (enemy=6){en_power=battle_object.p_eldar[battle_id];part10="Eldar";}
    if (enemy=7){en_power=battle_object.p_orks[battle_id];part10="Ork";}
    if (enemy=8){en_power=battle_object.p_tau[battle_id];part10="Tau";}
    if (enemy=9){en_power=battle_object.p_tyranids[battle_id];part10="Tyranid";}
    if (enemy=10){en_power=battle_object.p_traitors[battle_id];part10="Heretic";if (threat=7) then part10="Daemon";}
    if (enemy=11){en_power=battle_object.p_chaos[battle_id];part10="Chaos Space Marine";}
    if (enemy=13){en_power=battle_object.p_necrons[battle_id];part10="Necrons";}
    
    if (instance_exists(battle_object)) and (en_power&gt;2){
        if (string_count("Awakened",battle_object.p_feature[battle_id])=0){
            scr_gov_disp(battle_object.name,battle_id,floor(en_power/2));
        }
    }
    
    if (enemy!=2){
        if (attacker=0) then new_power=en_power-1;
        if ((attacker=1) or (dropping=1)) then new_power=en_power-2;
        
        new_power=max(new_power,0);
        if (part10="Daemon") then new_power=7;
        if (enemy=9) and (new_power=0) then scr_event_log("","Tyranids cleansed from "+string(battle_object.name)+" "+scr_roman(battle_id));
        if (enemy=11) and (en_power!=floor(en_power)) then en_power=floor(en_power);
    }
    
    
    if (obj_controller.blood_debt=1) and (defeat=0){
        if (enemy=6) or (enemy=9) or (enemy=11) or (enemy=13){
            if (en_power=1){obj_controller.penitent_current+=25;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=2){obj_controller.penitent_current+=62;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=3){obj_controller.penitent_current+=95;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=4){obj_controller.penitent_current+=190;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=5){obj_controller.penitent_current+=375;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=6){obj_controller.penitent_current+=750;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
        }
        if (enemy=7) or (enemy=8) or (enemy=10){
            if (en_power=1){obj_controller.penitent_current+=25;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=2){obj_controller.penitent_current+=50;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=3){obj_controller.penitent_current+=75;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=4){obj_controller.penitent_current+=150;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=5){obj_controller.penitent_current+=300;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=6){obj_controller.penitent_current+=600;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
            if (en_power=7){obj_controller.penitent_current+=1500;obj_controller.penitent_turn=0;obj_controller.penitent_turnly=0;}
        }
    }
    
    if (enemy=5){battle_object.p_sisters[battle_id]=new_power;}
    if (enemy=6){battle_object.p_eldar[battle_id]=new_power;}
    if (enemy=7){battle_object.p_orks[battle_id]=new_power;}
    if (enemy=8){battle_object.p_tau[battle_id]=new_power;}
    if (enemy=9){battle_object.p_tyranids[battle_id]=new_power;}
    if (enemy=10){battle_object.p_traitors[battle_id]=new_power;}
    if (enemy=11){battle_object.p_chaos[battle_id]=new_power;}
    if (enemy=13){battle_object.p_necrons[battle_id]=new_power;}
    
    if (enemy!=2) and (string_count("cs_meeting_battle",battle_special)=0){
        part10+=" Forces on "+string(battle_loc);
        if (battle_id=1) then part10+=" I";
        if (battle_id=2) then part10+=" II";
        if (battle_id=3) then part10+=" III";
        if (battle_id=4) then part10+=" IV";
        if (battle_id=5) then part10+=" V";
        part10+=" have decreased to "+string(new_power)+" ("+string(en_power)+"-"+string(en_power-new_power)+")";
        newline=part10;scr_newtext();
        
        if (new_power&lt;=0) and (en_power&gt;0) then battle_object.p_raided[battle_id]=1;
    }
    if (enemy=2){
        part10+=" "+string(obj_img.faction[2])+" Forces on "+string(battle_loc);
        if (battle_id=1) then part10+=" I";
        if (battle_id=2) then part10+=" II";
        if (battle_id=3) then part10+=" III";
        if (battle_id=4) then part10+=" IV";
        if (battle_id=5) then part10+=" V";
        part10+=" have decreased to "+string(battle_object.p_guardsmen[battle_id])+" ("+string(en_power)+"-"+string(threat)+")";
        newline=part10;scr_newtext();
    }
    
    
    
    if (enemy=8) and (ethereal&gt;0) and (defeat=0){
        newline=string(obj_img.faction[8])+" "+string(obj_img.unit[8,14])+" Captured";newline_color="yellow";scr_newtext();
    }
    
    if (enemy=13) and (battle_object.p_necrons[battle_id]&lt;3) and (string_count("Awakened "+string(obj_img.faction_dude_formal[13])+" Tomb|",battle_object.p_feature[battle_id])&gt;0){
    
        // var bombs;bombs=scr_check_equip("Plasma Bomb",battle_loc,battle_id,0);
        // var bombs;bombs=scr_check_equip("Plasma Bomb","","",0);
        
        // show_message(string(bombs));
        
        if (plasma_bomb&gt;0){
            // scr_check_equip("Plasma Bomb",battle_loc,battle_id,1);
            // scr_check_equip("Plasma Bomb","","",1);
            newline="Plasma Bomb used to seal the "+string(obj_img.faction_dude_formal[13])+" Tomb.";newline_color="yellow";scr_newtext();
            battle_object.p_feature[battle_id]=string_replace(battle_object.p_feature[battle_id],"Awakened "+string(obj_img.faction_dude_formal[13])+" Tomb|",string(obj_img.faction_dude_formal[13])+" Tomb|");
            // if (battle_object.p_feature[battle_id]="Awakened Necron Tomb") then battle_object.p_feature[battle_id]="Necron Tomb";
        }
        
        if (plasma_bomb&lt;=0){
            battle_object.p_necrons[battle_id]=3;// newline_color="yellow";
            if (dropping!=0) then newline="Deep Strike Ineffective; Plasma Bomb required";
            if (dropping=0) then newline="Attack Ineffective; Plasma Bomb required";
            scr_newtext();
        }
        
        // popup here
        /*
        var pip;
        pip=instance_create(0,0,obj_popup);
        pip.title="Necron Tombs";
        pip.text="The Necrons have been defeated on the surface, but remain able to replenish their numbers and recuperate.  Do you wish to advance your army into the tunnels?";
        pip.image="necron_tunnels_1";    
        pip.cooldown=15;
        cooldown=15;
        
        pip.option1="Advance!";
        pip.option2="Cancel the attack";*/
        
        
        
        
    }
    
    
    
    
    
    /*if (enemy=13) and (new_power&lt;=0) and (dropping=0){
        var bombs;bombs=scr_check_equip("Plasma Bomb",battle_loc,battle_id,0);
        if (bombs&gt;0){
            scr_check_equip("Plasma Bomb",battle_loc,battle_id,1);
            newline="Plasma Bomb used to seal the Necron Tomb.";newline_color="yellow";scr_newtext();
            if (battle_object.p_feature[battle_id]="Awakened Necron Tomb") then battle_object.p_feature[battle_id]="Necron Tomb";
        }
    }*/
}
if (defeat=0) and (enemy=9) and (battle_special="tyranid_org"){
    // show_message(string(captured_gaunt));
    if (captured_gaunt=1) then newline=string(captured_gaunt)+" Gaunt organism have been captured.";
    if (captured_gaunt&gt;1) or (captured_gaunt=0) then newline=string(captured_gaunt)+" Gaunt organisms have been captured.";
    scr_newtext();
    
    if (captured_gaunt&gt;0){
        var why,thatta;why=0;thatta=0;
        instance_activate_object(obj_star);
        // with(obj_star){if (name!=obj_ncombat.battle_loc) then instance_deactivate_object(id);}
        // thatta=obj_star;
        
        with(obj_star){
            var u;u=0;
            repeat(4){u+=1;
                if (p_problem[u,1]="tyranid_org"){p_problem[u,1]="";p_timer[u,1]=0;}
                if (p_problem[u,2]="tyranid_org"){p_problem[u,2]="";p_timer[u,2]=0;}
                if (p_problem[u,3]="tyranid_org"){p_problem[u,3]="";p_timer[u,3]=0;}
                if (p_problem[u,4]="tyranid_org"){p_problem[u,4]="";p_timer[u,4]=0;}
            }
        }
        
        /*var u;u=0;
        repeat(4){u+=1;
            if (thatta.p_problem[u,1]="tyranid_org"){thatta.p_problem[u,1]="";thatta.p_timer[u,1]=0;}
            if (thatta.p_problem[u,2]="tyranid_org"){thatta.p_problem[u,2]="";thatta.p_timer[u,2]=0;}
            if (thatta.p_problem[u,3]="tyranid_org"){thatta.p_problem[u,3]="";thatta.p_timer[u,3]=0;}
            if (thatta.p_problem[u,4]="tyranid_org"){thatta.p_problem[u,4]="";thatta.p_timer[u,4]=0;}
        }*/
    }
    
    scr_event_log("",string(obj_img.faction[4])+" Mission Completed: A Gaunt organism has been captured for the Inquisition.");
    
    if (captured_gaunt&gt;1){
        if (instance_exists(obj_turn_end)) then scr_popup(string(obj_img.faction[4])+" Mission Completed","You have captured several Gaunt organisms.  The "+string(obj_img.faction_dude_formal[4])+" is pleased with your work, though she notes that only one is needed- the rest are to be purged.  It will be stored until it may be retrieved.  The mission is a success.","inquisition","");
    }
    if (captured_gaunt=1){
        if (instance_exists(obj_turn_end)) then scr_popup(string(obj_img.faction[4])+" Mission Completed","You have captured a Gaunt organism- the "+string(obj_img.faction_dude_formal[4])+" is pleased with your work.  The "+string(obj_img.faction_dude_formal[9])+" will be stored until it may be retrieved.  The mission is a success.","inquisition","");
    }
    instance_deactivate_object(obj_star);
}


newline="------------------------------------------------------------------------------";scr_newtext();
newline="------------------------------------------------------------------------------";scr_newtext();

if (((leader=1)) or ((battle_special="world_eaters") and (obj_controller.faction_defeated[10]=0))) and (defeat=0){
    var nep;nep=false;
    newline="The enemy Leader has been killed!";newline_color="yellow";scr_newtext();
    newline="------------------------------------------------------------------------------";scr_newtext();
    newline="------------------------------------------------------------------------------";scr_newtext();
    instance_activate_object(obj_event_log);
    if (enemy=5) then scr_event_log("","Enemy Leader Assassinated: "+string(obj_img.faction_dude_formal[5])+" "+string(obj_img.faction_title[5]));
    if (enemy=6) then scr_event_log("","Enemy Leader Assassinated: "+string(obj_img.faction_dude_formal[6])+" "+string(obj_img.faction_title[6]));
    if (enemy=7) then scr_event_log("","Enemy Leader Assassinated: "+string(obj_img.faction_dude_formal[7])+" "+string(obj_img.faction_title[7]));
    if (enemy=8) then scr_event_log("","Enemy Leader Assassinated: "+string(obj_img.faction_dude_formal[8])+" "+string(obj_img.faction_title[8]));
    if (enemy=10) then scr_event_log("","Enemy Leader Assassinated: "+string(obj_img.faction_title[11]));
}

var endline,inq_eated;endline=1;
inq_eated=false;


if (obj_ini.omophagea=1){
    var eatme;eatme=floor(random(100))+1;
    if (enemy=13) or (enemy=9) or (battle_special="ship_demon") then eatme+=100;
    if (enemy=10) and (battle_object.p_traitors[battle_id]=7) then eatme+=200;
    
    if (red_thirst=3) then thirsty=1;if (red_thirst&gt;3) then thirsty=red_thirst-2;
    if (thirsty&gt;0) then eatme-=(thirsty*6);if (really_thirsty&gt;0) then eatme-=(really_thirsty*15);
    if (string_count("Shitty",obj_ini.strin2)=1) then eatme-=10;
    
    if (allies&gt;0){obj_controller.disposition[2]-=choose(1,0,0);obj_controller.disposition[4]-=choose(0,0,1);obj_controller.disposition[5]-=choose(0,0,1);}
    if (present_inquisitor&gt;0) then obj_controller.disposition[4]-=2;
    
    if (eatme&lt;=25){endline=0;
        if (thirsty=0) and (really_thirsty=0){
            var ran;ran=choose(1,2);
            newline="One of your marines slowly makes his way towards the fallen enemies, as if in a spell.  Once close enough the helmet is removed and he begins shoveling parts of their carcasses into his mouth.";
            newline="Two marines are sharing a quick discussion, and analysis of the battle, when one of the two suddenly drops down and begins shoveling parts of enemy corpses into his mouth.";
            newline+=choose("  Bone snaps and pops.","  Strange-colored blood squirts from between his teeth.","  Veins and tendons squish wetly.");
        }
        if (thirsty&gt;0) and (really_thirsty=0){
            var ran;ran=choose(1,2);
            newline="One of your Death Company marines slowly makes his way towards the fallen enemies, as if in a spell.  Once close enough the helmet is removed and he begins shoveling parts of their carcasses into his mouth.";
            newline="A marine is observing and communicating with a Death Company marine, to ensure they are responsive, when that Death Company marine drops down and suddenly begins shoveling parts of enemy corpses into his mouth.";
            newline+=choose("  Bone snaps and pops.","  Strange-colored blood squirts from between his teeth.","  Veins and tendons squish wetly.");
        }
        if (really_thirsty&gt;0){
            newline="One of your Death Company "+string(obj_ini.role[100,6])+" blitzes to the fallen enemy lines.  Massive mechanical hands begin to rend and smash at the fallen corpses, trying to squeeze their flesh and blood through the sarcophogi opening.";
        }
        
        newline+="  Almost at once most of the present "+string(global.chapter_name)+" follow suite, joining in and starting a massive feeding frenzy.  The sight is gruesome to behold.";
        scr_newtext();
        
        
        // check for pdf/guardsmen
        eatme=floor(random(100))+1;if (string_count("Shitty",obj_ini.strin2)=1) then eatme-=10;
        if (eatme&lt;=10) and (allies&gt;0){
            obj_controller.disposition[2]-=2;
            if (allies=1){newline="Local PDF have been eaten!";newline_color="red";scr_newtext();}
            if (allies=2){newline="Local Guardsmen have been eaten!";newline_color="red";scr_newtext();}
        }
        
        // check for inquisitor
        eatme=floor(random(100))+1;if (string_count("Shitty",obj_ini.strin2)=1) then eatme-=5;
        if (eatme&lt;=40) and (present_inquisitor=1){
            var thatta,thatta2,remove,i;thatta=0;remove=0;i=0;
            obj_controller.disposition[4]-=10;inq_eated=true;
            instance_activate_object(obj_en_fleet);
            
            if (instance_exists(inquisitor_ship)){
                repeat(2){scr_loyalty("Inquisitor Killer","+");}
                if (obj_controller.loyalty&gt;=85) then obj_controller.last_world_inspection-=44;
                if (obj_controller.loyalty&gt;=70) and (obj_controller.loyalty&lt;85) then obj_controller.last_world_inspection-=32;
                if (obj_controller.loyalty&gt;=50) and (obj_controller.loyalty&lt;70) then obj_controller.last_world_inspection-=20;
                if (obj_controller.loyalty&lt;50) then scr_loyalty("Inquisitor Killer","+");
                
                var msg,msg2,i,remove;msg="";msg2="";i=0;remove=0;
                // if (string_count("Inqis",inquisitor_ship.trade_goods)&gt;0) then show_message("B");
                if (string_count("Inqis1",inquisitor_ship.trade_goods)=1){newline="Inquisitor "+string(obj_controller.inquisitor[1])+" has been eaten!";msg="Inquisitor "+string(obj_controller.inquisitor[1]);remove=1;scr_event_log("red","Your Astartes consume "+string(msg)+".");}
                if (string_count("Inqis2",inquisitor_ship.trade_goods)=1){newline="Inquisitor "+string(obj_controller.inquisitor[2])+" has been eaten!";msg="Inquisitor "+string(obj_controller.inquisitor[2]);remove=2;scr_event_log("red","Your Astartes consume "+string(msg)+".");}
                if (string_count("Inqis3",inquisitor_ship.trade_goods)=1){newline="Inquisitor "+string(obj_controller.inquisitor[3])+" has been eaten!";msg="Inquisitor "+string(obj_controller.inquisitor[3]);remove=3;scr_event_log("red","Your Astartes consume "+string(msg)+".");}
                if (string_count("Inqis4",inquisitor_ship.trade_goods)=1){newline="Inquisitor "+string(obj_controller.inquisitor[4])+" has been eaten!";msg="Inquisitor "+string(obj_controller.inquisitor[4]);remove=4;scr_event_log("red","Your Astartes consume "+string(msg)+".");}
                if (string_count("Inqis5",inquisitor_ship.trade_goods)=1){newline="Inquisitor "+string(obj_controller.inquisitor[5])+" has been eaten!";msg="Inquisitor "+string(obj_controller.inquisitor[5]);remove=5;scr_event_log("red","Your Astartes consume "+string(msg)+".");}
                newline_color="red";scr_newtext();
                if (obj_controller.inquisitor_type[remove]="Ordo Hereticus") then scr_loyalty("Inquisitor Killer","+");
                
                i=remove;
                repeat(10-remove){
                    if (i&lt;10){
                        obj_controller.inquisitor_gender[i]=obj_controller.inquisitor_gender[i+1];
                        obj_controller.inquisitor_type[i]=obj_controller.inquisitor_type[i+1];
                        obj_controller.inquisitor[i]=obj_controller.inquisitor[i+1];
                    }
                    if (i=10){
                        obj_controller.inquisitor_gender[i]=choose(1,1,1,1,2,2,2);
                        obj_controller.inquisitor_type[i]=choose("Ordo Malleus","Ordo Xenos","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus","Ordo Hereticus");
                        obj_controller.inquisitor[i]=scr_imperial_name(obj_controller.inquisitor_gender[i]);// For 'random inquisitor wishes to inspect your fleet
                    }
                    i+=1;
                }
                
                instance_activate_object(obj_turn_end);
                if (obj_controller.known[4]&lt;3) and (!instance_exists(obj_turn_end)){
                    var pip;pip=instance_create(0,0,obj_popup);
                    pip.title=string(obj_img.faction_dude_formal[4])+" Killed";pip.text=msg;pip.image="inquisition";pip.cooldown=30;
                    pip.title="EXCOMMUNICATUS TRAITORUS";
                    pip.text="The "+string(obj_img.faction[4])+" has noticed your uncalled CONSUMPTION of "+string(msg)+" and declared your "+string(obj_img.player_army)+" Excommunicatus Traitorus.";
                    instance_deactivate_object(obj_popup);
                    obj_controller.alarm[8]=1;
                    scr_event_log("red","EXCOMMUNICATUS TRAITORUS");
                }
                if (obj_controller.known[4]&lt;3) and (instance_exists(obj_turn_end)){
                    scr_popup(string(obj_img.faction_dude_formal[4])+" Killed","The "+string(obj_img.faction[4])+" has noticed your uncalled CONSUMPTION of "+string(msg)+" and declared your "+string(obj_img.player_army)+" Excommunicatus Traitorus.","inquisition","");
                    obj_controller.alarm[8]=1;scr_event_log("red","EXCOMMUNICATUS TRAITORUS");
                }
                instance_deactivate_object(obj_turn_end);
                
                with(inquisitor_ship){instance_destroy();}
                with(obj_temp3){instance_destroy();}
                with(obj_temp4){instance_destroy();}
            }
            instance_deactivate_object(obj_star);
            instance_deactivate_object(obj_en_fleet);
        }
    }
}

if (inq_eated=false) and (obj_ncombat.sorcery_seen&gt;=2){
    scr_loyalty("Use of Sorcery","+");newline=string(obj_img.faction_dude_formal[4])+" "+string(obj_controller.inquisitor[1])+" witnessed your "+string(obj_img.player_army)+" using sorcery.";
    scr_event_log("green",string(newline));scr_newtext();
}

if (exterminatus&gt;0) and (dropping!=0){
    newline="Exterminatus has been succesfully placed.";newline_color="yellow";endline=0;scr_newtext();
}

instance_activate_object(obj_star);
instance_activate_object(obj_turn_end);
if (defeat=1) and (dropping=0) and (string_count(string(obj_img.hq_ground)+"|",battle_object.p_feature[obj_ncombat.battle_id])&gt;0){
    with(obj_star){
        if (string_count(string(obj_img.hq_ground)+"|",p_feature[obj_ncombat.battle_id])&gt;0){
            p_feature[obj_ncombat.battle_id]=string_replace(p_feature[obj_ncombat.battle_id],string(obj_img.hq_ground)+"|","");
        }
    }
    
    if (obj_controller.und_gene_vaults=0) then newline="Your "+string(obj_img.hq_ground)+" has been raided.  "+string(obj_controller.gene_seed)+" "+string(obj_img.organics)+" has been destroyed or stolen.";
    if (obj_controller.und_gene_vaults&gt;0) then newline="Your "+string(obj_img.hq_ground)+" has been raided.  "+string(floor(obj_controller.gene_seed/10))+" "+string(obj_img.organcs)+" has been destroyed or stolen.";
    
    scr_event_log("red",string(newline));
    instance_activate_object(obj_event_log);
    newline_color="red";scr_newtext();
    
    var lasers_lost,defenses_lost,silos_lost;
    lasers_lost=0;defenses_lost=0;silos_lost=0;
    
    if (player_defenses&gt;0){defenses_lost=round(player_defenses*0.75);}
    if (battle_object.p_silo[obj_ncombat.battle_id]&gt;0){silos_lost=round(battle_object.p_silo[obj_ncombat.battle_id]*0.75);}
    if (battle_object.p_lasers[obj_ncombat.battle_id]&gt;0){lasers_lost=round(battle_object.p_lasers[obj_ncombat.battle_id]*0.75);}
    
    if (player_defenses&lt;30) then defenses_lost=player_defenses;
    if (battle_object.p_silo[obj_ncombat.battle_id]&lt;30){silos_lost=battle_object.p_silo[obj_ncombat.battle_id];}
    if (battle_object.p_lasers[obj_ncombat.battle_id]&lt;8){lasers_lost=battle_object.p_lasers[obj_ncombat.battle_id];}
    
    var percent;percent=0;newline="";
    if (defenses_lost&gt;0){
        percent=round((defenses_lost/player_defenses)*100);
        newline=string(defenses_lost)+" Weapon Emplacements have been lost ("+string(percent)+"%).";
    }
    if (silos_lost&gt;0){
        percent=round((silos_lost/battle_object.p_silo[obj_ncombat.battle_id])*100);
        if (defenses_lost&gt;0) then newline+="  ";
        newline+=string(silos_lost)+" Missile Silos have been lost ("+string(percent)+"%).";
    }
    if (lasers_lost&gt;0){
        percent=round((lasers_lost/battle_object.p_lasers[obj_ncombat.battle_id])*100);
        if (silos_lost&gt;0) or (defenses_lost&gt;0) then newline+="  ";
        newline+=string(lasers_lost)+" Defense Lasers have been lost ("+string(percent)+"%).";
    }
    
    battle_object.p_defenses[obj_ncombat.battle_id]-=defenses_lost;
    battle_object.p_silo[obj_ncombat.battle_id]-=silos_lost;
    battle_object.p_lasers[obj_ncombat.battle_id]-=lasers_lost;
    if (defenses_lost+silos_lost+lasers_lost&gt;0){newline_color="red";scr_newtext();}
    
    endline=0;
    
    if (obj_controller.und_gene_vaults=0){
        obj_controller.gene_seed=0;var w;w=0;repeat(120){w+=1;if (obj_ini.slave_batch_num[w]&gt;0){obj_ini.slave_batch_num[w]=0;obj_ini.slave_batch_eta[w]=0;}}
    }
    if (obj_controller.und_gene_vaults&gt;0) then obj_controller.gene_seed-=floor(obj_controller.gene_seed/10);
    
}
instance_deactivate_object(obj_star);
instance_deactivate_object(obj_turn_end);

if (endline=0){
    newline="------------------------------------------------------------------------------";scr_newtext();
    newline="------------------------------------------------------------------------------";scr_newtext();
}


if (defeat=1){player_forces=0;}

instance_deactivate_object(obj_star);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Deaths</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var jims;jims=0;
repeat(20){
    jims+=1;
    
    if (dead_jim[jims]!=""){
        newline=dead_jim[jims];newline_color="red";
        scr_newtext();
        dead_jim[jims]="";
        dead_jims-=1;
        
        if (dead_jims&gt;0) then alarm[4]=1;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Bunch of messages</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// if (battle_over=1) then exit;
if (defeat_message=1) then exit;

if (wall_destroyed=1) then wall_destroyed=0;

var i,good,changed;i=0;good=0;changed=0;

// if (messages_to_show=8) and (messages_shown=0) then alarm[6]=75;
// if (messages_shown=105) then exit;




/*i+=1;if (message[i]!="") then show_message(message[i]);
i+=1;if (message[i]!="") then show_message(message[i]);
i+=1;if (message[i]!="") then show_message(message[i]);
i+=1;if (message[i]!="") then show_message(message[i]);
i+=1;if (message[i]!="") then show_message(message[i]);
i+=1;if (message[i]!="") then show_message(message[i]);*/



repeat(100){
    if (good=0){
        changed=0;i=0;
        
        repeat(55){
            i+=1;
            
            // Collide the messages if needed
            if (message[i]="") and (message[i+1]!=""){
                message[i]=message[i+1];
                message_sz[i]=message_sz[i+1];
                message_priority[i]=message_priority[i+1];
                
                message[i+1]="";
                message_sz[i+1]=0;
                message_priority[i+1]=0;
                changed=1;
            }
            
            // Move larger messages up
            if (message[i]!="") and (message[i+1]!="") and (message_sz[i]&lt;message_sz[i+1]) and ((message_priority[i]&lt;message_priority[i+1]) or (message_priority[i]=0)){
                message[100]=message[i];
                message_sz[100]=message_sz[i];
                message_priority[100]=message_priority[i];
                
                message[i]=message[i+1];
                message_sz[i]=message_sz[i+1];
                message_priority[i]=message_priority[i+1];
                
                message[i+1]=message[100];
                message_sz[i+1]=message_sz[100];
                message_priority[i+1]=message_priority[100];
                changed=1;
            }
            
            // Move messages with higher priority up
            if (message[i]!="") and (message[i+1]!="") and (message_priority[i]&lt;message_priority[i+1]){
                message[100]=message[i];
                message_sz[100]=message_sz[i];
                message_priority[100]=message_priority[i];
                
                message[i]=message[i+1];
                message_sz[i]=message_sz[i+1];
                message_priority[i]=message_priority[i+1];
                
                message[i+1]=message[100];
                message_sz[i+1]=message_sz[100];
                message_priority[i+1]=message_priority[100];
                changed=1;
            }
            
            if (changed=0) then good=1;
        }
    }
}




if ((messages&gt;0) and (messages_shown&lt;8)) and (messages_shown&lt;=100){
    var that_sz,that;// show_message("Largest Message");
    that_sz=0;that=0;
    
    i=0;repeat(60){
        i+=1;
        if (message[i]!="") and (message_sz[i]&gt;that_sz){
            that_sz=message_sz[i];that=i;
        }
    }
    if (that!=0) and (that_sz&gt;0){
        newline=message[that];
        if (message_priority[that]&gt;0) then newline_color="bright";
        if (string_count(" casts '",newline)&gt;0) then newline_color="blue";
        if (string_count("Perils of the Warp!",newline)&gt;0) then newline_color="red";
        if (string_count("^",newline)&gt;0){
            newline=string_replace(newline,"^","");
            newline_color="white";
        }
        if (message_priority[that]=2.1) then newline_color="purple";
        if (string_count("confers knowledge",newline)&gt;0) then newline_color="purple";
        
        if (message_priority[that]=135) then newline_color="blue";
        if (message_priority[that]=136) then newline_color="blue";
        
        scr_newtext();messages_shown+=1;largest+=1;
        message[that]="";message_sz[that]=0;message_priority[that]=0;messages-=1;
    }
    
    alarm[3]=2;
}








if (messages=0) or (messages_shown&gt;=8) then messages_shown=999;

if (messages=0) then messages_shown=999;

/*var noloss;noloss=instance_nearest(50,300,obj_pnunit);
if (!instance_exists(noloss)) then player_forces=0;
if (instance_exists(noloss)){if (point_distance(50,300,noloss.x,noloss.y)&gt;500) then player_forces=0;}*/


if (instance_exists(obj_pnunit)){
    var plnear;plnear=instance_nearest(room_width,240,obj_pnunit);
    if (plnear.x&lt;-40) then player_forces=0;
}
if (!instance_exists(obj_pnunit)) then player_forces=0;


if ((messages_shown=999) or (messages=0)) and (timer_stage=2){
    newline_color="yellow";
    if (obj_ncombat.enemy!=6){
        if (enemy_forces&gt;0) and (obj_ncombat.enemy!=30) then newline="Enemy Forces at "+string(max(1,round((enemy_forces/enemy_max)*100)))+"%";
        if (obj_ncombat.enemy=30) and (instance_exists(obj_enunit)){newline="Enemy has ";var yoo;yoo=instance_nearest(0,0,obj_enunit);newline+=string(round(yoo.dudes_hp[1]))+"HP remaining";}
        if (enemy_forces&lt;=0) or (!instance_exists(obj_enunit)) and (defeat_message=0){defeat_message=1;newline="Enemy Forces Defeated";timer_maxspeed=0;timer_speed=0;started=2;instance_activate_object(obj_pnunit);}
    }
    newline_color="yellow";
    if (obj_ncombat.enemy=6){
        var jims;jims=0;
        repeat(20){jims+=1;
            if (dead_jim[jims]!="") and (dead_jims&gt;0){
                newline=dead_jim[jims];newline_color="red";
                scr_newtext();dead_jim[jims]="";dead_jims-=1;
            }
        }
        if (player_forces&gt;0){newline=string(global.chapter_name)+" at "+string(round((player_forces/player_max)*100))+"%";four_show=0;}
        var plnear;plnear=instance_nearest(room_width,240,obj_pnunit);
        if ((player_forces&lt;=0) or (plnear.x&lt;-40)) and (defeat_message=0){defeat_message=1;newline=string(global.chapter_name)+" Defeated";timer_maxspeed=0;timer_speed=0;started=4;defeat=1;instance_activate_object(obj_pnunit);}
    }
    messages_shown=105;done=1;scr_newtext();timer_stage=3;exit;
}

if ((messages_shown=999) or (messages=0)) and ((timer_stage=4) or (timer_stage=5)) and (four_show=0){
    newline_color="yellow";
    if (obj_ncombat.enemy!=6){
        var jims;jims=0;
        repeat(20){jims+=1;
            if (dead_jim[jims]!="") and (dead_jims&gt;0){
                newline=dead_jim[jims];newline_color="red";
                scr_newtext();dead_jim[jims]="";dead_jims-=1;
            }
        }
        if (player_forces&gt;0){newline=string(global.chapter_name)+" at "+string(round((player_forces/player_max)*100))+"%";four_show=1;}
        var plnear;plnear=instance_nearest(room_width,240,obj_pnunit);
        if ((player_forces&lt;=0) or (plnear.x&lt;-40)) and (defeat_message=0){defeat_message=1;newline=string(global.chapter_name)+" Defeated";timer_maxspeed=0;timer_speed=0;started=4;defeat=1;instance_activate_object(obj_pnunit);}
    }
    newline_color="yellow";
    if (obj_ncombat.enemy=6){
        if (enemy_forces&gt;0) then newline="Enemy Forces at "+string(max(1,round((enemy_forces/enemy_max)*100)))+"%";
        if ((enemy_forces&lt;=0) or (!instance_exists(obj_enunit))) and (defeat_message=0){defeat_message=1;newline="Enemy Forces Defeated";timer_maxspeed=0;timer_speed=0;started=2;instance_activate_object(obj_pnunit);}
    }
    messages_shown=105;done=1;scr_newtext();timer_stage=5;exit;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
player_max=player_forces;enemy_max=enemy_forces;

instance_activate_object(obj_enunit);

if (dropping=1){
    repeat(10){
        var mm;mm=instance_nearest(5000,240,obj_pnunit);
        if (!collision_point(mm.x+10,mm.y,obj_enunit,0,1)) then with(obj_pnunit){x+=10;}
    }
    repeat(10){
        with(obj_enunit){
            if (!collision_point(x-10,y,obj_pnunit,0,1)) and (!collision_point(x-10,y,obj_enunit,0,1)) then x-=10;
        }
    }
}


if (ally&gt;0) and (ally_forces&gt;0){
    if (ally=3){
        if (ally_forces&gt;=1){
            var thata,ii,good;
            thata=instance_nearest(0,240,obj_pnunit);ii=0;good=0;
            
            
            
            if (instance_exists(thata)){
                repeat(1000){if (good=0){ii+=1;if (thata.marine_type[ii]="") and (thata.marine_id[ii]=0) then good=ii;}}
                ii=good;
                if (good&gt;0){
                    repeat(10){
                        thata.marine_type[ii]="Techpriest";thata.marine_hp[ii]=50;
                        thata.marine_ac[ii]=20;thata.marine_exp[ii]=100;
                        thata.marine_wep1[ii]="Power Weapon";thata.marine_wep2[ii]="Conversion Beam Projector";
                        thata.marine_armor[ii]="Dragon Scales";thata.marine_gear[ii]="Servo Arms";
                        thata.ally[ii]=true;thata.marine_dead[ii]=0;ii+=1;thata.men+=1;
                    }
                    repeat(20){
                        thata.marine_type[ii]="Skitarii";thata.marine_hp[ii]=40;
                        thata.marine_ac[ii]=10;thata.marine_exp[ii]=10;
                        thata.marine_wep1[ii]="Hellgun";thata.marine_wep2[ii]="";
                        thata.marine_armor[ii]="Skitarii Armor";thata.marine_gear[ii]="";
                        thata.ally[ii]=true;thata.marine_dead[ii]=0;ii+=1;thata.men+=1;
                    }
                }
                
                ii=0;good=0;
                repeat(50){if (good=0){ii+=1;if (thata.dudes[ii]="") and (thata.dudes_num[ii]=0) then good=ii;}}
                if (good&gt;0){thata.dudes[ii]="Techpriest";thata.dudes_num[ii]=10;thata.dudes_vehicle[ii]=0;}
                ii=0;good=0;
                repeat(50){if (good=0){ii+=1;if (thata.dudes[ii]="") and (thata.dudes_num[ii]=0) then good=ii;}}
                if (good&gt;0){thata.dudes[ii]="Skitarii";thata.dudes_num[ii]=20;thata.dudes_vehicle[ii]=0;}
                thata.alarm[1]=1;
            }
        }
    }
}






// scr_newtext();

/*if (newline!=""){
    var breaks,first_open;
    newline=scr_lines(89,newline);
    breaks=max(1,string_count("@",newline));
    first_open=liness+1;
    
    var b,f;b=first_open;f=-1;
    explode_script(newline,"@");
    f+=1;lines[b+f]=string("-"+explode[f]);
    repeat(breaks-1){f+=1;
        lines[b+f]=string(explode[f]);
    }
    liness+=string_count("@",newline);
    
    repeat(100){
        if (liness&gt;30){scr_lines_increase(1);liness-=1;}
    }
}

newline="";*/


instance_activate_object(obj_enunit);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>First Text Blurps</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var a1;a1="";

if (ally&gt;0) and (ally_forces&gt;0){
    if (ally=3){
        if (ally_forces&gt;=1) then a1="Joining your forces are 10 Techpriests and 20 Skitarii.  Omnissian Power Axes come to life, crackling and popping with disruptive energy, and Conversion Beam Projectors are levelled to fire.  The Tech-Guard are silent as they form a perimeter around their charges, at contrast with their loud litanies and Lingua-technis bursts.";
    }
}



// Player crap here
var p1,p2,p3,p4,p5,p6,p7,p8,temp,temp2,temp3,temp4,temp5,temp6;
p1="";p2="";p3="";p4="";p5="";p6="";p8="";temp=0;temp2=0;temp3=0;temp4=0;temp5=0;temp6=0;
var d1,d2,d3,d4,d5,d6,d7,d8;
d1="";d2="";d3="";d4="";d5="";d6="";d7="";d8="";


temp=scouts+tacticals+veterans+devastators+assaults+librarians;
temp+=techmarines+honors+dreadnoughts+terminators+captains;
temp+=standard_bearers+important_dudes+chaplains+apothecaries;

var color_descr;
color_descr="";

if (obj_ini.main_color!=obj_ini.secondary_color) then color_descr=string(obj_controller.col[obj_ini.main_color])+" and "+string(obj_controller.col[obj_ini.secondary_color]);
if (obj_ini.main_color=obj_ini.secondary_color) then color_descr=string(obj_controller.col[obj_ini.main_color]);

/*show_message(scouts+tacticals+veterans+devastators+assaults+librarians);
show_message(techmarines+honors+dreadnoughts+terminators+captains);
show_message(standard_bearers+important_dudes+chaplains+apothecaries);
show_message(temp);*/

// Random variations; dark out, rain pooling down, dawn shining off of the armor, etc.
var variation;variation="";
variation=choose("","dawn","rain");


if (battle_special="ship_demon"){
    p1="As the Artifact is smashed and melted down some foul smoke begins to erupt from it, spilling outward and upward.  After a sparse handful of seconds it takes form into a ";
    p1+=string(obj_enunit.dudes[1]);
    p1+=".  Now free, it seems bent upon slaying your marines.  Onboard you have ";
}

if (battle_special="ruins") or (battle_special="ruins_eldar"){
    p1="Your marines place themselves into a proper fighting position, defensible and ready to fight whatever may come.  Enemies may only come from a few directions, though the ancient corridors and alleyways are massive, and provide little cover.";
    p1+="  You have ";
}

if (string_count("mech",battle_special)&gt;0){
    p1="Large, hulking shapes advance upon your men from every direction.  The metal corridors and blast chambers prevent escape.  Soon 4 Thallax and half a dozen Praetorian Servitors can be seen, with undoubtably more to come.";
    p1+="  You have ";
}

if (battle_special="space_hulk"){
    if (hulk_forces&gt;0) then p1="Your marines manuever through the hull of the Space Hulk, shadows dancing and twisting before their luxcasters.  The hallway integrity is nonexistant- twisted metal juts out in hazardous ways or opens into bottomless pits.  Still, there is loot and knowledge to be gained.  It is not long before your men's sensorium pick up hostile blips.  Your own forces are made up of ";
    if (hulk_forces=0) then p1="Your marines manuever through the hull of the Space Hulk, shadows dancing and twisting before their luxcasters.  The hallway integrity is nonexistant- twisted metal juts out in hazardous ways or opens into bottomless pits.  Your forces are made up of ";
}


if (battle_special=""){
    if (dropping=0){
        if (temp-dreadnoughts&gt;0){
            if (variation=""){p1="Dirt crunches beneath the soles of "+string(temp)+" "+string(global.chapter_name)+" as they form up.  Your ranks are made up of ";}
            if (variation="rain"){p1="Rain pelts the ground and fogs the air, partly veiling the "+string(temp)+" "+string(global.chapter_name)+".  Your ranks are made up of ";}
            if (variation="dawn"){p1="The bright light of dawn reflects off the "+string_lower(color_descr)+" ceremite of "+string(temp)+" "+string(global.chapter_name)+".  Your ranks are made up of ";}
        }
    }
    if (dropping=1){
        if (temp-dreadnoughts&gt;0){// lyman
            p1="The air rumbles and quakes as "+string(temp)+" "+string(global.chapter_name)+" descend in drop-pods.  ";
        
        
            /*if (variation=""){
                if (lyman=0) then p1="The air rumbles and quakes as "+string(temp)+" "+string(global.chapter_name)+" descend in drop-pods.  Before the enemy can bring their full ranged power to bear the pods smash down.  With practiced speed your marines pour on free.  Their ranks are made up of ";
                if (lyman=1) then p1="The air rumbles and quakes as "+string(temp)+" "+string(global.chapter_name)+" descend in drop-pods.  Before the enemy can bring their full ranged power to bear the pods smash down.  Your marines exit the vehicles, shaking off their vertigo and nausea with varying degrees of success.  Your ranks are made up of ";
            }
            */
        }
    }
}
if (string_count("spyrer",battle_special)&gt;0){
    p1="Your marines search through the alleyways and corridors likely to contain the Spyrer.  It does not take long before the lunatic attacks, springing off from a wall to fall among your men.  Your ranks are made up of ";
}
if (string_count("fallen",battle_special)&gt;0){
    p1="Your marines search through the alleyways and dens likely to contain the Fallen.  Several days pass before the search is succesful; the prey is located by Auspex and closed in upon.  ";
    if (battle_climate="Lava") then p1="Your marines search through the broken craggs and spires of the molten planet.  Among the bubbling lava, and cracking earth, they search for the Fallen.  After several days of searching Auspex detect the prey.  ";
    if (battle_climate="Dead") then p1="Your marines search through the cratered surface of the debris field.  Among the cracking earth and dust they search for the Fallen.  After several days of searching Auspex detect the prey.  ";
    if (battle_climate="Agri") then p1="Endless fields of wheat and barley are an unlikely harbor for a renegade, but your marines search the agri world all the same.  After several days of searching Auspex detect the prey.  ";
    if (battle_climate="Feral") then p1="Deadly carniverous plants and endless canopy blot out the surface of the planet.  Among the disheveled hills, and heavy underbrush, your marines search for the Fallen.  After several days of searching Auspex detect the prey.  ";
    if (battle_climate="Ice") then p1="Your marines search through the endless glaciers and peaks of the frozen planet.  Among the howling wind, and cracking ice, they search for the Fallen.  After several days of searching Auspex detect the prey.  ";
    if (obj_enunit.dudes_num[1]=1) then p1+="The coward soon realizes he has been located, and reacts like a cornered animal, brandishing weapons.";
    if (obj_enunit.dudes_num[1]&gt;1) then p1+="The cowards soon realize they have been located, and react like cornered animals, brandishing weapons.";
    p1+="  Your ranks are made up of ";
}







if (string_count("_attack",battle_special)&gt;0){
    var wh;wh=choose(1,2);
    if (wh=1) then p1="Cave dirt crunches beneath the soles of your marines as they continue their descent.  There is little warning before ";
    if (wh=2) then p1="The shadows stretch and morph as the lights cast by your marines move along.  One large shadow begins to move on its own- ";

    if (string_count("wake",battle_special)&gt;0){
        p1="Cave dirt crunches beneath the soles of your marines as they continue their descent.  There is little warning when the ground begins to shake.  An old, dusty breeze seems to flow through the tunnel, followed by rumbling sensations and distant mechanical sounds.  ";
        if (string_count("1",battle_special)&gt;0) then p1+="Within minutes Necrons begin to appear from every direction.  There appears to be nearly fourty, cramped in the dark tunnels.";
        if (string_count("2",battle_special)&gt;0) then p1+="Within minutes Necrons begin to appear from every direction.  There appears to be nearly a hundred, cramped in the dark tunnels.";
        if (string_count("3",battle_special)&gt;0) then p1+="Within minutes Necrons begin to appear from every direction.  Their numbers are wihout number.";
    }
    
    
    
    
    if (string_count("wraith",battle_special)&gt;0) then p1+="two Necron Wraiths appear out of nowhere and begin to attack.";
    if (string_count("spyder",battle_special)&gt;0) then p1+="a large Canoptek Spyder launches towards your marines, a small group of scuttling Scarabs quickly following.";
    if (string_count("stalker",battle_special)&gt;0) then p1+="the tunnel begins to shake and a massive Tomb Stalker scuttles into your midst.";
    newline=p1;scr_newtext();
    exit;
}






if (tacticals&gt;0) and (veterans&gt;0){
    p2=string(tacticals+veterans)+" "+string(obj_ini.role[100,8])+"s, ";
}
if (tacticals&gt;0) and (veterans=0){
    if (tacticals=1) then p2=string(tacticals)+" "+string(obj_ini.role[100,8])+", ";
    if (tacticals&gt;1) then p2=string(tacticals)+" "+string(obj_ini.role[100,8])+"s, ";
}
if (tacticals=0) and (veterans&gt;0){
    if (veterans=1) then p2=string(veterans)+" "+string(obj_ini.role[100,3])+", ";
    if (veterans&gt;1) then p2=string(veterans)+" "+string(obj_ini.role[100,3])+"s, ";
}

if (assaults&gt;0){
    if (assaults=1) then p2+=string(assaults)+" "+string(obj_ini.role[100,10])+", ";
    if (assaults&gt;1) then p2+=string(assaults)+" "+string(obj_ini.role[100,10])+"s, ";
}
if (devastators&gt;0){
    if (devastators=1) then p2+=string(devastators)+" "+string(obj_ini.role[100,9])+", ";
    if (devastators&gt;1) then p2+=string(devastators)+" "+string(obj_ini.role[100,9])+"s, ";
}

if (temp&lt;200) and (terminators&gt;0){
    if (terminators=1) then p2+=string(terminators)+" Terminator, ";
    if (terminators&gt;1) then p2+=string(terminators)+" Terminators, ";
}

if (temp&lt;200) and (chaplains&gt;0){
    if (chaplains=1) then p2+=string(chaplains)+" "+string(obj_ini.role[100,14])+", ";
    if (chaplains&gt;1) then p2+=string(chaplains)+" "+string(obj_ini.role[100,14])+", ";
}

if (temp&lt;200) and (apothecaries&gt;0){
    if (apothecaries=1) then p2+=string(apothecaries)+" "+string(obj_ini.role[100,15])+", ";
    if (apothecaries&gt;1) then p2+=string(apothecaries)+" "+string(obj_ini.role[100,15])+", ";
}

if (temp&lt;200) and (librarians&gt;0){
    if (librarians=1) then p2+=string(librarians)+" "+string(obj_ini.role[100,17])+", ";
    if (librarians&gt;1) then p2+=string(librarians)+" "+string(obj_ini.role[100,17])+", ";
}

if (temp&lt;200) and (techmarines&gt;0){
    if (techmarines=1) then p2+=string(techmarines)+" "+string(obj_ini.role[100,16])+", ";
    if (techmarines&gt;1) then p2+=string(techmarines)+" "+string(obj_ini.role[100,16])+", ";
}


if (scouts&gt;0){
    if (scouts=1) then p2+=string(scouts)+" "+string(obj_ini.role[100,12])+", ";
    if (scouts&gt;1) then p2+=string(scouts)+" "+string(obj_ini.role[100,12])+"s, ";
}


// temp5=string_length(p2);p2=string_delete(p2,temp5-1,2);// p2+=".";
temp6=honors+captains+important_dudes+standard_bearers;
if (temp&gt;=200) then temp6+=terminators;
if (temp&gt;=200) then temp6+=chaplains;
if (temp&gt;=200) then temp6+=apothecaries;
if (temp&gt;=200) then temp6+=techmarines;
if (temp&gt;=200) then temp6+=librarians;
if (temp6&gt;0) then p2+=string(temp6)+" other various Astartes, ";

var woo;woo=string_length(p2);
p2=string_delete(p2,woo-1,2);

if (string_count(", ",p2)&gt;1){
    var woo;woo=string_rpos(", ",p2);
    p2=string_insert(" and",p2,woo+1);
}
if (string_count(", ",p2)=1){
    var woo;woo=string_rpos(", ",p2);
    p2=string_delete(p2,woo-1,2);
    p2=string_insert(" and",p2,woo+1);
}
p2+=".";





if (standard_bearers&gt;1) and (dropping=0) then p5="  The Battle Standard Bearers hold your "+string(obj_img.player_army)+" heraldry high and proud.";



if (dreadnoughts+predators+land_raiders&gt;3){
    p6="  Forming up the armored division is ";
    if (dreadnoughts=1) then p6+=string(dreadnoughts)+" "+string(obj_ini.role[100,6])+", ";
    if (dreadnoughts&gt;1) then p6+=string(dreadnoughts)+" "+string(obj_ini.role[100,6])+"s, ";
    
    if (rhinos=1) then p6+=string(rhinos)+" "+string(obj_img.unit[1,18])+", ";
    if (rhinos&gt;1) then p6+=string(rhinos)+" "+string(obj_img.unit[1,18])+"s, ";
    
    if (predators=1) then p6+=string(predators)+" "+string(obj_img.unit[1,19])+", ";
    if (predators&gt;1) then p6+=string(predators)+" "+string(obj_img.unit[1,19])+"s, ";
    
    if (land_raiders=1) then p6+=string(land_raiders)+" "+string(obj_img.unit[1,21])+", ";
    if (land_raiders&gt;1) then p6+=string(land_raiders)+" "+string(obj_img.unit[1,21])+"s, ";
    
    if (whirlwinds=1) then p6+=string(whirlwinds)+" "+string(obj_img.unit[1,20])+", ";
    if (whirlwinds&gt;1) then p6+=string(whirlwinds)+" "+string(obj_img.unit[1,20])+"s, ";
        
    // Other vehicles here?
    
    var woo;woo=string_length(p6);
    p6=string_delete(p6,woo-1,2);
    
    if (string_count(", ",p6)&gt;1){
        var woo;woo=string_rpos(", ",p6);    
        p6=string_insert(" and",p6,woo+1);
    }
    if (string_count(", ",p6)=1){
        var woo;woo=string_rpos(", ",p6);
        p6=string_delete(p6,woo-1,2);
        p6=string_insert(" and",p6,woo+1);
    }
    p6+=".";
    
}
// If less than three spell out the individual vehicles


if (battle_special="space_hulk"){
    newline=p1+p2;scr_newtext();
    if (a1!=""){newline=a1;scr_newtext();}
    if (hulk_forces&gt;0){newline="There are "+string(hulk_forces)+" or so blips.";scr_newtext();}
    
    exit;
}
if (dropping=0){
    newline=p1+p2+p3+p4+p5+p6;
    scr_newtext();
    if (a1!=""){newline=a1;scr_newtext();}
}

if (dropping=1) and (battle_special!="space_hulk"){
    d1=p1;d2=p2;
    d3=p3;d4=p4;
    d5=p5;d6=p6;
}


if (battle_special="ruins") or (battle_special="ruins_eldar"){
    newline="The enemy forces are made up of "+string(enemy_dudes);
    
    if (enemy=6) then newline+=" Craftworld Eldar.";
    if (enemy=10) then newline+=" Cultists and Mutants.";
    if (enemy=11) then newline+=" Chaos Space Marines.";
    if (enemy=12) then newline+=" Daemons.";
    
    scr_newtext();exit;
}




// Enemy crap here
var rand;
p1="";p2="";p3="";p4="";p5="";p6="";
temp2=0;temp3=0;temp4=0;temp5=0;

/*if (terrain=""){rand=choose(1,2,3);// Variations for terrain
    if (rand&lt;4) then 
    // if (rand=2) then p1="Encroaching upon your forces are ";
    // if (rand=3) then p1="Advancing upon your forces are ";
}

// p1+=string(enemy_dudes);// The number descriptor*/


if (enemy=2){
    p1="Opposing your forces are a total of "+scr_display_number(floor(guard_effective))+" Guardsmen, including Heavy Weapons and Armor.";
    p2="";p3="";
}



if (enemy=5) and (dropping=0){
    p1="Marching to face your forces ";
    if (threat=1) then p2="are a squad of Adepta Sororitas, back up by a dozen priests.  Forming up a protective shield around them are a large group of religious followers, gnashing and screaming out litanies to the "+string(obj_img.king_title)+".";
    if (threat=2) then p2="are several squads of Adepta Sororitas.  A large pack of religious followers forms up a protective shield in front, backed up by numerous Acro-Flagellents.";
    if (threat=3) then p2="are more than four hundred Adepta Sororitas, thick clouds of incense and smoke heralding their advance.  An equally massive pack of religious followers are spread around, screaming and babbling hyms to the "+string(obj_img.king_title)+".  Many are already bleeding from self-inflicted wounds or flagellation.  Several Penitent Engines clank and advance in the forefront.";
    if (threat=4) then p2="are more than a thousand Adepta Sororitas, a large portion of an order, thick clouds of incense and smoke heralding their advance.  A massive pack of religious followers are spread among the force, screaming and babbling hyms to the "+string(obj_img.king_title)+".  Many are already bleeding from self-inflicted wounds or flagellation.  Their voices are drowned out by the rumble of Penitent Engines and the loud vox-casters of Excorcists, blasting out litanies and organ music even more deafening volumes.";
    if (threat&gt;=5) then p2="is the entirety of an Adepta Sororitas order, the ground shaking beneath their combined thousands of footsteps.  Forming a shield around them in a massive, massive pack of religious followers, screaming out or babbling hyms to the "+string(obj_img.king_title)+".  All of the opposing army is a blurring, shifting mass of robes and ceremite, and sound, Ecclesiarchy Priests and Mistresses whipping the masses into more of a blood frenzy.  Organ music and litanies blast from the many Exorcists, the sound deafening to those too close.  Carried with the wind, and lingering in the air, is the heavy scent of promethium.";
}


if (enemy=6) and (dropping=0){
    // p1+=" Eldar";// Need a few random descriptors here
    rand=choose(1,2,3);
}
if (enemy=7) and (dropping=0){
    // p1+=" Orks";
    rand=choose(1,2,3);
    if (rand&lt;4){
        p1="Howls and grunts ring from the surrounding terrain as the Orks announce their presence.  ";
        p2=string(enemy_dudes)+", the bloodthirsty horde advances toward your Marines, ecstatic in their anticipation of carnage.  ";
        p3=p2;p2=string_delete(p2,2,999);p3=string_delete(p3,1,1);p2=string_upper(p2);// Capitalize the ENEMY DUDES first letter
    }
}
if (enemy=7) and (dropping=1){
    p1="The "+string(enemy_dudes)+"-some Orks howl and roar at the oncoming marines.  Many of the beasts fire their weapons, more or less spraying rounds aimlessly into the sky.";
}

if (enemy=8) and (dropping=0){
    // p1+=" Tau";
    rand=choose(1,2,3);
}
if (enemy=9) and (dropping=0){
    // p1+=" Tyranids";
    rand=choose(1,2,3);
}
if (enemy=9) and (dropping=1){
    p1="The "+string(enemy_dudes)+"-some Tyranids hiss and chitter as your marines rain down.  Blasts of acid and spikes fill the sky, but none seem to quite find their mark.";
}

if (enemy=10) and (dropping=0){
    // p1+=" heretics";
    rand=choose(1,2,3);
}


if (enemy=10) and (threat=7){
    rand=choose(1,2);
    if (rand=1) then p1="Laying before them is a hellish landscape, fitting for nightmares.  Twisted, flesh-like spires reach for the sky, each containing a multitude of fanged maws or eyes.  Lightning crackles through the red sky.  ";
    if (rand=2) then p1="Waiting for your marines is a twisted landscape.  Mutated, fleshy spires reach for the sky.  The ground itself is made up of choking purple ash, kicked up with each footstep, blocking vision.  ";
    p1+="All that can be seen twists and shifts, as though looking through a massive, distorted lens.  ";
    p8="The enemy forces are made up of over 3000 lesser Daemons.  Their front and rear ranks are made up of Maulerfiends and Soulgrinders, backed up by nearly a dozen Greater Daemons.  Each of the four Chaos Gods are represented.";
}

if (enemy=11) and (dropping=0){
    // p1+=" Chaos Space Marines";
    rand=choose(1,2,3);
}

if (enemy=12) and (dropping=0){
    // Daemons
}

if (enemy=13) and (dropping=0){
    rand=choose(1,2,3);
    if (rand&lt;4){
        p1="Dirt crunches beneath the feet of the Necrons as they make their silent advance.  ";
        p2=string(enemy_dudes)+", the souless xeno advance toward your Marines, silent and pulsing with green energy.  ";
        p3=p2;p2=string_delete(p2,2,999);p3=string_delete(p3,1,1);p2=string_upper(p2);// Capitalize the ENEMY DUDES first letter
    }
}


if (dropping=0){
    newline=p1+p2+p3+p4+p5+p6;
    scr_newtext();
    if (a1!=""){newline=a1;scr_newtext();}
    if (p8!=""){newline=p8;scr_newtext();}
}

if (dropping=1){
    newline=d1+p1;scr_newtext();
    if (lyman=0) then d7="After a brief descent all of the drop-pods smash down, followed quickly by your marines pouring free.  Their ranks are made up of ";
    if (lyman=1) then d7="After a brief descent all of the drop-pods smash down.  Your marines exit the vehicles, shaking off their vertigo and nausea with varying degrees of success.  Their ranks are made up of ";
    newline=d7+d2+d3+d4+d5+d6;scr_newtext();
    if (a1!=""){newline=a1;scr_newtext();}
    if (p8!=""){newline=p8;scr_newtext();}
}




if (occulobe=1) and (battle_special!="space_hulk"){
    if (time=5) or (time=6){
        newline="The morning light of dawn is blinding your marines!";newline_color="red";scr_newtext();
    }
}



if (fortified&gt;1) and (dropping=0) and (enemy+threat!=17){
    if (fortified=2) then newline="An Aegis Defense Line protects your forces.";
    if (fortified=3) then newline="Thick plasteel walls protect your forces.";
    if (fortified=4) then newline="A series of thick plasteel walls protect your forces.";
    if (fortified&gt;=5) then newline="A massive plasteel bastion protects your forces.";
    
    if (player_defenses&gt;0) and (player_silos&gt;0) then newline+="  The front of your "+string(obj_img.hq_ground)+" also boasts "+string(player_defenses)+" Weapon Emplacements and "+string(player_silos)+" Missile Silos.";
    if (player_defenses=0) and (player_silos&gt;0) then newline+="  Your "+string(obj_img.hq_ground)+" also boasts "+string(player_silos)+" Missile Silos.";
    if (player_defenses&gt;0) and (player_silos=0) then newline+="  The front of your "+string(obj_img.hq_ground)+" also boasts "+string(player_defenses)+" Weapon Emplacements.";
        
    scr_newtext();
}












// Check for battlecry here
// if (temp&gt;=100) and (threat&gt;1) and (big_mofo!=10) and (dropping=0){
if (temp&gt;=100) and (threat&gt;1) and (big_mofo&gt;0) and (big_mofo&lt;10) and (dropping=0){
    p1="";p2="";p3="";p4="";p5="";p6="";
    temp4=0;temp5=0;
    
    if (big_mofo=1) then p1="You ";
    if (big_mofo=2) then p1="The "+string(obj_img.head_chaplain)+" ";
    if (big_mofo=3) then p1="Chief "+string(obj_ini.role[100,17])+" ";
    if (big_mofo=5) then p1="A "+string(obj_ini.role[100,5])+" ";
    if (big_mofo=8) then p1="A "+string(obj_ini.role[100,14])+" ";
    
    
    
    var standard_cry;standard_cry=0;
    if (global.chapter_name="Salamanders"){standard_cry=1;
        var rand;rand=choose(1,2,3,4,5);
        if (rand=1) and (big_mofo!=1){p2="breaks the silence, begining the "+string(obj_img.player_army)+" Battlecry-";}if (rand=1) and (big_mofo=1){p2="break the silence, begining the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=2) and (big_mofo!=1){p2="roars the first half of the "+string(obj_img.player_army)+" Battlecry-";}if (rand=2) and (big_mofo=1){p2="roar the first half of the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=3) and (big_mofo!=1){p2="shouts the start of the "+string(obj_img.player_army)+" Battlecry-";}if (rand=3) and (big_mofo=1){p2="shout the start of the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=4) and (big_mofo!=1){p2="calls out to your marines-";}if (rand=4) and (big_mofo=1){p2="call out to your marines-";}
        if (rand=5) and (big_mofo!=1){p2="roars to your marines-";}if (rand=5) and (big_mofo=1){p2="roar to your marines-";}
        p3="''Into the fires of battle!''";
        if (temp&gt;=100) and (temp&lt;200){p4="Over a hundred "+string(obj_img.faction_dudes_formal[1])+" roar in return, their voice one-";}
        if (temp&gt;=200) and (temp&lt;400){p4="Several hundred "+string(obj_img.faction_dudes_formal[1])+" roar in return, their voice one-";}
        if (temp&gt;=500) and (temp&lt;800){p4="Your battle brothers echoe the cry, a massive sound felt more than heard-";}
        if (temp&gt;800){p4="The sound is deafening as the "+string(global.chapter_name)+" shout in unison-";}
        p5="''UNTO THE ANVIL OF WAR!''";
        newline=p1+p2;scr_newtext();
        newline=p3;scr_newtext();
        newline=p4;scr_newtext();
        newline=p5;scr_newtext();
    }
    
    // show_message(string(global.chapter_name)+"|"+string(global.custom)+"|"+string(standard_cry));
    
    if (global.chapter_name="Iron Warriors") and (global.custom=0){standard_cry=1;
        var rand;rand=choose(1,2,3,4,5);
        if (rand=1) and (big_mofo!=1){p2="breaks the silence, begining the "+string(obj_img.player_army)+" Battlecry-";}if (rand=1) and (big_mofo=1){p2="break the silence, begining the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=2) and (big_mofo!=1){p2="roars the first half of the "+string(obj_img.player_army)+" Battlecry-";}if (rand=2) and (big_mofo=1){p2="roar the first half of the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=3) and (big_mofo!=1){p2="shouts the start of the "+string(obj_img.player_army)+" Battlecry-";}if (rand=3) and (big_mofo=1){p2="shout the start of the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=4) and (big_mofo!=1){p2="calls out to your marines-";}if (rand=4) and (big_mofo=1){p2="call out to your marines-";}
        if (rand=5) and (big_mofo!=1){p2="roars to your marines-";}if (rand=5) and (big_mofo=1){p2="roar to your marines-";}
        p3="''Iron within!''";
        if (temp&gt;=100) and (temp&lt;200){p4="Over a hundred "+string(obj_img.faction_dudes_formal[1])+" roar in return, their voice one-";}
        if (temp&gt;=200) and (temp&lt;400){p4="Several hundred "+string(obj_img.faction_dudes_formal[1])+" roar in return, their voice one-";}
        if (temp&gt;=500) and (temp&lt;800){p4="Your battle brothers echoe the cry, a massive sound felt more than heard-";}
        if (temp&gt;800){p4="The sound is deafening as the "+string(global.chapter_name)+" shout in unison-";}
        p5="''IRON WITHOUT!''";
        newline=p1+p2;scr_newtext();
        newline=p3;scr_newtext();
        newline=p4;scr_newtext();
        newline=p5;scr_newtext();
    }
    
    
    if (standard_cry=0){standard_cry=1;
        var rand;rand=choose(1,2,3,4);
        if (rand=1){if (big_mofo!=1) then p2="breaks ";if (big_mofo=1) then p2="break ";p2+="the silence, calling out the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=2){if (big_mofo!=1) then p2="roars ";if (big_mofo=1) then p2="roar ";p2+="the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=3){if (big_mofo!=1) then p2="shouts ";if (big_mofo=1) then p2="shout ";p2+="the "+string(obj_img.player_army)+" Battlecry-";}
        if (rand=4){if (big_mofo!=1) then p2="roars ";if (big_mofo=1) then p2="roar ";p2+="to your marines-";}
        p3="''"+string(obj_ini.battle_cry)+"!''";
        if (temp&gt;=100) and (temp&lt;200){p4="Over a hundred "+string(obj_img.faction_dudes_formal[1])+" echoe the cry or let out shouts of their own.";}
        if (temp&gt;=200) and (temp&lt;400){p4="Several hundred "+string(obj_img.faction_dudes_formal[1])+" roar in return, echoing the cry.";}
        if (temp&gt;=500) and (temp&lt;800){p4="Your battle brothers echoe the cry, a massive sound felt more than heard.";}
        if (temp&gt;800) and (rand&gt;=3){p4="The sound is deafening as the "+string(global.chapter_name)+" add their voices.";}
        if (temp&gt;800) and (rand&lt;=2){p4="The sound is deafening as the "+string(global.chapter_name)+" return the cry and magnify it a thousand times.";}
        newline=p1+p2;scr_newtext();
        newline=p3;scr_newtext();
        newline=p4;scr_newtext();
    }
    
    
    
    
    
    
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Enemy Forces</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

if (battle_special="cs_meeting_battle5") then alpha_strike=1;

instance_activate_object(obj_enunit);


if (chapter_master_psyker=true) and (obj_ini.psy_powers="default"){
    var yeo,i;yeo=0;i=0;repeat(4){i+=1;if (obj_ini.adv[i]="Paragon") then yeo=1;}
    if (yeo=1) then kamehameha=true;
}



// show_message("Leader?: "+string(leader));


// if (enemy=1) then show_message("exiting obj_ncombat_Alarm 0_2 due to enemy=1");
if (enemy=1){instance_activate_object(obj_enunit);exit;}



if (battle_special="study2a") or (battle_special="study2b"){ally=3;ally_forces=1;}

xxx=instance_nearest(1000,240,obj_pnunit).x+80;

if (string_count("spyrer",battle_special)&gt;0) or (string_count("fallen",battle_special)&gt;0) or (string_count("mech",battle_special)&gt;0) or (battle_special="space_hulk") or (battle_special="study2a") or (battle_special="study2b") then fortified=0;

var i,u;i=11;
i=xxx/10;

if (fortified&gt;1) and (enemy+threat!=17){
    u=instance_create(0,0,obj_nfort);
    u.image_speed=0;u.image_alpha=0.5;
    
    if (fortified=2){
        u.ac[1]=30;
        u.hp[1]=400;
    }
    if (fortified=3){
        u.ac[1]=40;
        u.hp[1]=800;
    }
    if (fortified=4){
        u.ac[1]=40;
        u.hp[1]=1250;
    }
    if (fortified=5){
        u.ac[1]=40;
        u.hp[1]=1500;
    }
    
    if (siege=1) and (fortified&gt;0) and (attacker=0){
        global_attack=global_attack*1.1;
        u.hp[1]=round(u.hp[1]*1.2);
    }
    
    u.maxhp[1]=u.hp[1];
}



repeat(10){i-=1;
    u=instance_create(i*10,240,obj_enunit);
    u.column=i-((xxx/10)-10);
}

var u;
if (string_count("spyrer",battle_special)&gt;0){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(10,240,obj_enunit);
    enemy_dudes="1";u.dudes[1]="Malcadon Spyrer";u.dudes_num[1]=1;
    u.dudes_num[1]=1;enemies[1]=1;u.flank=1;
}
if (battle_special="fallen1"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(80,240,obj_enunit);
    enemy_dudes="1";u.dudes[1]="Fallen";u.dudes_num[1]=1;enemies[1]=1;
}
if (battle_special="fallen2"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(80,240,obj_enunit);
    enemy_dudes="1";u.dudes[1]="Fallen";
    u.dudes_num[1]=choose(1,1,2,2,3);
    enemies[1]=u.dudes_num[1];
}
if (string_count("mech",battle_special)&gt;0){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(xxx+10,240,obj_enunit);enemy_dudes="";
    u.dudes[1]=string(obj_img.unit[3,1]);u.dudes_num[1]=4;enemies[1]=4;
    u.dudes[2]=string(obj_img.unit[3,2]);u.dudes_num[2]=6;enemies[2]=6;
}
if (battle_special="ship_demon"){
    fortified=0;with(obj_enunit){instance_destroy();}
    enemy=10;u=instance_create(10,240,obj_enunit);
    enemy_dudes="1";u.dudes[1]=string(obj_img.unit[10,choose(37,38,39,40)]);
    u.dudes_num[1]=1;enemies[1]=1;u.flank=1;u.engaged=1;
    with(instance_nearest(x+1000,240,obj_pnunit)){engaged=1;}
}

if (battle_special="wraith_attack"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+10,240,obj_enunit);
    enemy_dudes="2";
    u.dudes[1]=string(obj_img.unit[13,6]);u.dudes_num[1]=1;enemies[1]=1;
    u.dudes[2]=string(obj_img.unit[13,6]);u.dudes_num[2]=1;enemies[2]=1;
    u.engaged=1;// u.flank=1;
    with(instance_nearest(x+1000,240,obj_pnunit)){engaged=1;}
}
if (battle_special="spyder_attack"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+10,240,obj_enunit);
    enemy_dudes="21";
    u.dudes[1]=string(obj_img.unit[13,9]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];
    u.dudes[2]=string(obj_img.unit[13,9]);u.dudes_num[2]=20;enemies[2]=u.dudes[2];
    u.engaged=1;// u.flank=1;
    with(instance_nearest(x+1000,240,obj_pnunit)){engaged=1;}
}
if (battle_special="stalker_attack"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+10,240,obj_enunit);
    enemy_dudes="1";u.dudes[1]=string(obj_img.unit[13,8]);
    u.dudes_num[1]=1;enemies[1]=1;
    u.engaged=1;// u.flank=1;
    with(instance_nearest(x+1000,240,obj_pnunit)){engaged=1;}
}

if (battle_special="cs_meeting_battle5") or (battle_special="cs_meeting_battle6"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(xxx+20,240,obj_enunit);enemy_dudes="";
    u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;
    u.dudes[2]=string(obj_img.unit[10,40]);u.dudes_num[2]=1;enemies[2]=1;
    u.dudes[3]=string(obj_img.unit[10,38]);u.dudes_num[3]=1;enemies[3]=1;
    u=instance_create(xxx+10,240,obj_enunit);enemy_dudes="";
    u.dudes[1]=string(obj_img.unit[10,6]);u.dudes_num[1]=20;enemies[1]=20;
}

if (battle_special="cs_meeting_battle10"){
    fortified=0;with(obj_enunit){instance_destroy();}
    u=instance_create(xxx+20,240,obj_enunit);enemy_dudes="";
    u.dudes[1]=string(obj_img.unit[10,40]);u.dudes_num[1]=1;enemies[1]=1;
    u.dudes[2]=string(obj_img.unit[10,38]);u.dudes_num[2]=1;enemies[2]=1;
    u.dudes[3]=string(obj_img.unit[10,6]);u.dudes_num[3]=20;enemies[3]=20;
    
    u=instance_create(xxx+10,240,obj_enunit);enemy_dudes="";
    u.dudes[1]=string(obj_img.unit[10,10]);u.dudes_num[1]=40;enemies[1]=40;
    u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=3;enemies[2]=3;
}




if (battle_special="wake1_attack"){enemy=13;threat=2;}
if (battle_special="wake2_attack"){enemy=13;threat=3;}
if (battle_special="wake3_attack"){enemy=13;threat=5;}

if (battle_special="study2a"){enemy=13;threat=2;}
if (battle_special="study2b"){enemy=13;threat=3;}


if (battle_special="space_hulk"){
    // show_message("space hulk battle, player forces: "+string(player_forces));
    with(obj_enunit){instance_destroy();}
    
    if (enemy=7){
        var make,modi;
        modi=random_range(0.80,1.20)+1;
        make=round(max(3,player_starting_dudes*modi));
        
        u=instance_create(instance_nearest(x-1000,240,obj_pnunit).x-10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,8]);u.dudes_num[1]=make;enemies[1]=u.dudes[1];u.engaged=1;u.flank=1;
        with(instance_nearest(x-1000,240,obj_pnunit)){engaged=1;}
        
        u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=make;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[7,6]);u.dudes_num[2]=make;enemies[2]=u.dudes[2];
        
        hulk_forces=make*3;
    }
    
    if (enemy=9){
        var make,modi;
        modi=random_range(0.80,1.20)+1;
        make=round(max(3,player_starting_dudes*modi))*2;
        
        u=instance_create(instance_nearest(x-1000,240,obj_pnunit).x-10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,9]);u.dudes_num[1]=round(make/3);enemies[1]=u.dudes[1];u.engaged=1;u.flank=1;
        with(instance_nearest(x-1000,240,obj_pnunit)){engaged=1;}
        
        u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,9]);u.dudes_num[1]=round(make/3);enemies[1]=u.dudes[1];
        
        u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+50,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,9]);u.dudes_num[1]=make-(round(make/3)*2);enemies[1]=u.dudes[1];
        
        hulk_forces=make;
    }
    
    if (enemy=10){
        var make,modi;
        modi=random_range(0.80,1.20)+1;
        make=round(max(3,player_starting_dudes*modi));
        
        u=instance_create(instance_nearest(x-1000,240,obj_pnunit).x-10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,5]);u.dudes_num[1]=round(make*0.25);enemies[1]=u.dudes[1];u.engaged=1;u.flank=1;
        with(instance_nearest(x-1000,240,obj_pnunit)){engaged=1;}
        
        u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,12]);u.dudes_num[1]=round(make*0.25);enemies[1]=u.dudes[1];
        
        u=instance_create(instance_nearest(x+1000,240,obj_pnunit).x+50,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=round(make*0.5);enemies[1]=u.dudes[1];
        
        hulk_forces=make;
    }
    
    // show_message(string(instance_number(obj_enunit))+"x enemy blocks");
    
    instance_activate_object(obj_enunit);
    exit;
}


if (battle_special="WL10_reveal"){
    u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="3300";
    u.dudes[1]="Leader";u.dudes_num[1]=1;
    u.dudes[2]=string(obj_img.unit[10,40]);u.dudes_num[2]=1;
    u.dudes[3]=string(obj_img.unit[10,38]);u.dudes_num[3]=1;
    u.dudes[4]=string(obj_img.unit[10,6]);u.dudes_num[4]=20;
    u.dudes[5]=string(obj_img.unit[10,10]);u.dudes_num[5]=50;
    // u.dudes[4]=string(obj_img.unit[10,36]);u.dudes_num[4]=18;
    instance_deactivate_object(u);
    
    u=instance_nearest(xxx+10,240,obj_enunit);
    // u.dudes[1]=string(obj_img.unit[10,35]);u.dudes_num[1]=40;
    u.dudes[1]=string(obj_img.unit[10,3]);u.dudes_num[1]=4;
    u.dudes[2]=string(obj_img.unit[10,12]);u.dudes_num[2]=100;
    u.dudes[3]=string(obj_img.unit[10,13]);u.dudes_num[3]=20;
    u.dudes[4]=string(obj_img.unit[10,14]);u.dudes_num[4]=20;
    u.dudes[5]=string(obj_img.unit[10,41]);u.dudes_num[5]=30;
    // u.dudes[3]=string(obj_img.unit[10,26]);u.dudes_num[3]=10;
    instance_deactivate_object(u);
    
    u=instance_nearest(xxx+20,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[10,24]);u.dudes_num[1]=30;
    u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=4;
    u.dudes[3]=string(obj_img.unit[10,28]);u.dudes_num[3]=2;
    instance_deactivate_object(u);
    
    u=instance_nearest(xxx+30,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[10,31]);u.dudes_num[1]=1500;
    // u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=1500;
    u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=3;
    // u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=6;
    // u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=3;
    // u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=2;
    instance_deactivate_object(u);
    
    u=instance_nearest(xxx+40,240,obj_enunit);
    // u.dudes[1]=string(obj_img.unit[10,32]);u.dudes_num[1]=8000;
    u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=1500;
    u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=3;
    instance_deactivate_object(u);
    
}

if (battle_special="WL10_later"){
    u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="200";
    u.dudes[1]="Leader";u.dudes_num[1]=1;
    u.dudes[2]=string(obj_img.unit[10,40]);u.dudes_num[2]=1;
    u.dudes[3]=string(obj_img.unit[10,38]);u.dudes_num[3]=1;
    u.dudes[4]=string(obj_img.unit[10,6]);u.dudes_num[4]=20;
    u.dudes[5]=string(obj_img.unit[10,6]);u.dudes_num[5]=50;
    // u.dudes[4]=string(obj_img.unit[10,36]);u.dudes_num[4]=18;
    instance_deactivate_object(u);
    
    u=instance_nearest(xxx+10,240,obj_enunit);
    // u.dudes[1]=string(obj_img.unit[10,35]);u.dudes_num[1]=40;
    u.dudes[1]=string(obj_img.unit[10,3]);u.dudes_num[1]=2;
    u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=100;
    u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=1;
    instance_deactivate_object(u);
}



if (enemy=2){
    guard_total=threat;
    guard_score=6;
    
    /*if (guard_total&gt;=15000000) then guard_score=6;
    if (guard_total&lt;15000000) and (guard_total&gt;=6000000) then guard_score=5;
    if (guard_total&lt;6000000) and (guard_total&gt;=1000000) then guard_score=4;
    if (guard_total&lt;1000000) and (guard_total&gt;=50000) then guard_score=3;
    if (guard_total&lt;50000) and (guard_total&gt;=500) then guard_score=2;
    if (guard_total&lt;500) then guard_score=1;*/
    
    // guard_effective=floor(guard_total)/8;
    
    
    var f,guar;
    f=0;guar=threat/10;
    
    u=instance_create(xxx,240,obj_enunit);enemy_dudes=threat;
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=round(guar/5);enemies[1]=u.dudes[1];
    instance_deactivate_object(u);
    
    f=round(threat/20000);
    if (f&gt;0){
        u=instance_create(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[2,6]);u.dudes_num[1]=f;enemies[1]=u.dudes[1];
        f=max(10,round(threat/6650));
        u.dudes[2]=string(obj_img.unit[2,3]);u.dudes_num[2]=f;enemies[2]=u.dudes[2];
        instance_deactivate_object(u);
    }
    
    f=max(1,round(threat/10000));
    u=instance_create(xxx+20,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[2,6]);u.dudes_num[1]=f;enemies[1]=u.dudes[1];
    f=max(1,round(threat/20000));
    u.dudes[2]=string(obj_img.unit[2,4]);u.dudes_num[2]=f;enemies[2]=u.dudes[2];
    instance_deactivate_object(u);
    
    u=instance_create(xxx+30,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=round(guar/5);enemies[1]=u.dudes[1];
    u=instance_create(xxx+40,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=round(guar/5);enemies[1]=u.dudes[1];
    u=instance_create(xxx+50,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=round(guar/5);enemies[1]=u.dudes[1];
    u=instance_create(xxx+60,240,obj_enunit);
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=round(guar/5);enemies[1]=u.dudes[1];
    
    u=instance_create(xxx+70,240,obj_enunit);
    f=round(threat/50000);
    if (f&gt;0){
        u.dudes[1]=string(obj_img.unit[2,5]);u.dudes_num[1]=f;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[2,2]);u.dudes_num[2]=round(threat/10000);enemies[2]=u.dudes[2];
    }
    else{u.dudes[1]=string(obj_img.unit[2,2]);u.dudes_num[1]=round(threat/10000);enemies[1]=u.dudes[1];}
    
    f=round(threat/40000);
    if (f&gt;0){
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[2,8]);u.dudes_num[1]=f;u.flank=1;u.flyer=1;
    }
    
    /*u=instance_nearest(xxx,240,obj_enunit);enemy_dudes=threat;
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=floor(guard_effective*0.6);enemies[1]=u.dudes[1];
    u.dudes[2]=string(obj_img.unit[2,2]);u.dudes_num[2]=min(1000,floor(guard_effective*0.1));enemies[2]=u.dudes[2];
    if (threat&gt;1){u.dudes[3]=string(obj_img.unit[2,6]);u.dudes_num[3]=min(1000,floor(guard_effective*0.1));enemies[3]=u.dudes[3];}
    
    u=instance_nearest(xxx,240+10,obj_enunit);enemy_dudes=threat;
    u.dudes[1]=string(obj_img.unit[2,1]);u.dudes_num[1]=floor(guard_effective*0.6);enemies[1]=u.dudes[1];
    u.dudes[2]=string(obj_img.unit[2,2]);u.dudes_num[2]=min(1000,floor(guard_effective*0.1));enemies[2]=u.dudes[2];
    if (threat&gt;1){u.dudes[3]=string(obj_img.unit[2,6]);u.dudes_num[3]=min(1000,floor(guard_effective*0.1));enemies[3]=u.dudes[3];}*/
}


if (enemy=6){
    
    if (threat=1){// ranger group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="20";
        u.dudes[1]=string(obj_img.unit[6,8]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[6,7]);u.dudes_num[2]=10;enemies[2]=u.dudes[2];
        u.dudes[3]=string(obj_img.unit[6,13]);u.dudes_num[3]=10;enemies[3]=u.dudes[3];
    }
    if (threat=1){// harle group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="9";
        u.dudes[1]=string(obj_img.unit[6,25]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[6,3]);u.dudes_num[2]=2;enemies[2]=u.dudes[2];
        u.dudes[3]=string(obj_img.unit[6,24]);u.dudes_num[3]=6;enemies[3]=u.dudes[3];
    }
    if (threat=1){// craftworld group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="24";
        u.dudes[1]=string(obj_img.unit[6,3]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];enemies_num[1]=1;
        u.dudes[2]=choose(string(obj_img.unit[6,11]),string(obj_img.unit[6,13]));u.dudes_num[2]=8;enemies[2]=u.dudes[2];
        u.dudes[3]=string(obj_img.unit[6,9]);u.dudes_num[3]=15;enemies[3]=u.dudes[3];
        
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;
            if (obj_controller.faction_gender[6]=2) then u.dudes[2]=string(obj_img.unit[6,11]);
            if (obj_controller.faction_gender[6]=2) then u.dudes[2]=string(obj_img.unit[6,19]);
        }
        
    }
    
    
    if (threat=2){// craftworld group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[6,9]);u.dudes_num[1]=56;u.dudes_special[1]="shimmershield";
        u.dudes[2]=string(obj_img.unit[6,10]);u.dudes_num[2]=4;u.dudes_special[2]="shimmershield";
        u.dudes[3]=string(obj_img.unit[6,1]);u.dudes_num[3]=1;
        u.dudes[4]=string(obj_img.unit[6,2]);u.dudes_num[4]=1;u.dudes_special[4]="farseer_powers";
        u.dudes[5]=string(obj_img.unit[6,30]);u.dudes_num[5]=1;
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;}
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,5]);u.dudes_num[1]=7;
        u.dudes[2]=string(obj_img.unit[6,6]);u.dudes_num[2]=1;
        u.dudes[3]=string(obj_img.unit[6,17]);u.dudes_num[3]=7;u.dudes_special[3]="warp_jump";
        u.dudes[4]=string(obj_img.unit[6,18]);u.dudes_num[4]=1;u.dudes_special[4]="warp_jump";
        u.dudes[5]=string(obj_img.unit[6,11]);u.dudes_num[5]=9;u.dudes_special[5]="banshee_mask";
        u.dudes[6]=string(obj_img.unit[6,12]);u.dudes_num[6]=1;u.dudes_special[6]="banshee_mask";
        u.dudes[7]=string(obj_img.unit[6,13]);u.dudes_num[7]=9;
        u.dudes[8]=string(obj_img.unit[6,14]);u.dudes_num[8]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,28]);u.dudes_num[1]=2;
    }
    if (threat=3){// craftworld group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="300";
        u.dudes[1]=string(obj_img.unit[6,9]);u.dudes_num[1]=140;u.dudes_special[1]="shimmershield";
        u.dudes[2]=string(obj_img.unit[6,10]);u.dudes_num[2]=10;u.dudes_special[2]="shimmershield";
        u.dudes[3]=string(obj_img.unit[6,1]);u.dudes_num[3]=1;
        u.dudes[4]=string(obj_img.unit[6,2]);u.dudes_num[4]=1;u.dudes_special[4]="farseer_powers";
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;}
        u.dudes[5]=string(obj_img.unit[6,29]);u.dudes_num[5]=3;
        u.dudes[6]=string(obj_img.unit[6,4]);u.dudes_num[6]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,15]);u.dudes_num[1]=18;
        u.dudes[2]=string(obj_img.unit[6,16]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[6,17]);u.dudes_num[3]=18;u.dudes_special[3]="warp_jump";
        u.dudes[4]=string(obj_img.unit[6,18]);u.dudes_num[4]=2;u.dudes_special[4]="warp_jump";
        u.dudes[5]=string(obj_img.unit[6,11]);u.dudes_num[5]=28;u.dudes_special[5]="banshee_mask";
        u.dudes[6]=string(obj_img.unit[6,12]);u.dudes_num[6]=2;u.dudes_special[6]="banshee_mask";
        u.dudes[7]=string(obj_img.unit[6,13]);u.dudes_num[7]=19;
        u.dudes[8]=string(obj_img.unit[6,14]);u.dudes_num[8]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,28]);u.dudes_num[1]=5;
        u.dudes[2]=string(obj_img.unit[6,27]);u.dudes_num[2]=12;
        u.dudes[3]=string(obj_img.unit[6,26]);u.dudes_num[3]=30;
        u.dudes[4]=string(obj_img.unit[6,31]);u.dudes_num[4]=2;
    }
    if (threat=4){// craftworld group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="1100";
        u.dudes[1]=string(obj_img.unit[6,9]);u.dudes_num[1]=280;u.dudes_special[1]="shimmershield";
        u.dudes[2]=string(obj_img.unit[6,10]);u.dudes_num[2]=20;u.dudes_special[2]="shimmershield";
        u.dudes[3]=string(obj_img.unit[6,1]);u.dudes_num[3]=3;
        u.dudes[4]=string(obj_img.unit[6,3]);u.dudes_num[4]=2;u.dudes_special[4]="farseer_powers";
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;}
        u.dudes[5]=string(obj_img.unit[6,29]);u.dudes_num[5]=3;
        u.dudes[6]=string(obj_img.unit[6,4]);u.dudes_num[6]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,3]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[6,22]);u.dudes_num[2]=400;
        u.dudes[3]=string(obj_img.unit[6,23]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[6,19]);u.dudes_num[4]=18;
        u.dudes[5]=string(obj_img.unit[6,20]);u.dudes_num[5]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,15]);u.dudes_num[1]=36;
        u.dudes[2]=string(obj_img.unit[6,16]);u.dudes_num[2]=4;
        u.dudes[3]=string(obj_img.unit[6,17]);u.dudes_num[3]=36;u.dudes_special[3]="warp_jump";
        u.dudes[4]=string(obj_img.unit[6,18]);u.dudes_num[4]=4;u.dudes_special[4]="warp_jump";
        u.dudes[5]=string(obj_img.unit[6,11]);u.dudes_num[5]=36;u.dudes_special[5]="banshee_mask";
        u.dudes[6]=string(obj_img.unit[6,12]);u.dudes_num[6]=4;u.dudes_special[6]="banshee_mask";
        u.dudes[7]=string(obj_img.unit[6,13]);u.dudes_num[7]=38;
        u.dudes[8]=string(obj_img.unit[6,14]);u.dudes_num[8]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,28]);u.dudes_num[1]=12;
        u.dudes[2]=string(obj_img.unit[6,27]);u.dudes_num[2]=20;
        u.dudes[3]=string(obj_img.unit[6,26]);u.dudes_num[3]=90;
        u.dudes[4]=string(obj_img.unit[6,31]);u.dudes_num[4]=5;
        u.dudes[5]=string(obj_img.unit[6,21]);u.dudes_num[5]=40;
    }
    if (threat=5){// craftworld group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="2500";
        u.dudes[1]=string(obj_img.unit[6,9]);u.dudes_num[1]=450;u.dudes_special[1]="shimmershield";
        u.dudes[2]=string(obj_img.unit[6,10]);u.dudes_num[2]=50;u.dudes_special[2]="shimmershield";
        u.dudes[3]=string(obj_img.unit[6,1]);u.dudes_num[3]=5;
        u.dudes[4]=string(obj_img.unit[6,2]);u.dudes_num[4]=3;u.dudes_special[4]="farseer_powers";
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;}
        u.dudes[5]=string(obj_img.unit[6,29]);u.dudes_num[5]=6;
        u.dudes[6]=string(obj_img.unit[6,5]);u.dudes_num[6]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,3]);u.dudes_num[1]=80;
        u.dudes[2]=string(obj_img.unit[6,22]);u.dudes_num[2]=1200;
        u.dudes[3]=string(obj_img.unit[6,23]);u.dudes_num[3]=40;
        u.dudes[4]=string(obj_img.unit[6,19]);u.dudes_num[4]=36;
        u.dudes[5]=string(obj_img.unit[6,20]);u.dudes_num[5]=4;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,15]);u.dudes_num[1]=72;
        u.dudes[2]=string(obj_img.unit[6,16]);u.dudes_num[2]=8;
        u.dudes[3]=string(obj_img.unit[6,17]);u.dudes_num[3]=72;u.dudes_special[3]="warp_jump";
        u.dudes[4]=string(obj_img.unit[6,18]);u.dudes_num[4]=8;u.dudes_special[4]="warp_jump";
        u.dudes[5]=string(obj_img.unit[6,11]);u.dudes_num[5]=72;u.dudes_special[5]="banshee_mask";
        u.dudes[6]=string(obj_img.unit[6,12]);u.dudes_num[6]=8;u.dudes_special[6]="banshee_mask";
        u.dudes[7]=string(obj_img.unit[6,13]);u.dudes_num[7]=72;
        u.dudes[8]=string(obj_img.unit[6,14]);u.dudes_num[8]=8;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,28]);u.dudes_num[1]=24;
        u.dudes[2]=string(obj_img.unit[6,27]);u.dudes_num[2]=40;
        u.dudes[3]=string(obj_img.unit[6,26]);u.dudes_num[3]=180;
        u.dudes[4]=string(obj_img.unit[6,31]);u.dudes_num[4]=10;
        u.dudes[5]=string(obj_img.unit[6,21]);u.dudes_num[5]=80;
    }
    if (threat=6){// craftworld group
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="5000";
        u.dudes[1]=string(obj_img.unit[6,9]);u.dudes_num[1]=540;u.dudes_special[1]="shimmershield";
        u.dudes[2]=string(obj_img.unit[6,10]);u.dudes_num[2]=60;u.dudes_special[2]="shimmershield";
        u.dudes[3]=string(obj_img.unit[6,1]);u.dudes_num[3]=8;
        u.dudes[4]=string(obj_img.unit[6,2]);u.dudes_num[4]=4;u.dudes_special[4]="farseer_powers";
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;}
        u.dudes[5]=string(obj_img.unit[6,29]);u.dudes_num[5]=12;
        u.dudes[6]=string(obj_img.unit[6,21]);u.dudes_num[6]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,3]);u.dudes_num[1]=100;
        u.dudes[2]=string(obj_img.unit[6,22]);u.dudes_num[2]=3000;
        u.dudes[3]=string(obj_img.unit[6,23]);u.dudes_num[3]=80;
        u.dudes[4]=string(obj_img.unit[6,19]);u.dudes_num[4]=72;
        u.dudes[5]=string(obj_img.unit[6,20]);u.dudes_num[5]=8;
        u.dudes[6]=string(obj_img.unit[6,32]);u.dudes_num[6]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,15]);u.dudes_num[1]=144;
        u.dudes[2]=string(obj_img.unit[6,16]);u.dudes_num[2]=16;
        u.dudes[3]=string(obj_img.unit[6,17]);u.dudes_num[3]=144;u.dudes_special[3]="warp_jump";
        u.dudes[4]=string(obj_img.unit[6,18]);u.dudes_num[4]=16;u.dudes_special[4]="warp_jump";
        u.dudes[5]=string(obj_img.unit[6,11]);u.dudes_num[5]=144;u.dudes_special[5]="banshee_mask";
        u.dudes[6]=string(obj_img.unit[6,12]);u.dudes_num[6]=16;u.dudes_special[6]="banshee_mask";
        u.dudes[7]=string(obj_img.unit[6,13]);u.dudes_num[7]=144;
        u.dudes[8]=string(obj_img.unit[6,14]);u.dudes_num[8]=16;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[6,28]);u.dudes_num[1]=48;
        u.dudes[2]=string(obj_img.unit[6,27]);u.dudes_num[2]=80;
        u.dudes[3]=string(obj_img.unit[6,26]);u.dudes_num[3]=360;
        u.dudes[4]=string(obj_img.unit[6,31]);u.dudes_num[4]=20;
        u.dudes[5]=string(obj_img.unit[6,21]);u.dudes_num[5]=160;
    }
}



if (enemy=5){
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="110";
        u.dudes[1]=string(obj_img.unit[5,4]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[5,7]);u.dudes_num[2]=4;enemies[2]=u.dudes[2];
        u.dudes[3]=string(obj_img.unit[5,2]);u.dudes_num[3]=10;enemies[3]=u.dudes[3];
        u.dudes[4]=string(obj_img.unit[5,11]);u.dudes_num[4]=100;enemies[4]=u.dudes[4];
    }
    if (threat=2){
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,4]);u.dudes_num[1]=1;if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[5,7]);u.dudes_num[2]=50;
        u.dudes[3]=string(obj_img.unit[5,11]);u.dudes_num[3]=300;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,3]);u.dudes_num[1]=50;enemy_dudes="nearly 400";
        u.dudes[2]=string(obj_img.unit[5,13]);u.dudes_num[2]=3;
    }
    if (threat=3){
        u=instance_nearest(xxx+30,240,obj_enunit);enemy_dudes="1000";
        u.dudes[1]=string(obj_img.unit[5,1]);u.dudes_num[1]=1;if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[5,7]);u.dudes_num[2]=200;
        u.dudes[3]=string(obj_img.unit[5,4]);u.dudes_num[3]=40;
        u.dudes[4]=string(obj_img.unit[5,10]);u.dudes_num[4]=50;
        u.dudes[5]=string(obj_img.unit[5,2]);u.dudes_num[5]=60;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,8]);u.dudes_num[1]=50;
        u.dudes[2]=string(obj_img.unit[5,9]);u.dudes_num[2]=50;
        u.dudes[3]=string(obj_img.unit[5,14]);u.dudes_num[3]=4;
        u.dudes[4]=string(obj_img.unit[5,15]);u.dudes_num[4]=2;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,11]);u.dudes_num[1]=450;
        u.dudes[2]=string(obj_img.unit[5,6]);u.dudes_num[2]=50;
        u.dudes[3]=string(obj_img.unit[5,3]);u.dudes_num[3]=30;
        u.dudes[4]=string(obj_img.unit[5,16]);u.dudes_num[4]=4;
    }
    if (threat=4){
        u=instance_nearest(xxx+30,240,obj_enunit);enemy_dudes="4000";
        u.dudes[1]=string(obj_img.unit[5,1]);u.dudes_num[1]=2;if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[5,7]);u.dudes_num[2]=1000;
        u.dudes[3]=string(obj_img.unit[5,4]);u.dudes_num[3]=150;
        u.dudes[4]=string(obj_img.unit[5,10]);u.dudes_num[4]=150;
        u.dudes[5]=string(obj_img.unit[5,2]);u.dudes_num[5]=150;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,8]);u.dudes_num[1]=200;
        u.dudes[2]=string(obj_img.unit[5,9]);u.dudes_num[2]=200;
        u.dudes[3]=string(obj_img.unit[5,14]);u.dudes_num[3]=15;
        u.dudes[4]=string(obj_img.unit[5,15]);u.dudes_num[4]=6;
        u.dudes[5]=string(obj_img.unit[5,11]);u.dudes_num[5]=600;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,11]);u.dudes_num[1]=1500;
        u.dudes[2]=string(obj_img.unit[5,6]);u.dudes_num[2]=100;
        u.dudes[3]=string(obj_img.unit[5,3]);u.dudes_num[3]=30;
        u.dudes[4]=string(obj_img.unit[5,16]);u.dudes_num[4]=4;
        u.dudes[5]=string(obj_img.unit[5,5]);u.dudes_num[5]=10;
    }
    if (threat=5){
        u=instance_nearest(xxx+40,240,obj_enunit);enemy_dudes="8000";
        u.dudes[1]=string(obj_img.unit[5,1]);u.dudes_num[1]=2;if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[5,7]);u.dudes_num[2]=1000;
        u.dudes[3]=string(obj_img.unit[5,4]);u.dudes_num[3]=150;
        u.dudes[4]=string(obj_img.unit[5,10]);u.dudes_num[4]=200;
        u.dudes[5]=string(obj_img.unit[5,2]);u.dudes_num[5]=200;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,7]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[5,4]);u.dudes_num[2]=150;
        u.dudes[3]=string(obj_img.unit[5,10]);u.dudes_num[3]=200;
        u.dudes[4]=string(obj_img.unit[5,2]);u.dudes_num[4]=200;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,8]);u.dudes_num[1]=200;
        u.dudes[2]=string(obj_img.unit[5,9]);u.dudes_num[2]=200;
        u.dudes[3]=string(obj_img.unit[5,14]);u.dudes_num[3]=25;
        u.dudes[4]=string(obj_img.unit[5,15]);u.dudes_num[4]=10;
        u.dudes[5]=string(obj_img.unit[5,11]);u.dudes_num[5]=2000;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,11]);u.dudes_num[1]=2000;
        u.dudes[2]=string(obj_img.unit[5,6]);u.dudes_num[2]=300;
        u.dudes[3]=string(obj_img.unit[5,3]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[5,16]);u.dudes_num[4]=15;
        u.dudes[5]=string(obj_img.unit[5,5]);u.dudes_num[5]=30;
    }
    if (threat=6){
        u=instance_nearest(xxx+50,240,obj_enunit);enemy_dudes="12000";
        u.dudes[1]=string(obj_img.unit[5,1]);u.dudes_num[1]=1;if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[5,7]);u.dudes_num[2]=1500;
        u.dudes[3]=string(obj_img.unit[5,4]);u.dudes_num[3]=150;
        u.dudes[4]=string(obj_img.unit[5,10]);u.dudes_num[4]=200;
        u.dudes[5]=string(obj_img.unit[5,2]);u.dudes_num[5]=200;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,7]);u.dudes_num[1]=1500;
        u.dudes[2]=string(obj_img.unit[5,4]);u.dudes_num[2]=150;
        u.dudes[3]=string(obj_img.unit[5,10]);u.dudes_num[3]=200;
        u.dudes[4]=string(obj_img.unit[5,2]);u.dudes_num[4]=200;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,8]);u.dudes_num[1]=200;
        u.dudes[2]=string(obj_img.unit[5,9]);u.dudes_num[2]=200;
        u.dudes[3]=string(obj_img.unit[5,14]);u.dudes_num[3]=50;
        u.dudes[4]=string(obj_img.unit[5,15]);u.dudes_num[4]=20;
        u.dudes[5]=string(obj_img.unit[5,11]);u.dudes_num[5]=2000;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,11]);u.dudes_num[1]=2000;
        u.dudes[2]=string(obj_img.unit[5,6]);u.dudes_num[2]=500;
        u.dudes[3]=string(obj_img.unit[5,3]);u.dudes_num[3]=250;
        u.dudes[4]=string(obj_img.unit[5,16]);u.dudes_num[4]=30;
        u.dudes[5]=string(obj_img.unit[5,5]);u.dudes_num[5]=50;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[5,11]);u.dudes_num[1]=3000;
    }
}





if (enemy=7){
    // u=instance_create(-10,240,obj_enunit);
    // u.dudes[1]=string(obj_img.unit[7,15]);u.dudes_num[1]=2500;u.flank=1;// enemies[1]=u.dudes[1];
    
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[7,8]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[7,5]);u.dudes_num[2]=50;enemies[2]=u.dudes[2];
        u.dudes[3]=string(obj_img.unit[7,6]);u.dudes_num[3]=50;enemies[3]=u.dudes[3];
        if (leader=1){u.dudes[4]="Leader";u.dudes_num[4]=1;enemies[4]=1;enemies_num[4]=1;}
    }
    if (threat=2){
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=50;enemy_dudes="nearly 350";
        u.dudes[2]=string(obj_img.unit[7,6]);u.dudes_num[2]=50;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[7,8]);u.dudes_num[2]=5;
        u.dudes[3]=string(obj_img.unit[7,5]);u.dudes_num[3]=70;
        u.dudes[4]=string(obj_img.unit[7,11]);u.dudes_num[4]=70;
        u.dudes[5]=string(obj_img.unit[7,6]);u.dudes_num[5]=100;
        if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
    }
    if (threat=3){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="over a 1000";
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=300;
        u.dudes[2]=string(obj_img.unit[7,11]);u.dudes_num[2]=150;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,17]);u.dudes_num[1]=9;
        u.dudes[2]=string(obj_img.unit[7,16]);u.dudes_num[2]=6;
        u.dudes[3]=string(obj_img.unit[7,7]);u.dudes_num[3]=1;
        u.dudes[4]=string(obj_img.unit[7,9]);u.dudes_num[4]=12;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,2]);u.dudes_num[1]=1;
        if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[7,8]);u.dudes_num[2]=10;
        u.dudes[3]=string(obj_img.unit[7,5]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[7,11]);u.dudes_num[4]=150;
        u.dudes[5]=string(obj_img.unit[7,6]);u.dudes_num[5]=350;
    }
    if (threat=4){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="a green tide of over 3600";
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=600;
        u.dudes[2]=string(obj_img.unit[7,11]);u.dudes_num[2]=300;
        u.dudes[3]=string(obj_img.unit[7,4]);u.dudes_num[3]=1000;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,17]);u.dudes_num[1]=21;
        u.dudes[2]=string(obj_img.unit[7,16]);u.dudes_num[2]=12;
        u.dudes[3]=string(obj_img.unit[7,7]);u.dudes_num[3]=3;
        u.dudes[4]=string(obj_img.unit[7,9]);u.dudes_num[4]=30;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,2]);u.dudes_num[1]=1;
        if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[7,8]);u.dudes_num[2]=30;
        u.dudes[3]=string(obj_img.unit[7,5]);u.dudes_num[3]=300;
        u.dudes[4]=string(obj_img.unit[7,11]);u.dudes_num[4]=450;
        u.dudes[5]=string(obj_img.unit[7,6]);u.dudes_num[5]=1000;
    }
    if (threat=5){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="a green tide of over 7000";
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=1200;
        u.dudes[2]=string(obj_img.unit[7,11]);u.dudes_num[2]=600;
        u.dudes[3]=string(obj_img.unit[7,4]);u.dudes_num[3]=2000;
        u.dudes[4]=string(obj_img.unit[7,14]);u.dudes_num[4]=100;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,17]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[7,16]);u.dudes_num[2]=18;
        u.dudes[3]=string(obj_img.unit[7,7]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[7,9]);u.dudes_num[4]=50;
        u.dudes[5]=string(obj_img.unit[7,12]);u.dudes_num[5]=20;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,2]);u.dudes_num[1]=1;
        if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[7,8]);u.dudes_num[2]=80;
        u.dudes[3]=string(obj_img.unit[7,5]);u.dudes_num[3]=600;
        u.dudes[4]=string(obj_img.unit[7,11]);u.dudes_num[4]=900;
        u.dudes[5]=string(obj_img.unit[7,6]);u.dudes_num[5]=2000;
    }
    if (threat=6){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="a WAAAAGH!! of 11000";
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=1200;
        u.dudes[2]=string(obj_img.unit[7,11]);u.dudes_num[2]=600;
        u.dudes[3]=string(obj_img.unit[7,4]);u.dudes_num[3]=2000;
        u.dudes[4]=string(obj_img.unit[7,14]);u.dudes_num[4]=100;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,17]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[7,16]);u.dudes_num[2]=18;
        u.dudes[3]=string(obj_img.unit[7,7]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[7,9]);u.dudes_num[4]=50;
        u.dudes[5]=string(obj_img.unit[7,12]);u.dudes_num[5]=20;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,5]);u.dudes_num[1]=1200;
        u.dudes[2]=string(obj_img.unit[7,11]);u.dudes_num[2]=600;
        u.dudes[3]=string(obj_img.unit[7,4]);u.dudes_num[3]=2000;
        u.dudes[4]=string(obj_img.unit[7,14]);u.dudes_num[4]=100;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,17]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[7,16]);u.dudes_num[2]=18;
        u.dudes[3]=string(obj_img.unit[7,7]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[7,9]);u.dudes_num[4]=50;
        u.dudes[5]=string(obj_img.unit[7,12]);u.dudes_num[5]=20;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[7,3]);u.dudes_num[1]=1;
        if (leader=1){u.dudes[1]="Leader";u.dudes_num[1]=1;enemies[1]=1;enemies_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[7,8]);u.dudes_num[2]=80;
        u.dudes[3]=string(obj_img.unit[7,5]);u.dudes_num[3]=600;
        u.dudes[4]=string(obj_img.unit[7,11]);u.dudes_num[4]=900;
        u.dudes[5]=string(obj_img.unit[7,6]);u.dudes_num[5]=2000;
    }
}




if (enemy=8){
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="11";
        u.dudes[1]=string(obj_img.unit[8,3]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[8,8]);u.dudes_num[2]=20;
        u.dudes[3]=string(obj_img.unit[8,10]);u.dudes_num[3]=20;enemies[3]=u.dudes[3];   
    }
    if (threat=2){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[8,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[8,2]);u.dudes_num[2]=6;
        u.dudes[3]=string(obj_img.unit[8,5]);u.dudes_num[3]=4;
        u.dudes[4]=string(obj_img.unit[8,6]);u.dudes_num[4]=3;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=60;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=60;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=12;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,13]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[8,12]);u.dudes_num[2]=4;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[8,7]);u.dudes_num[1]=6;u.flank=1;
    }
    if (threat=3){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[8,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[8,2]);u.dudes_num[2]=9;
        u.dudes[3]=string(obj_img.unit[8,5]);u.dudes_num[3]=8;
        u.dudes[4]=string(obj_img.unit[8,6]);u.dudes_num[4]=6;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=200;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=150;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=40;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=24;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,13]);u.dudes_num[1]=5;
        u.dudes[2]=string(obj_img.unit[8,12]);u.dudes_num[2]=10;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[8,7]);u.dudes_num[1]=12;u.flank=1;
    }
    
    if (threat=4){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[8,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[8,2]);u.dudes_num[2]=9;
        u.dudes[3]=string(obj_img.unit[8,5]);u.dudes_num[3]=8;
        u.dudes[4]=string(obj_img.unit[8,6]);u.dudes_num[4]=12;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=800;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=500;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=60;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=48;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,13]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[8,12]);u.dudes_num[2]=15;
        u.dudes[3]=string(obj_img.unit[8,3]);u.dudes_num[3]=48;
        
        u=instance_create(0,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,7]);u.dudes_num[1]=12;u.flank=1;
        u.dudes[2]=string(obj_img.unit[8,4]);u.dudes_num[2]=6;u.flank=1;
    }
    
    if (threat=5){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="4000";
        u.dudes[1]=string(obj_img.unit[8,1]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[8,2]);u.dudes_num[2]=18;
        u.dudes[3]=string(obj_img.unit[8,5]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[8,6]);u.dudes_num[4]=24;
        u.dudes[5]=string(obj_img.unit[8,11]);u.dudes_num[4]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=700;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=80;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=700;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=80;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,13]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[8,12]);u.dudes_num[2]=40;
        u.dudes[3]=string(obj_img.unit[8,3]);u.dudes_num[3]=48;
        
        u=instance_create(0,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,7]);u.dudes_num[1]=12;u.flank=1;
        u.dudes[2]=string(obj_img.unit[8,4]);u.dudes_num[2]=18;u.flank=1;
    }
    if (threat=6){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="6000";
        u.dudes[1]=string(obj_img.unit[8,1]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[8,2]);u.dudes_num[2]=18;
        u.dudes[3]=string(obj_img.unit[8,5]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[8,6]);u.dudes_num[4]=36;
        u.dudes[5]=string(obj_img.unit[8,11]);u.dudes_num[4]=60;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=700;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=80;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=700;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=80;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,8]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[8,10]);u.dudes_num[2]=700;
        u.dudes[3]=string(obj_img.unit[8,9]);u.dudes_num[3]=100;
        u.dudes[4]=string(obj_img.unit[8,3]);u.dudes_num[4]=80;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,13]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[8,12]);u.dudes_num[2]=80;
        u.dudes[3]=string(obj_img.unit[8,3]);u.dudes_num[3]=80;
        
        u=instance_create(0,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[8,7]);u.dudes_num[1]=12;u.flank=1;
        u.dudes[2]=string(obj_img.unit[8,4]);u.dudes_num[2]=24;u.flank=1;
    }
}






if (enemy=9) and (battle_special="tyranid_org"){
    u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="81";
    u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=40;
    u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=40;
    // u.dudes[3]=string(obj_img.unit[9,12]);u.dudes_num[3]=1;
}
if (enemy=9) and (battle_special!="tyranid_org"){
    if (threat=1){// genestealer
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="11";
        u.dudes[1]=string(obj_img.unit[9,9]);u.dudes_num[1]=10;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[9,12]);u.dudes_num[1]=1;u.flank=1;
    }
    if (threat=2){// genestealer
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[9,10]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[9,9]);u.dudes_num[2]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,8]);u.dudes_num[1]=150;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[9,12]);u.dudes_num[1]=1;u.flank=1;
    }
    if (threat=3){// genestealer
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="100";
        u.dudes[1]=string(obj_img.unit[9,10]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[9,9]);u.dudes_num[2]=120;
        u.dudes[3]=string(obj_img.unit[9,11]);u.dudes_num[3]=20;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=600;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[9,12]);u.dudes_num[1]=6;u.flank=1;
    }
    if (threat=4){// tyranids
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="7000";
        u.dudes[1]=string(obj_img.unit[9,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[9,2]);u.dudes_num[2]=16;
        u.dudes[3]=string(obj_img.unit[9,3]);u.dudes_num[3]=40;
        u.dudes[4]=string(obj_img.unit[9,4]);u.dudes_num[4]=10;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=1500;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=800;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=5;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=1500;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=800;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=5;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=1500;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=800;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=5;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,5]);u.dudes_num[1]=6;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[9,12]);u.dudes_num[1]=15;u.flank=1;
    }
    if (threat=5){// tyranids
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="15000";
        u.dudes[1]=string(obj_img.unit[9,1]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[9,2]);u.dudes_num[2]=32;
        u.dudes[3]=string(obj_img.unit[9,3]);u.dudes_num[3]=80;
        u.dudes[4]=string(obj_img.unit[9,4]);u.dudes_num[4]=20;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=3300;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=1600;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=3300;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=1600;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=30;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=3300;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=1600;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=60;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,5]);u.dudes_num[1]=20;
        u.dudes[2]=string(obj_img.unit[9,4]);u.dudes_num[2]=10;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[9,12]);u.dudes_num[1]=20;u.flank=1;
    }
    if (threat=6){// tyranids
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="45000";
        u.dudes[1]=string(obj_img.unit[9,1]);u.dudes_num[1]=4;
        u.dudes[2]=string(obj_img.unit[9,2]);u.dudes_num[2]=64;
        u.dudes[3]=string(obj_img.unit[9,3]);u.dudes_num[3]=160;
        u.dudes[4]=string(obj_img.unit[9,4]);u.dudes_num[4]=40;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=10000;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=4000;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=15;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=90;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=10000;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=4000;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=15;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=90;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,6]);u.dudes_num[1]=10000;
        u.dudes[2]=string(obj_img.unit[9,7]);u.dudes_num[2]=4000;
        u.dudes[3]=string(obj_img.unit[9,5]);u.dudes_num[3]=15;
        u.dudes[4]=string(obj_img.unit[9,3]);u.dudes_num[4]=90;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[9,5]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[9,4]);u.dudes_num[2]=20;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[9,12]);u.dudes_num[1]=40;u.flank=1;
    }
    
}





if (enemy=10) and (battle_special!="ship_demon") and (battle_special!="fallen1") and (battle_special!="fallen2") and (battle_special!="WL10_reveal") and (battle_special!="WL10_later") and (string_count("cs_meeting_battle",battle_special)=0){
    // u=instance_create(-10,240,obj_enunit);
    // u.dudes[1]=string(obj_img.unit[7,15]);u.dudes_num[1]=2500;u.flank=1;// enemies[1]=u.dudes[1];
    
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="150";
        u.dudes[1]=string(obj_img.unit[10,30]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=30;enemies[2]=u.dudes[2];
        u.dudes[3]=string(obj_img.unit[10,22]);u.dudes_num[3]=120;enemies[3]=u.dudes[3];
    }
    if (threat=2){
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,30]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=50;
        u.dudes[3]=string(obj_img.unit[10,22]);u.dudes_num[3]=300;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=50;enemy_dudes="nearly 400";
        u.dudes[2]=string(obj_img.unit[10,34]);u.dudes_num[2]=6;
    }
    if (threat=3){
        u=instance_nearest(xxx+20,240,obj_enunit);enemy_dudes="1000";
        u.dudes[1]=string(obj_img.unit[10,30]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=100;
        u.dudes[3]="Mutants";u.dudes_num[3]=200;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,34]);u.dudes_num[1]=9;
        u.dudes[2]=string(obj_img.unit[10,35]);u.dudes_num[2]=6;
        u.dudes[3]=string(obj_img.unit[10,22]);u.dudes_num[3]=200;
        instance_deactivate_object(u);
    
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=200;
        u.dudes[2]=string(obj_img.unit[10,32]);u.dudes_num[2]=300;
    }
    if (threat=4){
        u=instance_nearest(xxx+20,240,obj_enunit);enemy_dudes="4000";
        u.dudes[1]=string(obj_img.unit[10,30]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=400;
        u.dudes[3]=string(obj_img.unit[10,36]);u.dudes_num[3]=6;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,32]);u.dudes_num[1]=1500;
        u.dudes[2]=string(obj_img.unit[10,35]);u.dudes_num[2]=21;
        u.dudes[3]=string(obj_img.unit[10,29]);u.dudes_num[3]=5;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=600;
        u.dudes[2]=string(obj_img.unit[10,32]);u.dudes_num[2]=1500;
    }
    if (threat=5){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="8000";
        u.dudes[1]=string(obj_img.unit[10,33]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,5]);u.dudes_num[2]=10;
        u.dudes[3]=string(obj_img.unit[10,31]);u.dudes_num[3]=400;
        u.dudes[4]=string(obj_img.unit[10,36]);u.dudes_num[4]=9;
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,35]);u.dudes_num[1]=40;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=12;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,32]);u.dudes_num[1]=2000;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[10,32]);u.dudes_num[2]=2000;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx,40,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=1000;
        u.dudes[2]=string(obj_img.unit[10,32]);u.dudes_num[2]=2000;
        instance_deactivate_object(u);
        
        
    }
    if (threat=6){
        u=instance_nearest(xxx+40,240,obj_enunit);enemy_dudes="12000";
        u.dudes[1]="Greater Daemon of "+string(choose("Slaanesh","Khorne","Nurgle","Tzeentch,","Tzeentch"));u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[10,5]);u.dudes_num[2]=20;
        u.dudes[3]=string(obj_img.unit[10,36]);u.dudes_num[3]=18;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,35]);u.dudes_num[1]=80;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=20;
        u.dudes[3]=string(obj_img.unit[10,26]);u.dudes_num[3]=10;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,32]);u.dudes_num[1]=8000;
        u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=4000;
        instance_deactivate_object(u);
    }
    if (threat=7){
        u=instance_nearest(xxx+40,240,obj_enunit);u.neww=1;enemy_dudes="";
        u.dudes[1]=string(obj_img.unit[10,38]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,38]);u.dudes_num[2]=1;
        // u.dudes[3]=string(obj_img.unit[10,38]);u.dudes_num[3]=1;
        u.dudes[4]=string(obj_img.unit[10,40]);u.dudes_num[4]=1;
        u.dudes[5]=string(obj_img.unit[10,40]);u.dudes_num[5]=1;
        // u.dudes[6]=string(obj_img.unit[10,40]);u.dudes_num[6]=1;
        u.dudes[7]=string(obj_img.unit[10,46]);u.dudes_num[7]=3;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+30,240,obj_enunit);u.neww=1;
        u.dudes[1]=string(obj_img.unit[10,37]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,37]);u.dudes_num[2]=1;
        // u.dudes[3]=string(obj_img.unit[10,37]);u.dudes_num[3]=1;
        u.dudes[4]=string(obj_img.unit[10,39]);u.dudes_num[4]=1;
        u.dudes[5]=string(obj_img.unit[10,39]);u.dudes_num[5]=1;
        // u.dudes[6]=string(obj_img.unit[10,39]);u.dudes_num[6]=1;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,41]);u.dudes_num[1]=800;
        u.dudes[2]=string(obj_img.unit[10,42]);u.dudes_num[2]=800;
        u.dudes[3]=string(obj_img.unit[10,44]);u.dudes_num[3]=800;
        u.dudes[4]=string(obj_img.unit[10,43]);u.dudes_num[4]=800;
        u.dudes[5]=string(obj_img.unit[10,47]);u.dudes_num[5]=3;
        instance_deactivate_object(u);
        
        // u=instance_nearest(xxx+10,240,obj_enunit);
        // u.dudes[1]=string(obj_img.unit[10,32]);u.dudes_num[1]=6000;
        // instance_deactivate_object(u);
    }
}







if (enemy=11) and (battle_special!="world_eaters") and (string_count("cs_meeting_battle",battle_special)=0){
    // u=instance_create(-10,240,obj_enunit);
    // u.dudes[1]=string(obj_img.unit[7,15]);u.dudes_num[1]=2500;u.flank=1;// enemies[1]=u.dudes[1];
    
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="5";
        u.dudes[1]=string(obj_img.unit[10,12]);u.dudes_num[1]=5;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[10,22]);u.dudes_num[2]=30;enemies[2]=u.dudes[2];
    }
    
    if (threat=2){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,9]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,12]);u.dudes_num[2]=35;
        u.dudes[3]=string(obj_img.unit[10,13]);u.dudes_num[3]=5;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=100;enemy_dudes="41";
        u.dudes[2]=string(obj_img.unit[10,24]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=4;
    }
    
    if (threat=3){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,2]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,3]);u.dudes_num[2]=1;
        u.dudes[3]=string(obj_img.unit[10,9]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[10,12]);u.dudes_num[4]=100;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,24]);u.dudes_num[1]=6;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=300;enemy_dudes="over 100";
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=3;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[10,27]);u.dudes_num[4]=2; 
    }
    
    if (threat=4){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,2]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,3]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[10,9]);u.dudes_num[3]=10;
        // u.dudes[4]=string(obj_img.unit[10,5]);u.dudes_num[4]=5;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,12]);u.dudes_num[1]=250;
        u.dudes[2]=string(obj_img.unit[10,13]);u.dudes_num[2]=20;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,24]);u.dudes_num[1]=15;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=4;
        u.dudes[3]=string(obj_img.unit[10,28]);u.dudes_num[3]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=600;enemy_dudes="over 300";
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=3;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=3;
        u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=2;
    }
    
    if (threat=5){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,2]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[10,3]);u.dudes_num[2]=3;
        u.dudes[3]=string(obj_img.unit[10,9]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[10,8]);u.dudes_num[4]=6;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,12]);u.dudes_num[1]=600;
        u.dudes[2]=string(obj_img.unit[10,13]);u.dudes_num[2]=40;
        u.dudes[3]=string(obj_img.unit[10,14]);u.dudes_num[3]=40;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,24]);u.dudes_num[1]=25;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=8;
        u.dudes[3]=string(obj_img.unit[10,28]);u.dudes_num[3]=3;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=600;enemy_dudes="over 700";
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=5;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=6;
        u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=3;
        u.dudes[6]=string(obj_img.unit[10,11]);u.dudes_num[6]=30;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[10,5]);u.dudes_num[1]=10;u.flank=1;
    }
    
    
    if (threat=6){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="1000";
        u.dudes[1]=string(obj_img.unit[10,2]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[10,3]);u.dudes_num[2]=10;
        u.dudes[3]=string(obj_img.unit[10,9]);u.dudes_num[3]=40;
        u.dudes[4]=string(obj_img.unit[10,8]);u.dudes_num[4]=12;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,12]);u.dudes_num[1]=800;
        u.dudes[2]=string(obj_img.unit[10,13]);u.dudes_num[2]=50;
        u.dudes[3]=string(obj_img.unit[10,14]);u.dudes_num[3]=50;
        u.dudes[4]=choose(string(obj_img.unit[10,19]),string(obj_img.unit[10,18]),string(obj_img.unit[10,17]),string(obj_img.unit[10,20]));u.dudes_num[3]=50;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,24]);u.dudes_num[1]=30;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=10;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,22]);u.dudes_num[1]=1200;
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=10;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=15;
        u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=6;
        u.dudes[6]=string(obj_img.unit[10,11]);u.dudes_num[6]=60;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,28]);u.dudes_num[1]=6;u.flank=1;u.flyer=1;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[10,5]);u.dudes_num[1]=20;u.flank=1;
    }
    
    
}


if (enemy=11) and (battle_special="world_eaters"){
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="20";
        u.dudes[1]=string(obj_img.unit[10,17]);u.dudes_num[1]=15;enemies[1]=u.dudes[1];
        if (obj_controller.faction_defeated[10]=0){u.dudes[2]="Leader";u.dudes_num[2]=1;}
        u.dudes[3]=string(obj_img.unit[10,15]);u.dudes_num[3]=5;
    }
    
    if (threat=2){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,9]);u.dudes_num[1]=1;if (obj_controller.faction_defeated[10]=0) then u.dudes[1]="Leader";
        u.dudes[2]=string(obj_img.unit[10,17]);u.dudes_num[2]=35;
        u.dudes[3]=string(obj_img.unit[10,15]);u.dudes_num[3]=5;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,15]);u.dudes_num[1]=100;enemy_dudes="135";
        u.dudes[2]=string(obj_img.unit[10,24]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[10,26]);u.dudes_num[3]=4;
    }
    
    if (threat=3){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,9]);u.dudes_num[1]=1;if (obj_controller.faction_defeated[10]=0) then u.dudes[1]="Leader";
        u.dudes[2]=string(obj_img.unit[10,37]);u.dudes_num[2]=1;
        u.dudes[3]=string(obj_img.unit[10,7]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[10,15]);u.dudes_num[4]=100;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,24]);u.dudes_num[1]=6;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,17]);u.dudes_num[1]=100;enemy_dudes="over 200";
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=5;
        u.dudes[3]=string(obj_img.unit[10,26]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[10,27]);u.dudes_num[4]=4; 
    }
    
    if (threat=4){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,9]);u.dudes_num[1]=1;if (obj_controller.faction_defeated[10]=0) then u.dudes[1]="Leader";
        u.dudes[2]=string(obj_img.unit[10,37]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[10,7]);u.dudes_num[3]=10;
        // u.dudes[4]=string(obj_img.unit[10,5]);u.dudes_num[4]=5;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,15]);u.dudes_num[1]=250;
        u.dudes[2]=string(obj_img.unit[10,11]);u.dudes_num[2]=20;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,26]);u.dudes_num[1]=15;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=4;
        u.dudes[3]=string(obj_img.unit[10,28]);u.dudes_num[3]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,17]);u.dudes_num[1]=300;enemy_dudes="over 300";
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=3;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=6;
        u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=3;
        u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=2;
    }
    
    if (threat=5){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,9]);u.dudes_num[1]=1;if (obj_controller.faction_defeated[10]=0) then u.dudes[1]="Leader";
        u.dudes[2]=string(obj_img.unit[10,37]);u.dudes_num[2]=3;
        u.dudes[3]=string(obj_img.unit[10,7]);u.dudes_num[3]=20;
        u.dudes[4]=string(obj_img.unit[10,23]);u.dudes_num[4]=6;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,15]);u.dudes_num[1]=600;
        u.dudes[2]=string(obj_img.unit[10,11]);u.dudes_num[2]=40;
        u.dudes[3]=string(obj_img.unit[10,11]);u.dudes_num[3]=40;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,26]);u.dudes_num[1]=15;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=8;
        u.dudes[3]=string(obj_img.unit[10,28]);u.dudes_num[3]=3;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,17]);u.dudes_num[1]=300;enemy_dudes="over 900";
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=5;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=10;
        u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=6;
        u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=3;
        u.dudes[6]=string(obj_img.unit[10,11]);u.dudes_num[6]=30;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[10,5]);u.dudes_num[1]=10;u.flank=1;
    }
    
    
    if (threat&gt;=6){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="1300";
        u.dudes[1]=string(obj_img.unit[10,2]);u.dudes_num[1]=2;if (obj_controller.faction_defeated[10]=0){u.dudes[1]="Leader";u.dudes_num[1]=1;}
        u.dudes[2]=string(obj_img.unit[10,37]);u.dudes_num[2]=5;
        u.dudes[3]=string(obj_img.unit[10,7]);u.dudes_num[3]=40;
        u.dudes[4]=string(obj_img.unit[10,23]);u.dudes_num[4]=10;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,15]);u.dudes_num[1]=800;
        u.dudes[2]=string(obj_img.unit[10,11]);u.dudes_num[2]=50;
        u.dudes[3]=string(obj_img.unit[10,11]);u.dudes_num[3]=50;
        u.dudes[4]=string(obj_img.unit[10,17]);u.dudes_num[3]=50;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,26]);u.dudes_num[1]=20;
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=10;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,17]);u.dudes_num[1]=500;
        u.dudes[2]=string(obj_img.unit[10,23]);u.dudes_num[2]=10;
        u.dudes[3]=string(obj_img.unit[10,25]);u.dudes_num[3]=15;
        u.dudes[4]=string(obj_img.unit[10,26]);u.dudes_num[4]=20;
        u.dudes[5]=string(obj_img.unit[10,27]);u.dudes_num[5]=6;
        u.dudes[6]=string(obj_img.unit[10,11]);u.dudes_num[6]=60;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+40,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,28]);u.dudes_num[1]=6;u.flank=1;u.flyer=1;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[10,7]);u.dudes_num[1]=20;u.flank=1;
    }
    
    
}




if (enemy=12){// Daemons
    var slaa;slaa=0;
    if (battle_special="ruins_eldar") then slaa=1;
    
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="5";
        u.dudes[1]=choose(string(obj_img.unit[10,41]),string(obj_img.unit[10,42]),string(obj_img.unit[10,44]),string(obj_img.unit[10,43]));u.dudes_num[1]=5;enemies[1]=u.dudes[1];
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,42]);
        u.dudes[2]=string(obj_img.unit[10,31]);u.dudes_num[2]=30;enemies[2]=u.dudes[2];
    }
    
    if (threat=2){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=choose(string(obj_img.unit[10,41]),string(obj_img.unit[10,42]),string(obj_img.unit[10,44]),string(obj_img.unit[10,43]));u.dudes_num[1]=30;
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,42]);
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=choose(string(obj_img.unit[10,41]),string(obj_img.unit[10,42]),string(obj_img.unit[10,44]),string(obj_img.unit[10,43]));u.dudes_num[1]=30;enemy_dudes="90";
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,42]);
        u.dudes[2]=string(obj_img.unit[10,29]);u.dudes_num[2]=1;
    }
    
    if (threat=3){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]="Greater Daemon of "+choose("Tzeentch","Slaanesh","Nurgle","Khorne");u.dudes_num[1]=1;
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,38]);
        u.dudes[2]=string(obj_img.unit[10,3]);u.dudes_num[2]=1;
        u.dudes[3]=string(obj_img.unit[10,43]);u.dudes_num[3]=60;
        if (slaa=1) then u.dudes[3]=string(obj_img.unit[10,42]);
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[10,29]);u.dudes_num[1]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        if (slaa=1){u.dudes[1]=string(obj_img.unit[10,42]);u.dudes_num[1]=240;}
        if (slaa=0){
            u.dudes[1]=string(obj_img.unit[10,41]);u.dudes_num[1]=60;
            u.dudes[2]=string(obj_img.unit[10,44]);u.dudes_num[2]=60;
            u.dudes[3]=string(obj_img.unit[10,42]);u.dudes_num[3]=60;
            u.dudes[4]=string(obj_img.unit[10,47]);u.dudes_num[4]=2;
        }
        enemy_dudes="240";
    }
    
    if (threat=4){
        u=instance_nearest(xxx+40,240,obj_enunit);u.neww=1;enemy_dudes="400";
        u.dudes[1]="Greater Daemon of "+string(choose("Slaanesh","Tzeentch"));u.dudes_num[1]=1;
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,38]);
        u.dudes[2]="Greater Daemon of "+string(choose("Nurgle","Khorne"));u.dudes_num[2]=1;
        if (slaa=1) then u.dudes[2]=string(obj_img.unit[10,38]);
        // u.dudes[6]=string(obj_img.unit[10,40]);u.dudes_num[6]=1;
        u.dudes[3]=string(obj_img.unit[10,46]);u.dudes_num[3]=1;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        if (slaa=0){
            u.dudes[1]=string(obj_img.unit[10,41]);u.dudes_num[1]=100;
            u.dudes[2]=string(obj_img.unit[10,42]);u.dudes_num[2]=100;
            u.dudes[3]=string(obj_img.unit[10,44]);u.dudes_num[3]=100;
            u.dudes[4]=string(obj_img.unit[10,43]);u.dudes_num[4]=100;
            u.dudes[5]=string(obj_img.unit[10,47]);u.dudes_num[5]=2;
        }
        if (slaa=1){
            u.dudes[1]=string(obj_img.unit[10,42]);u.dudes_num[1]=400;
            u.dudes[2]=string(obj_img.unit[10,47]);u.dudes_num[2]=2;
        }
        
        instance_deactivate_object(u);
    }
    
    if (threat=5){
        u=instance_nearest(xxx+40,240,obj_enunit);u.neww=1;enemy_dudes="1000";
        u.dudes[1]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[1]=1;
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,38]);
        u.dudes[2]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[2]=1;
        if (slaa=1) then u.dudes[2]=string(obj_img.unit[10,38]);
        u.dudes[3]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[3]=1;
        if (slaa=1) then u.dudes[3]=string(obj_img.unit[10,38]);
        // u.dudes[6]=string(obj_img.unit[10,40]);u.dudes_num[6]=1;
        u.dudes[4]=string(obj_img.unit[10,46]);u.dudes_num[4]=2;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        if (slaa=0){
            u.dudes[1]=string(obj_img.unit[10,41]);u.dudes_num[1]=250;
            u.dudes[2]=string(obj_img.unit[10,42]);u.dudes_num[2]=250;
            u.dudes[3]=string(obj_img.unit[10,44]);u.dudes_num[3]=250;
            u.dudes[4]=string(obj_img.unit[10,43]);u.dudes_num[4]=250;
            u.dudes[5]=string(obj_img.unit[10,47]);u.dudes_num[5]=2;
        }
        if (slaa=1){
            u.dudes[1]=string(obj_img.unit[10,42]);u.dudes_num[1]=1000;
            u.dudes[2]=string(obj_img.unit[10,47]);u.dudes_num[2]=2;
        }
        instance_deactivate_object(u);
    }
    
    
    if (threat=6){
        u=instance_nearest(xxx+40,240,obj_enunit);u.neww=1;enemy_dudes="2000";
        u.dudes[1]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[1]=1;
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,38]);
        u.dudes[2]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[2]=1;
        if (slaa=1) then u.dudes[2]=string(obj_img.unit[10,38]);
        u.dudes[3]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[3]=1;
        if (slaa=1) then u.dudes[3]=string(obj_img.unit[10,38]);
        u.dudes[4]=string(obj_img.unit[10,46]);u.dudes_num[4]=1;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+30,240,obj_enunit);u.neww=1;
        u.dudes[1]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[1]=1;
        if (slaa=1) then u.dudes[1]=string(obj_img.unit[10,38]);
        u.dudes[2]=string(obj_img.unit[10,choose(37,38,39,40)]);u.dudes_num[2]=1;
        if (slaa=1) then u.dudes[2]=string(obj_img.unit[10,38]);
        u.dudes[3]=string(obj_img.unit[10,46]);u.dudes_num[3]=1;
        instance_deactivate_object(u);
        
        u=instance_nearest(xxx+20,240,obj_enunit);
        if (slaa=0){
            u.dudes[1]=string(obj_img.unit[10,41]);u.dudes_num[1]=500;
            u.dudes[2]=string(obj_img.unit[10,42]);u.dudes_num[2]=500;
            u.dudes[3]=string(obj_img.unit[10,44]);u.dudes_num[3]=500;
            u.dudes[4]=string(obj_img.unit[10,43]);u.dudes_num[4]=500;
            u.dudes[5]=string(obj_img.unit[10,47]);u.dudes_num[5]=3;
        }
        if (slaa=1){
            u.dudes[1]=string(obj_img.unit[10,42]);u.dudes_num[1]=2000;
            u.dudes[2]=string(obj_img.unit[10,47]);u.dudes_num[2]=3;
        }
        instance_deactivate_object(u);
    }   
}



if (enemy=13) and ((string_count("_attack",battle_special)=0) or (string_count("wake",battle_special)&gt;0)){
    if (threat=1){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="11";
        u.dudes[1]=string(obj_img.unit[13,7]);u.dudes_num[1]=1;enemies[1]=u.dudes[1];
        u.dudes[2]=string(obj_img.unit[13,4]);u.dudes_num[2]=10;enemies[2]=u.dudes[2];
    }
    
    if (threat=2){
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,7]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[13,4]);u.dudes_num[2]=20;
        u.dudes[3]=string(obj_img.unit[13,5]);u.dudes_num[3]=10;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,4]);u.dudes_num[1]=20;enemy_dudes="54";
        u.dudes[2]=string(obj_img.unit[13,9]);u.dudes_num[2]=3;
    }
    
    if (threat=3){enemy_dudes="110";
        u=instance_nearest(xxx,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[13,7]);u.dudes_num[2]=3;
        u.dudes[3]=string(obj_img.unit[13,2]);u.dudes_num[3]=5;
        u.dudes[4]=string(obj_img.unit[13,4]);u.dudes_num[4]=100;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,9]);u.dudes_num[1]=6;
        u.dudes[2]=string(obj_img.unit[13,10]);u.dudes_num[2]=120;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,12]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[13,11]);u.dudes_num[2]=1;
    }
    
    if (threat=4){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="290";
        u.dudes[1]=string(obj_img.unit[13,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[13,7]);u.dudes_num[2]=6;
        u.dudes[3]=string(obj_img.unit[13,2]);u.dudes_num[3]=10;
        // u.dudes[4]=string(obj_img.unit[10,5]);u.dudes_num[4]=5;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,4]);u.dudes_num[1]=250;
        u.dudes[2]=string(obj_img.unit[13,5]);u.dudes_num[2]=20;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,9]);u.dudes_num[1]=6;
        u.dudes[2]=string(obj_img.unit[13,10]);u.dudes_num[2]=120;
        u.dudes[3]=string(obj_img.unit[13,8]);u.dudes_num[3]=1;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,12]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[13,11]);u.dudes_num[2]=1;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[13,6]);u.dudes_num[1]=6;u.flank=1;
    }
    
    if (threat=5){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="700";
        u.dudes[1]=string(obj_img.unit[13,1]);u.dudes_num[1]=1;
        u.dudes[2]=string(obj_img.unit[13,7]);u.dudes_num[2]=12;
        u.dudes[3]=string(obj_img.unit[13,2]);u.dudes_num[3]=20;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,4]);u.dudes_num[1]=600;
        u.dudes[2]=string(obj_img.unit[13,5]);u.dudes_num[2]=40;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,9]);u.dudes_num[1]=12;
        u.dudes[2]=string(obj_img.unit[13,9]);u.dudes_num[2]=240;
        u.dudes[3]=string(obj_img.unit[13,8]);u.dudes_num[3]=2;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,12]);u.dudes_num[1]=4;
        u.dudes[2]=string(obj_img.unit[13,11]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[13,7]);u.dudes_num[3]=12;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[13,6]);u.dudes_num[1]=12;u.flank=1;
    }
    
    
    if (threat=6){
        u=instance_nearest(xxx,240,obj_enunit);enemy_dudes="1000";
        u.dudes[1]=string(obj_img.unit[13,1]);u.dudes_num[1]=2;
        u.dudes[2]=string(obj_img.unit[13,7]);u.dudes_num[2]=20;
        u.dudes[3]=string(obj_img.unit[13,2]);u.dudes_num[3]=40;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+10,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,4]);u.dudes_num[1]=800;
        u.dudes[2]=string(obj_img.unit[13,5]);u.dudes_num[2]=50;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+20,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,9]);u.dudes_num[1]=16;
        u.dudes[2]=string(obj_img.unit[13,10]);u.dudes_num[2]=320;
        u.dudes[3]=string(obj_img.unit[13,8]);u.dudes_num[3]=3;
        
        instance_deactivate_object(u);
        u=instance_nearest(xxx+30,240,obj_enunit);
        u.dudes[1]=string(obj_img.unit[13,12]);u.dudes_num[1]=6;
        u.dudes[2]=string(obj_img.unit[13,11]);u.dudes_num[2]=2;
        u.dudes[3]=string(obj_img.unit[13,7]);u.dudes_num[3]=20;
        
        u=instance_create(0,240,obj_enunit);u.dudes[1]=string(obj_img.unit[13,6]);u.dudes_num[1]=24;u.flank=1;
    }
    
}


if (player_defenses+player_silos&gt;0){
    u=instance_create(-50,240,obj_pnunit);
    u.defenses=1;
    
    var i;i=0;
    repeat(3){i+=1;
        u.veh_co[i]=0;u.veh_id[i]=0;u.veh_type[i]="Defenses";u.veh_hp[i]=1000;u.veh_ac[i]=1000;
        u.veh_dead[i]=0;u.veh_hp_multiplier[i]=1;
    }
    
    u.veh_wep1[1]="Heavy "+string(obj_img.gyro)+" Emplacement";
    u.veh_wep1[2]="Missile Launcher Emplacement";
    u.veh_wep1[3]="Missile Silo";
    u.veh=3;u.sprite_index=spr_weapon_blank;
}


instance_activate_object(obj_enunit);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if (fadein&gt;-30) then fadein-=1;
if (cd&gt;=0) then cd-=1;
if (fix_timer&gt;=0) then fix_timer-=1;
// if (done&gt;=1) then done+=1;




if (!instance_exists(obj_enunit)) then enemy_forces=0;
if (!instance_exists(obj_pnunit)) then player_forces=0;


if (fack=1) then instance_activate_object(obj_pnunit);
instance_activate_object(obj_centerline);
instance_activate_object(obj_cursor);


if ((fugg&gt;=60) or (fugg2&gt;=60)) and (messages_shown=0) and (messages_to_show=8) and (defeat_message=0){
    fugg=0;fugg2=0;
    if ((messages_shown=999) or (messages=0)) and (timer_stage=2){
        newline_color="yellow";
        if (obj_ncombat.enemy!=6){
            if (enemy_forces&lt;=0) or (!instance_exists(obj_enunit)) and (defeat_message=0){defeat_message=1;newline="Enemy Forces Defeated";timer_maxspeed=0;timer_speed=0;started=2;instance_activate_object(obj_pnunit);}
        }
        newline_color="yellow";
        if (obj_ncombat.enemy=6){
            if ((player_forces&lt;=0) or (!instance_exists(obj_pnunit))) and (defeat_message=0){defeat_message=1;newline=string(global.chapter_name)+" Defeated";timer_maxspeed=0;timer_speed=0;started=4;defeat=1;instance_activate_object(obj_pnunit);}
        }
        messages_shown=105;done=1;scr_newtext();timer_stage=3;exit;
    }
    
    // show_message("Shown: "+string(messages_shown)+"#Messages: "+string(messages)+"#Timer Stage: "+string(timer_stage));
    if ((messages_shown=999) or (messages=0)) and ((timer_stage=4) or (timer_stage=5)) and (four_show=0){
        newline_color="yellow";
        if (obj_ncombat.enemy!=6){
            if ((player_forces&lt;=0) or (!instance_exists(obj_pnunit))) and (defeat_message=0){defeat_message=1;newline=string(global.chapter_name)+" Defeated";timer_maxspeed=0;timer_speed=0;started=4;defeat=1;instance_activate_object(obj_pnunit);}
        }
        newline_color="yellow";
        if (obj_ncombat.enemy=6){
            if ((enemy_forces&lt;=0) or (!instance_exists(obj_enunit))) and (defeat_message=0){defeat_message=1;newline="Enemy Forces Defeated";timer_maxspeed=0;timer_speed=0;started=2;instance_activate_object(obj_pnunit);}
        }
        messages_shown=105;done=1;scr_newtext();timer_stage=5;exit;
    }
    exit;
}








// if (player_forces&gt;0) and (enemy_forces&gt;0) and (battle_over=0){
    if (timer_stage=2) then fugg+=1;
    if (timer_stage=2) and (fugg&gt;60){
        timer_stage=3;// if (!instance_exists(obj_pnunit)) or (!instance_exists(obj_enunit)){alarm[5]=1;started=4;defeat_message=1;}
    }
    
    if (timer_stage!=2) then fugg=0;
    if (timer_stage=4) then fugg2+=1;
    if (timer_stage=4) and (fugg2&gt;60){
        timer_stage=5;// if (!instance_exists(obj_pnunit)) or (!instance_exists(obj_enunit)){alarm[5]=1;started=4;defeat_message=1;}
    }
    
    if (timer_stage!=4) then fugg2=0;
    
    
    
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
draw_sprite(spr_rock_bg,0,0,0);

draw_set_color(c_black);draw_set_alpha(1);
draw_rectangle(0,0,800,900,0);
draw_rectangle(818,235,1578,666,0);

draw_set_color(38144);

var l;l=0;
draw_set_alpha(1);draw_rectangle(0+l,0+l,800-l,900-l,1);l+=1;
draw_set_alpha(0.75);draw_rectangle(0+l,0+l,800-l,900-l,1);l+=1;
draw_set_alpha(0.5);draw_rectangle(0+l,0+l,800-l,900-l,1);l+=1;
draw_set_alpha(0.25);draw_rectangle(0+l,0+l,6800-l,900-l,1);

l=0;
draw_set_alpha(1);draw_rectangle(818+l,235+l,1578-l,666-l,1);l+=1;
draw_set_alpha(0.75);draw_rectangle(818+l,235+l,1578-l,666-l,1);l+=1;
draw_set_alpha(0.5);draw_rectangle(818+l,235+l,1578-l,666-l,1);l+=1;
draw_set_alpha(0.25);draw_rectangle(818+l,235+l,1578-l,666-l,1);


l=0;draw_set_alpha(1);
draw_set_font(fnt_40k_14);

if (display_p1&gt;0) and (player_forces&gt;0){
    draw_set_color(c_yellow);draw_set_halign(fa_left);
    draw_text(64,880,string(display_p1n)+": "+string(display_p1)+"HP");
}
if (display_p2&gt;0) and (enemy_forces&gt;0){
    draw_set_color(c_yellow);draw_set_halign(fa_right);
    draw_text(800-64,880,string(display_p2n)+": "+string(display_p2)+"HP");
}

draw_set_halign(fa_left);



repeat(45){l+=1;
    // draw_text(x+6,y-10+(l*14),"."+string(lines[31-l]));
    draw_set_color(38144);
    if (lines_color[l]="red") then draw_set_color(255);
    if (lines_color[l]="yellow") then draw_set_color(3055825);
    if (lines_color[l]="purple") then draw_set_color(c_purple);
    if (lines_color[l]="bright") then draw_set_color(65280);
    if (lines_color[l]="white") then draw_set_color(c_silver);
    if (lines_color[l]="blue"){
        var yep;yep=false;
        if (obj_ini.adv[1]="Daemon Binders") or (obj_ini.adv[2]="Daemon Binders") or (obj_ini.adv[3]="Daemon Binders") or (obj_ini.adv[4]="Daemon Binders") then yep=true;
        if (yep=false) then draw_set_color(16711680);
        if (yep=true) then draw_set_color(16646566);
    }
    draw_text(x+6,y-10+(l*18),string(lines[l]));
}

draw_set_color(38144);
if (fix_timer&lt;=0){
    if (fadein&lt;0) and (fadein&gt;-100) and (started=0){
        draw_set_alpha((fadein*-1)/30);
        draw_set_halign(fa_center);
        draw_text(400,860,"[Press Enter to Begin]");
    }
    if (started=2) or ((started=1) and ((timer_stage=3) or (timer_stage=5) or (timer_stage=0))) or (started=4){
        draw_set_halign(fa_center);
        draw_text(400,860,"[Press Enter to Continue]");
    }
    if (started=3) or (started=5){
        draw_set_halign(fa_center);
        draw_text(400,860,"[Press Enter to Exit]");
    }
}



draw_set_halign(fa_left);draw_set_alpha(1);

// Timer
// draw_rectangle(16,464,min(16+(timer*2.026),624),472,0);


// draw_text(320,300,"Turn: "+string(turns));


draw_set_color(c_black);
draw_set_alpha(fadein/30);
draw_rectangle(0,0,1600,900,0);
draw_set_alpha(1);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="67">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
// instance_activate_object(obj_cursor);

// with(obj_enunit){instance_destroy();}


if (global.cheat_debug=true){
var i;i=0;
    repeat(30){i+=1;
        if (message[i]!="") then show_message(string(message[i]));
    }
}


// argument0: the item in question
// argument1: planet name, or "" for space
// argument2: planet or SID
// argument3: remove?

// scr_check_equip("Plasma Bomb",battle_loc,battle_id,0);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="13">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Start the battle</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>404</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_number</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>10</kind>
            <object>obj_popup</object>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>cd</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>1</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>fix_timer</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>1</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>

// with(ob_ennt){shomesge(string(dudes[1])+"|"+string(dudes_num[1])+"|"+string(men+medi)+"|"+string(dudes_hp[1]));}

// 135;
// instance_activate_object(obj_cursor);



if (started&gt;=2) then instance_activate_object(obj_pnunit);

if (started=3){
    instance_activate_all();
    instance_activate_object(obj_pnunit);
    instance_activate_object(obj_enunit);
    if (instance_exists(obj_pnunit)){obj_pnunit.alarm[6]=1;}
    
    alarm[7]=2;
    fix_timer=15;
}

// if (done&gt;=1) then exit;

if ((started=2) or (started=4)){
    instance_activate_object(obj_pnunit);instance_activate_object(obj_enunit);
    // started=3;alarm[5]=3;obj_pnunit.alarm[4]=1;obj_pnunit.alarm[5]=2;obj_enunit.alarm[1]=3;
    started=3;
    // obj_pnunit.alarm[4]=2;obj_pnunit.alarm[5]=3;obj_enunit.alarm[1]=1;
    if (instance_exists(obj_pnunit)){
        obj_pnunit.alarm[4]=2;
        obj_pnunit.alarm[5]=3;
    }
    if (instance_exists(obj_enunit)){obj_enunit.alarm[1]=1;}
    instance_activate_object(obj_star);
    instance_activate_object(obj_event_log);
    alarm[5]=6;fix_timer=15;
    
    fack=1;
    
    newline="------------------------------------------------------------------------------";scr_newtext();
    newline="------------------------------------------------------------------------------";scr_newtext();
}

if (fadein&lt;0) and (fadein&gt;-100) and (started=0){
    fadein=-500;started=1;timer_speed=1;timer_stage=1;timer=100;
    
    if (enemy=30) then timer_stage=3;
    if (battle_special="ship_demon") then timer_stage=3;
}


if (started&gt;0){// This might be causing problems?
    if (instance_exists(obj_pnunit)) then obj_pnunit.alarm[8]=8;
    if (instance_exists(obj_enunit)) then obj_enunit.alarm[8]=8;
}


if (timer_stage=1) or (timer_stage=5){
    if (global_perils&gt;0) then global_perils-=4;
    if (global_perils&lt;0) then global_perils=0;
    turns+=1;
    
    four_show=0;fix_timer=15;
    // if (battle_over!=1) then alarm[8]=15;

    if (enemy!=6){
        if (instance_exists(obj_pnunit)){
            obj_pnunit.alarm[3]=2;
            obj_pnunit.alarm[1]=3;
            obj_pnunit.alarm[0]=4;
        }
        if (instance_exists(obj_enunit)){obj_enunit.alarm[1]=1;}
        // alarm[9]=5;
        var i;i=0;messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
        repeat(60){i+=1;
            message[i]="";
            message_sz[i]=0;
            message_priority[i]=0;
        }
        timer_stage=2;timer=0;done=0;messages_shown=0;
    }
    if (enemy=6){
        if (instance_exists(obj_enunit)){
            obj_enunit.alarm[1]=2;
            obj_enunit.alarm[0]=3;
        }
        if (instance_exists(obj_pnunit)){obj_pnunit.alarm[1]=1;}
        var i;i=0;messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
        repeat(60){i+=1;
            message[i]="";
            message_sz[i]=0;
            message_priority[i]=0;
        }
        timer_stage=2;timer=0;done=0;messages_shown=0;
    }
}



if (timer_stage=3){
    if (battle_over!=1) then alarm[8]=15;
    fix_timer=15;

    if (enemy!=6){
        if (instance_exists(obj_pnunit)){obj_pnunit.alarm[1]=1;}
        if (instance_exists(obj_enunit)){
            obj_enunit.alarm[1]=2;
            obj_enunit.alarm[0]=3;
            obj_enunit.alarm[8]=4;
            turns+=1;
        }
        var i;i=0;messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
        repeat(60){i+=1;
            message[i]="";
            message_sz[i]=0;
            message_priority[i]=0;
        }
        timer_stage=4;timer=0;done=0;messages_shown=0;
    }
    if (enemy=6){
        if (instance_exists(obj_pnunit)){
            obj_pnunit.alarm[3]=2;
            obj_pnunit.alarm[1]=3;
            obj_pnunit.alarm[0]=4;
            turns+=1;
        }
        if (instance_exists(obj_enunit)){obj_enunit.alarm[1]=1;}
        // alarm[9]=5;
        var i;i=0;messages=0;messages_to_show=8;largest=0;random_messages=0;priority=0;messages_shown=0;
        repeat(60){i+=1;
            message[i]="";
            message_sz[i]=0;
            message_priority[i]=0;
        }
        timer_stage=4;timer=0;done=0;messages_shown=0;
    }
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
